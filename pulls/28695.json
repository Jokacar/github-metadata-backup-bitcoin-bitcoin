{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695",
    "id": 1566935891,
    "node_id": "PR_kwDOABII585dZYtT",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/28695",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/28695.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/28695.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28695",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28695/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
    "number": 28695,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "net: Sanity check private keys received from SAM proxy",
    "user": {
      "login": "dergoegge",
      "id": 8077169,
      "node_id": "MDQ6VXNlcjgwNzcxNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dergoegge",
      "html_url": "https://github.com/dergoegge",
      "followers_url": "https://api.github.com/users/dergoegge/followers",
      "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
      "organizations_url": "https://api.github.com/users/dergoegge/orgs",
      "repos_url": "https://api.github.com/users/dergoegge/repos",
      "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/dergoegge/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Not sanity checking can lead to crashes or worse:\r\n\r\n```\r\n==1715589==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6140000055c2 at pc 0x5622ed66e7ad bp 0x7ffee547a2c0 sp 0x7ffee547a2b8\r\nREAD of size 2 at 0x6140000055c2 thread T0 (b-test)\r\n    #0 0x5622ed66e7ac in memcpy include/bits/string_fortified.h:29:10\r\n    #1 0x5622ed66e7ac in i2p::sam::Session::MyDestination() const src/i2p.cpp:362:5\r\n    #2 0x5622ed662e46 in i2p::sam::Session::CreateIfNotCreatedAlready() src/i2p.cpp:414:40\r\n    #3 0x5622ed6619f2 in i2p::sam::Session::Listen(i2p::Connection&) src/i2p.cpp:143:9\r\n```",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "milestone": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/60",
      "html_url": "https://github.com/bitcoin/bitcoin/milestone/60",
      "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/60/labels",
      "id": 9286970,
      "node_id": "MI_kwDOABII584AjbU6",
      "number": 60,
      "state": "open",
      "title": "26.0",
      "description": "",
      "creator": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "open_issues": 3,
      "closed_issues": 102,
      "created_at": "2023-04-15T11:36:05Z",
      "updated_at": "2023-10-26T15:15:00Z"
    },
    "created_at": "2023-10-20T15:44:45Z",
    "updated_at": "2023-10-30T11:41:51Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "1a5ff19b91207bf24474bd07703a6911e3bdff30",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "dergoegge:2023-10-i2p-sanitize-priv",
      "ref": "2023-10-i2p-sanitize-priv",
      "sha": "5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 315023492,
        "node_id": "MDEwOlJlcG9zaXRvcnkzMTUwMjM0OTI=",
        "name": "bitcoin",
        "full_name": "dergoegge/bitcoin",
        "owner": {
          "login": "dergoegge",
          "id": 8077169,
          "node_id": "MDQ6VXNlcjgwNzcxNjk=",
          "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/dergoegge",
          "html_url": "https://github.com/dergoegge",
          "followers_url": "https://api.github.com/users/dergoegge/followers",
          "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
          "organizations_url": "https://api.github.com/users/dergoegge/orgs",
          "repos_url": "https://api.github.com/users/dergoegge/repos",
          "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/dergoegge/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/dergoegge/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/dergoegge/bitcoin",
        "archive_url": "https://api.github.com/repos/dergoegge/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/dergoegge/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/dergoegge/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/dergoegge/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/dergoegge/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/dergoegge/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/dergoegge/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/dergoegge/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/dergoegge/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/dergoegge/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/dergoegge/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/dergoegge/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/dergoegge/bitcoin/events",
        "forks_url": "https://api.github.com/repos/dergoegge/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/dergoegge/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/dergoegge/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/dergoegge/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/dergoegge/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/dergoegge/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/dergoegge/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/dergoegge/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/dergoegge/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/dergoegge/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/dergoegge/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/dergoegge/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/dergoegge/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/dergoegge/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/dergoegge/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/dergoegge/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:dergoegge/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/dergoegge/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/dergoegge/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/dergoegge/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/dergoegge/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/dergoegge/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/dergoegge/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/dergoegge/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/dergoegge/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/dergoegge/bitcoin/hooks",
        "svn_url": "https://github.com/dergoegge/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 230933,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-10-30T11:41:30Z",
        "created_at": "2020-11-22T11:41:30Z",
        "updated_at": "2023-05-05T12:10:28Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "feae4e04389b89e18a411596c4f2cdc18663a1ef",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35903,
        "stargazers_count": 71976,
        "watchers_count": 71976,
        "size": 243869,
        "default_branch": "master",
        "open_issues_count": 631,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-10-30T11:41:35Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-10-30T11:15:35Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 59,
    "deletions": 0,
    "changed_files": 2,
    "commits": 2,
    "review_comments": 10,
    "comments": 11
  },
  "events": [
    {
      "event": "commented",
      "id": 1772980550,
      "node_id": "IC_kwDOABII585prYlG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1772980550",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-20T15:44:48Z",
      "updated_at": "2023-10-30T11:41:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28695).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [mzumsande](https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1690371059), [kristapsk](https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1783006261) |\n| Stale ACK | [stickies-v](https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1700152008), [vasild](https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1701658433) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1772980550",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28695"
    },
    {
      "event": "labeled",
      "id": 10726158008,
      "node_id": "LE_lADOABII5850gC0mzwAAAAJ_VC64",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10726158008",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-20T15:44:51Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "commented",
      "id": 1772983120,
      "node_id": "IC_kwDOABII585prZNQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1772983120",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-20T15:46:41Z",
      "updated_at": "2023-10-20T15:46:41Z",
      "author_association": "MEMBER",
      "body": "I would greatly appreciate it if someone could write unit tests for this, @vasild @jonatack maybe?",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1772983120",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28695"
    },
    {
      "event": "mentioned",
      "id": 10726174814,
      "node_id": "MEE_lADOABII5850gC0mzwAAAAJ_VHBe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10726174814",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-20T15:46:42Z"
    },
    {
      "event": "subscribed",
      "id": 10726174830,
      "node_id": "SE_lADOABII5850gC0mzwAAAAJ_VHBu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10726174830",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-20T15:46:42Z"
    },
    {
      "event": "mentioned",
      "id": 10726174844,
      "node_id": "MEE_lADOABII5850gC0mzwAAAAJ_VHB8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10726174844",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-20T15:46:42Z"
    },
    {
      "event": "subscribed",
      "id": 10726174858,
      "node_id": "SE_lADOABII5850gC0mzwAAAAJ_VHCK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10726174858",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-20T15:46:42Z"
    },
    {
      "event": "reviewed",
      "id": 1690371059,
      "node_id": "PRR_kwDOABII585kwQPz",
      "url": null,
      "actor": null,
      "commit_id": "1e6d1dbd4a5ea90ddac9b4bc3a08247f1131db0c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nI think that keys that are loaded from disk (`ReadBinaryFile()`) also should be sanitized. That's what made the fuzzer crash in #28665.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1690371059",
      "submitted_at": "2023-10-20T15:53:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
    },
    {
      "event": "reviewed",
      "id": 1690585049,
      "node_id": "PRR_kwDOABII585kxEfZ",
      "url": null,
      "actor": null,
      "commit_id": "1e6d1dbd4a5ea90ddac9b4bc3a08247f1131db0c",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1690585049",
      "submitted_at": "2023-10-20T17:16:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
    },
    {
      "event": "labeled",
      "id": 10727964556,
      "node_id": "LE_lADOABII5850gC0mzwAAAAJ_b7-M",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10727964556",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-20T19:05:57Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1691269821,
      "node_id": "PRR_kwDOABII585kzrq9",
      "url": null,
      "actor": null,
      "commit_id": "1e6d1dbd4a5ea90ddac9b4bc3a08247f1131db0c",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "body": "",
      "user": {
        "login": "cacrowley",
        "id": 80238672,
        "node_id": "MDQ6VXNlcjgwMjM4Njcy",
        "avatar_url": "https://avatars.githubusercontent.com/u/80238672?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/cacrowley",
        "html_url": "https://github.com/cacrowley",
        "followers_url": "https://api.github.com/users/cacrowley/followers",
        "following_url": "https://api.github.com/users/cacrowley/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/cacrowley/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/cacrowley/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/cacrowley/subscriptions",
        "organizations_url": "https://api.github.com/users/cacrowley/orgs",
        "repos_url": "https://api.github.com/users/cacrowley/repos",
        "events_url": "https://api.github.com/users/cacrowley/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/cacrowley/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1691269821",
      "submitted_at": "2023-10-21T14:48:10Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
    },
    {
      "event": "reviewed",
      "id": 1691269899,
      "node_id": "PRR_kwDOABII585kzrsL",
      "url": null,
      "actor": null,
      "commit_id": "1e6d1dbd4a5ea90ddac9b4bc3a08247f1131db0c",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "body": "",
      "user": {
        "login": "cacrowley",
        "id": 80238672,
        "node_id": "MDQ6VXNlcjgwMjM4Njcy",
        "avatar_url": "https://avatars.githubusercontent.com/u/80238672?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/cacrowley",
        "html_url": "https://github.com/cacrowley",
        "followers_url": "https://api.github.com/users/cacrowley/followers",
        "following_url": "https://api.github.com/users/cacrowley/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/cacrowley/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/cacrowley/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/cacrowley/subscriptions",
        "organizations_url": "https://api.github.com/users/cacrowley/orgs",
        "repos_url": "https://api.github.com/users/cacrowley/repos",
        "events_url": "https://api.github.com/users/cacrowley/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/cacrowley/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1691269899",
      "submitted_at": "2023-10-21T14:48:46Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10733278075,
      "node_id": "HRFPE_lADOABII5850gC0mzwAAAAJ_wNN7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10733278075",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-22T13:15:02Z"
    },
    {
      "event": "commented",
      "id": 1774716867,
      "node_id": "IC_kwDOABII585pyAfD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774716867",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T08:49:24Z",
      "updated_at": "2023-10-23T08:49:24Z",
      "author_association": "MEMBER",
      "body": "This should probably be in the 26.0 milestone?",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1774716867",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28695"
    },
    {
      "event": "milestoned",
      "id": 10737690045,
      "node_id": "MIE_lADOABII5850gC0mzwAAAAKABCW9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10737690045",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T08:51:40Z",
      "milestone": {
        "title": "26.0"
      }
    },
    {
      "event": "commented",
      "id": 1774741614,
      "node_id": "IC_kwDOABII585pyGhu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774741614",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T09:03:18Z",
      "updated_at": "2023-10-23T09:03:18Z",
      "author_association": "MEMBER",
      "body": "To what extent is the proxy trusted, and to what extent is it required to validate inputs from it? I think it would be good to first document that and then design unit and fuzz tests based on that design assumption?",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1774741614",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28695"
    },
    {
      "event": "commented",
      "id": 1774747837,
      "node_id": "IC_kwDOABII585pyIC9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774747837",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T09:06:46Z",
      "updated_at": "2023-10-23T09:06:46Z",
      "author_association": "MEMBER",
      "body": "typo-nit: `received`",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1774747837",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28695"
    },
    {
      "event": "renamed",
      "id": 10737881561,
      "node_id": "RTE_lADOABII5850gC0mzwAAAAKABxHZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10737881561",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T09:07:40Z",
      "rename": {
        "from": "net: Sanitize private keys recevied from SAM proxy",
        "to": "net: Sanitize private keys received from SAM proxy"
      }
    },
    {
      "event": "commented",
      "id": 1774753670,
      "node_id": "IC_kwDOABII585pyJeG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774753670",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T09:10:06Z",
      "updated_at": "2023-10-23T09:10:06Z",
      "author_association": "MEMBER",
      "body": "> To what extent is the proxy trusted, and to what extent is it required to validate inputs from it?\r\n\r\n@jonatack @vasild @zzzi2p",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1774753670",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28695"
    },
    {
      "event": "mentioned",
      "id": 10737909409,
      "node_id": "MEE_lADOABII5850gC0mzwAAAAKAB36h",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10737909409",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T09:10:06Z"
    },
    {
      "event": "subscribed",
      "id": 10737909439,
      "node_id": "SE_lADOABII5850gC0mzwAAAAKAB36_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10737909439",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T09:10:06Z"
    },
    {
      "event": "mentioned",
      "id": 10737909466,
      "node_id": "MEE_lADOABII5850gC0mzwAAAAKAB37a",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10737909466",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T09:10:06Z"
    },
    {
      "event": "subscribed",
      "id": 10737909483,
      "node_id": "SE_lADOABII5850gC0mzwAAAAKAB37r",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10737909483",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T09:10:06Z"
    },
    {
      "event": "mentioned",
      "id": 10737909511,
      "node_id": "MEE_lADOABII5850gC0mzwAAAAKAB38H",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10737909511",
      "actor": {
        "login": "zzzi2p",
        "id": 62618568,
        "node_id": "MDQ6VXNlcjYyNjE4NTY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/62618568?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/zzzi2p",
        "html_url": "https://github.com/zzzi2p",
        "followers_url": "https://api.github.com/users/zzzi2p/followers",
        "following_url": "https://api.github.com/users/zzzi2p/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/zzzi2p/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/zzzi2p/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/zzzi2p/subscriptions",
        "organizations_url": "https://api.github.com/users/zzzi2p/orgs",
        "repos_url": "https://api.github.com/users/zzzi2p/repos",
        "events_url": "https://api.github.com/users/zzzi2p/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/zzzi2p/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T09:10:06Z"
    },
    {
      "event": "subscribed",
      "id": 10737909529,
      "node_id": "SE_lADOABII5850gC0mzwAAAAKAB38Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10737909529",
      "actor": {
        "login": "zzzi2p",
        "id": 62618568,
        "node_id": "MDQ6VXNlcjYyNjE4NTY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/62618568?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/zzzi2p",
        "html_url": "https://github.com/zzzi2p",
        "followers_url": "https://api.github.com/users/zzzi2p/followers",
        "following_url": "https://api.github.com/users/zzzi2p/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/zzzi2p/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/zzzi2p/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/zzzi2p/subscriptions",
        "organizations_url": "https://api.github.com/users/zzzi2p/orgs",
        "repos_url": "https://api.github.com/users/zzzi2p/repos",
        "events_url": "https://api.github.com/users/zzzi2p/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/zzzi2p/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T09:10:06Z"
    },
    {
      "event": "commented",
      "id": 1775063452,
      "node_id": "IC_kwDOABII585pzVGc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1775063452",
      "actor": {
        "login": "zzzi2p",
        "id": 62618568,
        "node_id": "MDQ6VXNlcjYyNjE4NTY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/62618568?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/zzzi2p",
        "html_url": "https://github.com/zzzi2p",
        "followers_url": "https://api.github.com/users/zzzi2p/followers",
        "following_url": "https://api.github.com/users/zzzi2p/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/zzzi2p/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/zzzi2p/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/zzzi2p/subscriptions",
        "organizations_url": "https://api.github.com/users/zzzi2p/orgs",
        "repos_url": "https://api.github.com/users/zzzi2p/repos",
        "events_url": "https://api.github.com/users/zzzi2p/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/zzzi2p/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T12:16:38Z",
      "updated_at": "2023-10-23T12:18:21Z",
      "author_association": "NONE",
      "body": "The i2pd crash in OP should be reported to that project and/or @orignal\r\n\r\nJava I2P probably won't crash on bad input and we do some validation of public and private keys but we can't promise to catch everything.\r\n\r\nThe format is a little elaborate, I don't know how far down you want to go. Would you validate the individual key fields? Would you check for pubkey/privkey mismatches? Just basic length checks?\r\n\r\nFrom the SAM spec:\r\n\r\n```\r\nThe $privkey is the base 64 of the concatenation of the [Destination](https://geti2p.net/en/docs/spec/common-structures#type_Destination) \r\nfollowed by the [Private Key](https://geti2p.net/en/docs/spec/common-structures#type_PrivateKey) \r\nfollowed by the [Signing Private Key](https://geti2p.net/en/docs/spec/common-structures#type_SigningPrivateKey),\r\n optionally followed by the [Offline Signature](https://geti2p.net/en/docs/spec/common-structures#struct_OfflineSignature), \r\nwhich is 663 or more bytes in binary and 884 or more bytes in base 64, depending on signature type. \r\nThe binary format is specified in [Private Key File](https://github.com/i2p/i2p.i2p/blob/master/core/java/src/net/i2p/data/PrivateKeyFile.java). \r\nSee additional notes about the [Private Key](https://geti2p.net/en/docs/spec/common-structures#type_PrivateKey)\r\n in the Destination Key Generation section below.\r\n\r\nIf the signing private key is all zeros, \r\nthe [Offline Signature](https://geti2p.net/en/docs/spec/common-structures#struct_OfflineSignature) \r\nsection follows....\r\n```\r\n\r\nAnd there's more near the bottom in the 'Destination Key Generation' section of https://geti2p.net/en/docs/api/samv3\r\n\r\nYou're not using offline signatures so you can skip that part.\r\n\r\nI can't really answer your question about \"trust\" in SAM. It probably won't send you bad input, and in most cases you can treat the private key as an opaque string without \"validation\". So as long as you don't corrupt it when you store and retrieve it, you should be fine. But it's up to you.",
      "user": {
        "login": "zzzi2p",
        "id": 62618568,
        "node_id": "MDQ6VXNlcjYyNjE4NTY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/62618568?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/zzzi2p",
        "html_url": "https://github.com/zzzi2p",
        "followers_url": "https://api.github.com/users/zzzi2p/followers",
        "following_url": "https://api.github.com/users/zzzi2p/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/zzzi2p/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/zzzi2p/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/zzzi2p/subscriptions",
        "organizations_url": "https://api.github.com/users/zzzi2p/orgs",
        "repos_url": "https://api.github.com/users/zzzi2p/repos",
        "events_url": "https://api.github.com/users/zzzi2p/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/zzzi2p/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1775063452",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28695"
    },
    {
      "event": "mentioned",
      "id": 10739935414,
      "node_id": "MEE_lADOABII5850gC0mzwAAAAKAJmi2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10739935414",
      "actor": {
        "login": "orignal",
        "id": 5358364,
        "node_id": "MDQ6VXNlcjUzNTgzNjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5358364?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/orignal",
        "html_url": "https://github.com/orignal",
        "followers_url": "https://api.github.com/users/orignal/followers",
        "following_url": "https://api.github.com/users/orignal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/orignal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/orignal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/orignal/subscriptions",
        "organizations_url": "https://api.github.com/users/orignal/orgs",
        "repos_url": "https://api.github.com/users/orignal/repos",
        "events_url": "https://api.github.com/users/orignal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/orignal/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T12:16:39Z"
    },
    {
      "event": "subscribed",
      "id": 10739935439,
      "node_id": "SE_lADOABII5850gC0mzwAAAAKAJmjP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10739935439",
      "actor": {
        "login": "orignal",
        "id": 5358364,
        "node_id": "MDQ6VXNlcjUzNTgzNjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5358364?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/orignal",
        "html_url": "https://github.com/orignal",
        "followers_url": "https://api.github.com/users/orignal/followers",
        "following_url": "https://api.github.com/users/orignal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/orignal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/orignal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/orignal/subscriptions",
        "organizations_url": "https://api.github.com/users/orignal/orgs",
        "repos_url": "https://api.github.com/users/orignal/repos",
        "events_url": "https://api.github.com/users/orignal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/orignal/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T12:16:39Z"
    },
    {
      "event": "commented",
      "id": 1775075623,
      "node_id": "IC_kwDOABII585pzYEn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1775075623",
      "actor": {
        "login": "zzzi2p",
        "id": 62618568,
        "node_id": "MDQ6VXNlcjYyNjE4NTY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/62618568?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/zzzi2p",
        "html_url": "https://github.com/zzzi2p",
        "followers_url": "https://api.github.com/users/zzzi2p/followers",
        "following_url": "https://api.github.com/users/zzzi2p/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/zzzi2p/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/zzzi2p/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/zzzi2p/subscriptions",
        "organizations_url": "https://api.github.com/users/zzzi2p/orgs",
        "repos_url": "https://api.github.com/users/zzzi2p/repos",
        "events_url": "https://api.github.com/users/zzzi2p/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/zzzi2p/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T12:23:45Z",
      "updated_at": "2023-10-23T12:23:45Z",
      "author_association": "NONE",
      "body": "Ah, correction, OP is a bitcoin crash not a i2pd crash, apologies to @orignal",
      "user": {
        "login": "zzzi2p",
        "id": 62618568,
        "node_id": "MDQ6VXNlcjYyNjE4NTY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/62618568?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/zzzi2p",
        "html_url": "https://github.com/zzzi2p",
        "followers_url": "https://api.github.com/users/zzzi2p/followers",
        "following_url": "https://api.github.com/users/zzzi2p/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/zzzi2p/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/zzzi2p/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/zzzi2p/subscriptions",
        "organizations_url": "https://api.github.com/users/zzzi2p/orgs",
        "repos_url": "https://api.github.com/users/zzzi2p/repos",
        "events_url": "https://api.github.com/users/zzzi2p/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/zzzi2p/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1775075623",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28695"
    },
    {
      "event": "mentioned",
      "id": 10740012273,
      "node_id": "MEE_lADOABII5850gC0mzwAAAAKAJ5Tx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10740012273",
      "actor": {
        "login": "orignal",
        "id": 5358364,
        "node_id": "MDQ6VXNlcjUzNTgzNjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5358364?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/orignal",
        "html_url": "https://github.com/orignal",
        "followers_url": "https://api.github.com/users/orignal/followers",
        "following_url": "https://api.github.com/users/orignal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/orignal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/orignal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/orignal/subscriptions",
        "organizations_url": "https://api.github.com/users/orignal/orgs",
        "repos_url": "https://api.github.com/users/orignal/repos",
        "events_url": "https://api.github.com/users/orignal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/orignal/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T12:23:45Z"
    },
    {
      "event": "subscribed",
      "id": 10740012297,
      "node_id": "SE_lADOABII5850gC0mzwAAAAKAJ5UJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10740012297",
      "actor": {
        "login": "orignal",
        "id": 5358364,
        "node_id": "MDQ6VXNlcjUzNTgzNjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5358364?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/orignal",
        "html_url": "https://github.com/orignal",
        "followers_url": "https://api.github.com/users/orignal/followers",
        "following_url": "https://api.github.com/users/orignal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/orignal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/orignal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/orignal/subscriptions",
        "organizations_url": "https://api.github.com/users/orignal/orgs",
        "repos_url": "https://api.github.com/users/orignal/repos",
        "events_url": "https://api.github.com/users/orignal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/orignal/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T12:23:45Z"
    },
    {
      "event": "commented",
      "id": 1775432406,
      "node_id": "IC_kwDOABII585p0vLW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1775432406",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-23T15:13:55Z",
      "updated_at": "2023-10-23T15:13:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "> To what extent is the proxy trusted, and to what extent is it required to validate inputs from it? I think it would be good to first document that and then design unit and fuzz tests based on that design assumption?\r\n\r\nWouldn't it be best to write error handling code / tests on the assumption that no external input source should be able to cause memory corruption within `bitcoind` - including trusted ones, like the datadir?",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1775432406",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28695"
    },
    {
      "event": "reviewed",
      "id": 1692484042,
      "node_id": "PRR_kwDOABII585k4UHK",
      "url": null,
      "actor": null,
      "commit_id": "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\n~I think I would prefer the constructor of `Binary` to do size sanity checks so we don't need to call a helper function any time we use a `Binary`, but it seems this doesn't pair very elegantly with the lazy construction approach of `sam::Session`. Below a diff of one such example implementation that passes unit tests by making `m_private_key` a `std::optional<Binary>` (using not-super-safe dereferencing on `m_private_key` for now just to PoC it)~ _edit: I think vasild's [approach](https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1370087750) is better_\r\n\r\n<details>\r\n<summary>git diff on 9ff405e9bb</summary>\r\n\r\n```diff\r\ndiff --git a/src/i2p.cpp b/src/i2p.cpp\r\nindex 1b8345059e..fc5d23e8fb 100644\r\n--- a/src/i2p.cpp\r\n+++ b/src/i2p.cpp\r\n@@ -77,19 +77,6 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\r\n     return std::move(*decoded);\r\n }\r\n \r\n-static Binary SanitizePrivKey(Binary&& binary)\r\n-{\r\n-    if (binary.size() < 387) {\r\n-        throw std::runtime_error(\"Private key too small (size < 387 bytes)\");\r\n-    }\r\n-\r\n-    if (binary.size() > (387 + std::numeric_limits<uint16_t>::max())) {\r\n-        throw std::runtime_error(\"Private key too large\");\r\n-    }\r\n-\r\n-    return binary;\r\n-}\r\n-\r\n /**\r\n  * Derive the .b32.i2p address of an I2P destination (binary).\r\n  * @param[in] dest I2P destination.\r\n@@ -340,7 +327,7 @@ void Session::DestGenerate(const Sock& sock)\r\n     // If SIGNATURE_TYPE is not specified, then the default one is DSA_SHA1.\r\n     const Reply& reply = SendRequestAndGetReply(sock, \"DEST GENERATE SIGNATURE_TYPE=7\", false);\r\n \r\n-    m_private_key = SanitizePrivKey(DecodeI2PBase64(reply.Get(\"PRIV\")));\r\n+    m_private_key = DecodeI2PBase64(reply.Get(\"PRIV\"));\r\n }\r\n \r\n void Session::GenerateAndSavePrivateKey(const Sock& sock)\r\n@@ -349,7 +336,7 @@ void Session::GenerateAndSavePrivateKey(const Sock& sock)\r\n \r\n     // umask is set to 0077 in common/system.cpp, which is ok.\r\n     if (!WriteBinaryFile(m_private_key_file,\r\n-                         std::string(m_private_key.begin(), m_private_key.end()))) {\r\n+                         std::string(m_private_key->begin(), m_private_key->end()))) {\r\n         throw std::runtime_error(\r\n             strprintf(\"Cannot save I2P private key to %s\", fs::quoted(fs::PathToString(m_private_key_file))));\r\n     }\r\n@@ -364,16 +351,16 @@ Binary Session::MyDestination() const\r\n     static constexpr size_t CERT_LEN_POS = 385;\r\n \r\n     uint16_t cert_len;\r\n-    memcpy(&cert_len, &m_private_key.at(CERT_LEN_POS), sizeof(cert_len));\r\n+    memcpy(&cert_len, &m_private_key->at(CERT_LEN_POS), sizeof(cert_len));\r\n     cert_len = be16toh(cert_len);\r\n \r\n     const size_t dest_len = DEST_LEN_BASE + cert_len;\r\n \r\n-    if (dest_len > m_private_key.size()) {\r\n+    if (dest_len > m_private_key->size()) {\r\n         throw std::runtime_error(\"Certificate length did not match the actual private key length\");\r\n     }\r\n \r\n-    return Binary{m_private_key.begin(), m_private_key.begin() + dest_len};\r\n+    return Binary{m_private_key->begin(), m_private_key->begin() + dest_len};\r\n }\r\n \r\n void Session::CreateIfNotCreatedAlready()\r\n@@ -399,18 +386,18 @@ void Session::CreateIfNotCreatedAlready()\r\n                       \"inbound.quantity=1 outbound.quantity=1\",\r\n                       session_id));\r\n \r\n-        m_private_key = SanitizePrivKey(DecodeI2PBase64(reply.Get(\"DESTINATION\")));\r\n+        m_private_key = DecodeI2PBase64(reply.Get(\"DESTINATION\"));\r\n     } else {\r\n         // Read our persistent destination (private key) from disk or generate\r\n         // one and save it to disk. Then use it when creating the session.\r\n         const auto& [read_ok, data] = ReadBinaryFile(m_private_key_file);\r\n         if (read_ok) {\r\n-            m_private_key = SanitizePrivKey(Binary{data.begin(), data.end()});\r\n+            m_private_key = Binary{data.begin(), data.end()};\r\n         } else {\r\n             GenerateAndSavePrivateKey(*sock);\r\n         }\r\n \r\n-        const std::string& private_key_b64 = SwapBase64(EncodeBase64(m_private_key));\r\n+        const std::string& private_key_b64 = SwapBase64(EncodeBase64(m_private_key.value()));\r\n \r\n         SendRequestAndGetReply(*sock,\r\n                                strprintf(\"SESSION CREATE STYLE=STREAM ID=%s DESTINATION=%s \"\r\ndiff --git a/src/i2p.h b/src/i2p.h\r\nindex cb9da64816..e5bcef53e5 100644\r\n--- a/src/i2p.h\r\n+++ b/src/i2p.h\r\n@@ -23,7 +23,31 @@ namespace i2p {\r\n /**\r\n  * Binary data.\r\n  */\r\n-using Binary = std::vector<uint8_t>;\r\n+class Binary {\r\n+private:\r\n+    std::vector<uint8_t> m_data;\r\n+    void Validate() const {\r\n+        if (m_data.size() < 387) {\r\n+            throw std::runtime_error(\"Private key too small (size < 387 bytes)\");\r\n+        } else if (m_data.size() > (387 + std::numeric_limits<uint16_t>::max())) {\r\n+            throw std::runtime_error(\"Private key too large\");\r\n+        }\r\n+    }\r\n+\r\n+public:\r\n+    template<typename... Args>\r\n+    Binary(Args&&... args) : m_data(std::forward<Args>(args)...) { Validate(); }\r\n+\r\n+    operator Span<const uint8_t>() const { return m_data; }\r\n+\r\n+    // forward to std::vector methods\r\n+    template<typename... Args>\r\n+    auto& at(Args&&... args) const { return m_data.at(std::forward<Args>(args)...); }\r\n+    auto begin() const { return m_data.begin(); }\r\n+    auto data() const { return m_data.data(); }\r\n+    auto end() const { return m_data.end(); }\r\n+    auto size() const { return m_data.size(); }\r\n+};\r\n \r\n /**\r\n  * An established connection with another peer.\r\n@@ -253,7 +277,7 @@ private:\r\n      * The private key of this peer.\r\n      * @see The reply to the \"DEST GENERATE\" command in https://geti2p.net/en/docs/api/samv3\r\n      */\r\n-    Binary m_private_key GUARDED_BY(m_mutex);\r\n+    std::optional<Binary> m_private_key GUARDED_BY(m_mutex);\r\n \r\n     /**\r\n      * SAM control socket.\r\n\r\n```\r\n</details>\r\n",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1692484042",
      "submitted_at": "2023-10-23T15:47:56Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
    },
    {
      "event": "commented",
      "id": 1776724021,
      "node_id": "IC_kwDOABII585p5qg1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1776724021",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-24T08:06:58Z",
      "updated_at": "2023-10-24T08:06:58Z",
      "author_association": "MEMBER",
      "body": "In any case, I don't think this is a blocker for rc1. It is not a regression and this diff can be added to rc2 trivially.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1776724021",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28695"
    },
    {
      "event": "reviewed",
      "id": 1694729744,
      "node_id": "PRR_kwDOABII585lA4YQ",
      "url": null,
      "actor": null,
      "commit_id": "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1694729744",
      "submitted_at": "2023-10-24T12:35:11Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
    },
    {
      "event": "unlabeled",
      "id": 10765647663,
      "node_id": "UNLE_lADOABII5850gC0mzwAAAAKBrr8v",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10765647663",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-25T10:55:50Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNmNzBhOGQ1NjUxMGE1ZjA3ZWZmMGZkNzczMTg0Y2FlMTRiMmRjYzk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cf70a8d56510a5f07eff0fd773184cae14b2dcc9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/cf70a8d56510a5f07eff0fd773184cae14b2dcc9",
      "tree": {
        "sha": "ff3254018e00ef5566dd2e6a506e6ccb568a9f8f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ff3254018e00ef5566dd2e6a506e6ccb568a9f8f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/106ab20f121f14d021725c8a657999079dbabfc1",
          "sha": "106ab20f121f14d021725c8a657999079dbabfc1",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/106ab20f121f14d021725c8a657999079dbabfc1"
        }
      ],
      "message": "[net] Check i2p private key constraints\n\nCo-authored-by: Vasil Dimov <vd@FreeBSD.org>",
      "committer": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2023-10-26T15:50:50Z"
      },
      "author": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2023-10-26T15:50:02Z"
      },
      "sha": "cf70a8d56510a5f07eff0fd773184cae14b2dcc9"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10781875196,
      "node_id": "HRFPE_lADOABII5850gC0mzwAAAAKCplv8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10781875196",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-26T15:54:54Z"
    },
    {
      "event": "renamed",
      "id": 10781890635,
      "node_id": "RTE_lADOABII5850gC0mzwAAAAKCpphL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10781890635",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-26T15:56:23Z",
      "rename": {
        "from": "net: Sanitize private keys received from SAM proxy",
        "to": "net: Sanity check private keys received from SAM proxy"
      }
    },
    {
      "event": "reviewed",
      "id": 1700152008,
      "node_id": "PRR_kwDOABII585lVkLI",
      "url": null,
      "actor": null,
      "commit_id": "adb5d6b8df575cacfdaf4223289bff7093d15639",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK adb5d6b8df575cacfdaf4223289bff7093d15639",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1700152008",
      "submitted_at": "2023-10-26T18:41:57Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
    },
    {
      "event": "review_requested",
      "id": 10783540247,
      "node_id": "RRE_lADOABII5850gC0mzwAAAAKCv8QX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10783540247",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-26T18:42:01Z",
      "requested_reviewer": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "review_requested",
      "id": 10783540361,
      "node_id": "RRE_lADOABII5850gC0mzwAAAAKCv8SJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10783540361",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-26T18:42:02Z",
      "requested_reviewer": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "reviewed",
      "id": 1701288573,
      "node_id": "PRR_kwDOABII585lZ5p9",
      "url": null,
      "actor": null,
      "commit_id": "adb5d6b8df575cacfdaf4223289bff7093d15639",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1701288573",
      "submitted_at": "2023-10-27T08:43:38Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
    },
    {
      "event": "reviewed",
      "id": 1701658433,
      "node_id": "PRR_kwDOABII585lbT9B",
      "url": null,
      "actor": null,
      "commit_id": "adb5d6b8df575cacfdaf4223289bff7093d15639",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK adb5d6b8df575cacfdaf4223289bff7093d15639",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#pullrequestreview-1701658433",
      "submitted_at": "2023-10-27T12:18:42Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
    },
    {
      "event": "commented",
      "id": 1783006261,
      "node_id": "IC_kwDOABII585qRoQ1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1783006261",
      "actor": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-27T14:23:29Z",
      "updated_at": "2023-10-27T14:23:29Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "kristapsk",
        "id": 4500994,
        "node_id": "MDQ6VXNlcjQ1MDA5OTQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4500994?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kristapsk",
        "html_url": "https://github.com/kristapsk",
        "followers_url": "https://api.github.com/users/kristapsk/followers",
        "following_url": "https://api.github.com/users/kristapsk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kristapsk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kristapsk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kristapsk/subscriptions",
        "organizations_url": "https://api.github.com/users/kristapsk/orgs",
        "repos_url": "https://api.github.com/users/kristapsk/repos",
        "events_url": "https://api.github.com/users/kristapsk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kristapsk/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#issuecomment-1783006261",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28695"
    },
    {
      "event": "referenced",
      "id": 10798398860,
      "node_id": "REFE_lADOABII5850gC0mzwAAAAKDon2M",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10798398860",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "272785aaea1fded13d5b125777f025fb658a8f43",
      "commit_url": "https://api.github.com/repos/bitcoinknots/bitcoin/commits/272785aaea1fded13d5b125777f025fb658a8f43",
      "created_at": "2023-10-28T18:59:38Z"
    },
    {
      "event": "referenced",
      "id": 10798398867,
      "node_id": "REFE_lADOABII5850gC0mzwAAAAKDon2T",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10798398867",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "14881cb1806e97330e97810cae7afb08b9e1808f",
      "commit_url": "https://api.github.com/repos/bitcoinknots/bitcoin/commits/14881cb1806e97330e97810cae7afb08b9e1808f",
      "created_at": "2023-10-28T18:59:38Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDVjZjRkMjY2ZDliMWU3YmQ5Mzk0ZTc1ODEzOThkZTViYzU0MGFlOTk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
      "tree": {
        "sha": "05245640c1ac78583b75ca0d399607977f68822d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/05245640c1ac78583b75ca0d399607977f68822d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cf70a8d56510a5f07eff0fd773184cae14b2dcc9",
          "sha": "cf70a8d56510a5f07eff0fd773184cae14b2dcc9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/cf70a8d56510a5f07eff0fd773184cae14b2dcc9"
        }
      ],
      "message": "[test] Test i2p private key constraints",
      "committer": {
        "name": "dergoegge",
        "email": "n.goeggi@gmail.com",
        "date": "2023-10-30T11:41:11Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-10-26T15:52:04Z"
      },
      "sha": "5cf4d266d9b1e7bd9394e7581398de5bc540ae99"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10806464533,
      "node_id": "HRFPE_lADOABII5850gC0mzwAAAAKEHZAV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10806464533",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-30T11:41:35Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1367292456",
      "pull_request_review_id": 1690585049,
      "id": 1367292456,
      "node_id": "PRRC_kwDOABII585Rfzoo",
      "diff_hunk": "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)\n+{\n+    if (binary.size() < 387) {\n+        throw std::runtime_error(\"Private key to small (size < 387 bytes)\");",
      "path": "src/i2p.cpp",
      "position": null,
      "original_position": 7,
      "commit_id": "5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
      "original_commit_id": "1e6d1dbd4a5ea90ddac9b4bc3a08247f1131db0c",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: typo `to` -> `too` (here and below).",
      "created_at": "2023-10-20T17:15:18Z",
      "updated_at": "2023-10-20T17:16:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1367292456",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1367292456"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 83,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368628730",
      "pull_request_review_id": 1692484042,
      "id": 1368628730,
      "node_id": "PRRC_kwDOABII585Rk536",
      "diff_hunk": "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)\n+{\n+    if (binary.size() < 387) {\n+        throw std::runtime_error(\"Private key too small (size < 387 bytes)\");\n+    }\n+\n+    if (binary.size() > (387 + std::numeric_limits<uint16_t>::max())) {\n+        throw std::runtime_error(\"Private key too large\");\n+    }\n+\n+    return binary;",
      "path": "src/i2p.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
      "original_commit_id": "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    return std::move(binary);\r\n```\r\n\r\n(requires `#include <utility>`)",
      "created_at": "2023-10-23T13:03:45Z",
      "updated_at": "2023-10-23T15:48:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1368628730",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368628730"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 90,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368632024",
      "pull_request_review_id": 1692484042,
      "id": 1368632024,
      "node_id": "PRRC_kwDOABII585Rk6rY",
      "diff_hunk": "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)",
      "path": "src/i2p.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
      "original_commit_id": "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: I find the name a bit misleading as we're not modifying the private key, I'd prefer `ValidatePrivKey{Size}` instead\r\n\r\n```suggestion\r\nstatic Binary ValidatePrivKeySize(Binary&& binary)\r\n```",
      "created_at": "2023-10-23T13:06:19Z",
      "updated_at": "2023-10-23T15:47:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1368632024",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368632024"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 80,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368633060",
      "pull_request_review_id": 1692484042,
      "id": 1368633060,
      "node_id": "PRRC_kwDOABII585Rk67k",
      "diff_hunk": "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)\n+{\n+    if (binary.size() < 387) {\n+        throw std::runtime_error(\"Private key too small (size < 387 bytes)\");\n+    }\n+\n+    if (binary.size() > (387 + std::numeric_limits<uint16_t>::max())) {",
      "path": "src/i2p.cpp",
      "position": null,
      "original_position": 10,
      "commit_id": "5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
      "original_commit_id": "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: since they're mutually exclusive, I think else if would make that more clear\r\n\r\n```suggestion\r\n    } else if (binary.size() > (387 + std::numeric_limits<uint16_t>::max())) {\r\n```",
      "created_at": "2023-10-23T13:07:07Z",
      "updated_at": "2023-10-23T15:47:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1368633060",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368633060"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
        }
      },
      "start_line": null,
      "original_start_line": 84,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 86,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368642646",
      "pull_request_review_id": 1692484042,
      "id": 1368642646,
      "node_id": "PRRC_kwDOABII585Rk9RW",
      "diff_hunk": "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)",
      "path": "src/i2p.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
      "original_commit_id": "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "in_reply_to_id": 1368632024,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Could also use `static const Binary& ValidatePrivKeySize(const Binary& binary LIFETIMEBOUND)` (requires `#include <attributes.h>`) to highlight the constness of `binary` and make the fn accept both lvalues and rvalues? I think this approach would have my preference, but I'm okay with either.",
      "created_at": "2023-10-23T13:12:48Z",
      "updated_at": "2023-10-23T15:47:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1368642646",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1368642646"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 80,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370087750",
      "pull_request_review_id": 1694729744,
      "id": 1370087750,
      "node_id": "PRRC_kwDOABII585RqeFG",
      "diff_hunk": "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)\n+{\n+    if (binary.size() < 387) {",
      "path": "src/i2p.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
      "original_commit_id": "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think it would be better to do the check just before doing the offensive operation. Consider:\r\n\r\n```cpp\r\nvoid f()\r\n{\r\n    if (x >= a.size()) {\r\n        return or throw (dont continue below)\r\n    }\r\n    a[x] = 0;\r\n```\r\nvs\r\n```cpp\r\nvoid f()\r\n{\r\n    a[x] = 0; // it is not immediately obvious if x has been checked\r\n\r\n...\r\n\r\n// somewhere else in the code\r\nif (x >= a.size()) {\r\n    // make sure f() is not called\r\n}\r\n// but new code or a refactor could end up calling f() nevertheless\r\n```\r\n\r\nThe following is shorter and I find it safer and it also avoids using magic numbers (+ unit test):\r\n\r\n```diff\r\ndiff --git i/src/i2p.cpp w/src/i2p.cpp\r\nindex 05a5dde396..685b43ba18 100644\r\n--- i/src/i2p.cpp\r\n+++ w/src/i2p.cpp\r\n@@ -381,17 +381,32 @@ Binary Session::MyDestination() const\r\n     // \"They are 387 bytes plus the certificate length specified at bytes 385-386, which may be\r\n     // non-zero\"\r\n     static constexpr size_t DEST_LEN_BASE = 387;\r\n     static constexpr size_t CERT_LEN_POS = 385;\r\n \r\n     uint16_t cert_len;\r\n+\r\n+    if (m_private_key.size() < CERT_LEN_POS + sizeof(cert_len)) {\r\n+        throw std::runtime_error(strprintf(\"The private key is too short (%d < %d)\",\r\n+                                           m_private_key.size(),\r\n+                                           CERT_LEN_POS + sizeof(cert_len)));\r\n+    }\r\n+\r\n     memcpy(&cert_len, &m_private_key.at(CERT_LEN_POS), sizeof(cert_len));\r\n     cert_len = be16toh(cert_len);\r\n \r\n     const size_t dest_len = DEST_LEN_BASE + cert_len;\r\n \r\n+    if (dest_len > m_private_key.size()) {\r\n+        throw std::runtime_error(strprintf(\"Certificate length (%d) designates that the private key should \"\r\n+                                           \"be %d bytes, but it is only %d bytes\",\r\n+                                           cert_len,\r\n+                                           dest_len,\r\n+                                           m_private_key.size()));\r\n+    }\r\n+\r\n     return Binary{m_private_key.begin(), m_private_key.begin() + dest_len};\r\n }\r\n \r\n void Session::CreateIfNotCreatedAlready()\r\n {\r\n     std::string errmsg;\r\ndiff --git i/src/test/i2p_tests.cpp w/src/test/i2p_tests.cpp\r\nindex 5b8b0e9215..d6bbe4fa8f 100644\r\n--- i/src/test/i2p_tests.cpp\r\n+++ w/src/test/i2p_tests.cpp\r\n@@ -6,12 +6,13 @@\r\n #include <i2p.h>\r\n #include <logging.h>\r\n #include <netaddress.h>\r\n #include <test/util/logging.h>\r\n #include <test/util/net.h>\r\n #include <test/util/setup_common.h>\r\n+#include <util/readwritefile.h>\r\n #include <util/threadinterrupt.h>\r\n \r\n #include <boost/test/unit_test.hpp>\r\n \r\n #include <memory>\r\n #include <string>\r\n@@ -122,7 +123,51 @@ BOOST_AUTO_TEST_CASE(listen_ok_accept_fail)\r\n         ASSERT_DEBUG_LOG(\"Destroying SAM session\");\r\n         BOOST_REQUIRE(session.Listen(conn));\r\n         BOOST_REQUIRE(!session.Accept(conn));\r\n     }\r\n }\r\n \r\n+BOOST_AUTO_TEST_CASE(damaged_private_key)\r\n+{\r\n+    const auto CreateSockOrig = CreateSock;\r\n+\r\n+    CreateSock = [](const CService&) {\r\n+        return std::make_unique<StaticContentsSock>(\"HELLO REPLY RESULT=OK VERSION=3.1\\n\"\r\n+                                                    \"SESSION STATUS RESULT=OK DESTINATION=\\n\");\r\n+    };\r\n+\r\n+    const auto i2p_private_key_file = gArgs.GetDataDirNet() / \"test_i2p_private_key_damaged\";\r\n+\r\n+    for (const auto& [file_contents, expected_error] : std::vector<std::tuple<std::string, std::string>>{\r\n+             {\"\", \"The private key is too short (0 < 387)\"},\r\n+\r\n+             {\"abcd\", \"The private key is too short (4 < 387)\"},\r\n+\r\n+             {std::string(386, '\\0'), \"The private key is too short (386 < 387)\"},\r\n+\r\n+             {std::string(385, '\\0') + '\\0' + '\\1',\r\n+              \"Certificate length (1) designates that the private key should be 388 bytes, but it is only \"\r\n+              \"387 bytes\"},\r\n+\r\n+             {std::string(385, '\\0') + '\\0' + '\\5' + \"abcd\",\r\n+              \"Certificate length (5) designates that the private key should be 392 bytes, but it is only \"\r\n+              \"391 bytes\"}}) {\r\n+\r\n+        BOOST_REQUIRE(WriteBinaryFile(i2p_private_key_file, file_contents));\r\n+\r\n+        CThreadInterrupt interrupt;\r\n+        i2p::sam::Session session(i2p_private_key_file, CService{}, &interrupt);\r\n+\r\n+        {\r\n+            ASSERT_DEBUG_LOG(\"Creating persistent SAM session\");\r\n+            ASSERT_DEBUG_LOG(expected_error);\r\n+\r\n+            i2p::Connection conn;\r\n+            bool proxy_error;\r\n+            BOOST_CHECK(!session.Connect(CService{}, conn, proxy_error));\r\n+        }\r\n+    }\r\n+\r\n+    CreateSock = CreateSockOrig;\r\n+}\r\n+\r\n BOOST_AUTO_TEST_SUITE_END()\r\n```",
      "created_at": "2023-10-24T12:34:58Z",
      "updated_at": "2023-10-24T12:35:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1370087750",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370087750"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 82,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1371165070",
      "pull_request_review_id": 1696386555,
      "id": 1371165070,
      "node_id": "PRRC_kwDOABII585RulGO",
      "diff_hunk": "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)\n+{\n+    if (binary.size() < 387) {",
      "path": "src/i2p.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
      "original_commit_id": "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "in_reply_to_id": 1370087750,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> The following is shorter and I find it safer and it also avoids using magic numbers (+ unit test)\r\n\r\nNice! (and unit test 👍)",
      "created_at": "2023-10-25T05:17:00Z",
      "updated_at": "2023-10-25T05:17:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1371165070",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1371165070"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 82,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1373399307",
      "pull_request_review_id": 1700002703,
      "id": 1373399307,
      "node_id": "PRRC_kwDOABII585R3GkL",
      "diff_hunk": "@@ -77,6 +77,19 @@ static Binary DecodeI2PBase64(const std::string& i2p_b64)\n     return std::move(*decoded);\n }\n \n+static Binary SanitizePrivKey(Binary&& binary)\n+{\n+    if (binary.size() < 387) {",
      "path": "src/i2p.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
      "original_commit_id": "9ff405e9bb338808a2f08f06a5ee3d7da0f7a6c8",
      "in_reply_to_id": 1370087750,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Very nice, thank you!",
      "created_at": "2023-10-26T15:55:40Z",
      "updated_at": "2023-10-26T15:55:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1373399307",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1373399307"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 82,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1374261420",
      "pull_request_review_id": 1701288573,
      "id": 1374261420,
      "node_id": "PRRC_kwDOABII585R6ZCs",
      "diff_hunk": "@@ -45,4 +46,47 @@ BOOST_AUTO_TEST_CASE(unlimited_recv)\n     LogInstance().SetLogLevel(prev_log_level);\n }\n \n+BOOST_AUTO_TEST_CASE(damaged_private_key)\n+{\n+    const auto CreateSockOrig = CreateSock;\n+\n+    CreateSock = [](const CService&) {\n+        return std::make_unique<StaticContentsSock>(\"HELLO REPLY RESULT=OK VERSION=3.1\\n\"\n+                                                    \"SESSION STATUS RESULT=OK DESTINATION=\\n\");\n+    };\n+\n+    const auto i2p_private_key_file = gArgs.GetDataDirNet() / \"test_i2p_private_key_damaged\";",
      "path": "src/test/i2p_tests.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
      "original_commit_id": "adb5d6b8df575cacfdaf4223289bff7093d15639",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    const auto i2p_private_key_file{m_args.GetDataDirNet() / \"test_i2p_private_key_damaged\"};\r\n```\r\n\r\n(if it compiles and passes tests)\r\n\r\nnit (feel free to ignore): Any reason to use the global, when the member is likely to work as well?",
      "created_at": "2023-10-27T08:43:38Z",
      "updated_at": "2023-10-27T08:43:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1374261420",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1374261420"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 58,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376067341",
      "pull_request_review_id": 1703889520,
      "id": 1376067341,
      "node_id": "PRRC_kwDOABII585SBR8N",
      "diff_hunk": "@@ -45,4 +46,47 @@ BOOST_AUTO_TEST_CASE(unlimited_recv)\n     LogInstance().SetLogLevel(prev_log_level);\n }\n \n+BOOST_AUTO_TEST_CASE(damaged_private_key)\n+{\n+    const auto CreateSockOrig = CreateSock;\n+\n+    CreateSock = [](const CService&) {\n+        return std::make_unique<StaticContentsSock>(\"HELLO REPLY RESULT=OK VERSION=3.1\\n\"\n+                                                    \"SESSION STATUS RESULT=OK DESTINATION=\\n\");\n+    };\n+\n+    const auto i2p_private_key_file = gArgs.GetDataDirNet() / \"test_i2p_private_key_damaged\";",
      "path": "src/test/i2p_tests.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "5cf4d266d9b1e7bd9394e7581398de5bc540ae99",
      "original_commit_id": "adb5d6b8df575cacfdaf4223289bff7093d15639",
      "in_reply_to_id": 1374261420,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done",
      "created_at": "2023-10-30T11:41:51Z",
      "updated_at": "2023-10-30T11:41:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28695#discussion_r1376067341",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376067341"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28695"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 58,
      "side": "RIGHT"
    }
  ]
}