{
  "type": "issue",
  "issue": {
    "id": 2314165065,
    "node_id": "I_kwDOABII586J71tJ",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30165",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30165/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30165/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30165/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/30165",
    "number": 30165,
    "state": "open",
    "state_reason": null,
    "title": "\"netinfo\" doesn't show IPv6 \"Local addresses\"",
    "body": "### Is there an existing issue for this?\r\n\r\n- [x] I have searched the existing issues\r\n\r\n### Current behaviour\r\n\r\n\"Local addresses\" section of \"netinfo\" does not show the IPv6 addresses added using  \"externalip\" config option. (Probably there is no announce of this addresses).\r\nBitnodes.io show the version string of all IPs, but after put many of the IPv6 on active monitoring, only the first one specified with \"externalip\" are \"UP\" and the others are \"UNREACHABLE\".\r\n(These are not my real addresses).\r\n\r\nroot@debianpc:~# bitcoin-cli -netinfo\r\n`  Bitcoin Core client v27.0.0 - server 70016/Satoshi:27.0.0/\r\n\r\n\r\n         ipv4   onion     i2p     npr   total   block\r\n    in          0       1       0       7       8\r\n    out         6       3       1       0      10       2\r\n    total       6       4       1       7      18\r\n\r\n  Local addresses\r\n  143.22.123.17                                                     port   8333    score     27\r\n  qsddczpwthdeddm3viv4brhxbbxdm5eh5ywasdfmmaefctwrrgjdw5hmid.onion     port   8333    score      4\r\n  awxyf6dvprtsssixojegfwjdn5xka62kpxecbwdovk23ohpqm.b32.i2p       port      0    score      4\r\n`\r\n\r\n### Expected behaviour\r\n\r\nroot@debianpc:~# bitcoin-cli -netinfo\r\n`  Bitcoin Core client v27.0.0 - server 70016/Satoshi:27.0.0/\r\n  \r\n         ipv4   onion     i2p     npr   total   block\r\n    in          0       1       0       7       8\r\n    out         6       3       1       0      10       2\r\n    total       6       4       1       7      18\r\n\r\n  Local addresses\r\n  143.22.123.17                                                       port   8333    score     27\r\n  2006:f10:0:aa::234                                                port   8333    score     16\r\n  2006:f10:0:aa::111                                                port   8333    score     16\r\n  qsddczpwthdeddm3viv4brhxbbxdm5eh5ywasdfmmaefctwrrgjdw5hmid.onion     port   8333    score      4\r\n  awxyf6dvprtsssixojegfwjdn5xka62kpxecbwdovk23ohpqm.b32.i2p       port      0    score      4\r\n`\r\n\r\n### Steps to reproduce\r\n\r\nThis is a very specific setup:\r\n1. In a machine A with no public IPv4 nor IPv6 address, start bitcoind with these options:\r\n\r\n #a public ipv4 and ipv6 address of another machine, let's say machine B\r\nexternalip=143.22.123.17 \r\nexternalip=qsddczpwthdeddm3viv4brhxbbxdm5eh5ywasdfmmaefctwrrgjdw5hmid.onion\r\nexternalip=2006:f10:0:aa::234\r\nexternalip=2006:f10:0:aa::111\r\n\r\n2. Now establish a reverse ssh tunnel from machine A to B\r\non machine A, run:\r\n autossh -N -f -o \"ExitOnForwardFailure=yes\" -o \"ServerAliveInterval=10\" -o \"ServerAliveCountMax=3\" -R 143.22.123.17:8333:127.0.0.1:8333 root@IP_machine_B\r\n\r\n3. Test all the externalip's using bitnodes.io, they shoud be reachable on the default port now. This configuration should provide IPv6 connectivity to the local node and the -netinfo should show the IPv6 announced using externalip config option (like it did with the public IPv4 specified).\r\n\r\n### Relevant log output\r\n\r\n_No response_\r\n\r\n### How did you obtain Bitcoin Core\r\n\r\nPre-built binaries\r\n\r\n### What version of Bitcoin Core are you using?\r\n\r\nv27.0.0\r\n\r\n### Operating system and version\r\n\r\nDebian 11\r\n\r\n### Machine specifications\r\n\r\n_No response_",
    "user": {
      "login": "lcharles123",
      "id": 8680067,
      "node_id": "MDQ6VXNlcjg2ODAwNjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8680067?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lcharles123",
      "html_url": "https://github.com/lcharles123",
      "followers_url": "https://api.github.com/users/lcharles123/followers",
      "following_url": "https://api.github.com/users/lcharles123/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/lcharles123/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/lcharles123/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/lcharles123/subscriptions",
      "organizations_url": "https://api.github.com/users/lcharles123/orgs",
      "repos_url": "https://api.github.com/users/lcharles123/repos",
      "events_url": "https://api.github.com/users/lcharles123/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/lcharles123/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 3,
    "created_at": "2024-05-24T02:00:18Z",
    "updated_at": "2024-05-24T16:06:58Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 2128362673,
      "node_id": "IC_kwDOABII585-3Dyx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2128362673",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-24T02:15:00Z",
      "updated_at": "2024-05-24T02:18:56Z",
      "author_association": "CONTRIBUTOR",
      "body": "Can you post the result of running `./src/bitcoin-cli getnetworkinfo` on your machine (with the same modified IPs as above)?  This is the information that `-netinfo` uses to fetch the local addresses.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/30165#issuecomment-2128362673",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30165"
    },
    {
      "event": "commented",
      "id": 2128367476,
      "node_id": "IC_kwDOABII585-3E90",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2128367476",
      "actor": {
        "login": "lcharles123",
        "id": 8680067,
        "node_id": "MDQ6VXNlcjg2ODAwNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8680067?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lcharles123",
        "html_url": "https://github.com/lcharles123",
        "followers_url": "https://api.github.com/users/lcharles123/followers",
        "following_url": "https://api.github.com/users/lcharles123/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/lcharles123/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/lcharles123/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/lcharles123/subscriptions",
        "organizations_url": "https://api.github.com/users/lcharles123/orgs",
        "repos_url": "https://api.github.com/users/lcharles123/repos",
        "events_url": "https://api.github.com/users/lcharles123/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/lcharles123/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-24T02:20:11Z",
      "updated_at": "2024-05-24T02:20:11Z",
      "author_association": "NONE",
      "body": "root@debianpc:~# bcli getnetworkinfo\r\n{\r\n  \"version\": 270000,\r\n  \"subversion\": \"/Satoshi:27.0.0/\",\r\n  \"protocolversion\": 70016,\r\n  \"localservices\": \"0000000000000c09\",\r\n  \"localservicesnames\": [\r\n    \"NETWORK\",\r\n    \"WITNESS\",\r\n    \"NETWORK_LIMITED\",\r\n    \"P2P_V2\"\r\n  ],\r\n  \"localrelay\": true,\r\n  \"timeoffset\": -8,\r\n  \"networkactive\": true,\r\n  \"connections\": 68,\r\n  \"connections_in\": 58,\r\n  \"connections_out\": 10,\r\n  \"networks\": [\r\n    {\r\n      \"name\": \"ipv4\",\r\n      \"limited\": false,\r\n      \"reachable\": true,\r\n      \"proxy\": \"\",\r\n      \"proxy_randomize_credentials\": false\r\n    },\r\n    {\r\n      \"name\": \"ipv6\",\r\n      \"limited\": true,\r\n      \"reachable\": false,\r\n      \"proxy\": \"\",\r\n      \"proxy_randomize_credentials\": false\r\n    },\r\n    {\r\n      \"name\": \"onion\",\r\n      \"limited\": false,\r\n      \"reachable\": true,\r\n      \"proxy\": \"127.0.0.1:9050\",\r\n      \"proxy_randomize_credentials\": true\r\n    },\r\n    {\r\n      \"name\": \"i2p\",\r\n      \"limited\": false,\r\n      \"reachable\": true,\r\n      \"proxy\": \"127.0.0.1:7656\",\r\n      \"proxy_randomize_credentials\": false\r\n    },\r\n    {\r\n      \"name\": \"cjdns\",\r\n      \"limited\": true,\r\n      \"reachable\": false,\r\n      \"proxy\": \"\",\r\n      \"proxy_randomize_credentials\": false\r\n    }\r\n  ],\r\n  \"relayfee\": 0.00001000,\r\n  \"incrementalfee\": 0.00001000,\r\n  \"localaddresses\": [\r\n    {\r\n      \"address\": \"143.22.123.17\",\r\n      \"port\": 8333,\r\n      \"score\": 127\r\n    },\r\n    {\r\n      \"address\": \"qsddczpwthdeddm3viv4brhxbbxdm5eh5ywasdfmmaefctwrrgjdw5hmid.onion\",\r\n      \"port\": 8333,\r\n      \"score\": 4\r\n    },\r\n    {\r\n      \"address\": \"awxyf6dvprtsssixojegfwjdn5xka62kpxecbwdovk23ohpqm.b32.i2p\",\r\n      \"port\": 0,\r\n      \"score\": 4\r\n    }\r\n  ],\r\n  \"warnings\": \"\"\r\n}\r\n",
      "user": {
        "login": "lcharles123",
        "id": 8680067,
        "node_id": "MDQ6VXNlcjg2ODAwNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8680067?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lcharles123",
        "html_url": "https://github.com/lcharles123",
        "followers_url": "https://api.github.com/users/lcharles123/followers",
        "following_url": "https://api.github.com/users/lcharles123/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/lcharles123/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/lcharles123/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/lcharles123/subscriptions",
        "organizations_url": "https://api.github.com/users/lcharles123/orgs",
        "repos_url": "https://api.github.com/users/lcharles123/repos",
        "events_url": "https://api.github.com/users/lcharles123/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/lcharles123/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/30165#issuecomment-2128367476",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30165"
    },
    {
      "event": "commented",
      "id": 2129888738,
      "node_id": "IC_kwDOABII585-84Xi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2129888738",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-24T16:00:31Z",
      "updated_at": "2024-05-24T16:06:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks @lcharles123 for the info.\r\n\r\n> \"Local addresses\" section of \"netinfo\" does not show the IPv6 addresses added using \"externalip\" config option. (Probably there is no announce of this addresses).\r\n\r\nCLI `-netinfo` will only return the local addresses that are returned by RPC `getnetworkinfo`, as under the hood, -netinfo calls getnetworkinfo to fetch that info.\r\n\r\nOf the networks getnetworkinfo returns to you, IPv6 (and CJDNS, which is an IPv6 overlay network) are not reachable, which is why -netinfo isn't showing `ipv6` and `cjdns` columns. \r\n\r\nPerhaps IPv6 is blocked at some level in your environment, or the IPv6 IP needs to be specified in your ssh tunnel, I don't know.\r\n\r\nEdit: probably not the issue, but did you try using the -discover config option?\r\n\r\n> Bitnodes.io show the version string of all IPs, but after put many of the IPv6 on active monitoring, only the first one specified with \"externalip\" are \"UP\" and the others are \"UNREACHABLE\".\r\n\r\nYou may set multiple local addresses with -externalip, but the one bitcoind rumors to a particular peer will be the most compatible address (with some additional heuristics).\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/30165#issuecomment-2129888738",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30165"
    },
    {
      "event": "mentioned",
      "id": 12927004066,
      "node_id": "MEE_lADOABII586J71tJzwAAAAMCgm2i",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12927004066",
      "actor": {
        "login": "lcharles123",
        "id": 8680067,
        "node_id": "MDQ6VXNlcjg2ODAwNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8680067?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lcharles123",
        "html_url": "https://github.com/lcharles123",
        "followers_url": "https://api.github.com/users/lcharles123/followers",
        "following_url": "https://api.github.com/users/lcharles123/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/lcharles123/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/lcharles123/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/lcharles123/subscriptions",
        "organizations_url": "https://api.github.com/users/lcharles123/orgs",
        "repos_url": "https://api.github.com/users/lcharles123/repos",
        "events_url": "https://api.github.com/users/lcharles123/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/lcharles123/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-24T16:00:32Z"
    },
    {
      "event": "subscribed",
      "id": 12927004084,
      "node_id": "SE_lADOABII586J71tJzwAAAAMCgm20",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12927004084",
      "actor": {
        "login": "lcharles123",
        "id": 8680067,
        "node_id": "MDQ6VXNlcjg2ODAwNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8680067?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lcharles123",
        "html_url": "https://github.com/lcharles123",
        "followers_url": "https://api.github.com/users/lcharles123/followers",
        "following_url": "https://api.github.com/users/lcharles123/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/lcharles123/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/lcharles123/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/lcharles123/subscriptions",
        "organizations_url": "https://api.github.com/users/lcharles123/orgs",
        "repos_url": "https://api.github.com/users/lcharles123/repos",
        "events_url": "https://api.github.com/users/lcharles123/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/lcharles123/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-24T16:00:32Z"
    }
  ]
}