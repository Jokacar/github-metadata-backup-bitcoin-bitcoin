{
  "type": "issue",
  "issue": {
    "id": 2605720663,
    "node_id": "I_kwDOABII586bUCRX",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31134",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31134/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31134/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31134/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/31134",
    "number": 31134,
    "state": "open",
    "state_reason": null,
    "title": "net: multiple-node local setups with different `-port` don't work anymore",
    "body": "With v28.0, (PR #22729), we now abort init on failed binds, as documented in the release notes. This also affects the default onion bind to port `8334`, which is always done unless the user specifies the desired binds using the `-bind` command.\r\n\r\nAs a result, setups with two local nodes that each use a different `-port` are not possible anymore - both of these nodes would attempt to create an onion bind to port `8334`, and one of them would fail. In earlier versions, we would silently ignore the failed bind (bad if we were actually interested in receiving onion inbound peers, but convenient if we weren't running Tor).\r\n\r\nI think that these kind of `-port` setups might be pretty widespread, especially in test setups where no inbound onion peers are desired, so this will likely affect multiple users. It has been reported on IRC multiple times ([1](https://bitcoin-irc.chaincode.com/bitcoin-core-dev/2024-10-18#1059878;), [2](https://bitcoin-irc.chaincode.com/bitcoin-core-dev/2024-10-09#1057998;)).\r\n\r\nThere is a simple fix: Stop using `-port`, but instead specify a different `-bind` on each of the local nodes.\r\n\r\nVarious possibilities how to deal with it (if at all) have been suggested on IRC by @vasild and @laanwj:\r\n\r\n1.  Do nothing and tell affected users to switch to `-bind` - maybe even deprecate `-port`\r\n2. if `-port` is given, don't attempt to bind to the default onion port\r\n3. if `-port` is given, derive an onion port from it (e.g. port+1) instead of always using `8334`\r\n4. disable the automatic tor binding silently if the port is already used\r\n\r\nI think that if we decide to do something about this, we should do so quickly in 28.1, so I opened this issue!\r\nThoughts?",
    "user": {
      "login": "mzumsande",
      "id": 48763452,
      "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mzumsande",
      "html_url": "https://github.com/mzumsande",
      "followers_url": "https://api.github.com/users/mzumsande/followers",
      "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
      "organizations_url": "https://api.github.com/users/mzumsande/orgs",
      "repos_url": "https://api.github.com/users/mzumsande/repos",
      "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/mzumsande/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 0,
    "created_at": "2024-10-22T14:59:38Z",
    "updated_at": "2024-10-22T14:59:38Z"
  },
  "events": []
}