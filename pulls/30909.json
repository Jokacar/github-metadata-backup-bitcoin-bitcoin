{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30909",
    "id": 2074412969,
    "node_id": "PR_kwDOABII5857pQep",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/30909",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/30909.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/30909.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30909",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30909/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30909/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30909/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/d7bc55696b376ba87f7e10a57090bec465e39e9a",
    "number": 30909,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "AssumeUTXO: Don't Assume m_chain_tx_count in GuessVerificationProgress",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "A test that is added as part of #30455 uncovered this issue: The `GuessVerificationProgress` function is used during during descriptor import and relies on `m_chain_tx_count`. In #29370 an [`Assume` was added](https://github.com/bitcoin/bitcoin/pull/29370/commits/0fd915ee6bef63bb360ccc5c039a3c11676c38e3) expecting the `m_chaint_tx_count` to be set. However, as the test uncovered, `GuessVerificationProgress` is called with background sync blocks that have `m_chaint_tx_count = 0` when they have not been downloaded and processed yet.\r\n\r\nThe simple fix is to remove the `Assume`. Users should not be thrown off by the `Internal bug detected` error. The behavior of `importdescriptor` is kept consistent with the behavior for blocks missing due to pruning.\r\n\r\nThe test by alfonsoromanz is cherry-picked here to show that the [CI errors](https://cirrus-ci.com/task/5110045812195328?logs=ci#L2535) should be fixed by this change.",
    "labels": [],
    "created_at": "2024-09-16T16:19:23Z",
    "updated_at": "2024-09-23T19:59:32Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "ab77cf8b729d8da63bb14fe021f668d0f71f1e67",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "fjahr:2024-09-au-guess",
      "ref": "2024-09-au-guess",
      "sha": "d7bc55696b376ba87f7e10a57090bec465e39e9a",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 196253948,
        "node_id": "MDEwOlJlcG9zaXRvcnkxOTYyNTM5NDg=",
        "name": "bitcoin",
        "full_name": "fjahr/bitcoin",
        "owner": {
          "login": "fjahr",
          "id": 1322187,
          "node_id": "MDQ6VXNlcjEzMjIxODc=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/fjahr",
          "html_url": "https://github.com/fjahr",
          "followers_url": "https://api.github.com/users/fjahr/followers",
          "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
          "organizations_url": "https://api.github.com/users/fjahr/orgs",
          "repos_url": "https://api.github.com/users/fjahr/repos",
          "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/fjahr/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/fjahr/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/fjahr/bitcoin",
        "archive_url": "https://api.github.com/repos/fjahr/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/fjahr/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/fjahr/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/fjahr/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/fjahr/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/fjahr/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/fjahr/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/fjahr/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/fjahr/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/fjahr/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/fjahr/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/fjahr/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/fjahr/bitcoin/events",
        "forks_url": "https://api.github.com/repos/fjahr/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/fjahr/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/fjahr/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/fjahr/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/fjahr/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/fjahr/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/fjahr/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/fjahr/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/fjahr/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/fjahr/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/fjahr/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/fjahr/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/fjahr/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/fjahr/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/fjahr/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/fjahr/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:fjahr/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/fjahr/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/fjahr/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/fjahr/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/fjahr/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/fjahr/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/fjahr/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/fjahr/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/fjahr/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/fjahr/bitcoin/hooks",
        "svn_url": "https://github.com/fjahr/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 4,
        "watchers_count": 4,
        "size": 255024,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-09-23T19:58:09Z",
        "created_at": "2019-07-10T18:11:06Z",
        "updated_at": "2024-07-23T22:14:45Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "dabc74e86c38e928b8506de20210f0bc49562d5c",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 36197,
        "stargazers_count": 78514,
        "watchers_count": 78514,
        "size": 268930,
        "default_branch": "master",
        "open_issues_count": 648,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-09-23T19:40:49Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-09-23T19:41:07Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30909"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 37,
    "deletions": 9,
    "changed_files": 5,
    "commits": 3,
    "review_comments": 3,
    "comments": 5
  },
  "events": [
    {
      "event": "commented",
      "id": 2353366569,
      "node_id": "IC_kwDOABII586MRYYp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2353366569",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-16T16:19:27Z",
      "updated_at": "2024-09-23T19:11:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/30909).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Stale ACK | [alfonsoromanz](https://github.com/bitcoin/bitcoin/pull/30909#pullrequestreview-2307534418) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#30678](https://github.com/bitcoin/bitcoin/pull/30678) (wallet: Write best block to disk before backup by fjahr)\n* [#30455](https://github.com/bitcoin/bitcoin/pull/30455) (test: assumeutxo: add missing tests in wallet_assumeutxo.py by alfonsoromanz)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30909#issuecomment-2353366569",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30909"
    },
    {
      "event": "reviewed",
      "id": 2307534418,
      "node_id": "PRR_kwDOABII586Jii5S",
      "url": null,
      "actor": null,
      "commit_id": "9be080abfa87543652c415af4e239a6ba4d2b2e1",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "tACK 9be080abfa87543652c415af4e239a6ba4d2b2e1\r\n\r\nThe test passes locally, and I see that all the CI checks have passed, so it looks good to me.\r\n\r\nIt took me some time today to get familiar with the CMake-based build system, but I managed to get it working.\r\n\r\n<img width=\"982\" alt=\"Screenshot 2024-09-16 at 16 05 09\" src=\"https://github.com/user-attachments/assets/bbe337ef-f789-49f0-a414-2661a17dbfb7\">\r\n\r\n\r\nThanks!",
      "user": {
        "login": "alfonsoromanz",
        "id": 19962151,
        "node_id": "MDQ6VXNlcjE5OTYyMTUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/19962151?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alfonsoromanz",
        "html_url": "https://github.com/alfonsoromanz",
        "followers_url": "https://api.github.com/users/alfonsoromanz/followers",
        "following_url": "https://api.github.com/users/alfonsoromanz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/alfonsoromanz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/alfonsoromanz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/alfonsoromanz/subscriptions",
        "organizations_url": "https://api.github.com/users/alfonsoromanz/orgs",
        "repos_url": "https://api.github.com/users/alfonsoromanz/repos",
        "events_url": "https://api.github.com/users/alfonsoromanz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/alfonsoromanz/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30909#pullrequestreview-2307534418",
      "submitted_at": "2024-09-16T19:09:53Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30909"
    },
    {
      "event": "reviewed",
      "id": 2307560796,
      "node_id": "PRR_kwDOABII586JipVc",
      "url": null,
      "actor": null,
      "commit_id": "9be080abfa87543652c415af4e239a6ba4d2b2e1",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30909#pullrequestreview-2307560796",
      "submitted_at": "2024-09-16T19:16:59Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30909"
    },
    {
      "event": "commented",
      "id": 2354677700,
      "node_id": "IC_kwDOABII586MWYfE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2354677700",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-17T06:42:50Z",
      "updated_at": "2024-09-17T06:42:50Z",
      "author_association": "MEMBER",
      "body": "> However, as the test uncovered, `GuessVerificationProgress` is called with snapshot blocks that have `m_chaint_tx_count = 0` when the assumeutxo background sync is in progress.\r\n\r\nCan you explain this a bit better? IIRC the snapshot base block itself has the count set, as well as any validated blocks after it. See `src/node/blockstorage.cpp:        base->m_chain_tx_count = au_data.m_chain_tx_count;\r\n`. So I think calling `GuessVerificationProgress` in this case shouldn't lead to issues. Whereas calling a rescan on the (missing) background blocks seems like a bug that should be avoided at the call site, no?",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30909#issuecomment-2354677700",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30909"
    },
    {
      "event": "reviewed",
      "id": 2313807588,
      "node_id": "PRR_kwDOABII586J6ebk",
      "url": null,
      "actor": null,
      "commit_id": "9be080abfa87543652c415af4e239a6ba4d2b2e1",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "> Whereas calling a rescan on the (missing) background blocks seems like a bug that should be avoided at the call site, no?\r\n\r\nWell, the approach seems to be similar with pruning: \r\n`importdescriptors` tries to scan as many blocks as possible (no stopping after a failure due to missing block data), and then returns a failure / warns the user that the result may be incomplete. It could probably have been implentend differently, checking if we are missing blocks due to pruning and refuse to import the descriptors, but it doesn't do that.\r\n\r\nIf that is seen as a viable way for the pruning case, maybe it would be a bit inconsistent to just forbid it in the assumeutxo background sync case?! In which case just dealing with the progress estimation error would be ok?",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30909#pullrequestreview-2313807588",
      "submitted_at": "2024-09-18T21:09:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30909"
    },
    {
      "event": "commented",
      "id": 2360075066,
      "node_id": "IC_kwDOABII586Mq-M6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2360075066",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-19T06:13:42Z",
      "updated_at": "2024-09-19T06:13:42Z",
      "author_association": "MEMBER",
      "body": "> Well, the approach seems to be similar with pruning:\r\n\r\nSure, if that is the case, the pull request description should mention it. Also, the error message could probably be updated, because it only mentions pruning, no AU. (Note to self: Reminds me of https://github.com/bitcoin/bitcoin/pull/26282)",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30909#issuecomment-2360075066",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30909"
    },
    {
      "event": "commented",
      "id": 2361367099,
      "node_id": "IC_kwDOABII586Mv5o7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2361367099",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-19T15:38:19Z",
      "updated_at": "2024-09-19T15:40:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "Though one could also make a case for not allowing importdescriptor/rescan during background sync if non-downloaded blocks are affected, with the reasoning \"just wait a little bit longer\" that doesn't really apply to the pruning case. Would be interesting to know if this has ever been discussed for assumeutxo.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30909#issuecomment-2361367099",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30909"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhjZWRjOTRjZjQyNTI4ODg3ZGExMWMwMjE5ZTEyYWRkNDAwYjdiN2E",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8cedc94cf42528887da11c0219e12add400b7b7a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8cedc94cf42528887da11c0219e12add400b7b7a",
      "tree": {
        "sha": "6821cade590439d3ec8e65633c27ec48dc55528a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6821cade590439d3ec8e65633c27ec48dc55528a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 6821cade590439d3ec8e65633c27ec48dc55528a\nparent e46bebb444dfff89813333dc1926a57c9a3e8aab\nauthor Fabian Jahr <fjahr@protonmail.com> 1726500446 +0200\ncommitter Fabian Jahr <fjahr@protonmail.com> 1727112457 +0200\n\nvalidation: Don't assume m_chain_tx_count in GuessVerificationProgress\n\nIn the context of an a descriptor import during assumeutxo background sync, the progress can not be estimated due to m_chain_tx_count being set to 0.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmbxpT0VHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNluEP/i4/PxNWlsBeslj8FMQyjgynMQIK\nDtwH4fX3B2HvsbZfFwf40rnqD46Gqz0L+dEtT3m6VbV1Q6wHdUFJbVgEfZHVCdAV\nJa2gELZ9TTKVc0dFjvrrpwsud5OCq8zXUy+5/t8UkgQKq4+tuNsmIuHhO2uRSMqw\nQZdko7PsgmHobkJdP2A/wMizP9Wx5mJZ1B92A+o2VdwK9R4Mgo9VLpncWRXcYZdx\n3RINXEz8dN/fRT1ZARGg4/A2J/Fqa0e0hnNp2SZbUJRZ/RPbFjnZZIpjTntIZ5j7\n5Jpo1YnwtzZuWda5pxqDvJt43U3cd6+0tkDCBBpZWqtjuQwfPTjql8NyPYxgXZdv\n7vrznQWwikGTNB/DRnL92LdlDDKz0GvEmWKlOcgH7KQZoAwwzrg6UkdbSfRskQ4c\n/UqXFWmGN7Td+lfDas4j+2XnZHNKQoppWOwQ5Sb6C7qWrouG+M/lmE9zk3H306pS\n4MhmOaAU2C069L0WvxoMTgOxm/LkzTverPK9rk/H2pTqYsVB6++kGGrYko3QcTst\n731g4ZIPBCEZuirccADgXLQ3EqBV3KUshedKX/A2JU83GusirVdLUU1phglOjI9P\n9VwXb/wEXFinZxqg9auckQlwiRgaX2rB2R3tDIagDMJNgdbYh5BT4cS7aFD3Vl2u\nbPeDhkDv+NUs+SCb\n=a/X6\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e46bebb444dfff89813333dc1926a57c9a3e8aab",
          "sha": "e46bebb444dfff89813333dc1926a57c9a3e8aab",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e46bebb444dfff89813333dc1926a57c9a3e8aab"
        }
      ],
      "message": "validation: Don't assume m_chain_tx_count in GuessVerificationProgress\n\nIn the context of an a descriptor import during assumeutxo background sync, the progress can not be estimated due to m_chain_tx_count being set to 0.",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2024-09-23T17:27:37Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2024-09-16T15:27:26Z"
      },
      "sha": "8cedc94cf42528887da11c0219e12add400b7b7a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDViOGZhYWNhNTBjN2M2OTg4NTFmZjg5NjcyOWUyMmVmZWE2MzkxNWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5b8faaca50c7c698851ff896729e22efea63915d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5b8faaca50c7c698851ff896729e22efea63915d",
      "tree": {
        "sha": "d6e32abf4531a8dc5b59ffbfb7dbb7c8668638e6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d6e32abf4531a8dc5b59ffbfb7dbb7c8668638e6"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree d6e32abf4531a8dc5b59ffbfb7dbb7c8668638e6\nparent 8cedc94cf42528887da11c0219e12add400b7b7a\nauthor Alfonso Roman Zubeldia <19962151+alfonsoromanz@users.noreply.github.com> 1724334438 -0300\ncommitter Fabian Jahr <fjahr@protonmail.com> 1727112509 +0200\n\ntest, assumeutxo: import descriptors during background sync\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmbxpT0VHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jN0a0P/1Cp8eAUjQzNtlvXsTzvyVJQMxGE\njts1A8diIf7xJg399/ytYnAQlQ8quMIMvkBvtG6c9gnWaT8gGGYB91Pg1PNOLaL8\nMzQtek0dUXwHf4B2Bgy9AmfDtpHsmbBByH5iPasqsGfKt2LBt1Pxl/vLz9hBMEUm\nZ3K++wv7Glk97tpXhWLn6ol4KFr9/HPPqlhyek+xnMynajW9mZHncHM35JD8Q9Qh\nmuxWmyrcltnbZhGyI7MSRygsbEuJPT4AJqtfHchWL8TO9J+q9aYLwG2jNEZuL67H\nr/0mCcWhWqbseM4zWLM1L+9fn0BhIdEHf8eaVaIweD6wbU9Ez8/SlKaPsYMHTTrX\ntRDudKzAUJ+/djk8Wuxcx+qmzr5+enj0TyyElhl2FUcfDP2Hx0oTMoGD4fRJNP2N\nh/KiDXJG1V8Oklv3RZUptEZvq3U3Nongz73p5gUd3xa1pExxjqiguos+IKMQ13yF\nMMTbjgHtWh8LGf8+JH5sN+bLHrAR5oo5K/oQX4InP19cLoZuERYwKGYmX/GZ3noh\nc2DiMBoRJidHCn3zodgwPyFPK/JZT3kTj2WtpMVVogoOtitbF11MAHTtWlG7iyHp\nyutMBEilplydHo5A1BJ9sIk0QIZTVuSxXZMFh+1nhrxqe7flf2g72QFG3KmmuKYq\nPqAFmo0/p6gvBKjd\n=vfcw\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8cedc94cf42528887da11c0219e12add400b7b7a",
          "sha": "8cedc94cf42528887da11c0219e12add400b7b7a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8cedc94cf42528887da11c0219e12add400b7b7a"
        }
      ],
      "message": "test, assumeutxo: import descriptors during background sync",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2024-09-23T17:28:29Z"
      },
      "author": {
        "name": "Alfonso Roman Zubeldia",
        "email": "19962151+alfonsoromanz@users.noreply.github.com",
        "date": "2024-08-22T13:47:18Z"
      },
      "sha": "5b8faaca50c7c698851ff896729e22efea63915d"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14369115320,
      "node_id": "HRFPE_lADOABII586WvBm4zwAAAANYd0y4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14369115320",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-23T19:11:50Z"
    },
    {
      "event": "commented",
      "id": 2369236572,
      "node_id": "IC_kwDOABII586NN65c",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2369236572",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-23T19:51:50Z",
      "updated_at": "2024-09-23T19:59:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Can you explain this a bit better?\r\n\r\nYeah, my statement was wrong. I think I managed to confuse myself with some wrongfully placed debug logging. I have fixed the description.\r\n\r\n> > Well, the approach seems to be similar with pruning:\r\n> \r\n> Sure, if that is the case, the pull request description should mention it. Also, the error message could probably be updated, because it only mentions pruning, no AU.\r\n\r\nUpdated the error message and realized that he same issue exists in `rescanblockchain`, too. So fixed it there as well.\r\n\r\nEDIT: I also add coverage for `rescanblockchain` in `wallet_assumeutxo`.\r\n\r\n> Though one could also make a case for not allowing importdescriptor/rescan during background sync if non-downloaded blocks are affected, with the reasoning \"just wait a little bit longer\" that doesn't really apply to the pruning case. Would be interesting to know if this has ever been discussed for assumeutxo.\r\n\r\nI had a similar thoughts when I looked into this earlier. But I think going that route might either break workflows with `importdescriptors` or it's a pretty invasive change. The RPC takes in multiple descriptors (requests) with timestamps for each and then rescans blocks starting from around the lowest timestamp. The simplest approach would be to check all the blocks from the lowest timestamp and abort the whole RPC if any of them don't have block data available for any block since the timestamp. Or we could exclude the offending requests and only import the remaining requests, starting rescan from the lowest timestamp with available block data. Both of these approaches seem pretty invasive and may lead to unexpected outcomes for users. I think people may undershoot the timestamp for example. We could then help them by returning the lowest timestamp that works (the snapshot height one) with the error but then we basically recreate the current behavior with extra steps. The ideal solution would be that the wallet rescans the missing blocks as they come in but that's probably a much bigger change, and also kind of tricky to communicate to the user.\r\n\r\nAlso, while \"just wait a little bit longer\" might be a good answer, we could also say \"just run another rescan later\" and that may ultimately be a better experience for the users.\r\n\r\nI don't have a strong opinion here but it seems like these ideas may better be scoped out in a separate issue first and then potentially be implemented as a follow-up.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30909#issuecomment-2369236572",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30909"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQ3YmM1NTY5NmIzNzZiYTg3ZjdlMTBhNTcwOTBiZWM0NjVlMzllOWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d7bc55696b376ba87f7e10a57090bec465e39e9a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d7bc55696b376ba87f7e10a57090bec465e39e9a",
      "tree": {
        "sha": "9165804e11365e83a9a0140338f0e8b915184b2e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9165804e11365e83a9a0140338f0e8b915184b2e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 9165804e11365e83a9a0140338f0e8b915184b2e\nparent 5b8faaca50c7c698851ff896729e22efea63915d\nauthor Fabian Jahr <fjahr@protonmail.com> 1727118337 +0200\ncommitter Fabian Jahr <fjahr@protonmail.com> 1727121475 +0200\n\ndoc: Include assumeutxo as a failure reason of rescanblockchain\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmbxyEoVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNfugP/jJvINw8eC1VecvygDuwG3iRZwty\n0qgQQwlrIlvJjmPjItW00vtABQtvlv6Qe8kS88sk1MDfzjW+q2z6YjUhkJew3gxl\nfgVMeuPJTCI5I+pw9omQ+mH1r+92Z3I0bKzkIG6G0ZDHcPs1d1rd1ylbp93sLg4f\ng8JI3CGCjL2MMOJJfvQFfOSLX2YdPVdyhs9EAk65gypPz0Lk0YmL8iqtLB096EBu\n2JyP8qdWgsRCVXVO1F+HC8oQRb1+71jXTdlKJ+l9Imp8647ICXk30Cjpcw2bkgtv\nwypPgwdUDeeYl0neF6MM0KtSThNY2S/7/flxLNjxWtWET1zRKY4ES7ZZKphV5Ikv\nwes7f11Fb6hdrSg+dCkJ+k0Cdvnexl4dxGoMKZg7EunWFad40X7dGo9pU3udlWig\niJKLj4ndBWbB8i0Fc8CiMet0lWzHPTxKO/z8k2mkWSHEy2/M5doCosfl9V1VDrY+\nOspMRdqrlfoTPuin/9zyIBOG4N9ZZHMDbQmpXd7AzdzonfRnm80WR+AKagdOhBEV\nk0c+Lmp8H8hFovI+vL2SkBByOlx3Owg50okDKObuu2bXvM5/5qQz6CP+tDJ29KLC\nbR9VUpFFj/1gOXskXJPGM1nW+cO32DkebJ8dQH/V/JZqNWPbgKO2zJKriaAKzKPg\nQ56Vh8QbI0lRCKUX\n=BMYO\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5b8faaca50c7c698851ff896729e22efea63915d",
          "sha": "5b8faaca50c7c698851ff896729e22efea63915d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5b8faaca50c7c698851ff896729e22efea63915d"
        }
      ],
      "message": "doc: Include assumeutxo as a failure reason of rescanblockchain",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2024-09-23T19:57:55Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2024-09-23T19:05:37Z"
      },
      "sha": "d7bc55696b376ba87f7e10a57090bec465e39e9a"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14369676248,
      "node_id": "HRFPE_lADOABII586WvBm4zwAAAANYf9vY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14369676248",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-23T19:58:10Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1761740170",
      "pull_request_review_id": 2307560796,
      "id": 1761740170,
      "node_id": "PRRC_kwDOABII585pAgWK",
      "diff_hunk": "@@ -5566,9 +5566,8 @@ double GuessVerificationProgress(const ChainTxData& data, const CBlockIndex *pin\n     if (pindex == nullptr)\n         return 0.0;\n \n-    if (!Assume(pindex->m_chain_tx_count > 0)) {\n-        LogWarning(\"Internal bug detected: block %d has unset m_chain_tx_count (%s %s). Please report this issue here: %s\\n\",\n-                   pindex->nHeight, PACKAGE_NAME, FormatFullVersion(), PACKAGE_BUGREPORT);\n+    if (pindex->m_chain_tx_count == 0) {",
      "path": "src/validation.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "d7bc55696b376ba87f7e10a57090bec465e39e9a",
      "original_commit_id": "9be080abfa87543652c415af4e239a6ba4d2b2e1",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Question, is debug logging this enough, unsure but e.g. in the various RPCs (and CLI -getinfo) that return a \"verificationprogress\" field, are there any where it would be a good idea to describe the what/why of a returned 0.0 value due to this case.",
      "created_at": "2024-09-16T19:16:59Z",
      "updated_at": "2024-09-16T19:19:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30909#discussion_r1761740170",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1761740170"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30909"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5569,
      "original_line": 5569,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1765732245",
      "pull_request_review_id": 2313817769,
      "id": 1765732245,
      "node_id": "PRRC_kwDOABII585pPu-V",
      "diff_hunk": "@@ -5566,9 +5566,8 @@ double GuessVerificationProgress(const ChainTxData& data, const CBlockIndex *pin\n     if (pindex == nullptr)\n         return 0.0;\n \n-    if (!Assume(pindex->m_chain_tx_count > 0)) {\n-        LogWarning(\"Internal bug detected: block %d has unset m_chain_tx_count (%s %s). Please report this issue here: %s\\n\",\n-                   pindex->nHeight, PACKAGE_NAME, FormatFullVersion(), PACKAGE_BUGREPORT);\n+    if (pindex->m_chain_tx_count == 0) {",
      "path": "src/validation.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "d7bc55696b376ba87f7e10a57090bec465e39e9a",
      "original_commit_id": "9be080abfa87543652c415af4e239a6ba4d2b2e1",
      "in_reply_to_id": 1761740170,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think this should only be possible to trigger with the rescan, the various RPCs are always called with a block (usually the tip) that is guaranteed to have `m_chain_tx_count` set.",
      "created_at": "2024-09-18T21:14:47Z",
      "updated_at": "2024-09-18T21:26:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30909#discussion_r1765732245",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1765732245"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30909"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5569,
      "original_line": 5569,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1771952837",
      "pull_request_review_id": 2323107188,
      "id": 1771952837,
      "node_id": "PRRC_kwDOABII585pndrF",
      "diff_hunk": "@@ -5566,9 +5566,8 @@ double GuessVerificationProgress(const ChainTxData& data, const CBlockIndex *pin\n     if (pindex == nullptr)\n         return 0.0;\n \n-    if (!Assume(pindex->m_chain_tx_count > 0)) {\n-        LogWarning(\"Internal bug detected: block %d has unset m_chain_tx_count (%s %s). Please report this issue here: %s\\n\",\n-                   pindex->nHeight, PACKAGE_NAME, FormatFullVersion(), PACKAGE_BUGREPORT);\n+    if (pindex->m_chain_tx_count == 0) {",
      "path": "src/validation.cpp",
      "position": 7,
      "original_position": 7,
      "commit_id": "d7bc55696b376ba87f7e10a57090bec465e39e9a",
      "original_commit_id": "9be080abfa87543652c415af4e239a6ba4d2b2e1",
      "in_reply_to_id": 1761740170,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "And aside from only hitting this in the context of rescan + blocks missing this is just about showing the progress and not the actual functionality the user seeks. So it didn't feel important enough for me to use another category mainly because of that. Unless there are strong opinions against it I will keep this as is.",
      "created_at": "2024-09-23T19:11:57Z",
      "updated_at": "2024-09-23T19:11:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30909#discussion_r1771952837",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1771952837"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30909"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5569,
      "original_line": 5569,
      "side": "RIGHT"
    }
  ]
}