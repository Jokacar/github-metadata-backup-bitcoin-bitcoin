{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128",
    "id": 829517928,
    "node_id": "PR_kwDOABII584xcXBo",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/24128",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/24128.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/24128.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24128",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24128/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/fa66fa27c6f04ce11539e05dae689a60761eda76",
    "number": 24128,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "wallet: BIP 326 sequence based anti-fee-snipe for taproot inputs",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The goal of BIP 326 is to provide a \"privacy cloak\" for txs that use sequence-based locking. This is only possible for taproot inputs, as taproot spends may look identical for \"dumb wallets\" and \"smart contracts\" iff they use the key-path spend.\r\n\r\nSequence-based locking has minimally lower anti-fee sniping guarantees if all the txs that created the inputs aren't itself locked to the block they were included in. However, the minimal degradation should be acceptable, given that anti-fee-snipe will set the locktime to the past of 10% of the txs anyway.",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      },
      {
        "id": 98279177,
        "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
        "name": "RPC/REST/ZMQ",
        "color": "0052cc",
        "default": false
      },
      {
        "id": 955867938,
        "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
        "name": "Needs rebase",
        "description": "",
        "color": "cccccc",
        "default": false
      },
      {
        "id": 5334691551,
        "node_id": "LA_kwDOABII588AAAABPfju3w",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
        "name": "CI failed",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2022-01-22T14:12:15Z",
    "updated_at": "2023-08-17T14:13:40Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "be94030540dbd9d0370dc16bb8a3f820e6e503ab",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "MarcoFalke:2201-126",
      "ref": "2201-126",
      "sha": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 40046254,
        "node_id": "MDEwOlJlcG9zaXRvcnk0MDA0NjI1NA==",
        "name": "b-c",
        "full_name": "MarcoFalke/b-c",
        "owner": {
          "login": "MarcoFalke",
          "id": 6399679,
          "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
          "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/MarcoFalke",
          "html_url": "https://github.com/MarcoFalke",
          "followers_url": "https://api.github.com/users/MarcoFalke/followers",
          "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
          "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
          "repos_url": "https://api.github.com/users/MarcoFalke/repos",
          "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/MarcoFalke/b-c",
        "fork": true,
        "url": "https://api.github.com/repos/MarcoFalke/b-c",
        "archive_url": "https://api.github.com/repos/MarcoFalke/b-c/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/MarcoFalke/b-c/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/MarcoFalke/b-c/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/MarcoFalke/b-c/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/MarcoFalke/b-c/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/MarcoFalke/b-c/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/MarcoFalke/b-c/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/MarcoFalke/b-c/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/MarcoFalke/b-c/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/MarcoFalke/b-c/contributors",
        "deployments_url": "https://api.github.com/repos/MarcoFalke/b-c/deployments",
        "downloads_url": "https://api.github.com/repos/MarcoFalke/b-c/downloads",
        "events_url": "https://api.github.com/repos/MarcoFalke/b-c/events",
        "forks_url": "https://api.github.com/repos/MarcoFalke/b-c/forks",
        "git_commits_url": "https://api.github.com/repos/MarcoFalke/b-c/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/MarcoFalke/b-c/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/MarcoFalke/b-c/git/tags%7B/sha%7D",
        "git_url": "git://github.com/MarcoFalke/b-c.git",
        "issue_comment_url": "https://api.github.com/repos/MarcoFalke/b-c/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/MarcoFalke/b-c/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/MarcoFalke/b-c/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/MarcoFalke/b-c/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/MarcoFalke/b-c/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/MarcoFalke/b-c/languages",
        "merges_url": "https://api.github.com/repos/MarcoFalke/b-c/merges",
        "milestones_url": "https://api.github.com/repos/MarcoFalke/b-c/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/MarcoFalke/b-c/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/MarcoFalke/b-c/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/MarcoFalke/b-c/releases%7B/id%7D",
        "ssh_url": "git@github.com:MarcoFalke/b-c.git",
        "stargazers_url": "https://api.github.com/repos/MarcoFalke/b-c/stargazers",
        "statuses_url": "https://api.github.com/repos/MarcoFalke/b-c/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/MarcoFalke/b-c/subscribers",
        "subscription_url": "https://api.github.com/repos/MarcoFalke/b-c/subscription",
        "tags_url": "https://api.github.com/repos/MarcoFalke/b-c/tags",
        "teams_url": "https://api.github.com/repos/MarcoFalke/b-c/teams",
        "trees_url": "https://api.github.com/repos/MarcoFalke/b-c/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/MarcoFalke/b-c.git",
        "hooks_url": "https://api.github.com/repos/MarcoFalke/b-c/hooks",
        "svn_url": "https://github.com/MarcoFalke/b-c",
        "homepage": "",
        "language": "C++",
        "forks_count": 12,
        "stargazers_count": 25,
        "watchers_count": 25,
        "size": 208465,
        "default_branch": "master",
        "open_issues_count": 25,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-08-17T14:56:50Z",
        "created_at": "2015-08-01T12:42:47Z",
        "updated_at": "2023-05-28T20:12:34Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "6ce5e8f4758e6fccf59b3980af417ec6c75e383e",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35550,
        "stargazers_count": 70961,
        "watchers_count": 70961,
        "size": 236798,
        "default_branch": "master",
        "open_issues_count": 667,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-08-17T14:56:57Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-08-17T14:48:28Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 80,
    "deletions": 15,
    "changed_files": 2,
    "commits": 1,
    "review_comments": 15,
    "comments": 6
  },
  "events": [
    {
      "event": "head_ref_force_pushed",
      "id": 5936970845,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAFh3vxd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5936970845",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-22T14:18:30Z"
    },
    {
      "event": "renamed",
      "id": 5936971506,
      "node_id": "RTE_lADOABII585CQVBjzwAAAAFh3v7y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5936971506",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-22T14:19:02Z",
      "rename": {
        "from": "wallet: Implement BIP 326 sequence based anti-fee-snipe for taproot inputs",
        "to": "wallet: BIP 326 sequence based anti-fee-snipe for taproot inputs"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5936982366,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAFh3yle",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5936982366",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-22T14:28:58Z"
    },
    {
      "event": "reviewed",
      "id": 860211256,
      "node_id": "PRR_kwDOABII584zRcg4",
      "url": null,
      "actor": null,
      "commit_id": "9fc7cd0e31bb3e8444d5e2ae7f080d3b826f61e9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK, that's awesome",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#pullrequestreview-860211256",
      "submitted_at": "2022-01-22T14:35:20Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5937019996,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAFh37xc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5937019996",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-22T15:03:32Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-22T15:04:09Z",
      "updated_at": "2022-01-22T15:04:09Z",
      "source": {
        "issue": {
          "id": 1096960047,
          "node_id": "PR_kwDOAN28mc4wsJbH",
          "url": "https://api.github.com/repos/bitcoin/bips/issues/1269",
          "repository_url": "https://api.github.com/repos/bitcoin/bips",
          "labels_url": "https://api.github.com/repos/bitcoin/bips/issues/1269/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bips/issues/1269/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bips/issues/1269/events",
          "html_url": "https://github.com/bitcoin/bips/pull/1269",
          "number": 1269,
          "state": "closed",
          "state_reason": null,
          "title": "BIP 326: Anti-fee-sniping protection with nSequence in taproot transactions to improve privacy for off-chain protocols",
          "body": "This adds a BIP for improve could the privacy of certain off-chain protocols like Lightning, CoinSwap or DLCs.\r\n\r\nIt has already been implemented by Sparrow wallet.",
          "user": {
            "login": "chris-belcher",
            "id": 8398185,
            "node_id": "MDQ6VXNlcjgzOTgxODU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8398185?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/chris-belcher",
            "html_url": "https://github.com/chris-belcher",
            "followers_url": "https://api.github.com/users/chris-belcher/followers",
            "following_url": "https://api.github.com/users/chris-belcher/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/chris-belcher/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/chris-belcher/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/chris-belcher/subscriptions",
            "organizations_url": "https://api.github.com/users/chris-belcher/orgs",
            "repos_url": "https://api.github.com/users/chris-belcher/repos",
            "events_url": "https://api.github.com/users/chris-belcher/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/chris-belcher/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 275845989,
              "node_id": "MDU6TGFiZWwyNzU4NDU5ODk=",
              "url": "https://api.github.com/repos/bitcoin/bips/labels/New%20BIP",
              "name": "New BIP",
              "color": "5319e7",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 10,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bips/pulls/1269",
            "html_url": "https://github.com/bitcoin/bips/pull/1269",
            "diff_url": "https://github.com/bitcoin/bips/pull/1269.diff",
            "patch_url": "https://github.com/bitcoin/bips/pull/1269.patch"
          },
          "closed_at": "2022-03-08T03:23:57Z",
          "created_at": "2022-01-08T15:36:37Z",
          "updated_at": "2022-06-01T08:04:50Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5937022592,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAFh38aA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5937022592",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-22T15:05:28Z"
    },
    {
      "event": "labeled",
      "id": 5937040890,
      "node_id": "LE_lADOABII585CQVBjzwAAAAFh4A36",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5937040890",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-22T15:21:18Z",
      "label": {
        "name": "RPC/REST/ZMQ",
        "color": "0052cc"
      }
    },
    {
      "event": "labeled",
      "id": 5937040891,
      "node_id": "LE_lADOABII585CQVBjzwAAAAFh4A37",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5937040891",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-22T15:21:18Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "commented",
      "id": 1019353666,
      "node_id": "IC_kwDOABII5848whpC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019353666",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-22T20:34:31Z",
      "updated_at": "2023-08-11T11:30:21Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [w0xlt](https://github.com/bitcoin/bitcoin/pull/24128#pullrequestreview-860319215), [0xB10C](https://github.com/bitcoin/bitcoin/pull/24128#issuecomment-1091839902) |\n| Stale ACK | [darosior](https://github.com/bitcoin/bitcoin/pull/24128#issuecomment-1087534889), [chris-belcher](https://github.com/bitcoin/bitcoin/pull/24128#issuecomment-1091428035) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#28246](https://github.com/bitcoin/bitcoin/pull/28246) (wallet: Use CTxDestination in CRecipient instead of just scriptPubKey by achow101)\n* [#28244](https://github.com/bitcoin/bitcoin/pull/28244) (Break up script/standard.{h/cpp} by achow101)\n* [#28122](https://github.com/bitcoin/bitcoin/pull/28122) (Silent Payments: Implement BIP352 by josibake)\n* [#26902](https://github.com/bitcoin/bitcoin/pull/26902) (wallet: do not backdate locktime if it may lead to fingerprinting by rodentrabies)\n* [#25273](https://github.com/bitcoin/bitcoin/pull/25273) (wallet: Pass through transaction locktime and preset input sequences and scripts to CreateTransaction by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#issuecomment-1019353666",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24128"
    },
    {
      "event": "subscribed",
      "id": 5937441542,
      "node_id": "SE_lADOABII585CQVBjzwAAAAFh5isG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5937441542",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-22T21:12:18Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-22T21:23:25Z",
      "updated_at": "2022-01-22T21:23:25Z",
      "source": {
        "issue": {
          "id": 1106307710,
          "node_id": "PR_kwDOABII584xLCyY",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24091",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24091/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24091/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24091/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24091",
          "number": 24091,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: Consolidate CInputCoin and COutput",
          "body": "While working on coin selection code, it occurred to me that `CInputCoin` is really a subset of `COutput` and the conversion of a `COutput` to a `CInputCoin` does not appear to be all that useful. So this PR adds fields that are present in `CInputCoin` to `COutput` and replaces the usage of `CInputCoin` with `COutput`.\r\n\r\n`COutput` is also moved to coinselection.h. As part of this move, the usage of `CWalletTx` is removed from `COutput`. It is instead replaced by storing a `COutPoint` and the `CTxOut` rather than the entire `CWalletTx` as coin selection does not really need the full `CWalletTx`. The `CWalletTx` was only used for figuring out whether the transaction containing the output was from the current wallet, and for the transaction's time. These are now parameters to `COutput`'s constructor.",
          "user": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24091",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24091",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24091.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24091.patch"
          },
          "closed_at": "2022-03-24T20:47:10Z",
          "created_at": "2022-01-17T22:30:14Z",
          "updated_at": "2023-06-09T10:05:40Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-22T23:05:50Z",
      "updated_at": "2022-01-22T23:05:50Z",
      "source": {
        "issue": {
          "id": 1083745414,
          "node_id": "PR_kwDOABII584wB0k4",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23810",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23810/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23810/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23810/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/23810",
          "number": 23810,
          "state": "closed",
          "state_reason": null,
          "title": "docs: avoid C-style casts; use modern C++ casts",
          "body": "In the words of practicalswift:\r\n```\r\nA C-style cast is equivalent to try casting in the following order:\r\n\r\n    const_cast(...)\r\n    static_cast(...)\r\n    const_cast(static_cast(...))\r\n    reinterpret_cast(...)\r\n    const_cast(reinterpret_cast(...))\r\n\r\nBy using static_cast<T>(...) explicitly we avoid the possibility of an unintentional and \r\ndangerous reinterpret_cast. Furthermore static_cast<T>(...) allows for easier grepping of casts.\r\n\r\nFor a more thorough discussion, see \"ES.49: If you must use a cast, use a named cast\"\r\nin the C++ Core Guidelines (Stroustrup & Sutter).\r\n```\r\n\r\nModern tooling, specifically `-Wold-style-cast` can enable us to enforce never using C-style casts. I believe this is especially important due to the number of C-style casts the codebase is currently being used as a reinterpret_cast. reinterpret_casts are especially dangerous, and should never be done via C-style casts.\r\n\r\nUpdate the docs to suggest the use of named cast or functional casts.",
          "user": {
            "login": "PastaPastaPasta",
            "id": 6443210,
            "node_id": "MDQ6VXNlcjY0NDMyMTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/PastaPastaPasta",
            "html_url": "https://github.com/PastaPastaPasta",
            "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
            "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
            "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
            "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
            "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 148216,
              "node_id": "MDU6TGFiZWwxNDgyMTY=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Docs",
              "name": "Docs",
              "color": "02d7e1",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 29,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23810",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/23810",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/23810.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/23810.patch"
          },
          "closed_at": "2023-02-08T10:37:04Z",
          "created_at": "2021-12-18T04:41:01Z",
          "updated_at": "2023-02-19T17:44:12Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-23T04:04:48Z",
      "updated_at": "2022-01-23T04:04:48Z",
      "source": {
        "issue": {
          "id": 771452944,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NTQyOTc3MTM4",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20726",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20726/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20726/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20726/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/20726",
          "number": 20726,
          "state": "closed",
          "state_reason": null,
          "title": "p2p: Add DISABLETX message for negotiating block-relay-only connections",
          "body": "Implement BIP 338.\r\n\r\nWhen we initiate a block-relay-only connection today, our peer doesn't know that we won't send transactions ourselves, or even that we won't try to turn on transaction relay at some later point during the connection's lifetime.\r\n\r\nThis PR adds a new p2p message, DISABLETX, to be sent between VERSION and VERACK so that peers can signal to each other that they only want blocks/compactblocks/headers to be sent on the link, and not transaction-relay traffic (or addr messages, unless otherwise indicated).",
          "user": {
            "login": "sdaftuar",
            "id": 7463573,
            "node_id": "MDQ6VXNlcjc0NjM1NzM=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sdaftuar",
            "html_url": "https://github.com/sdaftuar",
            "followers_url": "https://api.github.com/users/sdaftuar/followers",
            "following_url": "https://api.github.com/users/sdaftuar/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/sdaftuar/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/sdaftuar/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
            "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
            "repos_url": "https://api.github.com/users/sdaftuar/repos",
            "events_url": "https://api.github.com/users/sdaftuar/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 55,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20726",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/20726",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/20726.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/20726.patch"
          },
          "closed_at": "2022-05-19T12:47:00Z",
          "created_at": "2020-12-19T20:55:36Z",
          "updated_at": "2023-05-19T10:02:28Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 860319215,
      "node_id": "PRR_kwDOABII584zR23v",
      "url": null,
      "actor": null,
      "commit_id": "9cc17c584350fd7a3105958e9eb96fd39b7a667a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK.\r\n`AntiFeeSnipe` seems to be in line with the approach proposed in BIP 326 and with the suggested pseudocode.\r\nThe changes in comments made the purpose of some fields / variables clearer.",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#pullrequestreview-860319215",
      "submitted_at": "2022-01-23T12:57:00Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5940629865,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAFiFtFp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5940629865",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-24T08:53:00Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-27T00:57:43Z",
      "updated_at": "2022-01-27T00:57:43Z",
      "source": {
        "issue": {
          "id": 1112346906,
          "node_id": "PR_kwDOABII584xeu-v",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24136",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24136/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24136/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24136/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24136",
          "number": 24136,
          "state": "closed",
          "state_reason": null,
          "title": "Extract CTxIn::MAX_SEQUENCE_NONFINAL constant, rework BIP 65/68/112 docs",
          "body": "Extracting the constant makes it possible to attach documentation to it.\r\n\r\nAlso, rework the docs for the other \"sequence constants\".",
          "user": {
            "login": "MarcoFalke",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/MarcoFalke",
            "html_url": "https://github.com/MarcoFalke",
            "followers_url": "https://api.github.com/users/MarcoFalke/followers",
            "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
            "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
            "repos_url": "https://api.github.com/users/MarcoFalke/repos",
            "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 148216,
              "node_id": "MDU6TGFiZWwxNDgyMTY=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Docs",
              "name": "Docs",
              "color": "02d7e1",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 4,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24136",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24136",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24136.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24136.patch"
          },
          "closed_at": "2022-01-31T08:42:26Z",
          "created_at": "2022-01-24T08:56:48Z",
          "updated_at": "2023-01-31T10:10:33Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5979160915,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAFkYsFT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5979160915",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-31T09:12:22Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-31T20:49:08Z",
      "updated_at": "2022-01-31T20:49:08Z",
      "source": {
        "issue": {
          "id": 1119329239,
          "node_id": "PR_kwDOABII584x1SNd",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24213",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24213/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24213/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24213/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24213",
          "number": 24213,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: use Span in random.*",
          "body": "~This PR does two things~\r\n1. use a Span<unsigned char> for GetRandBytes and GetStrongRandBytes\r\n\r\n~2. make GetRand a template for which any integral type can be used, where the default behavior is to return a random integral up to the max of the integral unless a max is provided. \r\nThis simplifies a lot of code from `GetRand(std::numeric_limits<uint64_t>::max()` -> `GetRand<uint64_t>()`~\r\n\r\nMarcoFalke this was inspired by your comment here: https://github.com/bitcoin/bitcoin/pull/24185#issuecomment-1025514263 about using Span, so hopefully I'll be able to get this PR done and merged 😂 \r\n\r\n~Also, if requested I could revert the `GetRand(std::numeric_limits<uint64_t>::max()` -> `GetRand<uint64_t>()` related changes if it ends up causing too many conflicts~",
          "user": {
            "login": "PastaPastaPasta",
            "id": 6443210,
            "node_id": "MDQ6VXNlcjY0NDMyMTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/PastaPastaPasta",
            "html_url": "https://github.com/PastaPastaPasta",
            "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
            "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
            "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
            "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
            "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 241832923,
              "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
              "name": "Utils/log/libs",
              "description": "",
              "color": "5319e7",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 11,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24213",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24213",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24213.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24213.patch"
          },
          "closed_at": "2022-04-21T14:38:40Z",
          "created_at": "2022-01-31T11:51:24Z",
          "updated_at": "2023-01-10T20:16:55Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 869085466,
      "node_id": "PRR_kwDOABII584zzTEa",
      "url": null,
      "actor": null,
      "commit_id": "e0a3bf98b57fc36db60311f65793c16fdfee2452",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "PastaPastaPasta",
        "id": 6443210,
        "node_id": "MDQ6VXNlcjY0NDMyMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PastaPastaPasta",
        "html_url": "https://github.com/PastaPastaPasta",
        "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
        "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
        "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
        "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
        "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#pullrequestreview-869085466",
      "submitted_at": "2022-02-01T12:54:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5988121343,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAFk63r_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5988121343",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-01T13:12:17Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 5989652194,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAFlAtbi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5989652194",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-01T16:37:37Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-02T04:16:13Z",
      "updated_at": "2022-02-02T04:16:13Z",
      "source": {
        "issue": {
          "id": 1120677268,
          "node_id": "PR_kwDOABII584x5v7A",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24225",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24225/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24225/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24225/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24225",
          "number": 24225,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: Add sanity checks to DiscourageFeeSniping",
          "body": "I added those sanity checks as part of implementing BIP 326, but I think they make sense on their own. The checks require the transaction to be passed in to `DiscourageFeeSniping`. Also, replace `(int)locktime` cast with the equivalent `int(locktime)` cast.",
          "user": {
            "login": "MarcoFalke",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/MarcoFalke",
            "html_url": "https://github.com/MarcoFalke",
            "followers_url": "https://api.github.com/users/MarcoFalke/followers",
            "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
            "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
            "repos_url": "https://api.github.com/users/MarcoFalke/repos",
            "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignee": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "assignees": [
            {
              "login": "achow101",
              "id": 3782274,
              "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
              "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/achow101",
              "html_url": "https://github.com/achow101",
              "followers_url": "https://api.github.com/users/achow101/followers",
              "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
              "organizations_url": "https://api.github.com/users/achow101/orgs",
              "repos_url": "https://api.github.com/users/achow101/repos",
              "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/achow101/received_events",
              "type": "User",
              "site_admin": false
            }
          ],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 5,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24225",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24225",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24225.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24225.patch"
          },
          "closed_at": "2022-03-14T10:31:50Z",
          "created_at": "2022-02-01T13:29:42Z",
          "updated_at": "2023-03-14T10:19:06Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6234347319,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAFzmJc3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6234347319",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-14T10:38:28Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6234421578,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAFzmblK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6234421578",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-14T10:48:54Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-14T14:29:00Z",
      "updated_at": "2022-03-14T14:29:00Z",
      "source": {
        "issue": {
          "id": 1168451179,
          "node_id": "PR_kwDOABII5840ZlN7",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24560",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24560/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24560/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24560/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24560",
          "number": 24560,
          "state": "closed",
          "state_reason": null,
          "title": "wallet: Use single FastRandomContext when creating a wallet tx",
          "body": "Passing around a single randomness context shouldn't come with any downsides, but documents better where randomness is used and allows the unit test to be deterministic, if they wish to be so.",
          "user": {
            "login": "MarcoFalke",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/MarcoFalke",
            "html_url": "https://github.com/MarcoFalke",
            "followers_url": "https://api.github.com/users/MarcoFalke/followers",
            "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
            "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
            "repos_url": "https://api.github.com/users/MarcoFalke/repos",
            "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 2,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24560",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24560",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24560.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24560.patch"
          },
          "closed_at": "2022-03-23T17:51:22Z",
          "created_at": "2022-03-14T14:21:59Z",
          "updated_at": "2023-03-24T10:20:39Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 6294046233,
      "node_id": "LE_lADOABII585CQVBjzwAAAAF3J4YZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6294046233",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-23T18:49:35Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6297342392,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAF3WdG4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6297342392",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-24T08:20:07Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6297350247,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAF3WfBn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6297350247",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-24T08:21:19Z"
    },
    {
      "event": "unlabeled",
      "id": 6297827563,
      "node_id": "UNLE_lADOABII585CQVBjzwAAAAF3YTjr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6297827563",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-24T09:30:49Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 6303106475,
      "node_id": "LE_lADOABII585CQVBjzwAAAAF3scWr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6303106475",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-24T22:17:24Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6305770147,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAF32mqj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6305770147",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-25T09:13:40Z"
    },
    {
      "event": "unlabeled",
      "id": 6306406572,
      "node_id": "UNLE_lADOABII585CQVBjzwAAAAF35CCs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6306406572",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-25T10:54:31Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "ready_for_review",
      "id": 6307067222,
      "node_id": "RFRE_lADOABII585CQVBjzwAAAAF37jVW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6307067222",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-25T12:50:41Z"
    },
    {
      "event": "reviewed",
      "id": 926432309,
      "node_id": "PRR_kwDOABII5843ODw1",
      "url": null,
      "actor": null,
      "commit_id": "fa2066fd1272b857501f996267052b4f64a04b29",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "I've a question and a nit, but the code looks good to me and i tested it locally.\r\nACK fa2066fd1272b857501f996267052b4f64a04b29",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#pullrequestreview-926432309",
      "submitted_at": "2022-03-30T17:47:26Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6345695870,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAF6O6J-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6345695870",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-03-31T16:58:08Z"
    },
    {
      "event": "commented",
      "id": 1087534889,
      "node_id": "IC_kwDOABII585A0ncp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1087534889",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-04T13:08:48Z",
      "updated_at": "2022-04-04T13:08:48Z",
      "author_association": "MEMBER",
      "body": "re-ACK fa8cfae8b82a36ae598e1956d16d2d65ac8df44c",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#issuecomment-1087534889",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24128"
    },
    {
      "event": "commented",
      "id": 1091428035,
      "node_id": "IC_kwDOABII585BDd7D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1091428035",
      "actor": {
        "login": "chris-belcher",
        "id": 8398185,
        "node_id": "MDQ6VXNlcjgzOTgxODU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8398185?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/chris-belcher",
        "html_url": "https://github.com/chris-belcher",
        "followers_url": "https://api.github.com/users/chris-belcher/followers",
        "following_url": "https://api.github.com/users/chris-belcher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/chris-belcher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/chris-belcher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/chris-belcher/subscriptions",
        "organizations_url": "https://api.github.com/users/chris-belcher/orgs",
        "repos_url": "https://api.github.com/users/chris-belcher/repos",
        "events_url": "https://api.github.com/users/chris-belcher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/chris-belcher/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-07T09:33:42Z",
      "updated_at": "2022-04-07T09:33:42Z",
      "author_association": "CONTRIBUTOR",
      "body": "I've reviewed the code and it looks fine.\r\n\r\nI compiled this branch and in regtest mode I created many taproot UTXOs which I spent. For each one I looked at the decoded transaction and confirmed that it sometimes sets the sequence number and sometimes sets the locktime, which is the correct behaviour.\r\n\r\ntACK https://github.com/bitcoin/bitcoin/pull/24128/commits/fa8cfae8b82a36ae598e1956d16d2d65ac8df44c",
      "user": {
        "login": "chris-belcher",
        "id": 8398185,
        "node_id": "MDQ6VXNlcjgzOTgxODU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8398185?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/chris-belcher",
        "html_url": "https://github.com/chris-belcher",
        "followers_url": "https://api.github.com/users/chris-belcher/followers",
        "following_url": "https://api.github.com/users/chris-belcher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/chris-belcher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/chris-belcher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/chris-belcher/subscriptions",
        "organizations_url": "https://api.github.com/users/chris-belcher/orgs",
        "repos_url": "https://api.github.com/users/chris-belcher/repos",
        "events_url": "https://api.github.com/users/chris-belcher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/chris-belcher/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#issuecomment-1091428035",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24128"
    },
    {
      "event": "commented",
      "id": 1091839902,
      "node_id": "IC_kwDOABII585BFCee",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1091839902",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-07T14:52:37Z",
      "updated_at": "2022-04-07T14:52:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK. I'm putting this on my to-review list.",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#issuecomment-1091839902",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24128"
    },
    {
      "event": "reviewed",
      "id": 979274513,
      "node_id": "PRR_kwDOABII5846XosR",
      "url": null,
      "actor": null,
      "commit_id": "fa8cfae8b82a36ae598e1956d16d2d65ac8df44c",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#pullrequestreview-979274513",
      "submitted_at": "2022-05-19T21:31:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6720123677,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAGQjPMd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6720123677",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-01T15:15:44Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 6720129149,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAGQjQh9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6720129149",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-01T15:16:18Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-04T00:47:57Z",
      "updated_at": "2022-06-04T00:47:57Z",
      "source": {
        "issue": {
          "id": 1260256447,
          "node_id": "PR_kwDOABII5845Fj6p",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25273",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25273/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25273/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25273/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25273",
          "number": 25273,
          "state": "open",
          "state_reason": null,
          "title": "wallet: Pass through transaction locktime and preset input sequences and scripts to CreateTransaction",
          "body": "Currently `FundTransaction` handles transaction locktime and preset input data by extracting the selected inputs and change output from `CreateTransaction`'s results. This means that `CreateTransaction` is actually unaware of any user desired locktime or sequence numbers. This can have an effect on whether and how anti-fee-sniping works.\r\n\r\nThis PR makes `CreateTransaction` aware of the locktime and preset input data by providing them to `CCoinControl`. `CreateTransasction` will then set the sequences, scriptSigs, scriptWItnesses, and locktime as appropriate if they are specified. This allows `FundTransaction` to actually use `CreateTransaction`'s result directly instead of having to extract the parts of it that it wants.\r\n\r\nAdditionally `FundTransaction` will return a `CreateTransactionResult` as `CreateTransaction` does instead of having several output parameters. Lastly, instead of using `-1` as a magic number for the change output position, the change position is changed to be an optional with no value set indicating no desired change output position (when provided as an input parameter) or no change output present (in the result).",
          "user": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25273",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25273",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25273.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25273.patch"
          },
          "created_at": "2022-06-03T18:58:15Z",
          "updated_at": "2023-08-11T11:09:53Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-21T23:24:48Z",
      "updated_at": "2022-09-21T23:24:48Z",
      "source": {
        "issue": {
          "id": 1381479251,
          "node_id": "PR_kwDOABII584_YTiB",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26152",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26152/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26152/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26152/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26152",
          "number": 26152,
          "state": "open",
          "state_reason": null,
          "title": "Bump unconfirmed ancestor transactions to target feerate",
          "body": "Includes some commits to address follow-ups from #27021: https://github.com/bitcoin/bitcoin/pull/27021#issuecomment-1554675156\r\n\r\nReduces the effective value of unconfirmed UTXOs by the fees necessary to bump their ancestor transactions to the same feerate.\r\n\r\nWhile the individual UTXOs always account for their full ancestry before coin-selection, we can correct potential overestimates with a second pass where we establish the ancestry and bump fee for the whole input set collectively.\r\n\r\nFixes #9645 \r\nFixes #9864 \r\nFixes #15553",
          "user": {
            "login": "murchandamus",
            "id": 4060799,
            "node_id": "MDQ6VXNlcjQwNjA3OTk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/murchandamus",
            "html_url": "https://github.com/murchandamus",
            "followers_url": "https://api.github.com/users/murchandamus/followers",
            "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
            "organizations_url": "https://api.github.com/users/murchandamus/orgs",
            "repos_url": "https://api.github.com/users/murchandamus/repos",
            "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/murchandamus/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 1648013533,
              "node_id": "MDU6TGFiZWwxNjQ4MDEzNTMz",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Review%20club",
              "name": "Review club",
              "description": "",
              "color": "0052cc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 29,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26152",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26152",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26152.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26152.patch"
          },
          "created_at": "2022-09-21T20:52:28Z",
          "updated_at": "2023-08-16T22:23:10Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-11T22:55:45Z",
      "updated_at": "2022-10-11T22:55:45Z",
      "source": {
        "issue": {
          "id": 1238159102,
          "node_id": "PR_kwDOABII58437rQt",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25152",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25152/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25152/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25152/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25152",
          "number": 25152,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Split util/system into exception, shell, and fs-specific files",
          "body": "This is an attempt to significantly improve code organization while making changes as simple as possible to review.\r\n\r\nHere I split four files out of `util/system`:\r\n* `util/exception`, holding `PrintExceptionContinue`\r\n* `util/shell`, holding `ShellEscape`, `runCommand`\r\n* `util/fs`, holding various file, folder, and path-specific functions (building on `fs.h` and `filesystem`)\r\n* `util/args`, holding `ArgsManager` and related functions\r\n\r\nThe goal was to minimize review burden, so I made an effort to minimize the diffs and only modify the code when it was easy to confirm that the change would not have negative consequences.\r\n\r\nThat said, sourcing all of the windows-related headers was not straightforward, so I expect I'll need to touch this up to correct any issues there.",
          "user": {
            "login": "Empact",
            "id": 5470,
            "node_id": "MDQ6VXNlcjU0NzA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Empact",
            "html_url": "https://github.com/Empact",
            "followers_url": "https://api.github.com/users/Empact/followers",
            "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
            "organizations_url": "https://api.github.com/users/Empact/orgs",
            "repos_url": "https://api.github.com/users/Empact/repos",
            "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/Empact/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 9,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25152",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25152",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25152.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25152.patch"
          },
          "closed_at": "2023-03-14T11:37:18Z",
          "created_at": "2022-05-17T06:52:25Z",
          "updated_at": "2023-03-14T11:37:19Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-01-17T02:02:36Z",
      "updated_at": "2023-01-17T02:02:36Z",
      "source": {
        "issue": {
          "id": 1535454202,
          "node_id": "PR_kwDOABII585HfnBR",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26902",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26902/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26902/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26902/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26902",
          "number": 26902,
          "state": "open",
          "state_reason": null,
          "title": "wallet: do not backdate locktime if it may lead to fingerprinting",
          "body": "This is a draft implementation for #26526 and #26527. As suggested by 0xB10C, back-dating locktime in transactions that are RBF replacements or spend unconfirmed UTXOs may be used as a fingerprint of Bitcoin Core wallet.",
          "user": {
            "login": "rodentrabies",
            "id": 7646953,
            "node_id": "MDQ6VXNlcjc2NDY5NTM=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7646953?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/rodentrabies",
            "html_url": "https://github.com/rodentrabies",
            "followers_url": "https://api.github.com/users/rodentrabies/followers",
            "following_url": "https://api.github.com/users/rodentrabies/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/rodentrabies/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/rodentrabies/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/rodentrabies/subscriptions",
            "organizations_url": "https://api.github.com/users/rodentrabies/orgs",
            "repos_url": "https://api.github.com/users/rodentrabies/repos",
            "events_url": "https://api.github.com/users/rodentrabies/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/rodentrabies/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26902",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26902",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26902.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26902.patch"
          },
          "created_at": "2023-01-16T20:27:55Z",
          "updated_at": "2023-07-10T15:05:15Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1481033569,
      "node_id": "IC_kwDOABII585YRsdh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1481033569",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-03-23T11:36:47Z",
      "updated_at": "2023-03-23T11:36:47Z",
      "author_association": "MEMBER",
      "body": "People interested in seeing this move forward may be interested in giving https://github.com/bitcoin/bitcoin/pull/25273 a look. It was recently rebased and reviewed twice.",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#issuecomment-1481033569",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24128"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-05T20:54:09Z",
      "updated_at": "2023-06-05T20:54:09Z",
      "source": {
        "issue": {
          "id": 1741647494,
          "node_id": "PR_kwDOABII585SMBHD",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27827",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27827/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27827/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27827/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/27827",
          "number": 27827,
          "state": "open",
          "state_reason": null,
          "title": "Silent Payments: send and receive",
          "body": "## For reviewers\r\n\r\nIn an attempt to make reviewing a bit more sane, I'm breaking this up into a few smaller PRs, but will keep this one open as the parent PR and keep it rebased on the child PRs. The main purpose of having this PR is to track progress on child PRs and also have an easy way to compile `bitcoind` with both send and receive support for testing. Additionally, I'll be adding more functional tests to this PR since it's much easier to test when `bitcoind` can both send and receive.\r\n\r\n## PRs\r\n\r\n- [ ] https://github.com/bitcoin/bitcoin/pull/28122\r\n  - Implements the logic from BIP352 without any wallet code. This PR adds the necessary cryptographic functions and implements the logic needed for sending and scanning. This PR also includes the test vectors from the BIP as unit tests. Both the send and receive PRs have this as a dependency. In terms of priority, this PR should be reviewed first\r\n- [ ] https://github.com/bitcoin/bitcoin/pull/28201\r\n  - Implements sending in the Bitcoin Core wallet. This PR allows a wallet to send to a silent payment address, regardless of whether or not the wallet can receive silent payments\r\n  - Ready for review, but marked as a draft until dependencies are merged\r\n- [ ] https://github.com/bitcoin/bitcoin/pull/28202\r\n  - Implements receiving in the Bitcoin Core wallet. This PR allows a wallet to generate silent payment addresses and scan for silent payments, regardless of whether or not the wallet can send to a silent payment address\r\n  - Ready for review but marked as a draft until dependencies are merged\r\n\r\nFor the silent payments specification, see https://github.com/bitcoin/bips/pull/1458\r\n\r\n## Overall\r\n\r\nThis PR implements the full silent payments scheme: sending and receiving. The following items are not covered in this PR and are intended for follow-up PRs:\r\n\r\n* Adding labels for the receiver wallet\r\n* Full RPC coverage (only `sendtoaddress` and `sendmany` are covered in this PR)\r\n* Light client support (vending the tweak data per block, either in an index or to serve to indexer, such as electrum server)\r\n* Add benchmarks to validate that there are no DoS concerns for doing silent payment verification for transactions in the mempool\r\n* External signer support (dependent on hardware wallets supporting silent payments)\r\n* More unit / functional test coverage\r\n\r\n## Major changes\r\n\r\nThis PR is a continuation of the work done in https://github.com/bitcoin/bitcoin/pull/24897. Below is a summary of the major changes:\r\n\r\n* Remove labels\r\n  * The original draft included labels, but this has been deferred for a later PR. Labels are not necessary for sending and receiving and there are still some open questions on how best to implement them in Bitcoin Core. Labels can also be added at any point by the receiver without requiring any changes from the sender\r\n* Remove indexes\r\n  * In the original draft, indexes were used when scanning for silent payments and when doing wallet rescans. This has been removed in favor of using `rev*.dat` files for rescanning. It may make sense to add an index in the future, but for the purpose of vending tweak data to light clients, which is still an open question\r\n* Update to implement the most current version of BIP352\r\n  * Since the original draft, there have been a few changes in the BIP which are reflected in the current PR. Most notably, using 33-byte compressed keys for the silent payment address (as opposed to X-only keys in the original draft) \r\n\r\nIt may be helpful for context to read through the discussions on #24897 , but ongoing review should happen in the relevant child PRs listed above.",
          "user": {
            "login": "josibake",
            "id": 7444140,
            "node_id": "MDQ6VXNlcjc0NDQxNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/josibake",
            "html_url": "https://github.com/josibake",
            "followers_url": "https://api.github.com/users/josibake/followers",
            "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
            "organizations_url": "https://api.github.com/users/josibake/orgs",
            "repos_url": "https://api.github.com/users/josibake/repos",
            "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/josibake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 5,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27827",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/27827",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/27827.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/27827.patch"
          },
          "created_at": "2023-06-05T12:12:23Z",
          "updated_at": "2023-08-11T05:03:42Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-09T17:09:19Z",
      "updated_at": "2023-08-09T17:09:19Z",
      "source": {
        "issue": {
          "id": 1843493325,
          "node_id": "PR_kwDOABII585XjLWx",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28246",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28246/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28246/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28246/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28246",
          "number": 28246,
          "state": "open",
          "state_reason": null,
          "title": "wallet: Use CTxDestination in CRecipient instead of just scriptPubKey",
          "body": "For silent payments, we want to provide a `SilentPaymentsDestination` to be used as the recipient, which requires `CRecipient` to use something other than just the `scriptPubKey` as we cannot know the output script for a silent payment prior to transaction creation. `CTxDestination` seems like the obvious place to add a `SilentPaymentsDestination` as it is our internal representation of an address.\r\n\r\nIn order to still allow paying to arbitrary scriptPubKeys (e.g. for data carrier outputs, or the user hand crafted a raw transaction that they have given to `fundrawtransaction`), `CNoDestination` is changed to contain raw scripts.\r\n\r\nAdditionally, P2PK scripts are now interpreted as a new `PubKeyDestination` rather than `PKHash`. This results in some things that would have given an address for P2PK scripts to no longer do so. This is arguably more correct.\r\n\r\n`ExtractDestination`'s behavior is slightly changed for the above. It now returns `true` for those destinations that have addresses, so P2PK scripts now result in `false`. Even though it returns false for `CNoDestination`, the script will now be included in that `CNoDestination`.\r\n\r\nBuilds on #28244",
          "user": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 1,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28246",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28246",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28246.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28246.patch"
          },
          "created_at": "2023-08-09T15:16:28Z",
          "updated_at": "2023-08-15T02:43:03Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-09T17:14:37Z",
      "updated_at": "2023-08-09T17:14:37Z",
      "source": {
        "issue": {
          "id": 1843062887,
          "node_id": "PR_kwDOABII585XhuK3",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28244",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28244/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28244/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28244/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28244",
          "number": 28244,
          "state": "closed",
          "state_reason": null,
          "title": "Break up script/standard.{h/cpp}",
          "body": "Some future work needs to touch things in script/standard.{h/cpp}, however it is unclear if it is safe to do so as they are included in several different places that could effect standardness and consensus. It contains a mix of policy parameters, consensus parameters, and utilities only used by the wallet. This PR breaks up the various components and renames the files to clearly separate everything.\r\n\r\n* `CTxDestination` is moved to a new file `src/addresstype.{cpp/h}`\r\n* `TaprootSpendData` and `TaprootBuilder` (and their utility functions and structs) are moved to `SigningProvider` as these are used only during signing.\r\n* `CScriptID` is moved to `script/script.h` to be next to `CScript`.\r\n* `MANDATORY_SCRIPT_VERIFY_FLAGS` is moved to `interpreter.h`\r\n* The parameters `DEFAULT_ACCEPT_DATACARRIER` and `MAX_OP_RETURN_RELAY` are moved to `policy.h`\r\n* `standard.{cpp/h}` is renamed to `solver.{cpp/h}` since that's all that's left in the file after the above moves",
          "user": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 8,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28244",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28244",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28244.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28244.patch"
          },
          "closed_at": "2023-08-17T11:54:27Z",
          "created_at": "2023-08-09T11:43:57Z",
          "updated_at": "2023-08-17T14:03:27Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-11T03:21:23Z",
      "updated_at": "2023-08-11T03:21:23Z",
      "source": {
        "issue": {
          "id": 1816230792,
          "node_id": "PR_kwDOABII585WHu-Q",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28122",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28122/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28122/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28122/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28122",
          "number": 28122,
          "state": "open",
          "state_reason": null,
          "title": "Silent Payments: Implement BIP352",
          "body": "UPDATE: Rather than having a special encoder and decoder for silent payments, it makes more sense to have `CTxDestination` include a `V0SilentPaymentDestination` type. Some pre-work to make this easier is done in https://github.com/bitcoin/bitcoin/pull/28244 and https://github.com/bitcoin/bitcoin/pull/28246 , which this PR now depends on. If you want to review this PR, please review these two first. One is a move-only refactor, and the other a fairly light refactor with minimal behavior changes.\r\n\r\n<hr/>\r\n\r\nThis PR is a child of https://github.com/bitcoin/bitcoin/pull/27827 and only implements the BIP logic without the wallet code. For the wallet implementations:\r\n* #28201 - implements sending\r\n* #28202 - implements receiving\r\n* #27827 - all three PRs together - this PR is meant for tracking progress and is useful for reviewers who want to compile all three PRs at once for testing\r\n\r\n## BIP352\r\n\r\nThis PR focuses strictly on the BIP logic and attempts to separate it from the wallet and transaction implementation details. This is accomplished by working directly with public and private keys, instead of needing a wallet backend and transactions for testing. Labels for the receiver are optional and thus deferred for a later PR.\r\n\r\nTest vectors from the BIP are included as unit tests.\r\n\r\nBefore reviewing, it is strongly recommended you read https://github.com/bitcoin/bips/pull/1458 and take a look at the reference python implementation on the BIP.\r\n",
          "user": {
            "login": "josibake",
            "id": 7444140,
            "node_id": "MDQ6VXNlcjc0NDQxNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/josibake",
            "html_url": "https://github.com/josibake",
            "followers_url": "https://api.github.com/users/josibake/followers",
            "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
            "organizations_url": "https://api.github.com/users/josibake/orgs",
            "repos_url": "https://api.github.com/users/josibake/repos",
            "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/josibake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            },
            {
              "id": 5334691551,
              "node_id": "LA_kwDOABII588AAAABPfju3w",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
              "name": "CI failed",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28122",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28122",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28122.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28122.patch"
          },
          "created_at": "2023-07-21T18:36:37Z",
          "updated_at": "2023-08-17T13:49:58Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 10119795879,
      "node_id": "LE_lADOABII585CQVBjzwAAAAJbL9Sn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10119795879",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-17T13:52:26Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1682328142,
      "node_id": "IC_kwDOABII585kRkpO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1682328142",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-17T13:52:27Z",
      "updated_at": "2023-08-17T13:52:27Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\n🐙 This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#issuecomment-1682328142",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24128"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10119946457,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAJbMiDZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10119946457",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-17T14:04:28Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZhNjZmYTI3YzZmMDRjZTExNTM5ZTA1ZGFlNjg5YTYwNzYxZWRhNzY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa66fa27c6f04ce11539e05dae689a60761eda76",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/fa66fa27c6f04ce11539e05dae689a60761eda76",
      "tree": {
        "sha": "9cbcbbbb456bc7ca93a0e82d6eb2f8936b3d8fa5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9cbcbbbb456bc7ca93a0e82d6eb2f8936b3d8fa5"
      },
      "verification": {
        "verified": false,
        "reason": "no_user",
        "payload": "tree 9cbcbbbb456bc7ca93a0e82d6eb2f8936b3d8fa5\nparent 6ce5e8f4758e6fccf59b3980af417ec6c75e383e\nauthor MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1654097188 +0200\ncommitter MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1692281576 +0200\n\nImplement sequence-based anti-fee-snipe\n",
        "signature": "-----BEGIN SSH SIGNATURE-----\nU1NIU0lHAAAAAQAAADMAAAALc3NoLWVkMjU1MTkAAAAgqxY/aMPiuXoCFn6iAEyAhvUqFX\njanTudd31Jtt35ct0AAAADZ2l0AAAAAAAAAAZzaGE1MTIAAABTAAAAC3NzaC1lZDI1NTE5\nAAAAQJ2HuQ77ENtGOcKzMkWhs6BHyOg6HsakMyYw9hYkfNnejW1zoP9IOO703OG5udLZCH\n9rtou005VmECJ5a7mPxgg=\n-----END SSH SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6ce5e8f4758e6fccf59b3980af417ec6c75e383e",
          "sha": "6ce5e8f4758e6fccf59b3980af417ec6c75e383e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6ce5e8f4758e6fccf59b3980af417ec6c75e383e"
        }
      ],
      "message": "Implement sequence-based anti-fee-snipe",
      "committer": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2023-08-17T14:12:56Z"
      },
      "author": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2022-06-01T15:26:28Z"
      },
      "sha": "fa66fa27c6f04ce11539e05dae689a60761eda76"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10120052476,
      "node_id": "HRFPE_lADOABII585CQVBjzwAAAAJbM778",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10120052476",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-17T14:13:23Z"
    },
    {
      "event": "labeled",
      "id": 10120055870,
      "node_id": "LE_lADOABII585CQVBjzwAAAAJbM8w-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10120055870",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-17T14:13:40Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/796564941",
      "pull_request_review_id": 869085466,
      "id": 796564941,
      "node_id": "PRRC_kwDOABII584vep3N",
      "diff_hunk": "@@ -609,23 +618,77 @@ static uint32_t GetLocktimeForNewTransaction(interfaces::Chain& chain, const uin\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        locktime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (GetRandInt(10) == 0)\n-            locktime = std::max(0, (int)locktime - GetRandInt(100));\n+        bool locktime_based{false};\n+        for (const auto& in : inputs) {\n+            std::vector<std::vector<uint8_t>> dummy;\n+            const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+            // Use locktime if any nSequence is out-of-range or any input isn't taproot\n+            if (1 > in.m_depth || in.m_depth > 65535 || in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                locktime_based = true;\n+                break;\n+            }\n+        }\n+        if (locktime_based || GetRandInt(2) == 0) {\n+            tx.nLockTime = block_height;\n+\n+            // Secondly occasionally randomly pick a nLockTime even further back, so\n+            // that transactions that are delayed after signing for whatever reason,\n+            // e.g. high-latency mix networks and some CoinJoin implementations, have\n+            // better privacy.\n+            if (GetRandInt(10) == 0) {\n+                tx.nLockTime = std::max(0, (int)tx.nLockTime - GetRandInt(100));",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 80,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "e0a3bf98b57fc36db60311f65793c16fdfee2452",
      "in_reply_to_id": null,
      "user": {
        "login": "PastaPastaPasta",
        "id": 6443210,
        "node_id": "MDQ6VXNlcjY0NDMyMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PastaPastaPasta",
        "html_url": "https://github.com/PastaPastaPasta",
        "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
        "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
        "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
        "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
        "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "please convert this to a c++11 style functional cast",
      "created_at": "2022-02-01T12:52:59Z",
      "updated_at": "2022-02-01T12:54:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r796564941",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/796564941"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 664,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/796596221",
      "pull_request_review_id": 869129599,
      "id": 796596221,
      "node_id": "PRRC_kwDOABII584vexf9",
      "diff_hunk": "@@ -609,23 +618,77 @@ static uint32_t GetLocktimeForNewTransaction(interfaces::Chain& chain, const uin\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        locktime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (GetRandInt(10) == 0)\n-            locktime = std::max(0, (int)locktime - GetRandInt(100));\n+        bool locktime_based{false};\n+        for (const auto& in : inputs) {\n+            std::vector<std::vector<uint8_t>> dummy;\n+            const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+            // Use locktime if any nSequence is out-of-range or any input isn't taproot\n+            if (1 > in.m_depth || in.m_depth > 65535 || in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                locktime_based = true;\n+                break;\n+            }\n+        }\n+        if (locktime_based || GetRandInt(2) == 0) {\n+            tx.nLockTime = block_height;\n+\n+            // Secondly occasionally randomly pick a nLockTime even further back, so\n+            // that transactions that are delayed after signing for whatever reason,\n+            // e.g. high-latency mix networks and some CoinJoin implementations, have\n+            // better privacy.\n+            if (GetRandInt(10) == 0) {\n+                tx.nLockTime = std::max(0, (int)tx.nLockTime - GetRandInt(100));",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 80,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "e0a3bf98b57fc36db60311f65793c16fdfee2452",
      "in_reply_to_id": 796564941,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Seems unrelated to this pull request, but done in https://github.com/bitcoin/bitcoin/pull/24225",
      "created_at": "2022-02-01T13:30:13Z",
      "updated_at": "2022-02-01T13:30:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r796596221",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/796596221"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 664,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838760681",
      "pull_request_review_id": 926432309,
      "id": 838760681,
      "node_id": "PRRC_kwDOABII584x_njp",
      "diff_hunk": "@@ -615,15 +625,59 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        tx.nLockTime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (rng_fast.randrange(10) == 0) {\n-            tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+        auto locktime_based{[&] {\n+            if (!SignalsOptInRBF(CTransaction{tx})) {\n+                // Use locktime if the tx inputs do not opt-in to RBF\n+                return true;\n+            }\n+            for (const auto& in : inputs) {\n+                if (in.depth < 1 || uint64_t(in.depth) > MAX_BLOCK_SEQ) {\n+                    // Use locktime if any depth is out-of-range\n+                    return true;\n+                }\n+                std::vector<std::vector<uint8_t>> dummy;\n+                const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+                // Use locktime if any input isn't taproot\n+                if (in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                    return true;\n+                }\n+            }\n+            return false;\n+        }};\n+        if (locktime_based() || GetRandInt(2) == 0) {\n+            tx.nLockTime = block_height;\n+\n+            // Secondly occasionally randomly pick a nLockTime even further back, so\n+            // that transactions that are delayed after signing for whatever reason,\n+            // e.g. high-latency mix networks and some CoinJoin implementations, have\n+            // better privacy.\n+            if (rng_fast.randrange(10) == 0) {\n+                tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+            }\n+        } else { // sequence based\n+            tx.nLockTime = 0;\n+            const auto i_input{GetRandInt(tx.vin.size())};\n+            CTxIn& in{tx.vin.at(i_input)};\n+            in.nSequence = inputs.at(i_input).depth;\n+            if (GetRandInt(10) == 0) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 98,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "fa2066fd1272b857501f996267052b4f64a04b29",
      "in_reply_to_id": null,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: since you already have `rng_fast` you could use it instead of re-creating a context with `GetRandInt`. (Here and elsewhere in this function.)",
      "created_at": "2022-03-30T16:47:52Z",
      "updated_at": "2022-03-30T17:47:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r838760681",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838760681"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 677,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838787057",
      "pull_request_review_id": 926432309,
      "id": 838787057,
      "node_id": "PRRC_kwDOABII584x_t_x",
      "diff_hunk": "@@ -615,15 +625,59 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        tx.nLockTime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (rng_fast.randrange(10) == 0) {\n-            tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+        auto locktime_based{[&] {\n+            if (!SignalsOptInRBF(CTransaction{tx})) {\n+                // Use locktime if the tx inputs do not opt-in to RBF\n+                return true;\n+            }\n+            for (const auto& in : inputs) {\n+                if (in.depth < 1 || uint64_t(in.depth) > MAX_BLOCK_SEQ) {\n+                    // Use locktime if any depth is out-of-range\n+                    return true;\n+                }\n+                std::vector<std::vector<uint8_t>> dummy;\n+                const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+                // Use locktime if any input isn't taproot\n+                if (in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                    return true;\n+                }",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 79,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "fa2066fd1272b857501f996267052b4f64a04b29",
      "in_reply_to_id": null,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It has a specific usecase for Taproot, but what is the rationale for disabling it for non-(pure-)Taproot transactions? The \"created by Bitcoin Core wallet\" fingerprint?",
      "created_at": "2022-03-30T17:17:29Z",
      "updated_at": "2022-03-30T17:47:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r838787057",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/838787057"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": 653,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 832,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/839827974",
      "pull_request_review_id": 927906694,
      "id": 839827974,
      "node_id": "PRRC_kwDOABII584yDsIG",
      "diff_hunk": "@@ -615,15 +625,59 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        tx.nLockTime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (rng_fast.randrange(10) == 0) {\n-            tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+        auto locktime_based{[&] {\n+            if (!SignalsOptInRBF(CTransaction{tx})) {\n+                // Use locktime if the tx inputs do not opt-in to RBF\n+                return true;\n+            }\n+            for (const auto& in : inputs) {\n+                if (in.depth < 1 || uint64_t(in.depth) > MAX_BLOCK_SEQ) {\n+                    // Use locktime if any depth is out-of-range\n+                    return true;\n+                }\n+                std::vector<std::vector<uint8_t>> dummy;\n+                const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+                // Use locktime if any input isn't taproot\n+                if (in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                    return true;\n+                }",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 79,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "fa2066fd1272b857501f996267052b4f64a04b29",
      "in_reply_to_id": 838787057,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I can't say for sure, since I am not the author of BIP 326, but I presume:\r\n\r\n* Any protocol that relies on sequence values in \"legacy\" key-only spends may be encouraged to upgrade to taproot.\r\n* Any new \"population\" of txs that have the same fingerprint will reduce the privacy for themselves and everyone else. Though, if such a population already exists, I can see the reason for Bitcoin Core to mix itself into that population.\r\n\r\nSo I guess the question is whether such a protocol exists and is unlikely to use/upgrade to taproot?",
      "created_at": "2022-03-31T16:52:14Z",
      "updated_at": "2022-03-31T16:52:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r839827974",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/839827974"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": 653,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 832,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844146594",
      "pull_request_review_id": 933769676,
      "id": 844146594,
      "node_id": "PRRC_kwDOABII584yUKei",
      "diff_hunk": "@@ -615,15 +625,59 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        tx.nLockTime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (rng_fast.randrange(10) == 0) {\n-            tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+        auto locktime_based{[&] {\n+            if (!SignalsOptInRBF(CTransaction{tx})) {\n+                // Use locktime if the tx inputs do not opt-in to RBF\n+                return true;\n+            }\n+            for (const auto& in : inputs) {\n+                if (in.depth < 1 || uint64_t(in.depth) > MAX_BLOCK_SEQ) {\n+                    // Use locktime if any depth is out-of-range\n+                    return true;\n+                }\n+                std::vector<std::vector<uint8_t>> dummy;\n+                const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+                // Use locktime if any input isn't taproot\n+                if (in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                    return true;\n+                }",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 79,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "fa2066fd1272b857501f996267052b4f64a04b29",
      "in_reply_to_id": 838787057,
      "user": {
        "login": "chris-belcher",
        "id": 8398185,
        "node_id": "MDQ6VXNlcjgzOTgxODU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8398185?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/chris-belcher",
        "html_url": "https://github.com/chris-belcher",
        "followers_url": "https://api.github.com/users/chris-belcher/followers",
        "following_url": "https://api.github.com/users/chris-belcher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/chris-belcher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/chris-belcher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/chris-belcher/subscriptions",
        "organizations_url": "https://api.github.com/users/chris-belcher/orgs",
        "repos_url": "https://api.github.com/users/chris-belcher/repos",
        "events_url": "https://api.github.com/users/chris-belcher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/chris-belcher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "As the author of bip326, yes, I was thinking along the lines of @MarcoFalke's second point. Changing the behaviour of legacy transactions of which there is already a large population would reduce privacy. It's best to leave legacy transactions unchanged. Also non-taproot outputs cannot (easily) be used to create point-time-locked-contracts so the \"privacy cloak\" they create is useless, it would never be used.",
      "created_at": "2022-04-06T16:24:03Z",
      "updated_at": "2022-04-06T16:30:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r844146594",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844146594"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": 653,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 832,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844758976",
      "pull_request_review_id": 934549856,
      "id": 844758976,
      "node_id": "PRRC_kwDOABII584yWf_A",
      "diff_hunk": "@@ -615,15 +625,59 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        tx.nLockTime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (rng_fast.randrange(10) == 0) {\n-            tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+        auto locktime_based{[&] {\n+            if (!SignalsOptInRBF(CTransaction{tx})) {\n+                // Use locktime if the tx inputs do not opt-in to RBF\n+                return true;\n+            }\n+            for (const auto& in : inputs) {\n+                if (in.depth < 1 || uint64_t(in.depth) > MAX_BLOCK_SEQ) {\n+                    // Use locktime if any depth is out-of-range\n+                    return true;\n+                }\n+                std::vector<std::vector<uint8_t>> dummy;\n+                const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+                // Use locktime if any input isn't taproot\n+                if (in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                    return true;\n+                }",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 79,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "fa2066fd1272b857501f996267052b4f64a04b29",
      "in_reply_to_id": 838787057,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think a protocol that uses plain non-taproot keys with just plain pre-signed transactions and sequence based locktimes could still benefit from Bitcoin Core cloaking non-taproot inputs, no? Though, as they only use plain keys they might as well upgrade to taproot to get the taproot-specific cloak.",
      "created_at": "2022-04-07T06:40:21Z",
      "updated_at": "2022-04-07T06:40:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r844758976",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844758976"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": 653,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 832,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844916838",
      "pull_request_review_id": 934755979,
      "id": 844916838,
      "node_id": "PRRC_kwDOABII584yXGhm",
      "diff_hunk": "@@ -615,15 +625,59 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        tx.nLockTime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (rng_fast.randrange(10) == 0) {\n-            tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+        auto locktime_based{[&] {\n+            if (!SignalsOptInRBF(CTransaction{tx})) {\n+                // Use locktime if the tx inputs do not opt-in to RBF\n+                return true;\n+            }\n+            for (const auto& in : inputs) {\n+                if (in.depth < 1 || uint64_t(in.depth) > MAX_BLOCK_SEQ) {\n+                    // Use locktime if any depth is out-of-range\n+                    return true;\n+                }\n+                std::vector<std::vector<uint8_t>> dummy;\n+                const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+                // Use locktime if any input isn't taproot\n+                if (in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                    return true;\n+                }",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 79,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "fa2066fd1272b857501f996267052b4f64a04b29",
      "in_reply_to_id": 838787057,
      "user": {
        "login": "chris-belcher",
        "id": 8398185,
        "node_id": "MDQ6VXNlcjgzOTgxODU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8398185?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/chris-belcher",
        "html_url": "https://github.com/chris-belcher",
        "followers_url": "https://api.github.com/users/chris-belcher/followers",
        "following_url": "https://api.github.com/users/chris-belcher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/chris-belcher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/chris-belcher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/chris-belcher/subscriptions",
        "organizations_url": "https://api.github.com/users/chris-belcher/orgs",
        "repos_url": "https://api.github.com/users/chris-belcher/repos",
        "events_url": "https://api.github.com/users/chris-belcher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/chris-belcher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't think that kind of protocol is possible. A point lock requires taproot. Why would someone use nsequence-based locktimes when they can't have some kind of point-lock?",
      "created_at": "2022-04-07T09:25:21Z",
      "updated_at": "2022-04-07T09:25:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r844916838",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/844916838"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": 653,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 832,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/867757540",
      "pull_request_review_id": 965770410,
      "id": 867757540,
      "node_id": "PRRC_kwDOABII584zuO3k",
      "diff_hunk": "@@ -615,15 +625,59 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        tx.nLockTime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (rng_fast.randrange(10) == 0) {\n-            tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+        auto locktime_based{[&] {\n+            if (!SignalsOptInRBF(CTransaction{tx})) {\n+                // Use locktime if the tx inputs do not opt-in to RBF\n+                return true;\n+            }\n+            for (const auto& in : inputs) {\n+                if (in.depth < 1 || uint64_t(in.depth) > MAX_BLOCK_SEQ) {\n+                    // Use locktime if any depth is out-of-range\n+                    return true;\n+                }\n+                std::vector<std::vector<uint8_t>> dummy;\n+                const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+                // Use locktime if any input isn't taproot\n+                if (in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                    return true;\n+                }",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 79,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "fa2066fd1272b857501f996267052b4f64a04b29",
      "in_reply_to_id": 838787057,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Forgot to reply to this comment earlier. Chris, nSequence-based locktimes are useful for anti-fee sniping for presigned transactions (as you can't use nLockTime-based protection for those, use an input with an nSequence set when bumping the fees).\r\nI don't think this is a justification for cloaking non-Taproot inputs here. By the time the cloak is realistically available, they would probably use Taproot and otherwise they should. They have an incentive to upgrade anyways, as fee-bumping with Taproot inputs is more efficient.",
      "created_at": "2022-05-09T08:24:38Z",
      "updated_at": "2022-05-09T08:24:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r867757540",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/867757540"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": 653,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 832,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877548757",
      "pull_request_review_id": 979274513,
      "id": 877548757,
      "node_id": "PRRC_kwDOABII5840TlTV",
      "diff_hunk": "@@ -620,15 +630,59 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        tx.nLockTime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (rng_fast.randrange(10) == 0) {\n-            tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+        auto locktime_based{[&] {\n+            if (!SignalsOptInRBF(CTransaction{tx})) {\n+                // Use locktime if the tx inputs do not opt-in to RBF\n+                return true;\n+            }\n+            for (const auto& in : inputs) {\n+                if (in.depth < 1 || uint64_t(in.depth) > MAX_BLOCK_SEQ) {\n+                    // Use locktime if any depth is out-of-range\n+                    return true;\n+                }\n+                std::vector<std::vector<uint8_t>> dummy;\n+                const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+                // Use locktime if any input isn't taproot\n+                if (in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                    return true;\n+                }\n+            }\n+            return false;\n+        }};\n+        if (locktime_based() || rng_fast.randrange(2) == 0) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 83,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "fa8cfae8b82a36ae598e1956d16d2d65ac8df44c",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit:\r\n\r\nUse `randbool`\r\n\r\n```suggestion\r\n        if (locktime_based() || rng_fast.randbool()) {\r\n```\r\n\r\nAlso, why not have the random bool be part of `locktime_based`?",
      "created_at": "2022-05-19T21:17:49Z",
      "updated_at": "2022-05-19T21:31:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r877548757",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877548757"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 667,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877555927",
      "pull_request_review_id": 979274513,
      "id": 877555927,
      "node_id": "PRRC_kwDOABII5840TnDX",
      "diff_hunk": "@@ -620,15 +630,59 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        tx.nLockTime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (rng_fast.randrange(10) == 0) {\n-            tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+        auto locktime_based{[&] {\n+            if (!SignalsOptInRBF(CTransaction{tx})) {\n+                // Use locktime if the tx inputs do not opt-in to RBF\n+                return true;\n+            }\n+            for (const auto& in : inputs) {\n+                if (in.depth < 1 || uint64_t(in.depth) > MAX_BLOCK_SEQ) {\n+                    // Use locktime if any depth is out-of-range\n+                    return true;\n+                }\n+                std::vector<std::vector<uint8_t>> dummy;\n+                const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+                // Use locktime if any input isn't taproot\n+                if (in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                    return true;\n+                }\n+            }\n+            return false;\n+        }};\n+        if (locktime_based() || rng_fast.randrange(2) == 0) {\n+            tx.nLockTime = block_height;\n+\n+            // Secondly occasionally randomly pick a nLockTime even further back, so\n+            // that transactions that are delayed after signing for whatever reason,\n+            // e.g. high-latency mix networks and some CoinJoin implementations, have\n+            // better privacy.\n+            if (rng_fast.randrange(10) == 0) {\n+                tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+            }\n+        } else { // sequence based\n+            tx.nLockTime = 0;\n+            const auto i_input{rng_fast.randrange(tx.vin.size())};\n+            CTxIn& in{tx.vin.at(i_input)};\n+            in.nSequence = inputs.at(i_input).depth;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 97,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "fa8cfae8b82a36ae598e1956d16d2d65ac8df44c",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "There could be some unexpected behavior here when users set their own sequence numbers.\r\n\r\nIf a user set their own sequence, we would not want to clobber it as that could have negative effects on their payment. So we should avoid changing the sequence on any inputs that use a non-default sequence number.\r\n\r\nHowever, `DiscourageFeeSniping` is called by `CreateTransactionInternal` which does not actually set (or know about) user defined sequences. User defined sequences are handled externally in `FundTransaction` where the it actually retains the `CTxIn`s of the transaction to fund and then adds the inputs that `CreateTransaction` chooses.\r\n\r\nSo user defined sequences actually end up in the transaction and we lose the anti-fee-sniping that we wanted.\r\n\r\nI think the correct way to do this is to make `CreateTransactionInternal` aware of user defined sequences and set them in the transaction it is creating. Then here in `DiscrouageFeeSniping`, we can check just choose randomly among the inputs that have default sequences.\r\n\r\nHowever, what should we do if the user sets a default sequence explicitly? Should we respect that and avoid randomly selecting those inputs? Additionally, even if a user did set a default sequence explicitly, `fundrawtransaction` would not know because it takes a raw transaction which has sequences that `createrawtransaction` may have set using defaults.",
      "created_at": "2022-05-19T21:29:48Z",
      "updated_at": "2022-05-19T21:31:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r877555927",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877555927"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": 679,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 851,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/886735641",
      "pull_request_review_id": 991870231,
      "id": 886735641,
      "node_id": "PRRC_kwDOABII58402oMZ",
      "diff_hunk": "@@ -620,15 +630,59 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        tx.nLockTime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (rng_fast.randrange(10) == 0) {\n-            tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+        auto locktime_based{[&] {\n+            if (!SignalsOptInRBF(CTransaction{tx})) {\n+                // Use locktime if the tx inputs do not opt-in to RBF\n+                return true;\n+            }\n+            for (const auto& in : inputs) {\n+                if (in.depth < 1 || uint64_t(in.depth) > MAX_BLOCK_SEQ) {\n+                    // Use locktime if any depth is out-of-range\n+                    return true;\n+                }\n+                std::vector<std::vector<uint8_t>> dummy;\n+                const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+                // Use locktime if any input isn't taproot\n+                if (in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                    return true;\n+                }\n+            }\n+            return false;\n+        }};\n+        if (locktime_based() || rng_fast.randrange(2) == 0) {\n+            tx.nLockTime = block_height;\n+\n+            // Secondly occasionally randomly pick a nLockTime even further back, so\n+            // that transactions that are delayed after signing for whatever reason,\n+            // e.g. high-latency mix networks and some CoinJoin implementations, have\n+            // better privacy.\n+            if (rng_fast.randrange(10) == 0) {\n+                tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+            }\n+        } else { // sequence based\n+            tx.nLockTime = 0;\n+            const auto i_input{rng_fast.randrange(tx.vin.size())};\n+            CTxIn& in{tx.vin.at(i_input)};\n+            in.nSequence = inputs.at(i_input).depth;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 97,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "fa8cfae8b82a36ae598e1956d16d2d65ac8df44c",
      "in_reply_to_id": 877555927,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think we should never fiddle with user chosen sequence numbers, even if they happen to be \"default\". I also think this is the way that createrawtransaction/createpsbt works (it wouldn't set locktime nonzero unless the user asked for it and it wouldn't set sequence in violation of the `replaceable` boolean option unless the user asked for it).\r\n\r\nIf you are asking to extend fee sniping to createrawtransaction/createpsbt, I think this should be done in a separate pull request.\r\n\r\nThe sequence numbers in CreateTransactionInternal solely depend on `const bool use_rbf`, so I think the changes here are both safe and sane.",
      "created_at": "2022-06-01T12:17:16Z",
      "updated_at": "2022-06-01T12:17:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r886735641",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/886735641"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": 679,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 851,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/886736899",
      "pull_request_review_id": 991872045,
      "id": 886736899,
      "node_id": "PRRC_kwDOABII58402ogD",
      "diff_hunk": "@@ -620,15 +630,59 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        tx.nLockTime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (rng_fast.randrange(10) == 0) {\n-            tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+        auto locktime_based{[&] {\n+            if (!SignalsOptInRBF(CTransaction{tx})) {\n+                // Use locktime if the tx inputs do not opt-in to RBF\n+                return true;\n+            }\n+            for (const auto& in : inputs) {\n+                if (in.depth < 1 || uint64_t(in.depth) > MAX_BLOCK_SEQ) {\n+                    // Use locktime if any depth is out-of-range\n+                    return true;\n+                }\n+                std::vector<std::vector<uint8_t>> dummy;\n+                const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+                // Use locktime if any input isn't taproot\n+                if (in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                    return true;\n+                }\n+            }\n+            return false;\n+        }};\n+        if (locktime_based() || rng_fast.randrange(2) == 0) {",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 83,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "fa8cfae8b82a36ae598e1956d16d2d65ac8df44c",
      "in_reply_to_id": 877548757,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yeah, it can be moved inside, as all early returns are `true` and the final return is the only one with `false`.",
      "created_at": "2022-06-01T12:18:46Z",
      "updated_at": "2022-06-01T12:18:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r886736899",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/886736899"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 667,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/886962452",
      "pull_request_review_id": 992197699,
      "id": 886962452,
      "node_id": "PRRC_kwDOABII58403fkU",
      "diff_hunk": "@@ -620,15 +630,59 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        tx.nLockTime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (rng_fast.randrange(10) == 0) {\n-            tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+        auto locktime_based{[&] {\n+            if (!SignalsOptInRBF(CTransaction{tx})) {\n+                // Use locktime if the tx inputs do not opt-in to RBF\n+                return true;\n+            }\n+            for (const auto& in : inputs) {\n+                if (in.depth < 1 || uint64_t(in.depth) > MAX_BLOCK_SEQ) {\n+                    // Use locktime if any depth is out-of-range\n+                    return true;\n+                }\n+                std::vector<std::vector<uint8_t>> dummy;\n+                const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+                // Use locktime if any input isn't taproot\n+                if (in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                    return true;\n+                }\n+            }\n+            return false;\n+        }};\n+        if (locktime_based() || rng_fast.randrange(2) == 0) {\n+            tx.nLockTime = block_height;\n+\n+            // Secondly occasionally randomly pick a nLockTime even further back, so\n+            // that transactions that are delayed after signing for whatever reason,\n+            // e.g. high-latency mix networks and some CoinJoin implementations, have\n+            // better privacy.\n+            if (rng_fast.randrange(10) == 0) {\n+                tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+            }\n+        } else { // sequence based\n+            tx.nLockTime = 0;\n+            const auto i_input{rng_fast.randrange(tx.vin.size())};\n+            CTxIn& in{tx.vin.at(i_input)};\n+            in.nSequence = inputs.at(i_input).depth;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 97,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "fa8cfae8b82a36ae598e1956d16d2d65ac8df44c",
      "in_reply_to_id": 877555927,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "At the very least I think this ends up applying anti-fee-sniping inconsistently.\r\n\r\nThe current behavior is that we never apply anti-fee-sniping to transactions funded with `fundrawtransaction` and `walletcreatefundedpsbt` as the locktime provided by the user (or the default of 0) is always used regardless of `DiscourageFeeSniping`.\r\n\r\nWith this PR, if `DiscourageFeeSniping` randomly chose a preset input, then we would discard the sequence it applies to that input and use the user provided sequence (or the default).\r\n\r\nHowever if `DiscourageFeeSniping` chooses an input that coin selection chose, then the sequence it applies would be used and the transaction would end up using sequence based anti-fee-sniping.\r\n\r\nSo the only results if a user uses `fundrawtransaction` or `walletcreatefundedpsbt` are sequence based anti-fee-sniping or no anti-fee-sniping. This could be a potential fingerprint. Thus we may want to disable anti-fee-sniping whenever `fundrawtransaction` or `walletcreatefundedpsbt` are used, at least until we are able to provide sequences and locktimes to `CreateTransactionInternal` (which I am currently working on).",
      "created_at": "2022-06-01T15:45:01Z",
      "updated_at": "2022-06-01T15:45:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r886962452",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/886962452"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": 679,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 851,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/887150260",
      "pull_request_review_id": 992470354,
      "id": 887150260,
      "node_id": "PRRC_kwDOABII58404Na0",
      "diff_hunk": "@@ -620,15 +630,59 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     // enough, that fee sniping isn't a problem yet, but by implementing a fix\n     // now we ensure code won't be written that makes assumptions about\n     // nLockTime that preclude a fix later.\n+    //\n+    // nSequence-based\n+    // ---------------\n+    //\n+    // If all inputs in the tx spend taproot coins, use nSequence to discourage\n+    // fee-sniping. This creates a \"privacy cloak\" for txs that use taproot\n+    // key-path spends (BIP326).\n+    //\n+    // Compared to nLockTime-based anti-fee-sniping, this may be minimally less\n+    // effective, as nSequence only allows relative locks. If all inputs of the\n+    // tx can be moved backward in the chain, this tx can be as well. Though,\n+    // this should be fine given that 10% of txs have their locktime randomly\n+    // reduced to a past block. Also, sequence-based locking will only be used\n+    // if every sequence is at least 1.\n     if (IsCurrentForAntiFeeSniping(chain, block_hash)) {\n-        tx.nLockTime = block_height;\n-\n-        // Secondly occasionally randomly pick a nLockTime even further back, so\n-        // that transactions that are delayed after signing for whatever reason,\n-        // e.g. high-latency mix networks and some CoinJoin implementations, have\n-        // better privacy.\n-        if (rng_fast.randrange(10) == 0) {\n-            tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+        auto locktime_based{[&] {\n+            if (!SignalsOptInRBF(CTransaction{tx})) {\n+                // Use locktime if the tx inputs do not opt-in to RBF\n+                return true;\n+            }\n+            for (const auto& in : inputs) {\n+                if (in.depth < 1 || uint64_t(in.depth) > MAX_BLOCK_SEQ) {\n+                    // Use locktime if any depth is out-of-range\n+                    return true;\n+                }\n+                std::vector<std::vector<uint8_t>> dummy;\n+                const TxoutType in_type{Solver(in.txout.scriptPubKey, dummy)};\n+                // Use locktime if any input isn't taproot\n+                if (in_type != TxoutType::WITNESS_V1_TAPROOT) {\n+                    return true;\n+                }\n+            }\n+            return false;\n+        }};\n+        if (locktime_based() || rng_fast.randrange(2) == 0) {\n+            tx.nLockTime = block_height;\n+\n+            // Secondly occasionally randomly pick a nLockTime even further back, so\n+            // that transactions that are delayed after signing for whatever reason,\n+            // e.g. high-latency mix networks and some CoinJoin implementations, have\n+            // better privacy.\n+            if (rng_fast.randrange(10) == 0) {\n+                tx.nLockTime = std::max(0, int(tx.nLockTime) - int(rng_fast.randrange(100)));\n+            }\n+        } else { // sequence based\n+            tx.nLockTime = 0;\n+            const auto i_input{rng_fast.randrange(tx.vin.size())};\n+            CTxIn& in{tx.vin.at(i_input)};\n+            in.nSequence = inputs.at(i_input).depth;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 97,
      "commit_id": "fa66fa27c6f04ce11539e05dae689a60761eda76",
      "original_commit_id": "fa8cfae8b82a36ae598e1956d16d2d65ac8df44c",
      "in_reply_to_id": 877555927,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Oh, good catch. Though, it appears this bug already exists in current master.\r\n\r\nYou can test this by calling `createrawtransaction` with `replacable=True` and providing some inputs, then have `fundrawtransaction` pick the remaining inputs. Now anyone can tell apart the `createrawtransaction`-inputs from the `fundrawtransaction`-inputs by looking at the sequence number.",
      "created_at": "2022-06-01T17:59:24Z",
      "updated_at": "2022-06-01T17:59:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/24128#discussion_r887150260",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/887150260"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24128"
        }
      },
      "start_line": null,
      "original_start_line": 679,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 851,
      "side": "RIGHT"
    }
  ]
}