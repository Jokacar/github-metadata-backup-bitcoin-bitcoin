{
  "type": "issue",
  "issue": {
    "id": 2127419397,
    "node_id": "I_kwDOABII585-zdgF",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29416",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29416/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29416/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29416/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/29416",
    "number": 29416,
    "state": "open",
    "state_reason": null,
    "title": "Enable sanctions enforcement in Spam Filter Code",
    "body": "### Please describe the feature you'd like to see added.\n\nAs a miner operating within a sanctions regime,\r\nI need to be able to reject transactions and maybe even blocks that contain sanctioned hashes.\r\n\r\nPowerful sanctions regimes provide lists of sanctioned hashes for all major blockchains, including Bitcoin. These hashes end up being incorporated into output script templates that reside on the Bitcoin blockchain, and when these hashes are included, transactions need to be rejected.\n\n### Is your feature related to a problem, if so please describe it.\n\nYes, the problem to be fixed is described in Issue #29137\n\n### Describe the solution you'd like\n\n### Sanctions File\r\nSanctions regimes list their sanctioned hashes in standard address formats.\r\n\r\nThese hashes can be extracted from official sanctions files into a simple text file of one address per line. (To avoid semantical arguments, this file SHOULD NOT be seen as containing a list of sanctioned addresses; rather, it contains a list of sanctioned hashes that may later on be incorporated into standard output script templates.)\r\n\r\nAn example sanctions file extracted from OFAC's `sdn_advanced.xml` file is available in @0xB10C's `ofac-sanctioned-digital-currency-addresses` repository: https://github.com/0xB10C/ofac-sanctioned-digital-currency-addresses/blob/lists/sanctioned_addresses_XBT.txt\r\n\r\n### Command Line Arguments / Configuration File Options\r\nProposed command line options:\r\n* `-checksanctions=filename` : Enforce sanctions during transaction validation by loading the sanctions search tree from a specified text file (Default filename: sanctions.txt)\r\n* `-sanctionblocks` : Enforce sanctions by rejecting new blocks that contain sanctioned transactions\r\n\r\n### Runtime Operation\r\nIf I am subject to a sanctions regime, I need to be able to optionally turn on sanctions enforcement. Sanctions need to be enforced when transactions are validated, such as during mempool acceptance, package relay, and possibly block validation (but not initial block download).\r\n\r\n#### Load sanctions file & populate search tree\r\nOn startup, the sanctions text file is read and the encoded script template hashes are decoded into their byte arrays in accordance with `addresstype.{h,cpp}` and/or `script/solver.{h,cpp}`.\r\n\r\nAs each sanctioned hash is decoded into its `std::vector<unsigned char>`, it is added to a trie data structure for efficient matching during transaction validation.\r\n\r\nA ternary search tree that can take `std::basic_string`s backed by `std::vector<unsigned char>` is available to the Bitcoin source code via its dependency on Boost: https://www.boost.org/doc/libs/1_84_0/libs/spirit/doc/html/spirit/qi/reference/string/symbols.html\r\n\r\n#### Reject transactions containing sanctioned hashes\r\nAny time a sanctions-enforcing node takes in a new transaction or a new inventory of transactions, that node needs to check txin output scripts and txout output scripts for sanctioned hashes.\r\n\r\n#### Optionally reject sanctioned blocks\r\nIf a particular sanctions regime encompasses enough hash power, then sanctions-enforcing miners can safely orphan blocks containing sanctioned transactions.\n\n### Describe any alternatives you've considered\n\nThe exact trie data structure to use for acceptable performance could be evaluated further.\n\n### Please leave any additional context\n\nSeveral miners have implemented their own sanctions enforcement mechanisms, with private or unpublished patches going back to as early as 2014. These implementations are neither efficient not economical to maintain. A standard implementation that can be optionally relied upon by miners in sanctions regimes is becoming a necessity.",
    "user": {
      "login": "derekm",
      "id": 379469,
      "node_id": "MDQ6VXNlcjM3OTQ2OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/379469?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/derekm",
      "html_url": "https://github.com/derekm",
      "followers_url": "https://api.github.com/users/derekm/followers",
      "following_url": "https://api.github.com/users/derekm/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/derekm/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/derekm/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/derekm/subscriptions",
      "organizations_url": "https://api.github.com/users/derekm/orgs",
      "repos_url": "https://api.github.com/users/derekm/repos",
      "events_url": "https://api.github.com/users/derekm/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/derekm/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 64583,
        "node_id": "MDU6TGFiZWw2NDU4Mw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature",
        "name": "Feature",
        "color": "7cf575",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 1,
    "created_at": "2024-02-09T15:57:16Z",
    "updated_at": "2024-02-09T16:55:49Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 11759747593,
      "node_id": "LE_lADOABII585-zdgFzwAAAAK874IJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11759747593",
      "actor": {
        "login": "derekm",
        "id": 379469,
        "node_id": "MDQ6VXNlcjM3OTQ2OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/379469?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/derekm",
        "html_url": "https://github.com/derekm",
        "followers_url": "https://api.github.com/users/derekm/followers",
        "following_url": "https://api.github.com/users/derekm/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/derekm/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/derekm/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/derekm/subscriptions",
        "organizations_url": "https://api.github.com/users/derekm/orgs",
        "repos_url": "https://api.github.com/users/derekm/repos",
        "events_url": "https://api.github.com/users/derekm/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/derekm/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-09T15:57:16Z",
      "label": {
        "name": "Feature",
        "color": "7cf575"
      }
    },
    {
      "event": "mentioned",
      "id": 11759747718,
      "node_id": "MEE_lADOABII585-zdgFzwAAAAK874KG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11759747718",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-09T15:57:17Z"
    },
    {
      "event": "subscribed",
      "id": 11759747746,
      "node_id": "SE_lADOABII585-zdgFzwAAAAK874Ki",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11759747746",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-09T15:57:17Z"
    },
    {
      "event": "commented",
      "id": 1936268247,
      "node_id": "IC_kwDOABII585zaRvX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1936268247",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-09T16:55:47Z",
      "updated_at": "2024-02-09T16:55:47Z",
      "author_association": "CONTRIBUTOR",
      "body": "You are free to add this feature to your own fork of this open source software, but barring unforeseen circumstances, it won't achieve consensus and be merged in this project. Like your previous issue https://github.com/bitcoin/bitcoin/issues/29137, this will probably be closed as not planned.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29416#issuecomment-1936268247",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29416"
    }
  ]
}