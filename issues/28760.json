{
  "type": "issue",
  "issue": {
    "id": 1970392266,
    "node_id": "I_kwDOABII5851cczK",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28760",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28760/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28760/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28760/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/28760",
    "number": 28760,
    "state": "open",
    "state_reason": null,
    "title": "Evicting and filling attack for linking multiple network addresses",
    "body": "I've [discovered a paper](https://cybersecurity.springeropen.com/articles/10.1186/s42400-023-00182-9) published earlier this month. I haven't found any discussion in the repo, so I will summarize the relevant parts here and share my thoughts.\r\n\r\nLet's say we have a node that operates both over ipv4 and TOR. We don't want an observer to link these two addresses to the same node. For example, ADDR caching (#18991) was implemented for this reason.\r\n\r\nThe paper suggests the following attack:\r\n1. Fill all (115?) victim's inbound slots in `networkA.`\r\n2. Make sure these connections are candidates for eviction (higher latency, etc.).\r\n3. Make connection to the presumably-victim's node in `networkB`\r\n4. Observe whether `networkA` connections from (1) are dropped as you add connections in networkB.\r\n\r\nI haven't verified the experiments, but even understanding the attack assures me the problem exists. Authors claim to reach high precision at a very low cost (optimized by inspecting`VERSION` data and block relay data).\r\n\r\nThey suggest the following countermeasures:\r\n1. Have separate connection pools (for the sake of eviction) for each network (say TOR and ipv4).\r\n2. Make eviction unpredictable (e.g. after a random delay)",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": false,
    "comments": 1,
    "created_at": "2023-10-31T12:45:51Z",
    "updated_at": "2023-10-31T12:48:28Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 1787154709,
      "node_id": "IC_kwDOABII585qhdEV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1787154709",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-31T12:48:28Z",
      "updated_at": "2023-10-31T12:48:28Z",
      "author_association": "MEMBER",
      "body": "Recently, someone at the meetup told me that other projects usually consider this a lost cause. Apparently, it's easier to maintain two separate nodes and connect them if needed. This is probably not the case for Bitcoin, where the difference between *run one multi-homed node* and *run two single-homed nodes* is substantial enough for a regular user, so we better facilitate it (at least continue implementing basic privacy improvements).\r\n\r\nAt the same time, things like #27509 hopefully reduce the node mapping risks w.r.t. transaction relay privacy.\r\n\r\nI intend to think more about adequate solutions to this issue and suggest a PR.",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/28760#issuecomment-1787154709",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28760"
    }
  ]
}