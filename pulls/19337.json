{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337",
    "id": 437414567,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDM3NDE0NTY3",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19337",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/19337.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/19337.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
    "number": 19337,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "sync: detect double lock from the same thread",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Double lock of the same (non-recursive) mutex from the same thread would produce an undefined behavior. Detect this from `DEBUG_LOCKORDER` and react similarly to the deadlock detection.\r\n\r\nThis came up during discussion in another, related PR: https://github.com/bitcoin/bitcoin/pull/19238#discussion_r442394521.",
    "labels": [
      {
        "id": 241832923,
        "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
        "name": "Utils/log/libs",
        "description": "",
        "color": "5319e7",
        "default": false
      }
    ],
    "active_lock_reason": "resolved",
    "created_at": "2020-06-20T13:49:46Z",
    "updated_at": "2022-08-16T17:03:21Z",
    "closed_at": "2020-11-25T16:02:55Z",
    "mergeable_state": "unknown",
    "merged_at": "2020-11-25T16:02:55Z",
    "merge_commit_sha": "50091592dd875a1c94030dbed74112b003732d68",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "vasild:detect_double_lock",
      "ref": "detect_double_lock",
      "sha": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 120608826,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMjA2MDg4MjY=",
        "name": "bitcoin",
        "full_name": "vasild/bitcoin",
        "owner": {
          "login": "vasild",
          "id": 266751,
          "node_id": "MDQ6VXNlcjI2Njc1MQ==",
          "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/vasild",
          "html_url": "https://github.com/vasild",
          "followers_url": "https://api.github.com/users/vasild/followers",
          "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
          "organizations_url": "https://api.github.com/users/vasild/orgs",
          "repos_url": "https://api.github.com/users/vasild/repos",
          "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/vasild/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/vasild/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/vasild/bitcoin",
        "archive_url": "https://api.github.com/repos/vasild/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/vasild/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/vasild/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/vasild/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/vasild/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/vasild/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/vasild/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/vasild/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/vasild/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/vasild/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/vasild/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/vasild/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/vasild/bitcoin/events",
        "forks_url": "https://api.github.com/repos/vasild/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/vasild/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/vasild/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/vasild/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/vasild/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/vasild/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/vasild/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/vasild/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/vasild/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/vasild/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/vasild/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/vasild/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/vasild/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/vasild/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/vasild/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/vasild/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:vasild/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/vasild/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/vasild/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/vasild/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/vasild/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/vasild/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/vasild/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/vasild/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/vasild/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/vasild/bitcoin/hooks",
        "svn_url": "https://github.com/vasild/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 3,
        "watchers_count": 3,
        "size": 214063,
        "default_branch": "master",
        "open_issues_count": 2,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-08-02T12:37:14Z",
        "created_at": "2018-02-07T11:52:47Z",
        "updated_at": "2023-01-31T16:56:52Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "6d5a9fec2d576bdb17ff612e421a8c94dc362fbe",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35476,
        "stargazers_count": 70608,
        "watchers_count": 70608,
        "size": 236222,
        "default_branch": "master",
        "open_issues_count": 672,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-08-02T20:20:41Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-08-02T18:21:18Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 112,
    "deletions": 11,
    "changed_files": 3,
    "commits": 2,
    "review_comments": 32,
    "comments": 21
  },
  "events": [
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-20T13:52:56Z",
      "updated_at": "2020-06-20T13:52:56Z",
      "source": {
        "issue": {
          "id": 636353369,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDMyNTQxMzQz",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19238",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19238/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19238/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19238/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/19238",
          "number": 19238,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Make CAddrMan::cs non-recursive",
          "body": "This PR replaces `RecursiveMutex CAddrMan::cs` with `Mutex CAddrMan::cs`.\r\n\r\nAll of the related code branches are covered by appropriate lock assertions to insure that the mutex locking policy has not been changed by accident.\r\n\r\nRelated to #19303.\r\n\r\nBased on #22025, and first three commits belong to it.",
          "user": {
            "login": "hebasto",
            "id": 32963518,
            "node_id": "MDQ6VXNlcjMyOTYzNTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hebasto",
            "html_url": "https://github.com/hebasto",
            "followers_url": "https://api.github.com/users/hebasto/followers",
            "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
            "organizations_url": "https://api.github.com/users/hebasto/orgs",
            "repos_url": "https://api.github.com/users/hebasto/repos",
            "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/hebasto/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 28,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19238",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/19238",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/19238.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/19238.patch"
          },
          "closed_at": "2021-06-14T14:43:02Z",
          "created_at": "2020-06-10T15:39:51Z",
          "updated_at": "2022-08-16T17:24:15Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 646998291,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY0Njk5ODI5MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/646998291",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-20T13:54:04Z",
      "updated_at": "2020-06-20T13:54:04Z",
      "author_association": "MEMBER",
      "body": "Concept ACK.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-646998291",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "reviewed",
      "id": 434429994,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NDI5OTk0",
      "url": null,
      "actor": null,
      "commit_id": "401d3b759e14a96332a033485257d2e993c2b944",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#pullrequestreview-434429994",
      "submitted_at": "2020-06-20T13:54:54Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
    },
    {
      "event": "labeled",
      "id": 3464715766,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDM0NjQ3MTU3NjY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3464715766",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-20T13:55:11Z",
      "label": {
        "name": "Refactoring",
        "color": "E6F6D6"
      }
    },
    {
      "event": "unlabeled",
      "id": 3464716014,
      "node_id": "MDE0OlVubGFiZWxlZEV2ZW50MzQ2NDcxNjAxNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3464716014",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-20T13:55:20Z",
      "label": {
        "name": "Refactoring",
        "color": "E6F6D6"
      }
    },
    {
      "event": "labeled",
      "id": 3464716015,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDM0NjQ3MTYwMTU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3464716015",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-20T13:55:20Z",
      "label": {
        "name": "Utils/log/libs",
        "color": "5319e7"
      }
    },
    {
      "event": "commented",
      "id": 647005655,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzAwNTY1NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647005655",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-20T14:53:23Z",
      "updated_at": "2020-06-20T14:53:23Z",
      "author_association": "MEMBER",
      "body": "Travis error:\r\n- https://travis-ci.org/github/bitcoin/bitcoin/jobs/700351407#L4430",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-647005655",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "reviewed",
      "id": 434434405,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NDM0NDA1",
      "url": null,
      "actor": null,
      "commit_id": "401d3b759e14a96332a033485257d2e993c2b944",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Tested 401d3b759e14a96332a033485257d2e993c2b944 with the following diff:\r\n```diff\r\n--- a/src/addrman.h\r\n+++ b/src/addrman.h\r\n@@ -178,7 +178,7 @@ class CAddrMan\r\n friend class CAddrManTest;\r\n protected:\r\n     //! critical section to protect the inner data structures\r\n-    mutable RecursiveMutex cs;\r\n+    mutable Mutex cs;\r\n \r\n private:\r\n     //! last used nId\r\n```\r\n```\r\n$ ./src/qt/bitcoin-qt -regtest\r\nAssertion failed: detected double lock at sync.cpp:153, details in debug log.\r\nAborted (core dumped)\r\n```\r\nNice!\r\n\r\nSome non-blocking nits:\r\n- could place boost headers into a separate group\r\n- in commit 401d3b759e14a96332a033485257d2e993c2b944 message \"... would produce an undefined behavior\" -- mind rewording \"would\" -> \"is\"\r\n- could use unnamed namespace instead of `static`",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#pullrequestreview-434434405",
      "submitted_at": "2020-06-20T15:08:14Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
    },
    {
      "event": "commented",
      "id": 647010420,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzAxMDQyMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647010420",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-20T15:33:40Z",
      "updated_at": "2020-06-20T15:33:40Z",
      "author_association": "MEMBER",
      "body": "> Travis error:\r\n> \r\n>  - https://travis-ci.org/github/bitcoin/bitcoin/jobs/700351407#L4430\r\n\r\nIt is reliably reproducible locally.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-647010420",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "commented",
      "id": 647012158,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzAxMjE1OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647012158",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-20T15:48:57Z",
      "updated_at": "2020-06-20T15:58:30Z",
      "author_association": "MEMBER",
      "body": "> > Travis error:\r\n> > \r\n> > * https://travis-ci.org/github/bitcoin/bitcoin/jobs/700351407#L4430\r\n> \r\n> It is reliably reproducible locally.\r\n\r\n@vasild \r\n~idk exactly why but~ moving the `potential_deadlock_detected` test case to the end fixes the problem.\r\n\r\nUPDATE: at the end of the `potential_deadlock_detected` test case the lock stack is not empty.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-647012158",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "mentioned",
      "id": 3464799526,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzQ2NDc5OTUyNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3464799526",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-20T15:48:57Z"
    },
    {
      "event": "subscribed",
      "id": 3464799528,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM0NjQ3OTk1Mjg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3464799528",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-20T15:48:57Z"
    },
    {
      "event": "commented",
      "id": 647042058,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzA0MjA1OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647042058",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-20T20:27:07Z",
      "updated_at": "2020-06-20T20:27:07Z",
      "author_association": "MEMBER",
      "body": "> Travis error:\r\n> \r\n>     * https://travis-ci.org/github/bitcoin/bitcoin/jobs/700351407#L4430\r\n\r\nFixed in #19340.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-647042058",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-20T20:32:46Z",
      "updated_at": "2020-06-20T20:32:46Z",
      "source": {
        "issue": {
          "id": 642440475,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDM3NDU2ODUz",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19340",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19340/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19340/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19340/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/19340",
          "number": 19340,
          "state": "closed",
          "state_reason": null,
          "title": "Preserve the `LockData` initial state if \"potential deadlock detected\" exception thrown",
          "body": "On master (e3fa3c7d671e34038a262bb2db16b30bee82153d) if the `push_lock()` throws the \"potential deadlock detected\" exception (via the `potential_deadlock_detected()` call), the `LockData` instance internal state differs from one when the `push_lock()` was called. This non-well behaviour makes (at least) testing brittle.\r\n\r\nThis PR preserves the `LockData` instance initial state if `push_lock()` throws an exception, and improves the `sync_tests` unit test.",
          "user": {
            "login": "hebasto",
            "id": 32963518,
            "node_id": "MDQ6VXNlcjMyOTYzNTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hebasto",
            "html_url": "https://github.com/hebasto",
            "followers_url": "https://api.github.com/users/hebasto/followers",
            "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
            "organizations_url": "https://api.github.com/users/hebasto/orgs",
            "repos_url": "https://api.github.com/users/hebasto/repos",
            "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/hebasto/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 9,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19340",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/19340",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/19340.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/19340.patch"
          },
          "closed_at": "2020-08-04T15:01:38Z",
          "created_at": "2020-06-20T20:26:35Z",
          "updated_at": "2022-02-15T10:34:31Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 647050462,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzA1MDQ2Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647050462",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-20T22:06:07Z",
      "updated_at": "2020-11-15T02:31:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19983 (Drop some TSan suppressions by hebasto)\n* #19982 (test: Fix inconsistent lock order in wallet_tests/CreateWalletFromFile by hebasto)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-647050462",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "commented",
      "id": 647164552,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzE2NDU1Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647164552",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-21T18:32:49Z",
      "updated_at": "2020-06-21T18:32:49Z",
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-647164552",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "commented",
      "id": 647384558,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzM4NDU1OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647384558",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-22T09:00:36Z",
      "updated_at": "2020-06-22T09:00:36Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nNice!",
      "user": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-647384558",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3467615670,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzQ2NzYxNTY3MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3467615670",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-22T10:11:52Z"
    },
    {
      "event": "commented",
      "id": 647424861,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzQyNDg2MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647424861",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-22T10:17:20Z",
      "updated_at": "2020-06-22T10:17:20Z",
      "author_association": "CONTRIBUTOR",
      "body": ">     * could place boost headers into a separate group\r\n\r\nDone.\r\n \r\n>     * in commit [401d3b7](https://github.com/bitcoin/bitcoin/commit/401d3b759e14a96332a033485257d2e993c2b944) message \"... would produce an undefined behavior\" -- mind rewording \"would\" -> \"is\"\r\n\r\nDone.\r\n \r\n>     * could use unnamed namespace instead of `static`\r\n\r\nThe rest of the functions in the file use `static`, so for consistency I also used `static` in the newly introduced function. Maybe replace all `static` with an unnamed namespace in `sync.cpp`? If yes, then that would go as a separate commit, or maybe even a separate PR.\r\n\r\nReviewers: this PR exposed an existent deficiency which is fixed in https://github.com/bitcoin/bitcoin/pull/19340.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-647424861",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "reviewed",
      "id": 434792962,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM0NzkyOTYy",
      "url": null,
      "actor": null,
      "commit_id": "d32d85590e695fbe3acab0ce9a5525572a9bfa77",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK d32d85590e695fbe3acab0ce9a5525572a9bfa77\r\n\r\nBut #19340 should be considering for reviewing before this PR merging.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#pullrequestreview-434792962",
      "submitted_at": "2020-06-22T10:22:19Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
    },
    {
      "event": "convert_to_draft",
      "id": 3467799981,
      "node_id": "MDE5OkNvbnZlcnRUb0RyYWZ0RXZlbnQzNDY3Nzk5OTgx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3467799981",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-22T11:02:13Z"
    },
    {
      "event": "commented",
      "id": 647446864,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY0NzQ0Njg2NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647446864",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-22T11:04:25Z",
      "updated_at": "2020-06-22T11:04:25Z",
      "author_association": "CONTRIBUTOR",
      "body": "I converted this PR to \"draft\" so that it does not get merged accidentally. CI tests passed this time! I guess the order in which the tests are executed matters. https://github.com/bitcoin/bitcoin/pull/19340 will fix that and should be merged before this PR.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-647446864",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-06-22T18:57:24Z",
      "updated_at": "2020-06-22T18:57:24Z",
      "source": {
        "issue": {
          "id": 643186871,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDM4MDM0Nzk1",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19353",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19353/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19353/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19353/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/19353",
          "number": 19353,
          "state": "closed",
          "state_reason": null,
          "title": "Fix mistakenly swapped \"previous\" and \"current\" lock orders",
          "body": "In master (8ef15e8a86038225afef2487ca23abc10ca5dffa) the \"previous\" and \"current\" lock orders are mistakenly swapped.\r\n\r\nThis PR:\r\n- fixes printed lock orders\r\n- improves the `sync_tests` unit test\r\n- makes the \"detected inconsistent lock order\" error message pointing to the lock location rather `tfm::format()` location.\r\n\r\nDebugger output example with this PR (with modified code, of course):\r\n```\r\n2020-06-22T15:46:56Z [msghand] POTENTIAL DEADLOCK DETECTED\r\n2020-06-22T15:46:56Z [msghand] Previous lock order was:\r\n2020-06-22T15:46:56Z [msghand]  (2) 'cs_main' in net_processing.cpp:2545 (in thread 'msghand')\r\n2020-06-22T15:46:56Z [msghand]  (1) 'g_cs_orphans' in net_processing.cpp:1400 (in thread 'msghand')\r\n2020-06-22T15:46:56Z [msghand] Current lock order is:\r\n2020-06-22T15:46:56Z [msghand]  (1) 'g_cs_orphans' in net_processing.cpp:2816 (in thread 'msghand')\r\n2020-06-22T15:46:56Z [msghand]  (2) 'cs_main' in net_processing.cpp:2816 (in thread 'msghand')\r\nAssertion failed: detected inconsistent lock order for 'cs_main' in net_processing.cpp:2816 (in thread 'msghand'), details in debug log.\r\nProcess 131393 stopped\r\n* thread #15, name = 'b-msghand', stop reason = signal SIGABRT\r\n    frame #0: 0x00007ffff775c18b libc.so.6`__GI_raise(sig=2) at raise.c:51:1\r\n(lldb) bt\r\n* thread #15, name = 'b-msghand', stop reason = signal SIGABRT\r\n  * frame #0: 0x00007ffff775c18b libc.so.6`__GI_raise(sig=2) at raise.c:51:1\r\n    frame #1: 0x00007ffff773b859 libc.so.6`__GI_abort at abort.c:79:7\r\n    frame #2: 0x0000555555e5b196 bitcoind`(anonymous namespace)::potential_deadlock_detected(mismatch=0x00007fff99ff6f30, s1=size=2, s2=size=2, lock_location=0x00007fff99ff7010) at sync.cpp:134:9\r\n    frame #3: 0x0000555555e5a1b1 bitcoind`(anonymous namespace)::push_lock(c=0x0000555556379220, locklocation=0x00007fff99ff7010) at sync.cpp:158:13\r\n    frame #4: 0x0000555555e59e8a bitcoind`EnterCritical(pszName=\"cs_main\", pszFile=\"net_processing.cpp\", nLine=2816, cs=0x0000555556379220, fTry=false) at sync.cpp:177:5\r\n    frame #5: 0x00005555555b0500 bitcoind`UniqueLock<AnnotatedMixin<std::recursive_mutex>, std::unique_lock<std::recursive_mutex> >::Enter(this=0x00007fff99ff8c20, pszName=\"cs_main\", pszFile=\"net_processing.cpp\", nLine=2816) at sync.h:134:9\r\n    frame #6: 0x00005555555b017f bitcoind`UniqueLock<AnnotatedMixin<std::recursive_mutex>, std::unique_lock<std::recursive_mutex> >::UniqueLock(this=0x00007fff99ff8c20, mutexIn=0x0000555556379220, pszName=\"cs_main\", pszFile=\"net_processing.cpp\", nLine=2816, fTry=false) at sync.h:160:13\r\n    frame #7: 0x00005555556aa57e bitcoind`ProcessMessage(pfrom=0x00007fff90001180, msg_type=error: summary string parsing error, vRecv=0x00007fff9c005ac0, nTimeReceived=1592840815980751, chainparams=0x00005555564b7110, chainman=0x0000555556380880, mempool=0x0000555556380ae0, connman=0x000055555657aa20, banman=0x00005555565167b0, interruptMsgProc=0x00005555565cae90) at net_processing.cpp:2816:9\r\n```",
          "user": {
            "login": "hebasto",
            "id": 32963518,
            "node_id": "MDQ6VXNlcjMyOTYzNTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hebasto",
            "html_url": "https://github.com/hebasto",
            "followers_url": "https://api.github.com/users/hebasto/followers",
            "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
            "organizations_url": "https://api.github.com/users/hebasto/orgs",
            "repos_url": "https://api.github.com/users/hebasto/repos",
            "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/hebasto/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19353",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/19353",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/19353.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/19353.patch"
          },
          "closed_at": "2020-07-15T18:54:29Z",
          "created_at": "2020-06-22T15:55:20Z",
          "updated_at": "2022-02-15T10:33:55Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 435246234,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDM1MjQ2MjM0",
      "url": null,
      "actor": null,
      "commit_id": "d32d85590e695fbe3acab0ce9a5525572a9bfa77",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK, change LGTM.",
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#pullrequestreview-435246234",
      "submitted_at": "2020-06-22T20:23:46Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-07-28T06:29:00Z",
      "updated_at": "2020-07-28T06:29:00Z",
      "source": {
        "issue": {
          "id": 660925962,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUyNjQ0NzA4",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19556",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19556/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19556/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19556/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/19556",
          "number": 19556,
          "state": "closed",
          "state_reason": null,
          "title": "Remove mempool global",
          "body": "This refactor unlocks some nice potential features, such as, but not limited to:\r\n* Removing the fee estimates global (would avoid slightly fragile workarounds such as #18766)\r\n* Making the mempool optional for a \"blocksonly\" operation mode\r\n\r\nEven absent those features, the new code without the global should be easier to maintain, read and write tests for.",
          "user": {
            "login": "MarcoFalke",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/MarcoFalke",
            "html_url": "https://github.com/MarcoFalke",
            "followers_url": "https://api.github.com/users/MarcoFalke/followers",
            "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
            "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
            "repos_url": "https://api.github.com/users/MarcoFalke/repos",
            "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 16,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19556",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/19556",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/19556.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/19556.patch"
          },
          "closed_at": "2020-09-07T07:52:23Z",
          "created_at": "2020-07-19T16:20:05Z",
          "updated_at": "2022-02-15T10:35:51Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-07-30T03:48:54Z",
      "updated_at": "2020-07-30T03:48:54Z",
      "source": {
        "issue": {
          "id": 606814450,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDA4OTQwNDUy",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18766",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18766/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18766/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18766/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/18766",
          "number": 18766,
          "state": "closed",
          "state_reason": null,
          "title": "Disable fee estimation in blocksonly mode (by removing the fee estimates global)",
          "body": "If the `blocksonly` mode is turned on after running with transaction\r\nrelay enabled for a while, the fee estimation will serve outdated data\r\nto both the internal wallet and to external applications that might be\r\nfeerate-sensitive and make use of `estimatesmartfee` (for example a\r\nLightning Network node).\r\n\r\nThis has already caused issues (for example https://github.com/bitcoin/bitcoin/issues/16840 (C-lightning), or https://github.com/lightningnetwork/lnd/issues/2562 (LND)) and it seems prudent to fail rather than to give inaccurate values.\r\n\r\nThis fixes #16840, and closes #16890 which tried to fix the symptoms (RPC) but not the cause as mentioned by sdaftuar :\r\n> If this is a substantial problem, then I would think we should take action to protect our own wallet users as well (rather than hide the results of what our fee estimation would do!).",
          "user": {
            "login": "darosior",
            "id": 22457751,
            "node_id": "MDQ6VXNlcjIyNDU3NzUx",
            "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/darosior",
            "html_url": "https://github.com/darosior",
            "followers_url": "https://api.github.com/users/darosior/followers",
            "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
            "organizations_url": "https://api.github.com/users/darosior/orgs",
            "repos_url": "https://api.github.com/users/darosior/repos",
            "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/darosior/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 82428251,
              "node_id": "MDU6TGFiZWw4MjQyODI1MQ==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/TX%20fees%20and%20policy",
              "name": "TX fees and policy",
              "color": "5319e7",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 36,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18766",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/18766",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/18766.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/18766.patch"
          },
          "closed_at": "2020-12-07T12:02:02Z",
          "created_at": "2020-04-25T17:13:47Z",
          "updated_at": "2022-08-16T17:02:38Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 668652306,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODY1MjMwNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/668652306",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-04T15:06:35Z",
      "updated_at": "2020-08-04T15:06:35Z",
      "author_association": "MEMBER",
      "body": "@vasild \r\n> I converted this PR to \"draft\" so that it does not get merged accidentally. CI tests passed this time! I guess the order in which the tests are executed matters. #19340 will fix that and should be merged before this PR.\r\n\r\n#19340 is merged :)\r\n",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-668652306",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "mentioned",
      "id": 3620695696,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzYyMDY5NTY5Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3620695696",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-04T15:06:35Z"
    },
    {
      "event": "subscribed",
      "id": 3620695701,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM2MjA2OTU3MDE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3620695701",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-04T15:06:35Z"
    },
    {
      "event": "ready_for_review",
      "id": 3623398051,
      "node_id": "MDE5OlJlYWR5Rm9yUmV2aWV3RXZlbnQzNjIzMzk4MDUx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3623398051",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-05T07:36:12Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0ZGY2NTY3ZTRjYmI0Njc3ZTgwNDhkZTJmODAwODYxMmUxYjg2MGI5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4df6567e4cbb4677e8048de2f8008612e1b860b9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4df6567e4cbb4677e8048de2f8008612e1b860b9",
      "tree": {
        "sha": "b33c0dbe0e968d4157b3fb565408a290d12864f6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b33c0dbe0e968d4157b3fb565408a290d12864f6"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree b33c0dbe0e968d4157b3fb565408a290d12864f6\nparent 0f16212c5931b30f430014caa485de53f9a14920\nauthor Vasil Dimov <vd@FreeBSD.org> 1592592676 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1596613362 +0200\n\nsync: make EnterCritical() & push_lock() type safe\n\nThe functions `EnterCritical()` and `push_lock()` take a pointer to a\nmutex, but that pointer used to be of type `void*` because we use a few\ndifferent types for mutexes. This `void*` argument was not type safe\nbecause somebody could have send a pointer to anything that is not a\nmutex. Furthermore it wouldn't allow to check whether the passed mutex\nis recursive or not.\n\nThus, change the functions to templated ones so that we can implement\nstricter checks for non-recursive mutexes. This also simplifies the\ncallers of `EnterCritical()`.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAl8qYvQACgkQVN8G9ktV\ny79jKh//ZYIb2pzaZvEwKraa3SBy/bKRBZaljg6FaYz6dz+L/EPeHPf4Id96Gjqn\nXXspAyQutW/2aeb1eNuo6226y2qAImE0VOBF8TyLoqa6kOpCIgS4oXCGj7IdL7a1\npLfL6lChl4fFkMx6gI9nxDWEpfPDN2j18XVHAIyPOiVcTtB3gZ97XktET8z0oMoa\nt8GR1nm67l+RnGzgiXvQjk9oLWTlYDo1GVBa5BUqPGXC13NEaVhlBosJVwrYytK/\nh9fFGF0XQ9RduJTFVP6d+WL7pNGKiEpg7I+P7lhsMxu/I7kse0lXxHBIPdHI+BHf\nW2QiSusxyzTJ8T0mX0e4+//ECsW8a3NYUsG/SxdYDvUwMHwL7ZHqKup6ZhDjFDVc\nVsDpwAwQXfXlaSz9anVRBSOXxRTKajm68/1cByp1taPRGtHgmTRYXQ0cFI5F0P3w\nIC7fMtm3pRIKhGKB/Ms3vLkaIMYrjHdRd/R0/pw3NnPiKIUBfcJ9SH1zemb+nXUz\n1G9aiHWm3wbnKDxuEKyfeQW/r3EveWb4RgYGFz796ShBvfcHBIBbDHSNv4307IhS\nWgm/CxAcsuZwSMdFmEitkTaUAZmKhwiG/6CpPlA40W+Bg52sYSbbCd64pZzF6qq/\nJyXFgNFKm2FlNDZ8R6YrgFCwWLEOkxUFKAwOH7eGGoFHdguNZyBOsj1TlRLlLrmJ\nvS/fypQhBPPur/6j1kM4/gx1+sFgO5rq+2rkE55fzUeKr76lZYQSVCajV+rbZCof\nQUPwA81RUv2Bq379ZvFxfgAkA/hZw60lhMoevsx7/Lvj6Gct0k7mo/CmjYUrAfg4\ni4s4LbFcDGU15R+23DqlvRK5tOJfXXmtIqE/2HY7x8TgazH+MU/6zayy3R85td/W\nErATUE52YLFBCMJOgX3s6etZo/CSD8cD7ju5kKVJ19oaVvi+IRd4Wv+G+3L1kLrY\n3PCOSy6gxz3lJ4REIaavKUM9SZjiXcciZOsVM7E1trk/VaAAzFAJKthyr6bgG8vg\n9mYYAkWtE9J1iPLMJR+HI1DC4581YmL6Gk6slrJ/rMn+f6UGlSjafrZYxmcMOPiw\n8CS+ZxU9K0+gmb1asnGLlc8GQLtzTSq4379IVC93vY6zKjvRmfhXQzaJBQ5bTLmk\nve71lPO7QM8u1lkkcJNVy2+WBgplT4xaCFOL7pu6GQGzWVQwzugWK4K3TZ/uIy2O\nNOiZTsJH1ugDQjcuuvMaGnoQ8QtcuSuGLR3LQRPxqcmT3wN03RoCjlDtavGLoP1N\nqHzzyt4RKRRskPsqeZT/IP0Gq8dRyOdFHAGJXVre4ZhQELGvZ0h8qbP40Pk1Om4V\njoU/D2nLjHQGj7VRD9WadnRb2vreCA==\n=d6lL\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0f16212c5931b30f430014caa485de53f9a14920",
          "sha": "0f16212c5931b30f430014caa485de53f9a14920",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0f16212c5931b30f430014caa485de53f9a14920"
        }
      ],
      "message": "sync: make EnterCritical() & push_lock() type safe\n\nThe functions `EnterCritical()` and `push_lock()` take a pointer to a\nmutex, but that pointer used to be of type `void*` because we use a few\ndifferent types for mutexes. This `void*` argument was not type safe\nbecause somebody could have send a pointer to anything that is not a\nmutex. Furthermore it wouldn't allow to check whether the passed mutex\nis recursive or not.\n\nThus, change the functions to templated ones so that we can implement\nstricter checks for non-recursive mutexes. This also simplifies the\ncallers of `EnterCritical()`.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2020-08-05T07:42:42Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2020-06-19T18:51:16Z"
      },
      "sha": "4df6567e4cbb4677e8048de2f8008612e1b860b9"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3623445496,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzYyMzQ0NTQ5Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3623445496",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-05T07:49:40Z"
    },
    {
      "event": "commented",
      "id": 669040717,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY2OTA0MDcxNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/669040717",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-05T07:51:24Z",
      "updated_at": "2020-08-05T07:51:24Z",
      "author_association": "CONTRIBUTOR",
      "body": "Reopened this PR now that #19340 is merged and rebased to resolve a conflict.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-669040717",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "reviewed",
      "id": 461435804,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxNDM1ODA0",
      "url": null,
      "actor": null,
      "commit_id": "c269e0a22423294b81c7a60862bc20f6ccf80f1c",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK c269e0a22423294b81c7a60862bc20f6ccf80f1c, tested on Linux Mint 20 (x86_64).",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#pullrequestreview-461435804",
      "submitted_at": "2020-08-05T08:09:51Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3623565862,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzYyMzU2NTg2Mg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3623565862",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-05T08:21:21Z"
    },
    {
      "event": "reviewed",
      "id": 461444766,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxNDQ0NzY2",
      "url": null,
      "actor": null,
      "commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "re-ACK b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#pullrequestreview-461444766",
      "submitted_at": "2020-08-05T08:22:12Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
    },
    {
      "event": "reviewed",
      "id": 461451261,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxNDUxMjYx",
      "url": null,
      "actor": null,
      "commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK, only style and test nits. Feel free to ingore.",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#pullrequestreview-461451261",
      "submitted_at": "2020-08-05T08:41:58Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
    },
    {
      "event": "reviewed",
      "id": 461483926,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDYxNDgzOTI2",
      "url": null,
      "actor": null,
      "commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#pullrequestreview-461483926",
      "submitted_at": "2020-08-05T09:26:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
    },
    {
      "event": "commented",
      "id": 669179504,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY2OTE3OTUwNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/669179504",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-05T13:01:36Z",
      "updated_at": "2020-08-05T13:01:36Z",
      "author_association": "CONTRIBUTOR",
      "body": "Addressed some review suggestions.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-669179504",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3624562996,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzYyNDU2Mjk5Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3624562996",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-05T13:01:54Z"
    },
    {
      "event": "commented",
      "id": 669211924,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY2OTIxMTkyNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/669211924",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-05T14:02:29Z",
      "updated_at": "2020-08-05T14:02:29Z",
      "author_association": "MEMBER",
      "body": "<details><summary>a diff</summary>\r\n\r\n\r\n```diff\r\ndiff --git a/src/sync.cpp b/src/sync.cpp\r\nindex d020b4e334..55cc47191f 100644\r\n--- a/src/sync.cpp\r\n+++ b/src/sync.cpp\r\n@@ -220,9 +220,6 @@ void EnterCritical(const char* pszName, const char* pszFile, int nLine, MutexTyp\r\n }\r\n template void EnterCritical(const char*, const char*, int, Mutex*, bool);\r\n template void EnterCritical(const char*, const char*, int, RecursiveMutex*, bool);\r\n-template void EnterCritical(const char*, const char*, int, std::mutex*, bool);\r\n-template void EnterCritical(const char*, const char*, int, std::recursive_mutex*, bool);\r\n-template void EnterCritical(const char*, const char*, int, boost::mutex*, bool);\r\n \r\n void CheckLastCritical(void* cs, std::string& lockname, const char* guardname, const char* file, int line)\r\n {\r\ndiff --git a/src/test/sync_tests.cpp b/src/test/sync_tests.cpp\r\nindex 2ecc78bbed..9a3c276ed2 100644\r\n--- a/src/test/sync_tests.cpp\r\n+++ b/src/test/sync_tests.cpp\r\n@@ -33,37 +33,44 @@ void TestPotentialDeadLockDetected(MutexType& mutex1, MutexType& mutex2)\r\n     #endif\r\n }\r\n \r\n-#ifdef DEBUG_LOCKORDER\r\n template <typename MutexType>\r\n void TestDoubleLock2(MutexType& m)\r\n {\r\n-    ENTER_CRITICAL_SECTION(m);\r\n-    LEAVE_CRITICAL_SECTION(m);\r\n+    LOCK(m);\r\n }\r\n \r\n template <typename MutexType>\r\n void TestDoubleLock(bool should_throw)\r\n {\r\n+#ifdef DEBUG_LOCKORDER\r\n     const bool prev = g_debug_lockorder_abort;\r\n     g_debug_lockorder_abort = false;\r\n+#endif /* DEBUG_LOCKORDER */\r\n \r\n     MutexType m;\r\n-    ENTER_CRITICAL_SECTION(m);\r\n-    if (should_throw) {\r\n-        BOOST_CHECK_EXCEPTION(\r\n-            TestDoubleLock2(m), std::logic_error, [](const std::logic_error& e) {\r\n-                return strcmp(e.what(), \"double lock detected\") == 0;\r\n-            });\r\n-    } else {\r\n-        BOOST_CHECK_NO_THROW(TestDoubleLock2(m));\r\n+    {\r\n+        LOCK(m);\r\n+        if (should_throw) {\r\n+#ifdef DEBUG_LOCKORDER\r\n+            /* Double lock would produce an undefined behavior. Thus, we only do that if\r\n+         * DEBUG_LOCKORDER is activated to detect it. We don't want non-DEBUG_LOCKORDER\r\n+         * build to produce tests that exhibit known undefined behavior. */\r\n+            BOOST_CHECK_EXCEPTION(\r\n+                TestDoubleLock2(m), std::logic_error, [](const std::logic_error& e) {\r\n+                    return strcmp(e.what(), \"double lock detected\") == 0;\r\n+                });\r\n+#endif /* DEBUG_LOCKORDER */\r\n+        } else {\r\n+            BOOST_CHECK_NO_THROW(TestDoubleLock2(m));\r\n+        }\r\n     }\r\n-    LEAVE_CRITICAL_SECTION(m);\r\n \r\n     BOOST_CHECK(LockStackEmpty());\r\n \r\n+#ifdef DEBUG_LOCKORDER\r\n     g_debug_lockorder_abort = prev;\r\n-}\r\n #endif /* DEBUG_LOCKORDER */\r\n+}\r\n } // namespace\r\n \r\n BOOST_FIXTURE_TEST_SUITE(sync_tests, BasicTestingSetup)\r\n@@ -90,34 +97,14 @@ BOOST_AUTO_TEST_CASE(potential_deadlock_detected)\r\n     #endif\r\n }\r\n \r\n-/* Double lock would produce an undefined behavior. Thus, we only do that if\r\n- * DEBUG_LOCKORDER is activated to detect it. We don't want non-DEBUG_LOCKORDER\r\n- * build to produce tests that exhibit known undefined behavior. */\r\n-#ifdef DEBUG_LOCKORDER\r\n BOOST_AUTO_TEST_CASE(double_lock_mutex)\r\n {\r\n     TestDoubleLock<Mutex>(true /* should throw */);\r\n }\r\n \r\n-BOOST_AUTO_TEST_CASE(double_lock_std_mutex)\r\n-{\r\n-    TestDoubleLock<std::mutex>(true /* should throw */);\r\n-}\r\n-\r\n-BOOST_AUTO_TEST_CASE(double_lock_boost_mutex)\r\n-{\r\n-    TestDoubleLock<boost::mutex>(true /* should throw */);\r\n-}\r\n-\r\n BOOST_AUTO_TEST_CASE(double_lock_recursive_mutex)\r\n {\r\n     TestDoubleLock<RecursiveMutex>(false /* should not throw */);\r\n }\r\n \r\n-BOOST_AUTO_TEST_CASE(double_lock_std_recursive_mutex)\r\n-{\r\n-    TestDoubleLock<std::recursive_mutex>(false /* should not throw */);\r\n-}\r\n-#endif /* DEBUG_LOCKORDER */\r\n-\r\n BOOST_AUTO_TEST_SUITE_END()\r\n```\r\n\r\n</details>",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-669211924",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "commented",
      "id": 669893857,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY2OTg5Mzg1Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/669893857",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-06T12:21:26Z",
      "updated_at": "2020-08-06T12:21:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "@MarcoFalke the above patch does not compile for me (neither with clang 11 nor with gcc 10) with an error like\r\n\r\n```\r\nld: error: undefined symbol: void EnterCritical<std::mutex>(char const*, char const*, int, std::mutex*, bool)\r\n```\r\n\r\nI think you should also get it for `./configure --enable-debug` when the explicit instantiation of `EnterCritical<std::mutex>()` is removed. Here is how we end up needing that instantiation even though we never use `std::mutex` directly:\r\n\r\n```cpp\r\ntypedef AnnotatedMixin<std::mutex> Mutex;\r\n\r\ntemplate <typename PARENT>\r\nclass LOCKABLE AnnotatedMixin : public PARENT\r\n{\r\n...\r\n    using UniqueLock = std::unique_lock<PARENT>;\r\n```\r\n\r\nSo when one defines `Mutex m;` this ends up being `AnnotatedMixin<std::mutex> m;` and `AnnotatedMixin<std::mutex>::UniqueLock` is `std::unique_lock<std::mutex>`.\r\n\r\n`LOCK(m)` expands to\r\n`DebugLock<AnnotatedMixin<std::mutex>> criticalblock123(m, ...)` which expands to\r\n`UniqueLock<AnnotatedMixin<std::mutex>> criticalblock123(m, ...)` which expands to (with default 2nd template arg):\r\n`UniqueLock<AnnotatedMixin<std::mutex>, AnnotatedMixin<std::mutex>::UniqueLock> criticalblock123(m, ...)` which expands to\r\n`UniqueLock<AnnotatedMixin<std::mutex>, std::unique_lock<std::mutex>> criticalblock123(m, ...)`.\r\n\r\nThen the constructor of the above calls the `Enter()` method which calls\r\n`EnterCritical(name, file, line, Base::mutex())` which expands to\r\n`EnterCritical(name, file, line, std::unique_lock<std::mutex>::mutex())`.\r\nThe `mutex()` method (4th argument) returns a pointer to `std::mutex`.\r\n\r\nThis is how we end up calling `EnterCritical()` with a 4th argument of type pointer to `std::mutex`.\r\n\r\nThus we need the explicit instantiation `template void EnterCritical(const char*, const char*, int, std::mutex*, bool);`. Same applies to `std::recursive_mutex` and `boost::mutex`.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-669893857",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "mentioned",
      "id": 3628779009,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzYyODc3OTAwOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3628779009",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-06T12:21:26Z"
    },
    {
      "event": "subscribed",
      "id": 3628779013,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM2Mjg3NzkwMTM=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3628779013",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-06T12:21:26Z"
    },
    {
      "event": "referenced",
      "id": 3628786838,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDM2Mjg3ODY4Mzg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3628786838",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "2d547b4f7c6d1ea9860601b8543a81f7a972792f",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/2d547b4f7c6d1ea9860601b8543a81f7a972792f",
      "created_at": "2020-08-06T12:23:33Z"
    },
    {
      "event": "commented",
      "id": 669911268,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY2OTkxMTI2OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/669911268",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-06T12:59:37Z",
      "updated_at": "2020-08-06T12:59:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "I pushed the patch to my travis instance and it breaks the build, similarly to what I observe locally: https://travis-ci.org/github/vasild/bitcoin/jobs/715483824#L3800",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-669911268",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "commented",
      "id": 670399401,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY3MDM5OTQwMQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/670399401",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-07T08:29:38Z",
      "updated_at": "2020-08-07T08:29:38Z",
      "author_association": "MEMBER",
      "body": "Obviously I didn't compile with `--enable-debug` (shame!). Please disregard the sync.cpp patch, but the other hunks should compile?",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-670399401",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5NTk3NWRkMDhkOGZkYWFlYWYyOGUwZDA2Yjg2MWNlMjc0OGMxN2I2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "tree": {
        "sha": "c2fb3525064d0a722cad4c27cccdef67f41e4647",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c2fb3525064d0a722cad4c27cccdef67f41e4647"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree c2fb3525064d0a722cad4c27cccdef67f41e4647\nparent 4df6567e4cbb4677e8048de2f8008612e1b860b9\nauthor Vasil Dimov <vd@FreeBSD.org> 1592659915 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1597077788 +0200\n\nsync: detect double lock from the same thread\n\nDouble lock of the same (non-recursive) mutex from the same thread\nis producing an undefined behavior. Detect this from DEBUG_LOCKORDER\nand react similarly to the deadlock detection.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAl8xeSAACgkQVN8G9ktV\ny793Eh//Z3eJYcwNbnmcvfJWI332Xy4P7i0jOE3Iw5TMr6LGZ+ofT1E/tqDSojwP\nFd4X0gG/lweS3YzZTIxRBW2gYkDpbc1bxL0i+67asfVkkPkurQKk7vViqxkhlhwm\ncajJYVJkd0OXvB/zI1twf9l7L91XmEZ82TKPlWHQO9BcudSiSiZVsI44lFM2lvK9\nFds0qW4kxEysyA1I4nlkuugiDC8dy9pmOkD4y3dywAZyvAkrrsHpkO4L7C0U5mCV\npkhyPYoR6D2dQat2lCMs3+QnXk5HfL+QpkrtvgKdXZlt/5SdU6a+DKo92+DBMXUo\nOsIZ8mIUoEvw2zz/w5nfwrllUQWoJJ11q999JSZ6DM3lrkaPseSqOxFTWYegvvPJ\nFsrSD2gBfuBehaJ5f/QYBzA2zoB57OvFjF245X/KuCiVPWK2iEmHo3jEgMG+oabG\n8YKXlpy3Z3qhO1E2PbjwMp9JtI+ghxclZyKfZqfuLZCXPdGzHX5ntHc6MGpqsNOp\ndEY/sTZuMGaRRXMwnA7Ljt5CRZ+CAljXCKQ2YE/Sem/woLWgV+0KK60XMtS9OIRA\nfojVaCnebBOu4YP4FieulzsN4hIvFYSBmW8FcI/V+pFEl0KctyuuVuyrr7fnum1u\nfdkZ93rmjahgv2mTLuDvIegDNhgOqqni7pMfC/26uQpjXqxaESEtgZNcMSl2YDbx\n7yQ7O2toqbYsTTlKPo2+8TK1LY1MEJbiAL/KiMC0eTUGE3lge9YWZVk99sVFPwkJ\njzlHbxio1dHkYPkfurjPVw/28VWFF8F59VnJfNwmNbMNpEb25QiikMytQJRha6mm\nvv8L73G3WX2zfJFaXaIuGoO2zmVU1jpS8FLtNxI9u2UNn5KCvV3shArhyeKqFMf7\nkT3OZbehiBnG/Pp5crs9vPUQVdqTXpkQz23YGAZiOa93OmYOhWqHWuCD6BFUlsgX\nuqyPQ9X6B0+v5f9cNcnZHqaHwcwmuZPxy5JeehsrB8D0HtVnSUwZtWrOI4N/1Xv7\nwfRHRxABrh2Q44oeSnDVb6sXTWnxezelQRp4g4XyRixQJQDS2Jmp77QJ+a1nMwwP\ndyrNcoDdASSGYgkUWppwRWo59Gwkg95OD2JNTaaSk4iLB5OuPFHN5kiJsFFCbMh5\nBxHONXIFuLIcB9/pRkWNaVsSsKJ6PPVlrsSj5tMEcqO2F4uMEL1iqIo38vk+gxw+\n0LBEVy/cqaZNTx4dM4tpOAKnXJUr5SJEZ5/QCNJCwVdKTTLqluYreaJX2xk1rQ0+\nD+BQo/FNV+IIu2jY+tX8iR4jLbplmVvSwE/NgxX6GdNSGwhllbqPCKc+E92gj/yT\nsPvLOYxERnrVDpFQMZWpQ6Bf5I9VIw==\n=+C8Q\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4df6567e4cbb4677e8048de2f8008612e1b860b9",
          "sha": "4df6567e4cbb4677e8048de2f8008612e1b860b9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4df6567e4cbb4677e8048de2f8008612e1b860b9"
        }
      ],
      "message": "sync: detect double lock from the same thread\n\nDouble lock of the same (non-recursive) mutex from the same thread\nis producing an undefined behavior. Detect this from DEBUG_LOCKORDER\nand react similarly to the deadlock detection.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2020-08-10T16:43:08Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2020-06-20T13:31:55Z"
      },
      "sha": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3639608695,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzYzOTYwODY5NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3639608695",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-10T16:43:28Z"
    },
    {
      "event": "commented",
      "id": 671464378,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTQ2NDM3OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671464378",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-10T16:43:31Z",
      "updated_at": "2020-08-10T16:43:31Z",
      "author_association": "CONTRIBUTOR",
      "body": "@MarcoFalke, I looked carefully at the diff [above](https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-669211924) and took some of it but not all. Here are the reasons:\r\n\r\n* Indeed we never do `LOCK()` or `ENTER_CRITICAL_SECTION()` on `std::mutex` or `std::recursive_mutex` directly, so no need to test for that. Thus, I removed the tests `double_lock_std_mutex` and `double_lock_std_recursive_mutex`.\r\n\r\n* However we do [call](https://github.com/bitcoin/bitcoin/blob/fa488f1/src/checkqueue.h#L184) `ENTER_CRITICAL_SECTION()` on `boost::mutex`. So, I left the test `double_lock_boost_mutex`. So, `TestDoubleLock2()` cannot use `LOCK(m)` because it [does not compile](https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465691861).\r\n\r\n* I do not think it makes sense to do these tests for non-`DEBUG_LOCKORDER` build because they will decay to:\r\n  * if `should_throw == true`\r\n  ```cpp\r\n  mutex lock\r\n  if (should_throw) {\r\n      // nothing\r\n  }\r\n  mutex unlock\r\n  ```\r\n\r\n  * if `should_throw == false`\r\n  ```cpp\r\n  recursive mutex lock\r\n  recursive mutex lock\r\n  recursive mutex unlock\r\n  recursive mutex unlock\r\n  ```\r\n  (with none of the code from `sync.cpp` exercised)",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-671464378",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "mentioned",
      "id": 3639608894,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzYzOTYwODg5NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3639608894",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-10T16:43:31Z"
    },
    {
      "event": "subscribed",
      "id": 3639608897,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM2Mzk2MDg4OTc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3639608897",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-10T16:43:31Z"
    },
    {
      "event": "reviewed",
      "id": 467963212,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDY3OTYzMjEy",
      "url": null,
      "actor": null,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "re-ACK 95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#pullrequestreview-467963212",
      "submitted_at": "2020-08-15T10:29:45Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
    },
    {
      "event": "commented",
      "id": 674380324,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY3NDM4MDMyNA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/674380324",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-15T10:30:45Z",
      "updated_at": "2020-08-15T10:30:45Z",
      "author_association": "MEMBER",
      "body": "@ajtowns @ryanofsky @practicalswift Mind looking into this?",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-674380324",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "mentioned",
      "id": 3658405390,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzY1ODQwNTM5MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3658405390",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-15T10:30:45Z"
    },
    {
      "event": "subscribed",
      "id": 3658405392,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM2NTg0MDUzOTI=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3658405392",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-15T10:30:45Z"
    },
    {
      "event": "mentioned",
      "id": 3658405393,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzY1ODQwNTM5Mw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3658405393",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-15T10:30:45Z"
    },
    {
      "event": "subscribed",
      "id": 3658405394,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM2NTg0MDUzOTQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3658405394",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-15T10:30:45Z"
    },
    {
      "event": "mentioned",
      "id": 3658405395,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzY1ODQwNTM5NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3658405395",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-15T10:30:45Z"
    },
    {
      "event": "subscribed",
      "id": 3658405396,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM2NTg0MDUzOTY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3658405396",
      "actor": {
        "login": "practicalswift",
        "id": 7826565,
        "node_id": "MDQ6VXNlcjc4MjY1NjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/practicalswift",
        "html_url": "https://github.com/practicalswift",
        "followers_url": "https://api.github.com/users/practicalswift/followers",
        "following_url": "https://api.github.com/users/practicalswift/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/practicalswift/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/practicalswift/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
        "organizations_url": "https://api.github.com/users/practicalswift/orgs",
        "repos_url": "https://api.github.com/users/practicalswift/repos",
        "events_url": "https://api.github.com/users/practicalswift/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/practicalswift/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-15T10:30:45Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-27T16:56:35Z",
      "updated_at": "2020-08-27T16:56:35Z",
      "source": {
        "issue": {
          "id": 678598171,
          "node_id": "MDU6SXNzdWU2Nzg1OTgxNzE=",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19712",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19712/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19712/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19712/events",
          "html_url": "https://github.com/bitcoin/bitcoin/issues/19712",
          "number": 19712,
          "state": "closed",
          "state_reason": "completed",
          "title": "test: Data race detected when running rpc_blockchain.py",
          "body": "https://cirrus-ci.com/task/6068765160898560?command=ci#L5518",
          "user": {
            "login": "hebasto",
            "id": 32963518,
            "node_id": "MDQ6VXNlcjMyOTYzNTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hebasto",
            "html_url": "https://github.com/hebasto",
            "followers_url": "https://api.github.com/users/hebasto/followers",
            "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
            "organizations_url": "https://api.github.com/users/hebasto/orgs",
            "repos_url": "https://api.github.com/users/hebasto/repos",
            "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/hebasto/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 64585,
              "node_id": "MDU6TGFiZWw2NDU4NQ==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug",
              "name": "Bug",
              "color": "FBBAAB",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 2,
          "closed_at": "2020-08-31T01:59:40Z",
          "created_at": "2020-08-13T16:59:13Z",
          "updated_at": "2022-02-15T10:47:20Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-09T16:15:07Z",
      "updated_at": "2020-09-09T16:15:07Z",
      "source": {
        "issue": {
          "id": 692521585,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDc5MTEzNjg4",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19865",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19865/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19865/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19865/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/19865",
          "number": 19865,
          "state": "closed",
          "state_reason": null,
          "title": "scripted-diff: Restore AssertLockHeld after #19668, remove LockAssertion",
          "body": "**This PR is a simple 3-line scripted diff followed by a documentation cleanup.** The scripted diff does three things:\r\n\r\n1. Deletes all existing `AssertLockHeld` calls. Since #19668, `AssertLockHeld` has had an `EXCLUSIVE_LOCKS_REQUIRED` annotation which has guaranteed (though ongoing travis and cirrus CI builds since #19668 was merged) that these `AssertLockHeld` calls are redundant with `EXCLUSIVE_LOCKS_REQUIRED` or `EXCLUSIVE_LOCK_FUNCTION` annotations already present in surrounding code, and specifically that:\r\n\r\n  - There is no way the assert calls can trigger any behavior at runtime.\r\n  - The assert calls provide no new thread safety information to the compiler.\r\n\r\n\r\n2. Reverts `AssertLockHeld` implementation which got changed in #19668 to it's original pre-#19668 state. In #19668, `AssertLockHeld` was changed to have an `EXCLUSIVE_LOCKS_REQUIRED` annotation instead of having an `ASSERT_EXCLUSIVE_LOCK` annotation. As described above, having an `EXCLUSIVE_LOCKS_REQUIRED` annotation on an assert statement is only useful as proof that the assert statement doesn't do anything or convey any new information. By contrast, having an `ASSERT_EXCLUSIVE_LOCK` annotation on an assert statement can be an actually useful way of conveying to the compiler than a specific mutex is locked at a specific place in the code, when the compiler thread safety analysis can't determine that on its own (because of lost type information).\r\n\r\n3. Removes `LockAssertion` class, replacing all current uses with calls to `AssertLockHeld`. Ever since the `LockAssertion` class was first introduced in #14437 (as `LockAnnotation`), it has always been an inferior alternative to `AssertLockHeld` and not had a reason to exist. (#14437 was originally written before #13423 which added ASSERT_EXCLUSIVE_LOCK annotation. It was justified when the code was first written, but no longer necessary by the time it was merged).\r\n\r\n**Motivation for this PR** is to get rid of confusion between different types of lock assertions and only keep one assertion: `AssertLockHeld` which goes back to the implementation it's had since #13423 was merged until #19668 was merged. After this PR, `AssertLockHeld` only needs to be used sparingly to augment compile-time thread safety annotations, which are a superior alternative to runtime checks for guaranteeing thread safety.\r\n\r\nPR is compared with alternatives in https://github.com/bitcoin-core/bitcoin-devwiki/wiki/AssertLockHeld-PRs",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 22,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19865",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/19865",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/19865.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/19865.patch"
          },
          "closed_at": "2020-10-25T13:41:38Z",
          "created_at": "2020-09-03T23:49:38Z",
          "updated_at": "2022-02-15T10:48:30Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-20T18:45:11Z",
      "updated_at": "2020-09-20T18:45:11Z",
      "source": {
        "issue": {
          "id": 705120908,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDg5OTExNTA3",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19983",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19983/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19983/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19983/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/19983",
          "number": 19983,
          "state": "closed",
          "state_reason": null,
          "title": "Drop some TSan suppressions",
          "body": "It seems possible now to drop some TSan suppressions.",
          "user": {
            "login": "hebasto",
            "id": 32963518,
            "node_id": "MDQ6VXNlcjMyOTYzNTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hebasto",
            "html_url": "https://github.com/hebasto",
            "followers_url": "https://api.github.com/users/hebasto/followers",
            "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
            "organizations_url": "https://api.github.com/users/hebasto/orgs",
            "repos_url": "https://api.github.com/users/hebasto/repos",
            "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/hebasto/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 14,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19983",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/19983",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/19983.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/19983.patch"
          },
          "closed_at": "2020-12-22T20:56:58Z",
          "created_at": "2020-09-20T14:35:11Z",
          "updated_at": "2023-04-19T07:10:41Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-20T18:46:55Z",
      "updated_at": "2020-09-20T18:46:55Z",
      "source": {
        "issue": {
          "id": 705074372,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDg5ODc4MDE3",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19982",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19982/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19982/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19982/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/19982",
          "number": 19982,
          "state": "closed",
          "state_reason": null,
          "title": "test: Fix inconsistent lock order in wallet_tests/CreateWallet",
          "body": "This PR:\r\n- fixes #19049 that was caused by #16426\r\n- removes `wallet_tests::CreateWallet` suppression from the `test/sanitizer_suppressions/tsan`\r\n\r\nThe example of the improved `CheckLastCritical()`/`LEAVE_CRITICAL_SECTION()` log (could be got when compiled without the last commit):\r\n```\r\n2020-09-20T08:34:28.429485Z [test] INCONSISTENT LOCK ORDER DETECTED\r\n2020-09-20T08:34:28.429493Z [test] Current lock order (least recent first) is:\r\n2020-09-20T08:34:28.429501Z [test]  'walletInstance->cs_wallet' in wallet/wallet.cpp:4007 (in thread 'test')\r\n2020-09-20T08:34:28.429508Z [test]  'cs_wallets' in wallet/wallet.cpp:4089 (in thread 'test')\r\n```\r\n\r\nCurrently, there are other \"naked\" `LEAVE_CRITICAL_SECTION()` in the code base:\r\nhttps://github.com/bitcoin/bitcoin/blob/b99a1633b270e0e89479b2bb2ae19a8a8dc0fa05/src/rpc/mining.cpp#L698\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/b99a1633b270e0e89479b2bb2ae19a8a8dc0fa05/src/checkqueue.h#L208",
          "user": {
            "login": "hebasto",
            "id": 32963518,
            "node_id": "MDQ6VXNlcjMyOTYzNTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hebasto",
            "html_url": "https://github.com/hebasto",
            "followers_url": "https://api.github.com/users/hebasto/followers",
            "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
            "organizations_url": "https://api.github.com/users/hebasto/orgs",
            "repos_url": "https://api.github.com/users/hebasto/repos",
            "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/hebasto/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 17,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19982",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/19982",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/19982.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/19982.patch"
          },
          "closed_at": "2020-12-11T01:45:59Z",
          "created_at": "2020-09-20T09:10:54Z",
          "updated_at": "2022-02-15T10:39:38Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-14T12:30:46Z",
      "updated_at": "2020-10-14T12:30:46Z",
      "source": {
        "issue": {
          "id": 695670111,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDgxODc2NzQ2",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19915",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19915/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19915/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19915/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/19915",
          "number": 19915,
          "state": "closed",
          "state_reason": null,
          "title": "p2p, refactor: Use Mutex type for some mutexes in CNode class",
          "body": "No need the `RecursiveMutex` type for the `CNode::cs_vSend`, `CNode::cs_hSocket` and `CNode::cs_vRecv`.\r\n\r\nRelated to #19303.",
          "user": {
            "login": "hebasto",
            "id": 32963518,
            "node_id": "MDQ6VXNlcjMyOTYzNTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hebasto",
            "html_url": "https://github.com/hebasto",
            "followers_url": "https://api.github.com/users/hebasto/followers",
            "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
            "organizations_url": "https://api.github.com/users/hebasto/orgs",
            "repos_url": "https://api.github.com/users/hebasto/repos",
            "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/hebasto/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 9,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19915",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/19915",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/19915.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/19915.patch"
          },
          "closed_at": "2021-01-05T11:21:49Z",
          "created_at": "2020-09-08T08:30:34Z",
          "updated_at": "2022-08-16T17:02:05Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 732456570,
      "node_id": "MDEyOklzc3VlQ29tbWVudDczMjQ1NjU3MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/732456570",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-11-23T22:14:12Z",
      "updated_at": "2020-11-23T22:14:12Z",
      "author_association": "MEMBER",
      "body": "Given how much of the current work on mutexes is converting recursive mutexes to non-resursive ones, it would be nice to get this in.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-732456570",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "commented",
      "id": 733785839,
      "node_id": "MDEyOklzc3VlQ29tbWVudDczMzc4NTgzOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/733785839",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-11-25T15:44:49Z",
      "updated_at": "2020-11-25T15:44:49Z",
      "author_association": "MEMBER",
      "body": "code review ACK 95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-733785839",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19337"
    },
    {
      "event": "merged",
      "id": 4038806326,
      "node_id": "MDExOk1lcmdlZEV2ZW50NDAzODgwNjMyNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4038806326",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "50091592dd875a1c94030dbed74112b003732d68",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/50091592dd875a1c94030dbed74112b003732d68",
      "created_at": "2020-11-25T16:02:55Z"
    },
    {
      "event": "closed",
      "id": 4038806349,
      "node_id": "MDExOkNsb3NlZEV2ZW50NDAzODgwNjM0OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4038806349",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-11-25T16:02:56Z"
    },
    {
      "event": "head_ref_deleted",
      "id": 4038811706,
      "node_id": "MDE5OkhlYWRSZWZEZWxldGVkRXZlbnQ0MDM4ODExNzA2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4038811706",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-11-25T16:04:04Z"
    },
    {
      "event": "referenced",
      "id": 4039564780,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQwMzk1NjQ3ODA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4039564780",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "e7388e9c10fa7ece5b5f35f339b51c4e66a02528",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/e7388e9c10fa7ece5b5f35f339b51c4e66a02528",
      "created_at": "2020-11-25T19:25:35Z"
    },
    {
      "event": "reviewed",
      "id": 539163537,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTM5MTYzNTM3",
      "url": null,
      "actor": null,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "review ack",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#pullrequestreview-539163537",
      "submitted_at": "2020-11-26T10:08:59Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
    },
    {
      "event": "reviewed",
      "id": 542652683,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NTQyNjUyNjgz",
      "url": null,
      "actor": null,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#pullrequestreview-542652683",
      "submitted_at": "2020-12-02T09:38:33Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
    },
    {
      "event": "referenced",
      "id": 4249366829,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQyNDkzNjY4Mjk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4249366829",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "f827e151a2ce96e14aadb9e7d25045fe0a8afbd2",
      "commit_url": "https://api.github.com/repos/fanquake/bitcoin/commits/f827e151a2ce96e14aadb9e7d25045fe0a8afbd2",
      "created_at": "2021-01-26T07:59:15Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-01-26T07:59:49Z",
      "updated_at": "2021-01-26T07:59:49Z",
      "source": {
        "issue": {
          "id": 794018921,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NTYxNjA2ODQ4",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21010",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21010/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21010/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21010/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/21010",
          "number": 21010,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: remove straggling boost::mutex usage",
          "body": "After the merge of #18710, the linter is warning:\r\n```bash\r\nA new Boost dependency in the form of \"boost/thread/mutex.hpp\" appears to have been introduced:\r\nsrc/sync.cpp:#include <boost/thread/mutex.hpp>\r\nsrc/test/sync_tests.cpp:#include <boost/thread/mutex.hpp>\r\n\r\n^---- failure generated from test/lint/lint-includes.sh\r\n```\r\n\r\n#18710 removed `boost/thread/mutex.hpp` from lint-includes, however in the interim #19337 was merged, which introduced more `boost::mutex` usage.\r\n\r\nGiven we no longer use `boost::mutex`, just remove the double lock test and remaining includes.",
          "user": {
            "login": "fanquake",
            "id": 863730,
            "node_id": "MDQ6VXNlcjg2MzczMA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fanquake",
            "html_url": "https://github.com/fanquake",
            "followers_url": "https://api.github.com/users/fanquake/followers",
            "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
            "organizations_url": "https://api.github.com/users/fanquake/orgs",
            "repos_url": "https://api.github.com/users/fanquake/repos",
            "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/fanquake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 1,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21010",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/21010",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/21010.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/21010.patch"
          },
          "closed_at": "2021-01-26T08:31:51Z",
          "created_at": "2021-01-26T07:59:49Z",
          "updated_at": "2022-08-16T17:03:22Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "referenced",
      "id": 4249483831,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQyNDk0ODM4MzE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4249483831",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "280d0bd0bd19c7bb61a54a236c3c7f7cb3e515b2",
      "commit_url": "https://api.github.com/repos/MarcoFalke/b-c/commits/280d0bd0bd19c7bb61a54a236c3c7f7cb3e515b2",
      "created_at": "2021-01-26T08:31:47Z"
    },
    {
      "event": "referenced",
      "id": 4250499590,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQyNTA0OTk1OTA=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4250499590",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "3edbc4f0ad7ab11a6adbccc0da67c37babed8fe1",
      "commit_url": "https://api.github.com/repos/remyers/bitcoin/commits/3edbc4f0ad7ab11a6adbccc0da67c37babed8fe1",
      "created_at": "2021-01-26T12:45:50Z"
    },
    {
      "event": "locked",
      "id": 7199010932,
      "node_id": "LOE_lADOABII584mSfAXzwAAAAGtGDB0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7199010932",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-08-16T17:03:21Z",
      "lock_reason": "resolved"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443132759",
      "pull_request_review_id": 434429994,
      "id": 443132759,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzEzMjc1OQ==",
      "diff_hunk": "@@ -166,10 +206,16 @@ static void pop_lock()\n     }\n }\n \n-void EnterCritical(const char* pszName, const char* pszFile, int nLine, void* cs, bool fTry)\n+template <typename MutexType>\n+void EnterCritical(const char* pszName, const char* pszFile, int nLine, MutexType* cs, bool fTry)\n {\n     push_lock(cs, CLockLocation(pszName, pszFile, nLine, fTry, util::ThreadGetInternalName()));\n }\n+template void EnterCritical(const char*, const char*, int, Mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, RecursiveMutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::recursive_mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, boost::mutex*, bool);",
      "path": "src/sync.cpp",
      "position": 84,
      "original_position": 86,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "401d3b759e14a96332a033485257d2e993c2b944",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "no need to add dead code or code that is only used in tests",
      "created_at": "2020-06-20T13:54:46Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r443132759",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443132759"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 225,
      "original_line": 225,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443133836",
      "pull_request_review_id": 434430918,
      "id": 443133836,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzEzMzgzNg==",
      "diff_hunk": "@@ -166,10 +206,16 @@ static void pop_lock()\n     }\n }\n \n-void EnterCritical(const char* pszName, const char* pszFile, int nLine, void* cs, bool fTry)\n+template <typename MutexType>\n+void EnterCritical(const char* pszName, const char* pszFile, int nLine, MutexType* cs, bool fTry)\n {\n     push_lock(cs, CLockLocation(pszName, pszFile, nLine, fTry, util::ThreadGetInternalName()));\n }\n+template void EnterCritical(const char*, const char*, int, Mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, RecursiveMutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::recursive_mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, boost::mutex*, bool);",
      "path": "src/sync.cpp",
      "position": 84,
      "original_position": 86,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "401d3b759e14a96332a033485257d2e993c2b944",
      "in_reply_to_id": 443132759,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "These instantiations are required even if tests do not exist. Without them it wouldn't link with errors like:\r\n```\r\nld: error: undefined symbol: void EnterCritical<boost::mutex>(char const*, char const*, int, boost::mutex*, bool)\r\n>>> referenced by checkqueue.h:184 (src/checkqueue.h:184)\r\n>>>               libbitcoin_server_a-validation.o:(CCheckQueueControl<CScriptCheck>::CCheckQueueControl(CCheckQueue<CScriptCheck>*)) in archive libbitcoin_server.a\r\n```",
      "created_at": "2020-06-20T14:10:45Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r443133836",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443133836"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 225,
      "original_line": 225,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443134518",
      "pull_request_review_id": 434431505,
      "id": 443134518,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzEzNDUxOA==",
      "diff_hunk": "@@ -166,10 +206,16 @@ static void pop_lock()\n     }\n }\n \n-void EnterCritical(const char* pszName, const char* pszFile, int nLine, void* cs, bool fTry)\n+template <typename MutexType>\n+void EnterCritical(const char* pszName, const char* pszFile, int nLine, MutexType* cs, bool fTry)\n {\n     push_lock(cs, CLockLocation(pszName, pszFile, nLine, fTry, util::ThreadGetInternalName()));\n }\n+template void EnterCritical(const char*, const char*, int, Mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, RecursiveMutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::recursive_mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, boost::mutex*, bool);",
      "path": "src/sync.cpp",
      "position": 84,
      "original_position": 86,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "401d3b759e14a96332a033485257d2e993c2b944",
      "in_reply_to_id": 443132759,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yeah, this is solved in #18710 :)\r\n\r\nEDIT: I mean `boost::mutex`",
      "created_at": "2020-06-20T14:20:32Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r443134518",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443134518"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 225,
      "original_line": 225,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443355827",
      "pull_request_review_id": 434653385,
      "id": 443355827,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzM1NTgyNw==",
      "diff_hunk": "@@ -166,10 +206,16 @@ static void pop_lock()\n     }\n }\n \n-void EnterCritical(const char* pszName, const char* pszFile, int nLine, void* cs, bool fTry)\n+template <typename MutexType>\n+void EnterCritical(const char* pszName, const char* pszFile, int nLine, MutexType* cs, bool fTry)\n {\n     push_lock(cs, CLockLocation(pszName, pszFile, nLine, fTry, util::ThreadGetInternalName()));\n }\n+template void EnterCritical(const char*, const char*, int, Mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, RecursiveMutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::recursive_mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, boost::mutex*, bool);",
      "path": "src/sync.cpp",
      "position": 84,
      "original_position": 86,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "401d3b759e14a96332a033485257d2e993c2b944",
      "in_reply_to_id": 443132759,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "So when these two PRs meet and if that was the last usage of `boost::mutex`, then this line can be removed: `template void EnterCritical(const char*, const char*, int, boost::mutex*, bool);`.",
      "created_at": "2020-06-22T07:07:48Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r443355827",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443355827"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 225,
      "original_line": 225,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465550425",
      "pull_request_review_id": 461435804,
      "id": 465550425,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTU1MDQyNQ==",
      "diff_hunk": "@@ -29,6 +32,36 @@ void TestPotentialDeadLockDetected(MutexType& mutex1, MutexType& mutex2)\n     BOOST_CHECK(!error_thrown);\n     #endif\n }\n+\n+#ifdef DEBUG_LOCKORDER\n+template <typename MutexType>\n+void TestDoubleLock2(MutexType& m)\n+{\n+    ENTER_CRITICAL_SECTION(m);\n+    LEAVE_CRITICAL_SECTION(m);\n+}\n+\n+template <typename MutexType>\n+void TestDoubleLock(bool should_throw)\n+{\n+    const bool prev = g_debug_lockorder_abort;\n+    g_debug_lockorder_abort = false;\n+\n+    MutexType m;\n+    ENTER_CRITICAL_SECTION(m);\n+    if (should_throw) {\n+        BOOST_CHECK_EXCEPTION(\n+            TestDoubleLock2(m), std::logic_error, [](const std::logic_error& e) {\n+                return strcmp(e.what(), \"double lock detected\") == 0;\n+            });\n+    } else {\n+        BOOST_CHECK_NO_THROW(TestDoubleLock2(m));\n+    }\n+    LEAVE_CRITICAL_SECTION(m);",
      "path": "src/test/sync_tests.cpp",
      "position": 39,
      "original_position": 39,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "c269e0a22423294b81c7a60862bc20f6ccf80f1c",
      "in_reply_to_id": null,
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    LEAVE_CRITICAL_SECTION(m);\r\n    BOOST_CHECK(LockStackEmpty());\r\n```",
      "created_at": "2020-08-05T08:09:42Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465550425",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465550425"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 60,
      "original_line": 60,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465556579",
      "pull_request_review_id": 461443685,
      "id": 465556579,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTU1NjU3OQ==",
      "diff_hunk": "@@ -29,6 +32,36 @@ void TestPotentialDeadLockDetected(MutexType& mutex1, MutexType& mutex2)\n     BOOST_CHECK(!error_thrown);\n     #endif\n }\n+\n+#ifdef DEBUG_LOCKORDER\n+template <typename MutexType>\n+void TestDoubleLock2(MutexType& m)\n+{\n+    ENTER_CRITICAL_SECTION(m);\n+    LEAVE_CRITICAL_SECTION(m);\n+}\n+\n+template <typename MutexType>\n+void TestDoubleLock(bool should_throw)\n+{\n+    const bool prev = g_debug_lockorder_abort;\n+    g_debug_lockorder_abort = false;\n+\n+    MutexType m;\n+    ENTER_CRITICAL_SECTION(m);\n+    if (should_throw) {\n+        BOOST_CHECK_EXCEPTION(\n+            TestDoubleLock2(m), std::logic_error, [](const std::logic_error& e) {\n+                return strcmp(e.what(), \"double lock detected\") == 0;\n+            });\n+    } else {\n+        BOOST_CHECK_NO_THROW(TestDoubleLock2(m));\n+    }\n+    LEAVE_CRITICAL_SECTION(m);",
      "path": "src/test/sync_tests.cpp",
      "position": 39,
      "original_position": 39,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "c269e0a22423294b81c7a60862bc20f6ccf80f1c",
      "in_reply_to_id": 465550425,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done!",
      "created_at": "2020-08-05T08:20:48Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465556579",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465556579"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 60,
      "original_line": 60,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465562495",
      "pull_request_review_id": 461451261,
      "id": 465562495,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTU2MjQ5NQ==",
      "diff_hunk": "@@ -29,6 +32,38 @@ void TestPotentialDeadLockDetected(MutexType& mutex1, MutexType& mutex2)\n     BOOST_CHECK(!error_thrown);\n     #endif\n }\n+\n+#ifdef DEBUG_LOCKORDER\n+template <typename MutexType>\n+void TestDoubleLock2(MutexType& m)\n+{\n+    ENTER_CRITICAL_SECTION(m);\n+    LEAVE_CRITICAL_SECTION(m);",
      "path": "src/test/sync_tests.cpp",
      "position": 20,
      "original_position": 20,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Couldn't this use `LOCK(m)`, since `ENTER_CRITICAL_SECTION` is mostly only used internally to the sync module and other code used `LOCK`",
      "created_at": "2020-08-05T08:30:37Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465562495",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465562495"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 41,
      "original_line": 41,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465562816",
      "pull_request_review_id": 461451261,
      "id": 465562816,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTU2MjgxNg==",
      "diff_hunk": "@@ -29,6 +32,38 @@ void TestPotentialDeadLockDetected(MutexType& mutex1, MutexType& mutex2)\n     BOOST_CHECK(!error_thrown);\n     #endif\n }\n+\n+#ifdef DEBUG_LOCKORDER\n+template <typename MutexType>\n+void TestDoubleLock2(MutexType& m)\n+{\n+    ENTER_CRITICAL_SECTION(m);\n+    LEAVE_CRITICAL_SECTION(m);\n+}\n+\n+template <typename MutexType>\n+void TestDoubleLock(bool should_throw)\n+{\n+    const bool prev = g_debug_lockorder_abort;\n+    g_debug_lockorder_abort = false;\n+\n+    MutexType m;\n+    ENTER_CRITICAL_SECTION(m);",
      "path": "src/test/sync_tests.cpp",
      "position": 30,
      "original_position": 30,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    {\r\n        LOCK(m);\r\n```\r\n\r\nSame here. Should be equivalent?",
      "created_at": "2020-08-05T08:31:06Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465562816",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465562816"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 51,
      "original_line": 51,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465563801",
      "pull_request_review_id": 461451261,
      "id": 465563801,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTU2MzgwMQ==",
      "diff_hunk": "@@ -29,6 +32,38 @@ void TestPotentialDeadLockDetected(MutexType& mutex1, MutexType& mutex2)\n     BOOST_CHECK(!error_thrown);\n     #endif\n }\n+\n+#ifdef DEBUG_LOCKORDER\n+template <typename MutexType>\n+void TestDoubleLock2(MutexType& m)\n+{\n+    ENTER_CRITICAL_SECTION(m);\n+    LEAVE_CRITICAL_SECTION(m);\n+}\n+\n+template <typename MutexType>\n+void TestDoubleLock(bool should_throw)\n+{\n+    const bool prev = g_debug_lockorder_abort;\n+    g_debug_lockorder_abort = false;\n+\n+    MutexType m;\n+    ENTER_CRITICAL_SECTION(m);\n+    if (should_throw) {\n+        BOOST_CHECK_EXCEPTION(",
      "path": "src/test/sync_tests.cpp",
      "position": 32,
      "original_position": 32,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Could limit the `#ifdef DEBUG_LOCKORDER` to just this one line/statement? Benefit would be that `BOOST_CHECK_NO_THROW` will be run for non-debug builds as well.",
      "created_at": "2020-08-05T08:32:54Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465563801",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465563801"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 53,
      "original_line": 53,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465567687",
      "pull_request_review_id": 461451261,
      "id": 465567687,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTU2NzY4Nw==",
      "diff_hunk": "@@ -135,16 +139,53 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    // We throw or abort() here, never actually locking the mutex. So remove the entry\n+    // from the lock stack which we just added in push_lock(). Tests in sync_tests.cpp\n+    // continue executing past the exception and we don't want one test to leave a\n+    // bricked stack for a subsequent test that could execute in the same thread.\n+    lock_stack.pop_back();",
      "path": "src/sync.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Would be nice if the `potential_deadlock_detected` and `double_lock_detected` helpers used the same style to pop_back the just added lock. (Either pass in a mutable reference or create a copy)",
      "created_at": "2020-08-05T08:39:41Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465567687",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465567687"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 156,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465568870",
      "pull_request_review_id": 461451261,
      "id": 465568870,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTU2ODg3MA==",
      "diff_hunk": "@@ -135,16 +139,53 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    // We throw or abort() here, never actually locking the mutex. So remove the entry\n+    // from the lock stack which we just added in push_lock(). Tests in sync_tests.cpp\n+    // continue executing past the exception and we don't want one test to leave a\n+    // bricked stack for a subsequent test that could execute in the same thread.\n+    lock_stack.pop_back();\n+    if (g_debug_lockorder_abort) {\n+        tfm::format(std::cerr, \"Assertion failed: detected double lock at %s:%i, details in debug log.\\n\", __FILE__, __LINE__);\n+        abort();",
      "path": "src/sync.cpp",
      "position": 32,
      "original_position": 37,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        std::abort();\r\n```\r\n\r\nShould be the same symbol, but slightly clearer.",
      "created_at": "2020-08-05T08:41:38Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465568870",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465568870"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 154,
      "original_line": 154,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465587721",
      "pull_request_review_id": 461483926,
      "id": 465587721,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTU4NzcyMQ==",
      "diff_hunk": "@@ -135,16 +139,53 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    // We throw or abort() here, never actually locking the mutex. So remove the entry\n+    // from the lock stack which we just added in push_lock(). Tests in sync_tests.cpp\n+    // continue executing past the exception and we don't want one test to leave a\n+    // bricked stack for a subsequent test that could execute in the same thread.\n+    lock_stack.pop_back();\n+    if (g_debug_lockorder_abort) {\n+        tfm::format(std::cerr, \"Assertion failed: detected double lock at %s:%i, details in debug log.\\n\", __FILE__, __LINE__);\n+        abort();",
      "path": "src/sync.cpp",
      "position": 32,
      "original_position": 37,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": 465568870,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "There's more cases of s/abort()/std::abort so a follow up to to do this is also fine.",
      "created_at": "2020-08-05T09:14:43Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465587721",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465587721"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 154,
      "original_line": 154,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465592482",
      "pull_request_review_id": 461483926,
      "id": 465592482,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTU5MjQ4Mg==",
      "diff_hunk": "@@ -135,16 +139,53 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    // We throw or abort() here, never actually locking the mutex. So remove the entry\n+    // from the lock stack which we just added in push_lock(). Tests in sync_tests.cpp\n+    // continue executing past the exception and we don't want one test to leave a\n+    // bricked stack for a subsequent test that could execute in the same thread.\n+    lock_stack.pop_back();\n+    if (g_debug_lockorder_abort) {\n+        tfm::format(std::cerr, \"Assertion failed: detected double lock at %s:%i, details in debug log.\\n\", __FILE__, __LINE__);\n+        abort();\n+    }\n+    throw std::logic_error(\"double lock detected\");\n+}\n+\n+template <typename MutexType>\n+static void push_lock(MutexType* c, const CLockLocation& locklocation)\n+{\n+    constexpr bool is_recursive_mutex =\n+        std::is_base_of<RecursiveMutex, MutexType>::value ||\n+        std::is_base_of<std::recursive_mutex, MutexType>::value;\n+\n     LockData& lockdata = GetLockData();\n     std::lock_guard<std::mutex> lock(lockdata.dd_mutex);\n \n     LockStack& lock_stack = lockdata.m_lock_stacks[std::this_thread::get_id()];\n     lock_stack.emplace_back(c, locklocation);\n-    for (const LockStackItem& i : lock_stack) {\n-        if (i.first == c)\n-            break;\n+    for (size_t j = 0; j < lock_stack.size() - 1; ++j) {\n+        const LockStackItem& i = lock_stack[j];\n+\n+        if (i.first == c) {\n+            if (is_recursive_mutex) {\n+                break;\n+            }\n+            // It is not a recursive mutex and it appears in the stack two times:\n+            // at position `j` and at the end (which we added just before this loop).\n+            // Can't allow locking the same (non-recursive) mutex two times from the\n+            // same thread as that results in an undefined behavior.\n+            double_lock_detected(c, lock_stack);",
      "path": "src/sync.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": null,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Add `assert(false)` after this? Or some other \"unreachable\" assertion. Below, after `potential_deadlock_detected()` there's a comment, could also add the assertion there.",
      "created_at": "2020-08-05T09:22:53Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465592482",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465592482"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 187,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465593530",
      "pull_request_review_id": 461483926,
      "id": 465593530,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTU5MzUzMA==",
      "diff_hunk": "@@ -135,16 +139,53 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    // We throw or abort() here, never actually locking the mutex. So remove the entry\n+    // from the lock stack which we just added in push_lock(). Tests in sync_tests.cpp\n+    // continue executing past the exception and we don't want one test to leave a\n+    // bricked stack for a subsequent test that could execute in the same thread.\n+    lock_stack.pop_back();\n+    if (g_debug_lockorder_abort) {\n+        tfm::format(std::cerr, \"Assertion failed: detected double lock at %s:%i, details in debug log.\\n\", __FILE__, __LINE__);\n+        abort();\n+    }\n+    throw std::logic_error(\"double lock detected\");\n+}\n+\n+template <typename MutexType>\n+static void push_lock(MutexType* c, const CLockLocation& locklocation)\n+{\n+    constexpr bool is_recursive_mutex =\n+        std::is_base_of<RecursiveMutex, MutexType>::value ||\n+        std::is_base_of<std::recursive_mutex, MutexType>::value;\n+\n     LockData& lockdata = GetLockData();\n     std::lock_guard<std::mutex> lock(lockdata.dd_mutex);\n \n     LockStack& lock_stack = lockdata.m_lock_stacks[std::this_thread::get_id()];\n     lock_stack.emplace_back(c, locklocation);\n-    for (const LockStackItem& i : lock_stack) {\n-        if (i.first == c)\n-            break;\n+    for (size_t j = 0; j < lock_stack.size() - 1; ++j) {",
      "path": "src/sync.cpp",
      "position": 52,
      "original_position": 57,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": null,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Could keep range loop? When `lock_stack` is changed the iteration stops.",
      "created_at": "2020-08-05T09:24:45Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465593530",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465593530"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 171,
      "original_line": 171,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465691861",
      "pull_request_review_id": 461617580,
      "id": 465691861,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTY5MTg2MQ==",
      "diff_hunk": "@@ -29,6 +32,38 @@ void TestPotentialDeadLockDetected(MutexType& mutex1, MutexType& mutex2)\n     BOOST_CHECK(!error_thrown);\n     #endif\n }\n+\n+#ifdef DEBUG_LOCKORDER\n+template <typename MutexType>\n+void TestDoubleLock2(MutexType& m)\n+{\n+    ENTER_CRITICAL_SECTION(m);\n+    LEAVE_CRITICAL_SECTION(m);",
      "path": "src/test/sync_tests.cpp",
      "position": 20,
      "original_position": 20,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": 465562495,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`LOCK(m)` does not compile if `m` is `std::mutex`:\r\n\r\n```\r\nsrc/sync.h:132:59: error: no type named 'UniqueLock' in 'std::__1::mutex'\r\ntemplate <typename Mutex, typename Base = typename Mutex::UniqueLock>\r\n                                          ~~~~~~~~~~~~~~~~^~~~~~~~~~\r\n```",
      "created_at": "2020-08-05T12:32:44Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465691861",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465691861"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 41,
      "original_line": 41,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465693124",
      "pull_request_review_id": 461619254,
      "id": 465693124,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTY5MzEyNA==",
      "diff_hunk": "@@ -29,6 +32,38 @@ void TestPotentialDeadLockDetected(MutexType& mutex1, MutexType& mutex2)\n     BOOST_CHECK(!error_thrown);\n     #endif\n }\n+\n+#ifdef DEBUG_LOCKORDER\n+template <typename MutexType>\n+void TestDoubleLock2(MutexType& m)\n+{\n+    ENTER_CRITICAL_SECTION(m);\n+    LEAVE_CRITICAL_SECTION(m);\n+}\n+\n+template <typename MutexType>\n+void TestDoubleLock(bool should_throw)\n+{\n+    const bool prev = g_debug_lockorder_abort;\n+    g_debug_lockorder_abort = false;\n+\n+    MutexType m;\n+    ENTER_CRITICAL_SECTION(m);",
      "path": "src/test/sync_tests.cpp",
      "position": 30,
      "original_position": 30,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": 465562816,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Same [as above](https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465691861) - it does not compile.",
      "created_at": "2020-08-05T12:35:03Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465693124",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465693124"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 51,
      "original_line": 51,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465698117",
      "pull_request_review_id": 461625668,
      "id": 465698117,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTY5ODExNw==",
      "diff_hunk": "@@ -29,6 +32,38 @@ void TestPotentialDeadLockDetected(MutexType& mutex1, MutexType& mutex2)\n     BOOST_CHECK(!error_thrown);\n     #endif\n }\n+\n+#ifdef DEBUG_LOCKORDER\n+template <typename MutexType>\n+void TestDoubleLock2(MutexType& m)\n+{\n+    ENTER_CRITICAL_SECTION(m);\n+    LEAVE_CRITICAL_SECTION(m);\n+}\n+\n+template <typename MutexType>\n+void TestDoubleLock(bool should_throw)\n+{\n+    const bool prev = g_debug_lockorder_abort;\n+    g_debug_lockorder_abort = false;\n+\n+    MutexType m;\n+    ENTER_CRITICAL_SECTION(m);\n+    if (should_throw) {\n+        BOOST_CHECK_EXCEPTION(",
      "path": "src/test/sync_tests.cpp",
      "position": 32,
      "original_position": 32,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": 465563801,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Without `DEBUG_LOCKORDER` we would actually do the double lock and once executed then we are in \"undefined behavior\" state. We don't want to do that because it may randomly crash the test executable, overwrite random portions of memory for the excitement of subsequent tests, etc.\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/b1f94072a1cc3ca67ce13658bb981d03480ef38e/src/test/sync_tests.cpp#L93-L95",
      "created_at": "2020-08-05T12:43:27Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465698117",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465698117"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 53,
      "original_line": 53,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465703371",
      "pull_request_review_id": 461632341,
      "id": 465703371,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTcwMzM3MQ==",
      "diff_hunk": "@@ -135,16 +139,53 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    // We throw or abort() here, never actually locking the mutex. So remove the entry\n+    // from the lock stack which we just added in push_lock(). Tests in sync_tests.cpp\n+    // continue executing past the exception and we don't want one test to leave a\n+    // bricked stack for a subsequent test that could execute in the same thread.\n+    lock_stack.pop_back();",
      "path": "src/sync.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": 465567687,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done - used the same as used when calling `potential_deadlock_detected()` in `master` - a copy.",
      "created_at": "2020-08-05T12:52:06Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465703371",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465703371"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 156,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465704368",
      "pull_request_review_id": 461633623,
      "id": 465704368,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTcwNDM2OA==",
      "diff_hunk": "@@ -135,16 +139,53 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    // We throw or abort() here, never actually locking the mutex. So remove the entry\n+    // from the lock stack which we just added in push_lock(). Tests in sync_tests.cpp\n+    // continue executing past the exception and we don't want one test to leave a\n+    // bricked stack for a subsequent test that could execute in the same thread.\n+    lock_stack.pop_back();\n+    if (g_debug_lockorder_abort) {\n+        tfm::format(std::cerr, \"Assertion failed: detected double lock at %s:%i, details in debug log.\\n\", __FILE__, __LINE__);\n+        abort();",
      "path": "src/sync.cpp",
      "position": 32,
      "original_position": 37,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": 465568870,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I am leaving it as is for consistency with `potential_deadlock_detected()` which uses `abort()`. As @promag says, a subsequent patch could change all occurrences.",
      "created_at": "2020-08-05T12:53:43Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465704368",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465704368"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 154,
      "original_line": 154,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465704673",
      "pull_request_review_id": 461634020,
      "id": 465704673,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTcwNDY3Mw==",
      "diff_hunk": "@@ -135,16 +139,53 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    // We throw or abort() here, never actually locking the mutex. So remove the entry\n+    // from the lock stack which we just added in push_lock(). Tests in sync_tests.cpp\n+    // continue executing past the exception and we don't want one test to leave a\n+    // bricked stack for a subsequent test that could execute in the same thread.\n+    lock_stack.pop_back();\n+    if (g_debug_lockorder_abort) {\n+        tfm::format(std::cerr, \"Assertion failed: detected double lock at %s:%i, details in debug log.\\n\", __FILE__, __LINE__);\n+        abort();\n+    }\n+    throw std::logic_error(\"double lock detected\");\n+}\n+\n+template <typename MutexType>\n+static void push_lock(MutexType* c, const CLockLocation& locklocation)\n+{\n+    constexpr bool is_recursive_mutex =\n+        std::is_base_of<RecursiveMutex, MutexType>::value ||\n+        std::is_base_of<std::recursive_mutex, MutexType>::value;\n+\n     LockData& lockdata = GetLockData();\n     std::lock_guard<std::mutex> lock(lockdata.dd_mutex);\n \n     LockStack& lock_stack = lockdata.m_lock_stacks[std::this_thread::get_id()];\n     lock_stack.emplace_back(c, locklocation);\n-    for (const LockStackItem& i : lock_stack) {\n-        if (i.first == c)\n-            break;\n+    for (size_t j = 0; j < lock_stack.size() - 1; ++j) {\n+        const LockStackItem& i = lock_stack[j];\n+\n+        if (i.first == c) {\n+            if (is_recursive_mutex) {\n+                break;\n+            }\n+            // It is not a recursive mutex and it appears in the stack two times:\n+            // at position `j` and at the end (which we added just before this loop).\n+            // Can't allow locking the same (non-recursive) mutex two times from the\n+            // same thread as that results in an undefined behavior.\n+            double_lock_detected(c, lock_stack);",
      "path": "src/sync.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": 465592482,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I added a comment, like done for `potential_deadlock_detected()`.",
      "created_at": "2020-08-05T12:54:14Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465704673",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465704673"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 187,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465709073",
      "pull_request_review_id": 461639766,
      "id": 465709073,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTcwOTA3Mw==",
      "diff_hunk": "@@ -135,16 +139,53 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    // We throw or abort() here, never actually locking the mutex. So remove the entry\n+    // from the lock stack which we just added in push_lock(). Tests in sync_tests.cpp\n+    // continue executing past the exception and we don't want one test to leave a\n+    // bricked stack for a subsequent test that could execute in the same thread.\n+    lock_stack.pop_back();\n+    if (g_debug_lockorder_abort) {\n+        tfm::format(std::cerr, \"Assertion failed: detected double lock at %s:%i, details in debug log.\\n\", __FILE__, __LINE__);\n+        abort();\n+    }\n+    throw std::logic_error(\"double lock detected\");\n+}\n+\n+template <typename MutexType>\n+static void push_lock(MutexType* c, const CLockLocation& locklocation)\n+{\n+    constexpr bool is_recursive_mutex =\n+        std::is_base_of<RecursiveMutex, MutexType>::value ||\n+        std::is_base_of<std::recursive_mutex, MutexType>::value;\n+\n     LockData& lockdata = GetLockData();\n     std::lock_guard<std::mutex> lock(lockdata.dd_mutex);\n \n     LockStack& lock_stack = lockdata.m_lock_stacks[std::this_thread::get_id()];\n     lock_stack.emplace_back(c, locklocation);\n-    for (const LockStackItem& i : lock_stack) {\n-        if (i.first == c)\n-            break;\n+    for (size_t j = 0; j < lock_stack.size() - 1; ++j) {",
      "path": "src/sync.cpp",
      "position": 52,
      "original_position": 57,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": 465593530,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "We need to iterate on all but the last element.",
      "created_at": "2020-08-05T13:01:11Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465709073",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465709073"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 171,
      "original_line": 171,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465712075",
      "pull_request_review_id": 461643924,
      "id": 465712075,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTcxMjA3NQ==",
      "diff_hunk": "@@ -135,16 +139,53 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    // We throw or abort() here, never actually locking the mutex. So remove the entry\n+    // from the lock stack which we just added in push_lock(). Tests in sync_tests.cpp\n+    // continue executing past the exception and we don't want one test to leave a\n+    // bricked stack for a subsequent test that could execute in the same thread.\n+    lock_stack.pop_back();\n+    if (g_debug_lockorder_abort) {\n+        tfm::format(std::cerr, \"Assertion failed: detected double lock at %s:%i, details in debug log.\\n\", __FILE__, __LINE__);\n+        abort();\n+    }\n+    throw std::logic_error(\"double lock detected\");\n+}\n+\n+template <typename MutexType>\n+static void push_lock(MutexType* c, const CLockLocation& locklocation)\n+{\n+    constexpr bool is_recursive_mutex =\n+        std::is_base_of<RecursiveMutex, MutexType>::value ||\n+        std::is_base_of<std::recursive_mutex, MutexType>::value;\n+\n     LockData& lockdata = GetLockData();\n     std::lock_guard<std::mutex> lock(lockdata.dd_mutex);\n \n     LockStack& lock_stack = lockdata.m_lock_stacks[std::this_thread::get_id()];\n     lock_stack.emplace_back(c, locklocation);\n-    for (const LockStackItem& i : lock_stack) {\n-        if (i.first == c)\n-            break;\n+    for (size_t j = 0; j < lock_stack.size() - 1; ++j) {",
      "path": "src/sync.cpp",
      "position": 52,
      "original_position": 57,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": 465593530,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Right, for `double_lock_detected` the last element should be skipped. But now lines L187-200 don't run for the last element.",
      "created_at": "2020-08-05T13:06:20Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465712075",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465712075"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 171,
      "original_line": 171,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465749596",
      "pull_request_review_id": 461694949,
      "id": 465749596,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTc0OTU5Ng==",
      "diff_hunk": "@@ -29,6 +32,38 @@ void TestPotentialDeadLockDetected(MutexType& mutex1, MutexType& mutex2)\n     BOOST_CHECK(!error_thrown);\n     #endif\n }\n+\n+#ifdef DEBUG_LOCKORDER\n+template <typename MutexType>\n+void TestDoubleLock2(MutexType& m)\n+{\n+    ENTER_CRITICAL_SECTION(m);\n+    LEAVE_CRITICAL_SECTION(m);\n+}\n+\n+template <typename MutexType>\n+void TestDoubleLock(bool should_throw)\n+{\n+    const bool prev = g_debug_lockorder_abort;\n+    g_debug_lockorder_abort = false;\n+\n+    MutexType m;\n+    ENTER_CRITICAL_SECTION(m);\n+    if (should_throw) {\n+        BOOST_CHECK_EXCEPTION(",
      "path": "src/test/sync_tests.cpp",
      "position": 32,
      "original_position": 32,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": 465563801,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I compiled and tested locally with sanitizers and it passed. Am I missing something? https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-669211924",
      "created_at": "2020-08-05T14:02:43Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465749596",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465749596"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 53,
      "original_line": 53,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465749673",
      "pull_request_review_id": 461695054,
      "id": 465749673,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTc0OTY3Mw==",
      "diff_hunk": "@@ -29,6 +32,38 @@ void TestPotentialDeadLockDetected(MutexType& mutex1, MutexType& mutex2)\n     BOOST_CHECK(!error_thrown);\n     #endif\n }\n+\n+#ifdef DEBUG_LOCKORDER\n+template <typename MutexType>\n+void TestDoubleLock2(MutexType& m)\n+{\n+    ENTER_CRITICAL_SECTION(m);\n+    LEAVE_CRITICAL_SECTION(m);",
      "path": "src/test/sync_tests.cpp",
      "position": 20,
      "original_position": 20,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": 465562495,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Though, we never use `LOCK` or even `ENTER_CRITICAL_SECTION` on `std::mutex`, so what is the point of testing for that? https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-669211924",
      "created_at": "2020-08-05T14:02:52Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465749673",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465749673"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 41,
      "original_line": 41,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465749839",
      "pull_request_review_id": 461695271,
      "id": 465749839,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTc0OTgzOQ==",
      "diff_hunk": "@@ -166,10 +206,16 @@ static void pop_lock()\n     }\n }\n \n-void EnterCritical(const char* pszName, const char* pszFile, int nLine, void* cs, bool fTry)\n+template <typename MutexType>\n+void EnterCritical(const char* pszName, const char* pszFile, int nLine, MutexType* cs, bool fTry)\n {\n     push_lock(cs, CLockLocation(pszName, pszFile, nLine, fTry, util::ThreadGetInternalName()));\n }\n+template void EnterCritical(const char*, const char*, int, Mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, RecursiveMutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::recursive_mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, boost::mutex*, bool);",
      "path": "src/sync.cpp",
      "position": 84,
      "original_position": 86,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "401d3b759e14a96332a033485257d2e993c2b944",
      "in_reply_to_id": 443132759,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I tried compiling locally without it and it worked https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-669211924",
      "created_at": "2020-08-05T14:03:05Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r465749839",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465749839"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 225,
      "original_line": 225,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/466023613",
      "pull_request_review_id": 462047924,
      "id": 466023613,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjAyMzYxMw==",
      "diff_hunk": "@@ -135,16 +139,53 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    // We throw or abort() here, never actually locking the mutex. So remove the entry\n+    // from the lock stack which we just added in push_lock(). Tests in sync_tests.cpp\n+    // continue executing past the exception and we don't want one test to leave a\n+    // bricked stack for a subsequent test that could execute in the same thread.\n+    lock_stack.pop_back();\n+    if (g_debug_lockorder_abort) {\n+        tfm::format(std::cerr, \"Assertion failed: detected double lock at %s:%i, details in debug log.\\n\", __FILE__, __LINE__);\n+        abort();\n+    }\n+    throw std::logic_error(\"double lock detected\");\n+}\n+\n+template <typename MutexType>\n+static void push_lock(MutexType* c, const CLockLocation& locklocation)\n+{\n+    constexpr bool is_recursive_mutex =\n+        std::is_base_of<RecursiveMutex, MutexType>::value ||\n+        std::is_base_of<std::recursive_mutex, MutexType>::value;\n+\n     LockData& lockdata = GetLockData();\n     std::lock_guard<std::mutex> lock(lockdata.dd_mutex);\n \n     LockStack& lock_stack = lockdata.m_lock_stacks[std::this_thread::get_id()];\n     lock_stack.emplace_back(c, locklocation);\n-    for (const LockStackItem& i : lock_stack) {\n-        if (i.first == c)\n-            break;\n+    for (size_t j = 0; j < lock_stack.size() - 1; ++j) {",
      "path": "src/sync.cpp",
      "position": 52,
      "original_position": 57,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "b1f94072a1cc3ca67ce13658bb981d03480ef38e",
      "in_reply_to_id": 465593530,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nevermind, the last element was already skipped with `if (i.first == c) break;`.",
      "created_at": "2020-08-05T21:48:34Z",
      "updated_at": "2020-08-10T16:43:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r466023613",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/466023613"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 171,
      "original_line": 171,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/530909272",
      "pull_request_review_id": 539163537,
      "id": 530909272,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDkwOTI3Mg==",
      "diff_hunk": "@@ -135,16 +139,50 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    if (g_debug_lockorder_abort) {\n+        tfm::format(std::cerr, \"Assertion failed: detected double lock at %s:%i, details in debug log.\\n\", __FILE__, __LINE__);",
      "path": "src/sync.cpp",
      "position": 31,
      "original_position": 31,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This will always blame the bug on sync.cpp itself:\r\n\r\n```\r\ndetected double lock at sync.cpp:153",
      "created_at": "2020-11-26T10:00:58Z",
      "updated_at": "2020-11-26T10:08:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r530909272",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/530909272"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 153,
      "original_line": 153,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531040992",
      "pull_request_review_id": 539329719,
      "id": 531040992,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA0MDk5Mg==",
      "diff_hunk": "@@ -135,16 +139,50 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    if (g_debug_lockorder_abort) {\n+        tfm::format(std::cerr, \"Assertion failed: detected double lock at %s:%i, details in debug log.\\n\", __FILE__, __LINE__);",
      "path": "src/sync.cpp",
      "position": 31,
      "original_position": 31,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "in_reply_to_id": 530909272,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Right!\r\n\r\nAddressed in https://github.com/bitcoin/bitcoin/pull/20507",
      "created_at": "2020-11-26T13:48:34Z",
      "updated_at": "2020-11-26T13:48:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r531040992",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531040992"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 153,
      "original_line": 153,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/534023890",
      "pull_request_review_id": 542652683,
      "id": 534023890,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDAyMzg5MA==",
      "diff_hunk": "@@ -135,16 +139,50 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    if (g_debug_lockorder_abort) {\n+        tfm::format(std::cerr, \"Assertion failed: detected double lock at %s:%i, details in debug log.\\n\", __FILE__, __LINE__);\n+        abort();\n+    }\n+    throw std::logic_error(\"double lock detected\");\n+}\n+\n+template <typename MutexType>\n+static void push_lock(MutexType* c, const CLockLocation& locklocation)\n+{\n+    constexpr bool is_recursive_mutex =\n+        std::is_base_of<RecursiveMutex, MutexType>::value ||\n+        std::is_base_of<std::recursive_mutex, MutexType>::value;\n+\n     LockData& lockdata = GetLockData();\n     std::lock_guard<std::mutex> lock(lockdata.dd_mutex);\n \n     LockStack& lock_stack = lockdata.m_lock_stacks[std::this_thread::get_id()];\n     lock_stack.emplace_back(c, locklocation);\n-    for (const LockStackItem& i : lock_stack) {\n-        if (i.first == c)\n-            break;\n+    for (size_t j = 0; j < lock_stack.size() - 1; ++j) {\n+        const LockStackItem& i = lock_stack[j];\n+        if (i.first == c) {\n+            if (is_recursive_mutex) {\n+                break;\n+            }\n+            // It is not a recursive mutex and it appears in the stack two times:\n+            // at position `j` and at the end (which we added just before this loop).\n+            // Can't allow locking the same (non-recursive) mutex two times from the\n+            // same thread as that results in an undefined behavior.\n+            auto lock_stack_copy = lock_stack;\n+            lock_stack.pop_back();",
      "path": "src/sync.cpp",
      "position": 63,
      "original_position": 63,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "in_reply_to_id": null,
      "user": {
        "login": "promag",
        "id": 3534524,
        "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/promag",
        "html_url": "https://github.com/promag",
        "followers_url": "https://api.github.com/users/promag/followers",
        "following_url": "https://api.github.com/users/promag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/promag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/promag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
        "organizations_url": "https://api.github.com/users/promag/orgs",
        "repos_url": "https://api.github.com/users/promag/repos",
        "events_url": "https://api.github.com/users/promag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/promag/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "@vasild why copy and pop here?",
      "created_at": "2020-12-02T09:38:33Z",
      "updated_at": "2020-12-02T09:38:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r534023890",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/534023890"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 182,
      "original_line": 182,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/534699937",
      "pull_request_review_id": 543557341,
      "id": 534699937,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDY5OTkzNw==",
      "diff_hunk": "@@ -135,16 +139,50 @@ static void potential_deadlock_detected(const LockPair& mismatch, const LockStac\n     throw std::logic_error(strprintf(\"potential deadlock detected: %s -> %s -> %s\", mutex_b, mutex_a, mutex_b));\n }\n \n-static void push_lock(void* c, const CLockLocation& locklocation)\n+static void double_lock_detected(const void* mutex, LockStack& lock_stack)\n {\n+    LogPrintf(\"DOUBLE LOCK DETECTED\\n\");\n+    LogPrintf(\"Lock order:\\n\");\n+    for (const LockStackItem& i : lock_stack) {\n+        if (i.first == mutex) {\n+            LogPrintf(\" (*)\"); /* Continued */\n+        }\n+        LogPrintf(\" %s\\n\", i.second.ToString());\n+    }\n+    if (g_debug_lockorder_abort) {\n+        tfm::format(std::cerr, \"Assertion failed: detected double lock at %s:%i, details in debug log.\\n\", __FILE__, __LINE__);\n+        abort();\n+    }\n+    throw std::logic_error(\"double lock detected\");\n+}\n+\n+template <typename MutexType>\n+static void push_lock(MutexType* c, const CLockLocation& locklocation)\n+{\n+    constexpr bool is_recursive_mutex =\n+        std::is_base_of<RecursiveMutex, MutexType>::value ||\n+        std::is_base_of<std::recursive_mutex, MutexType>::value;\n+\n     LockData& lockdata = GetLockData();\n     std::lock_guard<std::mutex> lock(lockdata.dd_mutex);\n \n     LockStack& lock_stack = lockdata.m_lock_stacks[std::this_thread::get_id()];\n     lock_stack.emplace_back(c, locklocation);\n-    for (const LockStackItem& i : lock_stack) {\n-        if (i.first == c)\n-            break;\n+    for (size_t j = 0; j < lock_stack.size() - 1; ++j) {\n+        const LockStackItem& i = lock_stack[j];\n+        if (i.first == c) {\n+            if (is_recursive_mutex) {\n+                break;\n+            }\n+            // It is not a recursive mutex and it appears in the stack two times:\n+            // at position `j` and at the end (which we added just before this loop).\n+            // Can't allow locking the same (non-recursive) mutex two times from the\n+            // same thread as that results in an undefined behavior.\n+            auto lock_stack_copy = lock_stack;\n+            lock_stack.pop_back();",
      "path": "src/sync.cpp",
      "position": 63,
      "original_position": 63,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "in_reply_to_id": 534023890,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```cpp\r\n            auto lock_stack_copy = lock_stack;\r\n            lock_stack.pop_back();\r\n            double_lock_detected(c, lock_stack_copy);\r\n```\r\n\r\nThat's subtle:\r\n1. `double_lock_detected()` can `abort()` in which case it does not matter, but it can also `throw` and tests catch this exception and continue working and executing other tests. So the lock stack needs to be correct after the `throw` because it is going to be reused by subsequent tests. Notice that we did not acquire the offending mutex that is at the top of the lock stack - we only detected a request to acquire it, which if executed would cause a double lock. So the topmost element needs to be removed before the `throw`.\r\n2. `double_lock_detected()` needs the full lock stack, including the offending-but-not-actually-acquired-mutex because it prints some of its elements. It will want to print that last one.",
      "created_at": "2020-12-03T05:57:23Z",
      "updated_at": "2020-12-03T05:57:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r534699937",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/534699937"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 182,
      "original_line": 182,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564340866",
      "pull_request_review_id": 576133278,
      "id": 564340866,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2NDM0MDg2Ng==",
      "diff_hunk": "@@ -166,10 +206,16 @@ static void pop_lock()\n     }\n }\n \n-void EnterCritical(const char* pszName, const char* pszFile, int nLine, void* cs, bool fTry)\n+template <typename MutexType>\n+void EnterCritical(const char* pszName, const char* pszFile, int nLine, MutexType* cs, bool fTry)\n {\n     push_lock(cs, CLockLocation(pszName, pszFile, nLine, fTry, util::ThreadGetInternalName()));\n }\n+template void EnterCritical(const char*, const char*, int, Mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, RecursiveMutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::recursive_mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, boost::mutex*, bool);",
      "path": "src/sync.cpp",
      "position": 84,
      "original_position": 86,
      "commit_id": "95975dd08d8fdaaeaf28e0d06b861ce2748c17b6",
      "original_commit_id": "401d3b759e14a96332a033485257d2e993c2b944",
      "in_reply_to_id": 443132759,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Just for reference - the two PRs met in `master` and afterwards that line was removed in https://github.com/bitcoin/bitcoin/pull/21010.\r\n\r\nThanks, @fanquake!",
      "created_at": "2021-01-26T08:51:27Z",
      "updated_at": "2021-01-26T08:51:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r564340866",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/564340866"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 225,
      "original_line": 225,
      "side": "RIGHT"
    }
  ]
}