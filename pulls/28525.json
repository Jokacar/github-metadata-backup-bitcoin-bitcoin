{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525",
    "id": 1527708277,
    "node_id": "PR_kwDOABII585bDvp1",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/28525",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/28525.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/28525.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28525",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28525/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/f02fb7119eca6ee9744fa7c28291e6351650291a",
    "number": 28525,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "net: Drop v2 garbage authentication packet",
    "user": {
      "login": "real-or-random",
      "id": 1071625,
      "node_id": "MDQ6VXNlcjEwNzE2MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/real-or-random",
      "html_url": "https://github.com/real-or-random",
      "followers_url": "https://api.github.com/users/real-or-random/followers",
      "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
      "organizations_url": "https://api.github.com/users/real-or-random/orgs",
      "repos_url": "https://api.github.com/users/real-or-random/repos",
      "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/real-or-random/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Note that this is a breaking change, see also https://github.com/bitcoin/bips/pull/1498\r\n\r\nThe benefit is a simpler implementation:\r\n - The protocol state machine does not need separate states for garbage authentication and version phases.\r\n - The special case of \"ignoring the ignore bit\" is removed.\r\n - The freedom to choose the contents of the garbage authentication packet is removed. This simplifies testing.",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "created_at": "2023-09-24T13:46:50Z",
    "updated_at": "2023-09-26T12:29:41Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "6551151f8b1ced3c33d61d45db93809e15857cc1",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "real-or-random:202309-garbauth",
      "ref": "202309-garbauth",
      "sha": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 132016800,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMzIwMTY4MDA=",
        "name": "bitcoin",
        "full_name": "real-or-random/bitcoin",
        "owner": {
          "login": "real-or-random",
          "id": 1071625,
          "node_id": "MDQ6VXNlcjEwNzE2MjU=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/real-or-random",
          "html_url": "https://github.com/real-or-random",
          "followers_url": "https://api.github.com/users/real-or-random/followers",
          "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
          "organizations_url": "https://api.github.com/users/real-or-random/orgs",
          "repos_url": "https://api.github.com/users/real-or-random/repos",
          "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/real-or-random/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/real-or-random/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/real-or-random/bitcoin",
        "archive_url": "https://api.github.com/repos/real-or-random/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/real-or-random/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/real-or-random/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/real-or-random/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/real-or-random/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/real-or-random/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/real-or-random/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/real-or-random/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/real-or-random/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/real-or-random/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/real-or-random/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/real-or-random/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/real-or-random/bitcoin/events",
        "forks_url": "https://api.github.com/repos/real-or-random/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/real-or-random/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/real-or-random/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/real-or-random/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/real-or-random/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/real-or-random/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/real-or-random/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/real-or-random/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/real-or-random/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/real-or-random/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/real-or-random/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/real-or-random/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/real-or-random/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/real-or-random/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/real-or-random/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/real-or-random/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:real-or-random/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/real-or-random/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/real-or-random/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/real-or-random/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/real-or-random/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/real-or-random/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/real-or-random/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/real-or-random/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/real-or-random/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/real-or-random/bitcoin/hooks",
        "svn_url": "https://github.com/real-or-random/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 218457,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-09-26T11:39:34Z",
        "created_at": "2018-05-03T15:43:06Z",
        "updated_at": "2018-08-21T19:00:23Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "dcfbf3c2107c3cb9d343ebfa0eee78278dea8d66",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35748,
        "stargazers_count": 71490,
        "watchers_count": 71490,
        "size": 240204,
        "default_branch": "master",
        "open_issues_count": 637,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-09-26T12:20:07Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-09-26T12:35:44Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 62,
    "deletions": 92,
    "changed_files": 3,
    "commits": 2,
    "review_comments": 9,
    "comments": 2
  },
  "events": [
    {
      "event": "commented",
      "id": 1732574160,
      "node_id": "IC_kwDOABII585nRPvQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1732574160",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-24T13:46:53Z",
      "updated_at": "2023-09-26T09:05:00Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [naumenkogs](https://github.com/bitcoin/bitcoin/pull/28525#pullrequestreview-1643691130) |\n| Approach ACK | [ajtowns](https://github.com/bitcoin/bitcoin/pull/28525#issuecomment-1735129734) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28525#issuecomment-1732574160",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28525"
    },
    {
      "event": "labeled",
      "id": 10455262730,
      "node_id": "LE_lADOABII585x2_NGzwAAAAJvLqYK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10455262730",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-24T13:46:54Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-25T13:05:33Z",
      "updated_at": "2023-09-25T13:05:33Z",
      "source": {
        "issue": {
          "id": 1910235128,
          "node_id": "PR_kwDOAN28mc5bDutB",
          "url": "https://api.github.com/repos/bitcoin/bips/issues/1498",
          "repository_url": "https://api.github.com/repos/bitcoin/bips",
          "labels_url": "https://api.github.com/repos/bitcoin/bips/issues/1498/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bips/issues/1498/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bips/issues/1498/events",
          "html_url": "https://github.com/bitcoin/bips/pull/1498",
          "number": 1498,
          "state": "open",
          "state_reason": null,
          "title": "bip324: Remove garbage authentication packet (breaking change)",
          "body": "by merging it with the version packet. Or more accurately, by merging it with the first packet sent after garbage termination, which may be a decoy packet or the version packet.\r\n\r\nThe new protocol simplifies implementations:\r\n - A protocol state machine won't need separate states for garbage authentication and version phases.\r\n - The special case of \"ignoring the ignore bit\" is removed.\r\n - The freedom to choose the contents of the garbage authentication packet is removed. This simplifies testing.\r\n\r\nThe reason for having a separate garbage authentication packet was to materialize the separation of the key exchange phase and version negotiation phase even in the bytestream on the wire. However, this is not necessary, and arguably, these phases are still properly separated: Since the AEAD will ensure that AAD (=garbage) is checked before looking at the contents (=version), the peers won't interpret version data before having authenticated the garbage.",
          "user": {
            "login": "real-or-random",
            "id": 1071625,
            "node_id": "MDQ6VXNlcjEwNzE2MjU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/real-or-random",
            "html_url": "https://github.com/real-or-random",
            "followers_url": "https://api.github.com/users/real-or-random/followers",
            "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
            "organizations_url": "https://api.github.com/users/real-or-random/orgs",
            "repos_url": "https://api.github.com/users/real-or-random/repos",
            "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/real-or-random/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 9,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bips/pulls/1498",
            "html_url": "https://github.com/bitcoin/bips/pull/1498",
            "diff_url": "https://github.com/bitcoin/bips/pull/1498.diff",
            "patch_url": "https://github.com/bitcoin/bips/pull/1498.patch"
          },
          "created_at": "2023-09-24T13:30:04Z",
          "updated_at": "2023-09-26T12:12:14Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 1643691130,
      "node_id": "PRR_kwDOABII585h-Lx6",
      "url": null,
      "actor": null,
      "commit_id": "8753b6af9bf8767be50d71d1bf7e3711738fcfd2",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28525#pullrequestreview-1643691130",
      "submitted_at": "2023-09-26T08:48:32Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525"
    },
    {
      "event": "commented",
      "id": 1735129734,
      "node_id": "IC_kwDOABII585na_qG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1735129734",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-26T09:04:57Z",
      "updated_at": "2023-09-26T09:04:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK assuming BIP change is accepted",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28525#issuecomment-1735129734",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28525"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGY5M2Y4YjQ1N2YxMDYyYWY3YjQyYThlNzI4YWUzZDVhYjRiMzJkMGY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f93f8b457f1062af7b42a8e728ae3d5ab4b32d0f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f93f8b457f1062af7b42a8e728ae3d5ab4b32d0f",
      "tree": {
        "sha": "c6716953aa6aac7a05978bfbcb8c0da565caf766",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c6716953aa6aac7a05978bfbcb8c0da565caf766"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ac9fa6ec78158e41006d621ee62e44dec0f934c0",
          "sha": "ac9fa6ec78158e41006d621ee62e44dec0f934c0",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ac9fa6ec78158e41006d621ee62e44dec0f934c0"
        }
      ],
      "message": "net: Drop v2 garbage authentication packet\n\nSee also https://github.com/bitcoin/bips/pull/1498\n\nThe benefit is a simpler implementation:\n - The protocol state machine does not need separate states for garbage\n   authentication and version phases.\n - The special case of \"ignoring the ignore bit\" is removed.\n - The freedom to choose the contents of the garbage authentication\n   packet is removed. This simplifies testing.",
      "committer": {
        "name": "Tim Ruffing",
        "email": "crypto@timruffing.de",
        "date": "2023-09-26T11:30:25Z"
      },
      "author": {
        "name": "Tim Ruffing",
        "email": "crypto@timruffing.de",
        "date": "2023-09-23T23:50:01Z"
      },
      "sha": "f93f8b457f1062af7b42a8e728ae3d5ab4b32d0f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGYwMmZiNzExOWVjYTZlZTk3NDRmYTdjMjgyOTFlNjM1MTY1MDI5MWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f02fb7119eca6ee9744fa7c28291e6351650291a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f02fb7119eca6ee9744fa7c28291e6351650291a",
      "tree": {
        "sha": "0c5630b147dcf54434e869d57b571c0c245ffabd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0c5630b147dcf54434e869d57b571c0c245ffabd"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f93f8b457f1062af7b42a8e728ae3d5ab4b32d0f",
          "sha": "f93f8b457f1062af7b42a8e728ae3d5ab4b32d0f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f93f8b457f1062af7b42a8e728ae3d5ab4b32d0f"
        }
      ],
      "message": "net: Simplify v2 recv logic by decoupling AAD from state machine",
      "committer": {
        "name": "Tim Ruffing",
        "email": "crypto@timruffing.de",
        "date": "2023-09-26T11:30:25Z"
      },
      "author": {
        "name": "Tim Ruffing",
        "email": "crypto@timruffing.de",
        "date": "2023-09-26T11:26:27Z"
      },
      "sha": "f02fb7119eca6ee9744fa7c28291e6351650291a"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10473972378,
      "node_id": "HRFPE_lADOABII585x2_NGzwAAAAJwTCKa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10473972378",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-26T11:39:54Z"
    },
    {
      "event": "reviewed",
      "id": 1644125951,
      "node_id": "PRR_kwDOABII585h_17_",
      "url": null,
      "actor": null,
      "commit_id": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28525#pullrequestreview-1644125951",
      "submitted_at": "2023-09-26T12:19:50Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525"
    },
    {
      "event": "reviewed",
      "id": 1644144918,
      "node_id": "PRR_kwDOABII585h_6kW",
      "url": null,
      "actor": null,
      "commit_id": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28525#pullrequestreview-1644144918",
      "submitted_at": "2023-09-26T12:29:41Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336842411",
      "pull_request_review_id": 1643691130,
      "id": 1336842411,
      "node_id": "PRRC_kwDOABII585Prpir",
      "diff_hunk": "@@ -1266,18 +1253,16 @@ bool V2Transport::ProcessReceivedPacketBytes() noexcept\n         // At this point we have a valid packet decrypted into m_recv_decode_buffer. Depending on\n         // the current state, decide what to do with it.\n         switch (m_recv_state) {\n-        case RecvState::GARBAUTH:\n-            // Ignore flag does not matter for garbage authentication. Any valid packet functions\n-            // as authentication. Receive and process the version packet next.\n-            SetReceiveState(RecvState::VERSION);\n-            ClearShrink(m_recv_garbage);\n-            break;\n         case RecvState::VERSION:\n             if (!ignore) {\n                 // Version message received; transition to application phase. The contents is\n                 // ignored, but can be used for future extensions.\n                 SetReceiveState(RecvState::APP);\n             }\n+            // We have decrypted one valid packet (which may or may not have been a decoy) with the\n+            // received garbage as AAD. We no longer need the received garbage and further packets",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 89,
      "commit_id": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "original_commit_id": "8753b6af9bf8767be50d71d1bf7e3711738fcfd2",
      "in_reply_to_id": null,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": ">further packets are expected to use the empty string as AAD.\r\n\r\nthis part is irrelevant here?",
      "created_at": "2023-09-26T08:38:08Z",
      "updated_at": "2023-09-26T08:48:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28525#discussion_r1336842411",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336842411"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1263,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336844877",
      "pull_request_review_id": 1643691130,
      "id": 1336844877,
      "node_id": "PRRC_kwDOABII585PrqJN",
      "diff_hunk": "@@ -485,24 +485,19 @@ class V2Transport final : public Transport\n         /** Garbage and garbage terminator.\n          *\n          * Whenever a byte is received, the last 16 bytes are compared with the expected garbage\n-         * terminator. When that happens, the state becomes GARBAUTH. If no matching terminator is\n+         * terminator. When that happens, the state becomes VERSION. If no matching terminator is\n          * received in 4111 bytes (4095 for the maximum garbage length, and 16 bytes for the\n          * terminator), the connection aborts. */\n         GARB_GARBTERM,\n \n-        /** Garbage authentication packet.\n-         *\n-         * A packet is received, and decrypted/verified with AAD set to the garbage received during\n-         * the GARB_GARBTERM state. If that succeeds, the state becomes VERSION. If it fails the\n-         * connection aborts. */\n-        GARBAUTH,\n-\n         /** Version packet.\n          *\n-         * A packet is received, and decrypted/verified. If that succeeds, the state becomes APP,\n-         * and the decrypted contents is interpreted as version negotiation (currently, that means\n-         * ignoring it, but it can be used for negotiating future extensions). If it fails, the\n-         * connection aborts. */\n+         * A packet is received, and decrypted/verified. The first received packet in this state\n+         * (whether it's a decoy or not) is expected to authenticate the garbage received during\n+         * the GARB_GARBTERM state as AAD. If decryption/verification (of the first non-decoy",
      "path": "src/net.h",
      "position": 40,
      "original_position": 40,
      "commit_id": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "original_commit_id": "8753b6af9bf8767be50d71d1bf7e3711738fcfd2",
      "in_reply_to_id": null,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`non-decoy decoy`? Not sure if this is intentional, although i can see some sense in this... :)",
      "created_at": "2023-09-26T08:39:55Z",
      "updated_at": "2023-09-26T08:48:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28525#discussion_r1336844877",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336844877"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 497,
      "original_line": 497,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336851588",
      "pull_request_review_id": 1643691130,
      "id": 1336851588,
      "node_id": "PRRC_kwDOABII585PrryE",
      "diff_hunk": "@@ -485,24 +485,19 @@ class V2Transport final : public Transport\n         /** Garbage and garbage terminator.\n          *\n          * Whenever a byte is received, the last 16 bytes are compared with the expected garbage\n-         * terminator. When that happens, the state becomes GARBAUTH. If no matching terminator is\n+         * terminator. When that happens, the state becomes VERSION. If no matching terminator is\n          * received in 4111 bytes (4095 for the maximum garbage length, and 16 bytes for the\n          * terminator), the connection aborts. */\n         GARB_GARBTERM,\n \n-        /** Garbage authentication packet.\n-         *\n-         * A packet is received, and decrypted/verified with AAD set to the garbage received during\n-         * the GARB_GARBTERM state. If that succeeds, the state becomes VERSION. If it fails the\n-         * connection aborts. */\n-        GARBAUTH,\n-\n         /** Version packet.\n          *\n-         * A packet is received, and decrypted/verified. If that succeeds, the state becomes APP,\n-         * and the decrypted contents is interpreted as version negotiation (currently, that means\n-         * ignoring it, but it can be used for negotiating future extensions). If it fails, the\n-         * connection aborts. */\n+         * A packet is received, and decrypted/verified. The first received packet in this state\n+         * (whether it's a decoy or not) is expected to authenticate the garbage received during\n+         * the GARB_GARBTERM state as AAD. If decryption/verification (of the first non-decoy\n+         * decoy) succeeds, the state becomes APP, and the decrypted contents is interpreted as\n+         * version negotiation (currently, that means ignoring it, but it can be used for",
      "path": "src/net.h",
      "position": 42,
      "original_position": 42,
      "commit_id": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "original_commit_id": "8753b6af9bf8767be50d71d1bf7e3711738fcfd2",
      "in_reply_to_id": null,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This description is confusing.\r\nCurrently, we will switch to APP no matter whether the authenticating package was decoy or version.\r\n\r\nIn future, `the state becomes APP, and the decrypted contents is interpreted as version negotiation`might not be the case, if the authenticating package was decoy.\r\n\r\nAt that point we might as well change this comment, but why having something certainly confusing in the first place?",
      "created_at": "2023-09-26T08:44:59Z",
      "updated_at": "2023-09-26T08:48:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28525#discussion_r1336851588",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336851588"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 499,
      "original_line": 499,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337026829",
      "pull_request_review_id": 1643975973,
      "id": 1337026829,
      "node_id": "PRRC_kwDOABII585PsWkN",
      "diff_hunk": "@@ -485,24 +485,19 @@ class V2Transport final : public Transport\n         /** Garbage and garbage terminator.\n          *\n          * Whenever a byte is received, the last 16 bytes are compared with the expected garbage\n-         * terminator. When that happens, the state becomes GARBAUTH. If no matching terminator is\n+         * terminator. When that happens, the state becomes VERSION. If no matching terminator is\n          * received in 4111 bytes (4095 for the maximum garbage length, and 16 bytes for the\n          * terminator), the connection aborts. */\n         GARB_GARBTERM,\n \n-        /** Garbage authentication packet.\n-         *\n-         * A packet is received, and decrypted/verified with AAD set to the garbage received during\n-         * the GARB_GARBTERM state. If that succeeds, the state becomes VERSION. If it fails the\n-         * connection aborts. */\n-        GARBAUTH,\n-\n         /** Version packet.\n          *\n-         * A packet is received, and decrypted/verified. If that succeeds, the state becomes APP,\n-         * and the decrypted contents is interpreted as version negotiation (currently, that means\n-         * ignoring it, but it can be used for negotiating future extensions). If it fails, the\n-         * connection aborts. */\n+         * A packet is received, and decrypted/verified. The first received packet in this state\n+         * (whether it's a decoy or not) is expected to authenticate the garbage received during\n+         * the GARB_GARBTERM state as AAD. If decryption/verification (of the first non-decoy",
      "path": "src/net.h",
      "position": 40,
      "original_position": 40,
      "commit_id": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "original_commit_id": "8753b6af9bf8767be50d71d1bf7e3711738fcfd2",
      "in_reply_to_id": 1336844877,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Oh, I wanted to write \"first non-decoy **packet**\" here. Fixed.",
      "created_at": "2023-09-26T10:58:59Z",
      "updated_at": "2023-09-26T11:40:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28525#discussion_r1337026829",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337026829"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 497,
      "original_line": 497,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337030584",
      "pull_request_review_id": 1643975973,
      "id": 1337030584,
      "node_id": "PRRC_kwDOABII585PsXe4",
      "diff_hunk": "@@ -485,24 +485,19 @@ class V2Transport final : public Transport\n         /** Garbage and garbage terminator.\n          *\n          * Whenever a byte is received, the last 16 bytes are compared with the expected garbage\n-         * terminator. When that happens, the state becomes GARBAUTH. If no matching terminator is\n+         * terminator. When that happens, the state becomes VERSION. If no matching terminator is\n          * received in 4111 bytes (4095 for the maximum garbage length, and 16 bytes for the\n          * terminator), the connection aborts. */\n         GARB_GARBTERM,\n \n-        /** Garbage authentication packet.\n-         *\n-         * A packet is received, and decrypted/verified with AAD set to the garbage received during\n-         * the GARB_GARBTERM state. If that succeeds, the state becomes VERSION. If it fails the\n-         * connection aborts. */\n-        GARBAUTH,\n-\n         /** Version packet.\n          *\n-         * A packet is received, and decrypted/verified. If that succeeds, the state becomes APP,\n-         * and the decrypted contents is interpreted as version negotiation (currently, that means\n-         * ignoring it, but it can be used for negotiating future extensions). If it fails, the\n-         * connection aborts. */\n+         * A packet is received, and decrypted/verified. The first received packet in this state\n+         * (whether it's a decoy or not) is expected to authenticate the garbage received during\n+         * the GARB_GARBTERM state as AAD. If decryption/verification (of the first non-decoy\n+         * decoy) succeeds, the state becomes APP, and the decrypted contents is interpreted as\n+         * version negotiation (currently, that means ignoring it, but it can be used for",
      "path": "src/net.h",
      "position": 42,
      "original_position": 42,
      "commit_id": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "original_commit_id": "8753b6af9bf8767be50d71d1bf7e3711738fcfd2",
      "in_reply_to_id": 1336851588,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> In future, `the state becomes APP, and the decrypted contents is interpreted as version negotiation` might not be the case, if the authenticating package was decoy.\r\n\r\n`the state becomes APP, and the decrypted contents is interpreted as version negotiation` *is* always the case. The first non-decoy packet received in VERSION state is the version packet, and that means that we interpret the contents as version info and switch to APP.\r\n\r\n> At that point we might as well change this comment, but why having something certainly confusing in the first place?\r\n\r\nI'm not sure what you're suggesting. Can you elaborate? (Maybe it's based on a misunderstanding that has been resolved now?)",
      "created_at": "2023-09-26T11:02:32Z",
      "updated_at": "2023-09-26T11:40:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28525#discussion_r1337030584",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337030584"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 499,
      "original_line": 499,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337071855",
      "pull_request_review_id": 1643975973,
      "id": 1337071855,
      "node_id": "PRRC_kwDOABII585Pshjv",
      "diff_hunk": "@@ -1266,18 +1253,16 @@ bool V2Transport::ProcessReceivedPacketBytes() noexcept\n         // At this point we have a valid packet decrypted into m_recv_decode_buffer. Depending on\n         // the current state, decide what to do with it.\n         switch (m_recv_state) {\n-        case RecvState::GARBAUTH:\n-            // Ignore flag does not matter for garbage authentication. Any valid packet functions\n-            // as authentication. Receive and process the version packet next.\n-            SetReceiveState(RecvState::VERSION);\n-            ClearShrink(m_recv_garbage);\n-            break;\n         case RecvState::VERSION:\n             if (!ignore) {\n                 // Version message received; transition to application phase. The contents is\n                 // ignored, but can be used for future extensions.\n                 SetReceiveState(RecvState::APP);\n             }\n+            // We have decrypted one valid packet (which may or may not have been a decoy) with the\n+            // received garbage as AAD. We no longer need the received garbage and further packets",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 89,
      "commit_id": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "original_commit_id": "8753b6af9bf8767be50d71d1bf7e3711738fcfd2",
      "in_reply_to_id": 1336842411,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Hah, it's not. We need to clear `m_recv_garbage` to make sure potential further packets in VERSION state don't except AAD. I agree that it's confusing. Added a commit to simply further. (Happy to squash if that's simpler.)",
      "created_at": "2023-09-26T11:38:24Z",
      "updated_at": "2023-09-26T11:40:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28525#discussion_r1337071855",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337071855"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1263,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337119907",
      "pull_request_review_id": 1644125951,
      "id": 1337119907,
      "node_id": "PRRC_kwDOABII585PstSj",
      "diff_hunk": "@@ -1249,45 +1236,37 @@ bool V2Transport::ProcessReceivedPacketBytes() noexcept\n         // as GetMaxBytesToProcess only allows up to LENGTH_LEN into the buffer before that point.\n         m_recv_decode_buffer.resize(m_recv_len);\n         bool ignore{false};\n-        Span<const std::byte> aad;\n-        if (m_recv_state == RecvState::GARBAUTH) aad = MakeByteSpan(m_recv_garbage);\n         bool ret = m_cipher.Decrypt(\n             /*input=*/MakeByteSpan(m_recv_buffer).subspan(BIP324Cipher::LENGTH_LEN),\n-            /*aad=*/aad,\n+            /*aad=*/MakeByteSpan(m_recv_aad),\n             /*ignore=*/ignore,\n             /*contents=*/MakeWritableByteSpan(m_recv_decode_buffer));\n         if (!ret) {\n             LogPrint(BCLog::NET, \"V2 transport error: packet decryption failure (%u bytes), peer=%d\\n\", m_recv_len, m_nodeid);\n             return false;\n         }\n+        // We have decrypted a valid packet with the AAD we expected, so clear the expected AAD.\n+        ClearShrink(m_recv_aad);\n         // Feed the last 4 bytes of the Poly1305 authentication tag (and its timing) into our RNG.\n         RandAddEvent(ReadLE32(m_recv_buffer.data() + m_recv_buffer.size() - 4));\n \n-        // At this point we have a valid packet decrypted into m_recv_decode_buffer. Depending on\n-        // the current state, decide what to do with it.\n-        switch (m_recv_state) {\n-        case RecvState::GARBAUTH:\n-            // Ignore flag does not matter for garbage authentication. Any valid packet functions\n-            // as authentication. Receive and process the version packet next.\n-            SetReceiveState(RecvState::VERSION);\n-            ClearShrink(m_recv_garbage);\n-            break;\n-        case RecvState::VERSION:\n-            if (!ignore) {\n+        // At this point we have a valid packet decrypted into m_recv_decode_buffer. If it's not a\n+        // decoy, which we simply ignore, use the current state to decide what to do with it.\n+        if (!ignore) {\n+            switch (m_recv_state) {\n+            case RecvState::VERSION:",
      "path": "src/net.cpp",
      "position": 101,
      "original_position": 101,
      "commit_id": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "original_commit_id": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "~~The ` if (m_recv_state != RecvState::APP_READY) ClearShrink(m_recv_decode_buffer);` below could be moved into this state transition.~~\r\n\r\nEDIT: no, we also want to do that for decoy packets.",
      "created_at": "2023-09-26T12:19:49Z",
      "updated_at": "2023-09-26T12:23:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28525#discussion_r1337119907",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337119907"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1257,
      "original_line": 1257,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337126185",
      "pull_request_review_id": 1644135666,
      "id": 1337126185,
      "node_id": "PRRC_kwDOABII585Psu0p",
      "diff_hunk": "@@ -1249,45 +1236,37 @@ bool V2Transport::ProcessReceivedPacketBytes() noexcept\n         // as GetMaxBytesToProcess only allows up to LENGTH_LEN into the buffer before that point.\n         m_recv_decode_buffer.resize(m_recv_len);\n         bool ignore{false};\n-        Span<const std::byte> aad;\n-        if (m_recv_state == RecvState::GARBAUTH) aad = MakeByteSpan(m_recv_garbage);\n         bool ret = m_cipher.Decrypt(\n             /*input=*/MakeByteSpan(m_recv_buffer).subspan(BIP324Cipher::LENGTH_LEN),\n-            /*aad=*/aad,\n+            /*aad=*/MakeByteSpan(m_recv_aad),\n             /*ignore=*/ignore,\n             /*contents=*/MakeWritableByteSpan(m_recv_decode_buffer));\n         if (!ret) {\n             LogPrint(BCLog::NET, \"V2 transport error: packet decryption failure (%u bytes), peer=%d\\n\", m_recv_len, m_nodeid);\n             return false;\n         }\n+        // We have decrypted a valid packet with the AAD we expected, so clear the expected AAD.\n+        ClearShrink(m_recv_aad);\n         // Feed the last 4 bytes of the Poly1305 authentication tag (and its timing) into our RNG.\n         RandAddEvent(ReadLE32(m_recv_buffer.data() + m_recv_buffer.size() - 4));\n \n-        // At this point we have a valid packet decrypted into m_recv_decode_buffer. Depending on\n-        // the current state, decide what to do with it.\n-        switch (m_recv_state) {\n-        case RecvState::GARBAUTH:\n-            // Ignore flag does not matter for garbage authentication. Any valid packet functions\n-            // as authentication. Receive and process the version packet next.\n-            SetReceiveState(RecvState::VERSION);\n-            ClearShrink(m_recv_garbage);\n-            break;\n-        case RecvState::VERSION:\n-            if (!ignore) {\n+        // At this point we have a valid packet decrypted into m_recv_decode_buffer. If it's not a\n+        // decoy, which we simply ignore, use the current state to decide what to do with it.\n+        if (!ignore) {\n+            switch (m_recv_state) {\n+            case RecvState::VERSION:",
      "path": "src/net.cpp",
      "position": 101,
      "original_position": 101,
      "commit_id": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "original_commit_id": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "in_reply_to_id": 1337119907,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "~~You mean \"into this `switch`\"? Since I moved the `switch` block into the `if (!ignore)` block, this means we would not clean the buffer in case of a decoy packet. That seems fine to me, but is this what you're suggesting?~~",
      "created_at": "2023-09-26T12:24:56Z",
      "updated_at": "2023-09-26T12:27:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28525#discussion_r1337126185",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337126185"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1257,
      "original_line": 1257,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337132054",
      "pull_request_review_id": 1644144918,
      "id": 1337132054,
      "node_id": "PRRC_kwDOABII585PswQW",
      "diff_hunk": "@@ -485,24 +485,19 @@ class V2Transport final : public Transport\n         /** Garbage and garbage terminator.\n          *\n          * Whenever a byte is received, the last 16 bytes are compared with the expected garbage\n-         * terminator. When that happens, the state becomes GARBAUTH. If no matching terminator is\n+         * terminator. When that happens, the state becomes VERSION. If no matching terminator is\n          * received in 4111 bytes (4095 for the maximum garbage length, and 16 bytes for the\n          * terminator), the connection aborts. */\n         GARB_GARBTERM,\n \n-        /** Garbage authentication packet.\n-         *\n-         * A packet is received, and decrypted/verified with AAD set to the garbage received during\n-         * the GARB_GARBTERM state. If that succeeds, the state becomes VERSION. If it fails the\n-         * connection aborts. */\n-        GARBAUTH,\n-\n         /** Version packet.\n          *\n-         * A packet is received, and decrypted/verified. If that succeeds, the state becomes APP,\n-         * and the decrypted contents is interpreted as version negotiation (currently, that means\n-         * ignoring it, but it can be used for negotiating future extensions). If it fails, the\n-         * connection aborts. */\n+         * A packet is received, and decrypted/verified. The first received packet in this state\n+         * (whether it's a decoy or not) is expected to authenticate the garbage received during\n+         * the GARB_GARBTERM state as AAD. If decryption/verification (of the first non-decoy\n+         * packet) succeeds, the state becomes APP, and the decrypted contents is interpreted as\n+         * version negotiation (currently, that means ignoring it, but it can be used for\n+         * negotiating future extensions). If it fails, the connection aborts. */",
      "path": "src/net.h",
      "position": 43,
      "original_position": 43,
      "commit_id": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "original_commit_id": "f02fb7119eca6ee9744fa7c28291e6351650291a",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: the `it` in this sentence is easily interpreted as \"decryption/verification of the first non-decoy packet\", which is slightly confusing, as failure to decrypt will causing aborting even for decoy packets.\r\n\r\nSuggestion:\r\n\r\n> A packet is received, and decrypted/verified. If that fails, the connection aborts. The first received packet in this state (whether it's a decoy or not) is expected to authenticate the garbage received during the GARB_GARBTERM state as AAD. The first non-decoy packet in this state is interpreted as version negotiation (currently, that means ignoring it, but it can be used for negotiating future extensions), and afterwards the state becomes APP.",
      "created_at": "2023-09-26T12:29:41Z",
      "updated_at": "2023-09-26T12:29:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28525#discussion_r1337132054",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337132054"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28525"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 500,
      "original_line": 500,
      "side": "RIGHT"
    }
  ]
}