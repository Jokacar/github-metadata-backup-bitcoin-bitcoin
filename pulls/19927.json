{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927",
    "id": 483001261,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDgzMDAxMjYx",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19927",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/19927.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/19927.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19927",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19927/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/72a1d5c6f3834e206719ee5121df7727aed5b786",
    "number": 19927,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "validation: Reduce direct g_chainman usage",
    "user": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This PR paves the way for de-globalizing `g_chainman` entirely by removing the usage of `g_chainman` in the following functions/methods:\r\n- `~CMainCleanup`\r\n- `CChainState::FlushStateToDisk`\r\n- `UnloadBlockIndex`\r\n\r\nThe remaining direct uses of `g_chainman` are as follows:\r\n1. In initialization codepaths:\r\n\t- `AppTests`\r\n\t- `AppInitMain`\r\n\t- `TestingSetup::TestingSetup`\r\n2. `::ChainstateActive`\r\n3. `LookupBlockIndex`\r\n\t- Note: `LookupBlockIndex` is used extensively throughout the codebase and require a much larger set of changes, therefore I've left it out of this initial PR",
    "labels": [
      {
        "id": 135961,
        "node_id": "MDU6TGFiZWwxMzU5NjE=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
        "name": "Refactoring",
        "color": "E6F6D6",
        "default": false
      },
      {
        "id": 118379652,
        "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
        "name": "Validation",
        "color": "6060aa",
        "default": false
      }
    ],
    "active_lock_reason": "resolved",
    "created_at": "2020-09-09T17:08:05Z",
    "updated_at": "2022-02-15T10:48:39Z",
    "closed_at": "2020-09-23T18:37:09Z",
    "mergeable_state": "unknown",
    "merged_at": "2020-09-23T18:37:09Z",
    "merge_commit_sha": "1b313cacc99a1b372238f9036abed5491f9d28f7",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "dongcarl:2020-09-reduce-g_chainman-usage",
      "ref": "2020-09-reduce-g_chainman-usage",
      "sha": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "user": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 97671618,
        "node_id": "MDEwOlJlcG9zaXRvcnk5NzY3MTYxOA==",
        "name": "bitcoin",
        "full_name": "dongcarl/bitcoin",
        "owner": {
          "login": "dongcarl",
          "id": 3445290,
          "node_id": "MDQ6VXNlcjM0NDUyOTA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/dongcarl",
          "html_url": "https://github.com/dongcarl",
          "followers_url": "https://api.github.com/users/dongcarl/followers",
          "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
          "organizations_url": "https://api.github.com/users/dongcarl/orgs",
          "repos_url": "https://api.github.com/users/dongcarl/repos",
          "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/dongcarl/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/dongcarl/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/dongcarl/bitcoin",
        "archive_url": "https://api.github.com/repos/dongcarl/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/dongcarl/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/dongcarl/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/dongcarl/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/dongcarl/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/dongcarl/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/dongcarl/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/dongcarl/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/dongcarl/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/dongcarl/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/dongcarl/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/dongcarl/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/dongcarl/bitcoin/events",
        "forks_url": "https://api.github.com/repos/dongcarl/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/dongcarl/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/dongcarl/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/dongcarl/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/dongcarl/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/dongcarl/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/dongcarl/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/dongcarl/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/dongcarl/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/dongcarl/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/dongcarl/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/dongcarl/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/dongcarl/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/dongcarl/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/dongcarl/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/dongcarl/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:dongcarl/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/dongcarl/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/dongcarl/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/dongcarl/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/dongcarl/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/dongcarl/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/dongcarl/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/dongcarl/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/dongcarl/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/dongcarl/bitcoin/hooks",
        "svn_url": "https://github.com/dongcarl/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 2,
        "watchers_count": 2,
        "size": 204504,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-05-28T17:13:06Z",
        "created_at": "2017-07-19T04:07:18Z",
        "updated_at": "2022-06-03T10:08:14Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "b99a1633b270e0e89479b2bb2ae19a8a8dc0fa05",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35476,
        "stargazers_count": 70608,
        "watchers_count": 70608,
        "size": 236222,
        "default_branch": "master",
        "open_issues_count": 672,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-08-02T20:20:41Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-08-02T18:21:18Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 72,
    "deletions": 69,
    "changed_files": 6,
    "commits": 7,
    "review_comments": 18,
    "comments": 11
  },
  "events": [
    {
      "event": "labeled",
      "id": 3746897327,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDM3NDY4OTczMjc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3746897327",
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-09T17:08:05Z",
      "label": {
        "name": "Refactoring",
        "color": "E6F6D6"
      }
    },
    {
      "event": "labeled",
      "id": 3746897328,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDM3NDY4OTczMjg=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3746897328",
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-09T17:08:05Z",
      "label": {
        "name": "Validation",
        "color": "6060aa"
      }
    },
    {
      "event": "reviewed",
      "id": 485345020,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg1MzQ1MDIw",
      "url": null,
      "actor": null,
      "commit_id": "bc872e44e29f7108720072a7d37ce06fb069ba4f",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK. I did similar changes or was planning to do them.",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#pullrequestreview-485345020",
      "submitted_at": "2020-09-09T19:36:44Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
    },
    {
      "event": "commented",
      "id": 689786686,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY4OTc4NjY4Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/689786686",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-09T19:57:43Z",
      "updated_at": "2020-09-09T19:57:43Z",
      "author_association": "MEMBER",
      "body": "Concept ACK; helps reduce globals, supports fuzzing.",
      "user": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#issuecomment-689786686",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19927"
    },
    {
      "event": "commented",
      "id": 689904588,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY4OTkwNDU4OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/689904588",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-10T00:55:40Z",
      "updated_at": "2020-09-10T00:55:40Z",
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#issuecomment-689904588",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19927"
    },
    {
      "event": "reviewed",
      "id": 487326578,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg3MzI2NTc4",
      "url": null,
      "actor": null,
      "commit_id": "86cb85e77fb960452f904190a3eec892dc7185ef",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK.\r\n\r\nI think you may as well clean up the code as you're moving it. No need to retain comments that are no longer useful, for example.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#pullrequestreview-487326578",
      "submitted_at": "2020-09-13T17:47:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
    },
    {
      "event": "commented",
      "id": 691737398,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY5MTczNzM5OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/691737398",
      "actor": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-13T22:57:55Z",
      "updated_at": "2020-09-13T23:02:31Z",
      "author_association": "MEMBER",
      "body": "I get this warning: \r\n\r\n```\r\nqt/test/apptests.cpp:87:45: warning: passing variable 'g_chainman' by reference requires holding mutex 'cs_main' [-Wthread-safety-reference]\r\n    UnloadBlockIndex(/* mempool */ nullptr, g_chainman);\r\n                                            ^\r\n```\r\n\r\nAnother proposed change: pass as a ref instead (I see this was discussed above).",
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#issuecomment-691737398",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19927"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0NjY4ZGVkNmQ2ZWE0Mjk5ZDk5OGFiYmI1NzU0M2YzNzUxOTgxMmUy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4668ded6d6ea4299d998abbb57543f37519812e2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4668ded6d6ea4299d998abbb57543f37519812e2",
      "tree": {
        "sha": "40074f54b00208f7e4cdb1a141974040e7bf2cd3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/40074f54b00208f7e4cdb1a141974040e7bf2cd3"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 40074f54b00208f7e4cdb1a141974040e7bf2cd3\nparent 147d50d63e07f600b414273a9f6b84f9f4ad9696\nauthor Carl Dong <contact@carldong.me> 1599590191 -0400\ncommitter Carl Dong <contact@carldong.me> 1600094565 -0400\n\nvalidation: Move ~CMainCleanup logic to ~BlockManager\n\n~CMainCleanup:\n1. Is vestigial\n2. References the g_chainman global (we should minimize g_chainman refs)\n3. Only acts on g_chainman.m_blockman\n4. Does the same thing as BlockManager::Unload\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEECc3SW1JEo3Z49u6oDMUhUxl5kaUFAl9fgbcACgkQDMUhUxl5\nkaUwkQ//f8gppBQZf6NhFEW69AuPbK66gsrbJrWnzqDxk+rxCRN21DYCbWa7aSpc\nnZKy49Rn56WPIbR5NDEh5UMChohHn97sX4iI3RKDPpK73t+DThdleqhznJns7Aen\nRSxZQ8Tb6OyZY79sjm7+g1wBCb4cSQFRNlIASEN/sD5mvVy6tOryNlPr+DeR8eej\njU1csdxbZPhjxdok81tHayEePhfSpswTYT+f9WKFxDN9oebFNppUvoEEGQzIqUsb\nGt9UhyU1RgeBdQ1eEKnq61Ie/BTNn2gmZbBR3yOJW2ybjZnbjMgh8AODlDLcGgWw\na95PMAS8n71LVEqM0x6k67lUcQ7lzmTDNYp0H/vTqGnlIsfugGAl8WTSDSgqUoL8\n4Ti7I4yse9qwkrPegEo4wjnHypRGBeXZRBLA9BRd6aWbPARH8M9jXCDauJjjtDBj\n5Ur0UMU1dVISr++XsYKbvxjseTGIttbfIrPgshs3Y4iYAVIRd8X5xx5QkHkgQ6Vz\note5M145Qmr0f6qsZltvgguMg4ta03NkUGXcW9xkC1jziock2H9j1Ce1BkNVzdiy\nN7Rf86H7ldLhGDF/a3iET5W62vgTKUJPXeEadUZznvOV3V1auqWYH21OtycqBx9o\nDWyk7O4CqyAiguRr+5TaqEqSugIqfGNzajG9VSRgbDG4CNlBhJo=\n=SkXz\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/147d50d63e07f600b414273a9f6b84f9f4ad9696",
          "sha": "147d50d63e07f600b414273a9f6b84f9f4ad9696",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/147d50d63e07f600b414273a9f6b84f9f4ad9696"
        }
      ],
      "message": "validation: Move ~CMainCleanup logic to ~BlockManager\n\n~CMainCleanup:\n1. Is vestigial\n2. References the g_chainman global (we should minimize g_chainman refs)\n3. Only acts on g_chainman.m_blockman\n4. Does the same thing as BlockManager::Unload",
      "committer": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-09-14T14:42:45Z"
      },
      "author": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-09-08T18:36:31Z"
      },
      "sha": "4668ded6d6ea4299d998abbb57543f37519812e2"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3763950940,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50Mzc2Mzk1MDk0MA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3763950940",
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-14T15:13:28Z"
    },
    {
      "event": "commented",
      "id": 692129520,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY5MjEyOTUyMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/692129520",
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-14T15:22:08Z",
      "updated_at": "2020-09-14T15:22:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thank you MarcoFalke, jnewbery, and Empact for the code review!\r\n\r\nMarco: `ChainstateManager` is now passed in as a reference in 577ec184bd47b3e88a1d3e60b4d2045bd51328b4\r\njnewbery: Thanks for the detailed review! See the review comments for resolutions\r\nEmpact: Good find. I'm turning on `-Werror=thread-safety` by default now and that particular problem is fixed in 577ec184bd47b3e88a1d3e60b4d2045bd51328b4\r\n\r\n-----\r\n\r\nNote: I will push a commit to remove the comments and assertions in 84d983656f1927955e516a94366b7c216bacded3 once I get the first Code Review ACK.",
      "user": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#issuecomment-692129520",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19927"
    },
    {
      "event": "reviewed",
      "id": 488595575,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4NTk1NTc1",
      "url": null,
      "actor": null,
      "commit_id": "cdd2063bbe8b8df4db42c81ee7913e2dc0b2387a",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "utACK cdd2063bbe8b8df4db42c81ee7913e2dc0b2387a\r\n\r\nJust a couple of style suggestions inline. Feel free to ignore.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#pullrequestreview-488595575",
      "submitted_at": "2020-09-15T11:49:17Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
    },
    {
      "event": "reviewed",
      "id": 488777314,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg4Nzc3MzE0",
      "url": null,
      "actor": null,
      "commit_id": "577ec184bd47b3e88a1d3e60b4d2045bd51328b4",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review ACK cdd2063bbe8b8df4db42c81ee7913e2dc0b2387a. Seems good and can re-ack if an extra assert-cleanup commit will be added.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#pullrequestreview-488777314",
      "submitted_at": "2020-09-15T15:17:45Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3NGY3M2M3ODNkNDZiMDEyZjM3NWQ4MTllMmNkMDljNzkyODIwY2Q1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/74f73c783d46b012f375d819e2cd09c792820cd5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/74f73c783d46b012f375d819e2cd09c792820cd5",
      "tree": {
        "sha": "9c351abe4519267e6c57ce65b195b819e2ca3e2e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9c351abe4519267e6c57ce65b195b819e2ca3e2e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 9c351abe4519267e6c57ce65b195b819e2ca3e2e\nparent 4668ded6d6ea4299d998abbb57543f37519812e2\nauthor Carl Dong <contact@carldong.me> 1598383437 -0400\ncommitter Carl Dong <contact@carldong.me> 1600193494 -0400\n\nvalidation: Pass in chainman to UnloadBlockIndex\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEECc3SW1JEo3Z49u6oDMUhUxl5kaUFAl9hBFcACgkQDMUhUxl5\nkaVvBhAAvpAaaxCWu7B/dmefdP0mW5FWykHe7J+UvTnJIqTsOUJD728XJzil7Tik\n50eGzPEiDS5oAdnB8mtaD/cNJzzdvGwlwnmxDDqkl+xxreBk4/4tyGqL5uIus59a\nPT+SjkgdofkRP2rRoIe+DLvLEbE8oy4ePVyOErbU2dXr+CIELx9Q+WpO6QNJTBeJ\nEB8xReh0KJWx2oypvqI4pwXKCP06hVCZu6MmXxmYgFYMxUvEfw3gHk2Kh3g09YUz\n0KBRnRsNEFMXSqylXSRyXDncNyNF3BbpWbGbmnmrfDv380VFKOoCQfzkYT5UTPkf\n+WEDuVz53sEHg18GIb3iaYIreZ0wvVqOfE3ArEoUCOb292h3ahlLyDm8I5hAtFQj\nW5tMoazx9AACQIMnWmfzf0Qb1w53AQ3rRlBwZYYqJJbLZzTZEATfJ0Woni96UyVu\nuTqHjS42BcyzLdXiqKRsylxFMiSUuufgdWnEVyiJJyfP3LHxXXwAtpgczQ/mRrmB\n7FKhXv4HE8+9/D6TufhMGb4iU5Roh7ypy8Ue5c8Q1Mjmm96bcRUwKU3fHwwVuhFI\nu4mvLS9zlJwNsRdypbtoEtjJzfJwxWEm//2YifjnAddJUrGZdDvIH/YJGZmfVa7I\nCm0Hafo1Nf86QBpnQfPRIDYN8eHOYwo9J4q2+zQoBvx2rpEDHKA=\n=lgXK\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4668ded6d6ea4299d998abbb57543f37519812e2",
          "sha": "4668ded6d6ea4299d998abbb57543f37519812e2",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4668ded6d6ea4299d998abbb57543f37519812e2"
        }
      ],
      "message": "validation: Pass in chainman to UnloadBlockIndex",
      "committer": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-09-15T18:11:34Z"
      },
      "author": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-08-25T19:23:57Z"
      },
      "sha": "74f73c783d46b012f375d819e2cd09c792820cd5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmOGQ0OTc1YWIzZmNkMzU1Mzg0M2NmMDg2MjI1MTI4OWM4OGMxMDZi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f8d4975ab3fcd3553843cf0862251289c88c106b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f8d4975ab3fcd3553843cf0862251289c88c106b",
      "tree": {
        "sha": "fc52dc628f532971eb04873acd483aa5f19f831d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fc52dc628f532971eb04873acd483aa5f19f831d"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree fc52dc628f532971eb04873acd483aa5f19f831d\nparent 74f73c783d46b012f375d819e2cd09c792820cd5\nauthor Carl Dong <contact@carldong.me> 1598396750 -0400\ncommitter Carl Dong <contact@carldong.me> 1600193624 -0400\n\nvalidation: Move PruneOneBlockFile to BlockManager\n\n[META] This is a pure refactor commit.\n\nMove PruneBlockFile to BlockManager because:\n1. PruneOneBlockFile only acts on BlockManager\n2. Eliminates the need for callers (FindFilesToPrune{,Manual}) to have a\n   reference to the larger ChainstateManager, just a reference to\n   BlockManager is enough. See following commits.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEECc3SW1JEo3Z49u6oDMUhUxl5kaUFAl9hBFgACgkQDMUhUxl5\nkaXtFw//VAKKXe0xT91zI3AnNujYwJ9buzf1bKnba+o9+gxn0QplngQ8zTeA9Uf3\nsPepvoyUi8dE987G17SxsY+ef29CxA71MptBOwYGv0xstPJ4PhkYBScrAtwlCF1+\nBMrpifRf6h5hdEHwqANXVpBhoU9eibNcuZtYU5vUf66pm2KdpBvKnFQDIZe7emGq\ndrBLdIHwKGqxCTK96ZyLkHr7zst52rukPhA8BRGtM/r6gUdnm2RiyxAcaNipSz8f\nmNm4EA8iLQqOVnnPNDhF4/6lhhFhRxj9o0JGNTIjPEA2ECmT+G9LWhPtzhbyaQCP\nz/VnyvySaRf3rcISmywnvW/HvPEkeC742sM85AQK9cVcp9pi7PUjDnnKfieL/J6d\nOixXIbBYzuev59UqOvYnYgjLmYSo/aL+Y+qMHh6foUZDzOSexsHyoZFMSxMeP4Hn\nUS8Lrsq/ybZ1nPfaSic2SuO/TY7vaP3PuUP9tT7scno4+mwOixnYu0AcyBON595J\nU40JpdycBBeiL6IiVu0CQK6Y+51o41kHU6LnOy49Xf5/6Y4Rcz9ua2LDwXGFmpQ1\nmk+wwzn6UreAEnLI9r8LUrAtpFer5TnG1F6pEBZa+Qj7vtcuUtIQlaNtUIbK2RXr\nHSei+5E1U4Ox8giIboA8s9wvGjlGGTZ8/Bkbb2VNwdjTyYrnLlk=\n=kKvH\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/74f73c783d46b012f375d819e2cd09c792820cd5",
          "sha": "74f73c783d46b012f375d819e2cd09c792820cd5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/74f73c783d46b012f375d819e2cd09c792820cd5"
        }
      ],
      "message": "validation: Move PruneOneBlockFile to BlockManager\n\n[META] This is a pure refactor commit.\n\nMove PruneBlockFile to BlockManager because:\n1. PruneOneBlockFile only acts on BlockManager\n2. Eliminates the need for callers (FindFilesToPrune{,Manual}) to have a\n   reference to the larger ChainstateManager, just a reference to\n   BlockManager is enough. See following commits.",
      "committer": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-09-15T18:13:44Z"
      },
      "author": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-08-25T23:05:50Z"
      },
      "sha": "f8d4975ab3fcd3553843cf0862251289c88c106b"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3769731844,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50Mzc2OTczMTg0NA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3769731844",
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-15T18:23:38Z"
    },
    {
      "event": "commented",
      "id": 692895586,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY5Mjg5NTU4Ng==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/692895586",
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-15T18:30:03Z",
      "updated_at": "2020-09-15T18:31:07Z",
      "author_association": "CONTRIBUTOR",
      "body": "Got a [code review ACK](https://github.com/bitcoin/bitcoin/pull/19927#pullrequestreview-488777314), just pushed a version which:\r\n1. Has a [last commit](75142a7bd7890f2e14920dbe9701ada2cbc2326f) which removes the review-only comments + assertions\r\n2. Adds a [style-only commit](597ec8a853df20fc68892b5f1131d27a1f2cf0e5) which makes the code I moved conform to our style guide\r\n\r\nThis is now ready for final review and (hopefully) merge.",
      "user": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#issuecomment-692895586",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19927"
    },
    {
      "event": "commented",
      "id": 693252979,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY5MzI1Mjk3OQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/693252979",
      "actor": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-16T08:20:31Z",
      "updated_at": "2020-09-16T08:20:31Z",
      "author_association": "MEMBER",
      "body": "code review ACK 75142a7bd7890f2e14920dbe9701ada2cbc2326f",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#issuecomment-693252979",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19927"
    },
    {
      "event": "reviewed",
      "id": 489775489,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDg5Nzc1NDg5",
      "url": null,
      "actor": null,
      "commit_id": "75142a7bd7890f2e14920dbe9701ada2cbc2326f",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review ACK 75142a7bd7890f2e14920dbe9701ada2cbc2326f. Since last review just new commit removing asserts, new commit cleaning up whitespace, and a newline fix in earlier commit",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#pullrequestreview-489775489",
      "submitted_at": "2020-09-16T16:00:02Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
    },
    {
      "event": "commented",
      "id": 695215048,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY5NTIxNTA0OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/695215048",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-19T13:42:13Z",
      "updated_at": "2020-09-22T19:49:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19909 (txmempool: Remove unused clear() member function by MarcoFalke)\n* #18731 (refactor: Make CCheckQueue RAII-styled by hebasto)\n* #18710 (Add local thread pool to CCheckQueue by hebasto)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#issuecomment-695215048",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19927"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-19T13:47:19Z",
      "updated_at": "2020-09-19T13:47:19Z",
      "source": {
        "issue": {
          "id": 695177712,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDgxNDU3MDI1",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19909",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19909/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19909/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19909/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/19909",
          "number": 19909,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Remove unused CTxMemPool::clear() helper",
          "body": "Seems odd to have code in Bitcoin Core that is unused.\r\n\r\nMoreover the function was broken (see https://github.com/bitcoin/bitcoin/pull/24145) and is brittle, as there is nothing that prevents similar bugs from re-appearing.\r\n\r\nFix both issues by replacing it with C++11 member initializers.",
          "user": {
            "login": "MarcoFalke",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/MarcoFalke",
            "html_url": "https://github.com/MarcoFalke",
            "followers_url": "https://api.github.com/users/MarcoFalke/followers",
            "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
            "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
            "repos_url": "https://api.github.com/users/MarcoFalke/repos",
            "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 19,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19909",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/19909",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/19909.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/19909.patch"
          },
          "closed_at": "2023-01-04T08:45:25Z",
          "created_at": "2020-09-07T14:48:42Z",
          "updated_at": "2023-01-04T10:30:02Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-19T15:01:49Z",
      "updated_at": "2020-09-19T15:01:49Z",
      "source": {
        "issue": {
          "id": 652920165,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ1OTI3NjM1",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19463",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19463/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19463/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19463/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/19463",
          "number": 19463,
          "state": "open",
          "state_reason": null,
          "title": "Prune locks",
          "body": "This adds the ability to have any number of internal or external locks to prevent pruning specific block ranges.\r\n\r\nSome examples where this would be useful:\r\n\r\n* Ensuring any known Core wallet won't become unable to sync due to pruning when it is unloaded. (Included in this PR)\r\n* Ensuring pruning doesn't go too far for a desired-functional wallet backup. (Questionable, since you probably lose the node if you need the backup anyway?)\r\n* Allowing users to temporarily disable block indexes and filters, without pruning cutting them off from catching up later.\r\n* Avoiding pruning out from under external wallets (Armory, EPS, etc) that might need block data.\r\n* External block indexes/filters, etc.\r\n\r\nBy design, users retain complete control over prune locks, and can delete them out from under applications using them. This is to avoid circumstances where a prune lock has been set, by an application that may no longer be used.\r\n\r\n~~One caveat in this PR is that it exposes the BDB \"fileid\" to wallet logic. This is to ensure the same prune lock is used/updated even if the wallet is moved or renamed later. It might seem ugly at face value to do it this way, but I'm not sure we have any other unique identifier, and it should be trivial for any new db backend to simply migrate the fileid to a dedicated key.~~\r\n\r\nTODO:\r\n\r\n- [X] Tests\r\n- [ ]  ~~Check endian safety of BDB fileid~~\r\n- [ ] GUI management of prune locks (followup PR?)\r\n- [ ]  ~~Ability to enable for wallets from the GUI (followup PR?)~~\r\n\r\nEdit: Removed wallet usage for this PR",
          "user": {
            "login": "luke-jr",
            "id": 1095675,
            "node_id": "MDQ6VXNlcjEwOTU2NzU=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/luke-jr",
            "html_url": "https://github.com/luke-jr",
            "followers_url": "https://api.github.com/users/luke-jr/followers",
            "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
            "organizations_url": "https://api.github.com/users/luke-jr/orgs",
            "repos_url": "https://api.github.com/users/luke-jr/repos",
            "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/luke-jr/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            },
            {
              "id": 219890555,
              "node_id": "MDU6TGFiZWwyMTk4OTA1NTU=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Block%20storage",
              "name": "Block storage",
              "color": "000000",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 17,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19463",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/19463",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/19463.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/19463.patch"
          },
          "created_at": "2020-07-08T04:03:17Z",
          "updated_at": "2023-07-08T01:58:05Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-19T16:01:26Z",
      "updated_at": "2020-09-19T16:01:26Z",
      "source": {
        "issue": {
          "id": 604368916,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDA2OTc3Mjg0",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18731",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18731/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18731/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18731/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/18731",
          "number": 18731,
          "state": "closed",
          "state_reason": null,
          "title": "refactor: Make CCheckQueue RAII-styled",
          "body": "This PR:\r\n- makes `CCheckQueue` RAII-styled\r\n- gets rid of two global variables:\r\n  - `scriptcheckqueue`\r\n  - `g_parallel_script_checks`\r\n\r\nThis PR is based on #18710, therefore only the last two commits should be considered.",
          "user": {
            "login": "hebasto",
            "id": 32963518,
            "node_id": "MDQ6VXNlcjMyOTYzNTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hebasto",
            "html_url": "https://github.com/hebasto",
            "followers_url": "https://api.github.com/users/hebasto/followers",
            "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
            "organizations_url": "https://api.github.com/users/hebasto/orgs",
            "repos_url": "https://api.github.com/users/hebasto/repos",
            "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/hebasto/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 20,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18731",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/18731",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/18731.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/18731.patch"
          },
          "closed_at": "2022-04-22T14:31:40Z",
          "created_at": "2020-04-22T00:33:08Z",
          "updated_at": "2022-12-28T13:18:44Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-19T16:04:06Z",
      "updated_at": "2020-09-19T16:04:06Z",
      "source": {
        "issue": {
          "id": 603299146,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDA2MTEyNjEx",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18710",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18710/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18710/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18710/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/18710",
          "number": 18710,
          "state": "closed",
          "state_reason": null,
          "title": "Add local thread pool to CCheckQueue",
          "body": "This PR:\r\n- gets rid of `boost::thread_group` in the `CCheckQueue` class\r\n- allows thread safety annotation usage in the `CCheckQueue` class\r\n- is alternative to #14464 (https://github.com/bitcoin/bitcoin/pull/18710#issuecomment-616618525, https://github.com/bitcoin/bitcoin/pull/18710#issuecomment-617291612)\r\n\r\nAlso, with this PR (I hope) it could be easier to resurrect a bunch of brilliant ideas from #9938.\r\n\r\nRelated: #17307",
          "user": {
            "login": "hebasto",
            "id": 32963518,
            "node_id": "MDQ6VXNlcjMyOTYzNTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hebasto",
            "html_url": "https://github.com/hebasto",
            "followers_url": "https://api.github.com/users/hebasto/followers",
            "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
            "organizations_url": "https://api.github.com/users/hebasto/orgs",
            "repos_url": "https://api.github.com/users/hebasto/repos",
            "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/hebasto/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 118379652,
              "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
              "name": "Validation",
              "color": "6060aa",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "milestone": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/47",
            "html_url": "https://github.com/bitcoin/bitcoin/milestone/47",
            "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/47/labels",
            "id": 5347322,
            "node_id": "MDk6TWlsZXN0b25lNTM0NzMyMg==",
            "number": 47,
            "state": "closed",
            "title": "22.0",
            "description": "",
            "creator": {
              "login": "MarcoFalke",
              "id": 6399679,
              "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
              "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/MarcoFalke",
              "html_url": "https://github.com/MarcoFalke",
              "followers_url": "https://api.github.com/users/MarcoFalke/followers",
              "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
              "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
              "repos_url": "https://api.github.com/users/MarcoFalke/repos",
              "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
              "type": "User",
              "site_admin": false
            },
            "open_issues": 0,
            "closed_issues": 124,
            "created_at": "2020-04-25T00:14:49Z",
            "updated_at": "2021-09-14T07:16:53Z",
            "closed_at": "2021-09-09T12:47:52Z"
          },
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 48,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18710",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/18710",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/18710.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/18710.patch"
          },
          "closed_at": "2021-01-25T19:21:55Z",
          "created_at": "2020-04-20T14:51:38Z",
          "updated_at": "2022-08-16T17:03:20Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 695758685,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY5NTc1ODY4NQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/695758685",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-20T08:08:41Z",
      "updated_at": "2020-09-20T08:08:41Z",
      "author_association": "MEMBER",
      "body": "Previously those methods were private (`static` in a cpp file), so I am a bit worried about exposing them as public member functions to all of Bitcoin Core (rpc, net_processing, ...). \r\n\r\nWhat do you think about turning them `private` again?\r\n\r\nE.g.\r\n\r\n```diff\r\ndiff --git a/src/validation.h b/src/validation.h\r\nindex cc5e36acfc..bc9b136039 100644\r\n--- a/src/validation.h\r\n+++ b/src/validation.h\r\n@@ -357,7 +357,12 @@ struct CBlockIndexWorkComparator\r\n  * This data is used mostly in `CChainState` - information about, e.g.,\r\n  * candidate tips is not maintained here.\r\n  */\r\n-class BlockManager {\r\n+class BlockManager\r\n+{\r\n+    friend CChainState;\r\n+    void FindFilesToPruneManual(std::set<int>& setFilesToPrune, int nManualPruneHeight, int chain_tip_height);\r\n+    void FindFilesToPrune(std::set<int>& setFilesToPrune, uint64_t nPruneAfterHeight, int chain_tip_height, bool is_ibd);\r\n+\r\n public:\r\n     BlockMap m_block_index GUARDED_BY(cs_main);\r\n \r\n@@ -411,24 +416,6 @@ public:\r\n     //! Mark one block file as pruned (modify associated database entries)\r\n     void PruneOneBlockFile(const int fileNumber) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\r\n \r\n-    /* Calculate the block/rev files to delete based on height specified by user with RPC command pruneblockchain */\r\n-    void FindFilesToPruneManual(std::set<int>& setFilesToPrune, int nManualPruneHeight, int chain_tip_height);\r\n-    /**\r\n-     * Prune block and undo files (blk???.dat and undo???.dat) so that the disk space used is less than a user-defined target.\r\n-     * The user sets the target (in MB) on the command line or in config file.  This will be run on startup and whenever new\r\n-     * space is allocated in a block or undo file, staying below the target. Changing back to unpruned requires a reindex\r\n-     * (which in this case means the blockchain must be re-downloaded.)\r\n-     *\r\n-     * Pruning functions are called from FlushStateToDisk when the global fCheckForPruning flag has been set.\r\n-     * Block and undo files are deleted in lock-step (when blk00003.dat is deleted, so is rev00003.dat.)\r\n-     * Pruning cannot take place until the longest chain is at least a certain length (100000 on mainnet, 1000 on testnet, 1000 on regtest).\r\n-     * Pruning will never delete a block within a defined distance (currently 288) from the active chain's tip.\r\n-     * The block index is updated by unsetting HAVE_DATA and HAVE_UNDO for any blocks that were stored in the deleted files.\r\n-     * A db flag records the fact that at least some block files have been pruned.\r\n-     *\r\n-     * @param[out]   setFilesToPrune   The set of file indices that can be unlinked will be returned\r\n-     */\r\n-    void FindFilesToPrune(std::set<int>& setFilesToPrune, uint64_t nPruneAfterHeight, int chain_tip_height, bool is_ibd);\r\n     /**\r\n      * If a block header hasn't already been seen, call CheckBlockHeader on it, ensure\r\n      * that it doesn't descend from an invalid block, and then add it to m_block_index.\r\n",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#issuecomment-695758685",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19927"
    },
    {
      "event": "commented",
      "id": 695758925,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY5NTc1ODkyNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/695758925",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-20T08:11:46Z",
      "updated_at": "2020-09-20T08:11:46Z",
      "author_association": "MEMBER",
      "body": "cr ACK 75142a7bd7890f2e14920dbe9701ada2cbc2326f 😺\r\n\r\n<details><summary>Show signature and timestamp</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\ncr ACK 75142a7bd7890f2e14920dbe9701ada2cbc2326f 😺\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUhyqwv/eNXZQ6DzY+d3CX83lRRCFbjD3zfjQ0o0dT2SBGnP4oaG6gI+fwzUQacl\r\nZdtAZ3JEhJU6RDFs+gMun19ldVP7SG+RhJAGHRZgNuWzT0VvC/I1USyK/QZ7Rb53\r\nG2Rz7oSIMTZ9X88kVBuBVYPphSalSVKDTwbPoV5tYUn96Z753aG768FS1pop6Lvx\r\nLwFLLVWjN8hpA1UAinh57qIAy9Jr21jA1bGcUG5M8AydqTlwA1pTig80Yktn5cvb\r\nMe9FWSLHqifUHR2Js8TUjwykChul18d/8C9C4kmOynDeH4b+n7nmYFP1Ynrh458X\r\nP71pSb0vcVFK1fXnFFVh3z493Is2vpGxxuZino4RPvK4+53G7fJ41xlL78r+2cRk\r\ngKrBAukJNMM02RRwdQ1W+4jSpcZcf8PHLUNSg7BVOP5AFLcCekvhExVLIJJO9LiS\r\nQ5jNu4OQSVEuoZhjbmoeHQhgPe+lrd3LYWvPtpJveos24+gTNSS3KWFD1IB3QvzK\r\nHIpk9O5/\r\n=izRp\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n[Timestamp of file with hash `3230012495f1048f1411855fc06225652a1358399085dc6b400e304c7f82dadb  -`](https://opentimestamps.org/info/?004f70656e54696d657374616d7073000050726f6f6600bf89e2e884e8929401083230012495f1048f1411855fc06225652a1358399085dc6b400e304c7f82dadbf01013255e7a96728bed9b4f3c17ee1ce96008fff010057b6b712b35e5da800f897e8b9e753a08f1045f670e6ff008d9dec54e95a7ad710083dfe30d2ef90c8e2e2d68747470733a2f2f616c6963652e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267fff0104d400ed7649431e136461dee16a397c808f1045f670e6df0086215af5b970539220083dfe30d2ef90c8e232268747470733a2f2f6274632e63616c656e6461722e636174616c6c6178792e636f6dfff0104fe0a6d7756d26a1ad8de59d3e0f835f08f1045f670e6df008fb8f52995c50205e0083dfe30d2ef90c8e292868747470733a2f2f66696e6e65792e63616c656e6461722e657465726e69747977616c6c2e636f6df0107c2543e58756487877c7da29d6ab3c5908f1045f670e6ff0082c828ef742ef5b560083dfe30d2ef90c8e2c2b68747470733a2f2f626f622e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267)\r\n\r\n</details>\r\n",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#issuecomment-695758925",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19927"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzozZjViNWYzZjZkYjBlNTcxNjkxMWIzZmJhMTQ2MGNlMzI3ZThhODQ1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3f5b5f3f6db0e5716911b3fba1460ce327e8a845",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/3f5b5f3f6db0e5716911b3fba1460ce327e8a845",
      "tree": {
        "sha": "f8364c75d5a999791fd33847914eecf6014ecbe1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f8364c75d5a999791fd33847914eecf6014ecbe1"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree f8364c75d5a999791fd33847914eecf6014ecbe1\nparent f8d4975ab3fcd3553843cf0862251289c88c106b\nauthor Carl Dong <contact@carldong.me> 1598398703 -0400\ncommitter Carl Dong <contact@carldong.me> 1600709264 -0400\n\nvalidation: Move FindFilesToPrune{,Manual} to BlockManager\n\n[META] No behaviour change is intended in this commit.\n[META] This commit should be followed up by removing the comments and\n       assertions meant only to show that the change is correct.\n\nAlso stop FindFilesToPrune{,Manual} from unnecessary reaching for\n::ChainActive() by passing in the necessary information.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEECc3SW1JEo3Z49u6oDMUhUxl5kaUFAl9o4pIACgkQDMUhUxl5\nkaV+qhAAzESZFVrfkgsHNhvX8ofj2aI9XycdEP0uCXDtAyorJOarhepXjo2JUYo0\nj2KaWpu3XCobWPHUvOqFnHAKz6om9WYQto9SApg2nsVoCiSBYrLbI73abOcvbRdQ\n8jtxOnCgAjeXt3OXVr3Xx+6YLPG9FMCDsgB0maNu8h9mp3wDJrYWgG+uDWj+Z4FT\nnG+FxJv5lQopezVTSmL0tbQGUhyf1XOvWwAJbtMYfnAZyAUPGZmNUw04SUx16r6b\nyBXl+/6groc0ecLfT35cdlYU2ZfJbMkhD25O2B6t6hvuYGI9L9SIw7G2xZgD6w0z\nix+X0ECSHTK0Iu72DyG6Ky7GwVaiLYxTyEEC8IuaZHYktlemvVQj95iM17QWl3DD\nF3nnX4iVHJ3QtVoxVw9KuOpNDmQKPJ4yzZtxfC9uJ5raw7nFxfgncvFEwMtmRB2C\nxyWJ4f4qeCCEUiu4lGsrQCFrgSNBYEQmuQHIFAlfoWw0kZlkDg3VCBTkxDjTh0h1\nQdrSzuI/Xbuklsp5VdeNyKXozUJN3yk3x71kEMoK0GWifQzk+5W/Q4PYk/oXQzkx\nWq5TVxuAuQ0YRz9aXBMIJTMHnpyY9VKxxKHhSqYZ2y30MSZ9yz30wvnqWVRHjKlV\nmi8WLRYmpT2pNyjhKBBAmbGzXSmAt27VQK5td95Of7hxYLJUkWo=\n=XWhE\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f8d4975ab3fcd3553843cf0862251289c88c106b",
          "sha": "f8d4975ab3fcd3553843cf0862251289c88c106b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f8d4975ab3fcd3553843cf0862251289c88c106b"
        }
      ],
      "message": "validation: Move FindFilesToPrune{,Manual} to BlockManager\n\n[META] No behaviour change is intended in this commit.\n[META] This commit should be followed up by removing the comments and\n       assertions meant only to show that the change is correct.\n\nAlso stop FindFilesToPrune{,Manual} from unnecessary reaching for\n::ChainActive() by passing in the necessary information.",
      "committer": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-09-21T17:27:44Z"
      },
      "author": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-08-25T23:38:23Z"
      },
      "sha": "3f5b5f3f6db0e5716911b3fba1460ce327e8a845"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0ODU4OTlhOTNjNmY1ZmZmNjIwOTA5MDdlZmIwYWM5Mzg5OTJlMWZi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/485899a93c6f5fff62090907efb0ac938992e1fb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/485899a93c6f5fff62090907efb0ac938992e1fb",
      "tree": {
        "sha": "5dc94a120b5f367119a6f9d8b3612344eba753c5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5dc94a120b5f367119a6f9d8b3612344eba753c5"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 5dc94a120b5f367119a6f9d8b3612344eba753c5\nparent 3f5b5f3f6db0e5716911b3fba1460ce327e8a845\nauthor Carl Dong <contact@carldong.me> 1600193364 -0400\ncommitter Carl Dong <contact@carldong.me> 1600709288 -0400\n\nstyle: Make FindFilesToPrune{,Manual} match style guide\n\n[META] This is a pure style commit.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEECc3SW1JEo3Z49u6oDMUhUxl5kaUFAl9o4qgACgkQDMUhUxl5\nkaUJ4Q//RW/z1Wg52AeFC4ULQXDT3Cftv7fJ6Oo2QLWaMNHX3iFpGbxoN/flqzzb\n8LkRlhkiLXcKWzOIT9+3mhF/mB1xNzvYHl5IFOWzHvOQdgJ9T0kBbWpnlxbLFIoU\nfamHi++YeOv5Bgf9xpPy80GWQDwQeUiRuK36rJhmbisM9R2f7kAarKVXQfuXo25H\ns6uzvHBcwLmrnDoB+trwXW10Y0599Squvzs6ebXB2qdBmrxhBzUwVCX9D0YDNJ6i\npues1Dqw/+nVzHqYrT5ekqyylK3GuIQ6qBRtddWC5tqIGVou2Gdslu1+2aW80etv\ncxd+c6wqpfGiULpkiMGjhlXtDVcY3Mdk95yPZ9ZL/4naLW3cP3IWkTPuLFsN3GzK\nCrCId9caDIp38vUczq/S20lA/+hlsFT6golptTG7a96A0jdaQR7HCa/SDqGKl/G2\no9tDYokoZfmhUX4+IS344HOqDA4KEbPg6ynnLuz46iX3xAaP0nKL8uHhfJkulAAh\n6l8HLOUnkkvCwYYPDSj7WsVomPtGcfnAavuO5H+nD1ANccTn0TR5qt8ku++iVo2Q\nNROkhmdDAXxYiiyHb3Qjgqq5DPg6ehuwScxLHyEX+SmVwQIEjxD/ZD1Y4N26kONj\nAW0id5OVbMg7UeUpJyyVdD7PyQByj1T7bB3gLmxraTpSyo2Y3Cc=\n=tHNk\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3f5b5f3f6db0e5716911b3fba1460ce327e8a845",
          "sha": "3f5b5f3f6db0e5716911b3fba1460ce327e8a845",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/3f5b5f3f6db0e5716911b3fba1460ce327e8a845"
        }
      ],
      "message": "style: Make FindFilesToPrune{,Manual} match style guide\n\n[META] This is a pure style commit.",
      "committer": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-09-21T17:28:08Z"
      },
      "author": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-09-15T18:09:24Z"
      },
      "sha": "485899a93c6f5fff62090907efb0ac938992e1fb"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzozNzU2ODUzYjE1OTAyZDYzZjRiNWEzMTI5ZThiNWQ4MmU4NGUxMjVi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3756853b15902d63f4b5a3129e8b5d82e84e125b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/3756853b15902d63f4b5a3129e8b5d82e84e125b",
      "tree": {
        "sha": "cb6874bb607d2459569bc40fb3f5bf5d98bf9616",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cb6874bb607d2459569bc40fb3f5bf5d98bf9616"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree cb6874bb607d2459569bc40fb3f5bf5d98bf9616\nparent 485899a93c6f5fff62090907efb0ac938992e1fb\nauthor Carl Dong <contact@carldong.me> 1600093152 -0400\ncommitter Carl Dong <contact@carldong.me> 1600709421 -0400\n\ndocs: Move FindFilesToPrune{,Manual} doxygen comment\n\n[META] This is a pure comment commit.\n\nThey belong in the member declarations in the header file.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEECc3SW1JEo3Z49u6oDMUhUxl5kaUFAl9o4zIACgkQDMUhUxl5\nkaWdERAAwAy9vlyJ/BtfGaD6X899guGKm5uIFcp2D0FTWupyFcThrgW4S1gDQFDa\nPfrrzsjQ/HYNWDKn2XOEGPgb5Vev/EkksFUNeqTo7zU/ZaxDbgvXtZ72tZsQHaYk\nZTedfLIN9FNoItyXearBTKUc8OCNIOb/32qoAVoPzR589RLRYUnW6/S3yaJGXMuP\nKMZU+Pmp65kfPHs0nV9//rF9iMWSxfS+eN0RePXezxP8E62qC0E9mGxDxbWfG+a5\nGhRaprv3hDeL6N96eYx5+sQMhVSJ20CEr1l9OLvHN22FnA6b+fusAtK7EB0vg/Vj\nxZcH/olF6PKM7PXR22NG31L02KCilc8Uw4RopnDkhXGRGvgdACQuwoDMc7FoiCXH\n0buOBEcSJki0rHNzxqAs3GACLHVKjeq368xzhEhMVtNOyIEaVY9Rx2ALn1A23slS\nYZU0HsYD7dLFqvVmuDSJ1/OMSAL+ZBCW072gSDqM07KU0HqHySZEHSMNfAdNe6wz\n4Z76BEi+Pden9SV664PYIXol4xPbcfI8GjVVQBIKnq0ZFbAD3ncloTp9E4tLTHBc\nNUZD0KMmxsb+V5exEPniYKQ9CSNKUUvWh+HpBLaXvB8CXouhr7I8tVSvt+8J9DlP\n8U/5AiupA8ZT1/IxIbbCACBUdMWW/d0+a9GzFgWBGmDVWliWU+U=\n=/rks\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/485899a93c6f5fff62090907efb0ac938992e1fb",
          "sha": "485899a93c6f5fff62090907efb0ac938992e1fb",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/485899a93c6f5fff62090907efb0ac938992e1fb"
        }
      ],
      "message": "docs: Move FindFilesToPrune{,Manual} doxygen comment\n\n[META] This is a pure comment commit.\n\nThey belong in the member declarations in the header file.",
      "committer": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-09-21T17:30:21Z"
      },
      "author": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-09-14T14:19:12Z"
      },
      "sha": "3756853b15902d63f4b5a3129e8b5d82e84e125b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3MmExZDVjNmYzODM0ZTIwNjcxOWVlNTEyMWRmNzcyN2FlZDViNzg2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/72a1d5c6f3834e206719ee5121df7727aed5b786",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/72a1d5c6f3834e206719ee5121df7727aed5b786",
      "tree": {
        "sha": "35c0f795a1adc5e1c9dc6b83f1e35f6320ce954f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/35c0f795a1adc5e1c9dc6b83f1e35f6320ce954f"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 35c0f795a1adc5e1c9dc6b83f1e35f6320ce954f\nparent 3756853b15902d63f4b5a3129e8b5d82e84e125b\nauthor Carl Dong <contact@carldong.me> 1600193764 -0400\ncommitter Carl Dong <contact@carldong.me> 1600709427 -0400\n\nvalidation: Remove review-only comments + assertions\n\n[META] This is a followup to \"validation: Move FindFilesToPrune{,Manual}\n       to BlockManager\" removing comments and assertions meant only to\n       show that the change is correct.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEECc3SW1JEo3Z49u6oDMUhUxl5kaUFAl9o4zMACgkQDMUhUxl5\nkaVVMBAAk3RtmQUBsvjR9mhIDnDsc1OkmWmIhXlvV2XKpSX4Dz9QN9R6G0BI/JFG\nTDM1Kc8R59nuOPp9IZV1hOanXI91o3GszwGtP03BEZrMadFcMzCzHw3qvWtEguaR\nYfuu4/Y80B5S5hC/UX6l/XvNVaPcgGhIcL+Zmw7nR3B49AdeuLrpBY2GRBbuYM4r\nGn8JA4lNpuas7hwgSHcRMoQiglh3cJY/ulrWpLrS9osxGsYcPuZ9kGWwrji9qzDV\nuzmxr8ZM1M2FNdBaPI3ThM/RXdmzz32n1U9OXcJH3GBXSZNl16u6VJz/w3P7uXqX\nTnBSwnMx90bMwRXDJlLTJqYMi/sIEGFUErxGiXIzFq0pNKhYsdWBNQBQ+OrlAxc6\nB5hTEZqUzUaRM/IY4QuvqHb8otFKq0GpIZQaYEs4+jbV7oB8QLkTYOgJkzJ69DAS\nHBrUdaoQFel7cRPZsgpgraaH5VeyOX6PCPHYQul9555n5wiVBTDKcPGjo+v8NzW5\nWMrLWP21LbUJ9YUdEcOEb8BOJ6K8e5iFq7zFrsgftT3qD9xGE8qYsWaYs1P67Xzb\n9HW2q42uFd7FWx/8soHlpcyZPxQC2Izs4y+kZJLgBCczBE/Umo/rkKyktkM0jTVt\nyJ3x67ra1qKOU7qEjaN2rdgeFSYGEMNoePBmOrFLx2Ioq4S6PT0=\n=OH5Q\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3756853b15902d63f4b5a3129e8b5d82e84e125b",
          "sha": "3756853b15902d63f4b5a3129e8b5d82e84e125b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/3756853b15902d63f4b5a3129e8b5d82e84e125b"
        }
      ],
      "message": "validation: Remove review-only comments + assertions\n\n[META] This is a followup to \"validation: Move FindFilesToPrune{,Manual}\n       to BlockManager\" removing comments and assertions meant only to\n       show that the change is correct.",
      "committer": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-09-21T17:30:27Z"
      },
      "author": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-09-15T18:16:04Z"
      },
      "sha": "72a1d5c6f3834e206719ee5121df7727aed5b786"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 3789813037,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50Mzc4OTgxMzAzNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3789813037",
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-21T17:33:42Z"
    },
    {
      "event": "commented",
      "id": 696262568,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY5NjI2MjU2OA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/696262568",
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-21T17:35:31Z",
      "updated_at": "2020-09-21T17:35:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "Made `FindFilesToPrune{,Manual}` private per Marco's [comment](https://github.com/bitcoin/bitcoin/pull/19927#issuecomment-695758685).\r\n\r\nPrevious code reviewers: this change can be reviewed with:\r\n\r\n```sh\r\ngit diff 75142a7 72a1d5c\r\n```",
      "user": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#issuecomment-696262568",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19927"
    },
    {
      "event": "reviewed",
      "id": 494515671,
      "node_id": "MDE3OlB1bGxSZXF1ZXN0UmV2aWV3NDk0NTE1Njcx",
      "url": null,
      "actor": null,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "utACK 72a1d5c6f3834e206719ee5121df7727aed5b786\r\n\r\nOne style suggestion inline. Only consider it if you retouch the branch.",
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#pullrequestreview-494515671",
      "submitted_at": "2020-09-23T10:26:26Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
    },
    {
      "event": "commented",
      "id": 697853851,
      "node_id": "MDEyOklzc3VlQ29tbWVudDY5Nzg1Mzg1MQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/697853851",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-23T18:34:34Z",
      "updated_at": "2020-09-23T18:34:34Z",
      "author_association": "MEMBER",
      "body": "re-ACK 72a1d5c6f3 👚\r\n\r\n<details><summary>Show signature and timestamp</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nre-ACK 72a1d5c6f3 👚\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUhTrAv+Ky3GNUn0kO04zX+7dsU23mPYIvAUJ/SRXBtSQID9lNph+93gmf29iMWM\r\n3eOnDT1KhSINP5mHGRX9j4loYTh2VxUE9Hwqzc/em4bfh+QcE/Fyjxx6uArGVZBQ\r\ncYCEwsoQ51nbp9/Yftt2UFQzjjtHXtEGn7KO++u2WDzpOtL8vdxOZTK+e0Xb6Gbd\r\nXJSDGf2D6YeAhElyMETc6TJQ3/E7nHTWurNjXVR/C6EbeeVzrTlaLmGVGUBqWcAf\r\nqcQjVHB3qrQHrXfr+bK6XlSOJ4/60T+Q801mX2AeUK4ygpgcsVpWquaviC1DqzfM\r\nkdrdssVPW9b5yuUM8ciaPxLTiXBqyzKVaUA8Q3CADsQClStA7MOfUItmo9HUs/Lz\r\nVWughvafPFfI+cbHkR3rvvvMcPza12/9sYYfCi+xHfw1CaMnjs5lvDD0Cw4ShGMH\r\nh/vJzV/MFnDquVrg/T1Cam1zkXf3bxGsc7K/mJh3wO99Kgf9X9nlS7Y77eQIeWx2\r\nbzQoIo/G\r\n=9glt\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n[Timestamp of file with hash `bcdea3595c56b92fa07e06e3a4cdb3a9a7439cb78f42e7fcdf109c35f3d1dd79  -`](https://opentimestamps.org/info/?004f70656e54696d657374616d7073000050726f6f6600bf89e2e884e892940108bcdea3595c56b92fa07e06e3a4cdb3a9a7439cb78f42e7fcdf109c35f3d1dd79f0108ff9d29c43c3d6dc694e93253a4531cc08fff0106dae1a5708a642bbde08f35182544b7908f1045f6b952bf0085abce0ed22949f0e0083dfe30d2ef90c8e232268747470733a2f2f6274632e63616c656e6461722e636174616c6c6178792e636f6df010c306f28c43b05661189d352bbe487e0008f1045f6b952cf008329198c87a3d41430083dfe30d2ef90c8e2c2b68747470733a2f2f626f622e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267)\r\n\r\n</details>\r\n",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#issuecomment-697853851",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19927"
    },
    {
      "event": "merged",
      "id": 3799514000,
      "node_id": "MDExOk1lcmdlZEV2ZW50Mzc5OTUxNDAwMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3799514000",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "1b313cacc99a1b372238f9036abed5491f9d28f7",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1b313cacc99a1b372238f9036abed5491f9d28f7",
      "created_at": "2020-09-23T18:37:09Z"
    },
    {
      "event": "closed",
      "id": 3799514010,
      "node_id": "MDExOkNsb3NlZEV2ZW50Mzc5OTUxNDAxMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3799514010",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-23T18:37:09Z"
    },
    {
      "event": "referenced",
      "id": 3799534221,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDM3OTk1MzQyMjE=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/3799534221",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "be4781cdfb230c9f2844234dfc82d5f57b2a03b4",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/be4781cdfb230c9f2844234dfc82d5f57b2a03b4",
      "created_at": "2020-09-23T18:42:45Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-30T19:37:57Z",
      "updated_at": "2020-09-30T19:37:57Z",
      "source": {
        "issue": {
          "id": 712225587,
          "node_id": "MDU6SXNzdWU3MTIyMjU1ODc=",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20049",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20049/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20049/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20049/events",
          "html_url": "https://github.com/bitcoin/bitcoin/issues/20049",
          "number": 20049,
          "state": "closed",
          "state_reason": "completed",
          "title": "De-globalizing ChainstateManager",
          "body": "## Update\r\n\r\nDraft overall changeset published in #20158, closing this in favor of discussing in #20158.\r\n\r\n## Prelude\r\nFrom my reading of past conversations and from a few offline chats, it seems that modularizing our consensus engine is a worthwhile first step towards a more complete isolation of said engine from non-consensus code.\r\n\r\nModularizing our consensus engine means that:\r\n\r\n1. We get clearer visibility into what currently lies in consensus codepaths **and** what depends on our consensus engine\r\n1. We can coalesce duplicate consensus initialization codepaths, mitigating against bugs that arise out of test/non-test initialization inconsistencies\r\n\r\n## De-globalizing `g_chainman`\r\n\r\nIn order to modularize our consensus engine, we need to first de-globalize the global `ChainstateManager` -- namely `g_chainman` -- as it and its dependencies are what makes up the bulk of our consensus engine. A few direct references to `g_chainman` have already been removed in #19927, however, its indirect uses (mainly via `::Chain(state|)Active()`) are numerous in our codebase and often used to ~~cheat~~ avoid obtaining a `ChainstateManager` reference.\r\n\r\nIn a series of PRs, I plan to remove the `g_chainman` global and ensure that codepaths which depend on our consensus engine have a non-global reference to the object they require (be it `ChainstateManger`, `CChainState`, `BlockManager`, or something more specific).\r\n\r\n### Order of commits\r\n\r\nAfter having reorganized my commits a few times, I've realized that the ordering of commits can drastically influence both the review complexity of each diff and the number of commits needed in total to achieve the same thing. My current approach is basically to \"continuously trim the leaves of the g_chainman call graph\".\r\n\r\nTake, as an example, the following call graph where all of these functions either directly or indirectly reference `g_chainman`/`::Chain(state|)Active()`:\r\n\r\n![ChainmanCall](https://user-images.githubusercontent.com/3445290/94731545-7c270400-0354-11eb-8725-046f53a2bcde.png)\r\n\r\nI can start with `Qux`, and do the following:\r\n1. Does it need all of `ChainstateManger`? Or does it just need a `CChainState`? Or just a `BlockManager`? Or just the `ChainstateManager::ActiveTip()`?\r\n2. If it already has the reference that it needs (as a member of the class it belongs to, as a function parameter, etc.) -> Use it\r\n3. If we're dealing with a function which looks like it should be a member of a class that would have that reference -> Move the function to that class\r\n4. Otherwise, we need to pass the reference to `Qux`.\r\n\r\nWhen we have to invoke the last two options, we propagate the dependency on `g_chainman`/`::Chain(state|)Active()` up to `Wibble` and `Wobble`. In the case of (3), it'll look something like `::ChainstateActive().Qux()`; whereas in the case of (4), it'll look something like `Qux(::ChainstateActive())`. \r\n\r\nThis mean that, for some functions (`LookupBlockIndex` being the main culprit), a resolution of their dependency on the `g_chainman`/`::Chain(state|)Active()` globals results in an increase in apparent references to `g_chainman`/`::Chain(state|)Active()`. However, it is important to note that these are not _new_ dependencies by any means, those dependency were always there -- they was just hidden by `Qux`'s use of the globals. Furthermore, all of these \"new\" apparent references to `g_chainman`/`::Chain(state|)Active()` will be dealt with as we prune the call graph upward.\r\n\r\n### Current status\r\n\r\nRight now, I have a working branch https://github.com/bitcoin/bitcoin/compare/master...dongcarl:2020-09-libbitcoinruntime-v5, which resolves of all the `g_chainman`/`::Chain(state|)Active()` global calls in `validation.{cpp,h}`. I noticed that for resolving these calls in validation, there are 3 somewhat distinct bundles that have a natural ordering:\r\n\r\n1. A bundle of functions that are related to `::LookupBlockIndex` in the call graph (see: #20050)\r\n2. A bundle of functions that are mempool-related\r\n\t- This has a dependency on bundle (1) as `MemPoolAccept::PreChecks` calls `::GetSpendHeight`, which is in bundle (1) as it calls `LookupBlockIndex`\r\n3. A bundle of functions which are not related to either\r\n\t-  This has a dependency on bundle (2) as `CChainState::{ActivateBestChainStep,InvalidateBlock}` both call `::UpdateMempoolForReorg` which is in bundle (2)\r\n\r\nI believe this bundling naturally splits up the validation cleanup into 3 pull requests, each touching around 12 functions.\r\n\r\nI'm still organizing the rest the non-validation commits and will be pushing that up when it's ready.\r\n\r\n**Note to reviewers**: At this stage I would very much like to get a sanity check on my approach to make sure that there isn't a better way to organize my commits that I've missed.",
          "user": {
            "login": "dongcarl",
            "id": 3445290,
            "node_id": "MDQ6VXNlcjM0NDUyOTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dongcarl",
            "html_url": "https://github.com/dongcarl",
            "followers_url": "https://api.github.com/users/dongcarl/followers",
            "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
            "organizations_url": "https://api.github.com/users/dongcarl/orgs",
            "repos_url": "https://api.github.com/users/dongcarl/repos",
            "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/dongcarl/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 64584,
              "node_id": "MDU6TGFiZWw2NDU4NA==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Brainstorming",
              "name": "Brainstorming",
              "color": "ebd775",
              "default": false
            },
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 1392286103,
              "node_id": "MDU6TGFiZWwxMzkyMjg2MTAz",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20Conceptual%20Review",
              "name": "Needs Conceptual Review",
              "description": "",
              "color": "fef2c0",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 6,
          "closed_at": "2020-10-15T18:29:32Z",
          "created_at": "2020-09-30T19:37:56Z",
          "updated_at": "2022-02-15T11:04:39Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-09-30T22:25:45Z",
      "updated_at": "2020-09-30T22:25:45Z",
      "source": {
        "issue": {
          "id": 712321424,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDk1ODIyNjY0",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20050",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20050/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20050/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20050/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/20050",
          "number": 20050,
          "state": "closed",
          "state_reason": null,
          "title": "validation: Prune (in)direct g_chainman usage related to ::LookupBlockIndex (bundle 1)",
          "body": "This PR builds on the work of #19927 towards #20049\r\n\r\nPlease see #20049 for the broader context, especially this section which applies specifically to this PR:\r\n\r\n> ...for some functions (`LookupBlockIndex` being the main culprit), a resolution of their dependency on the `g_chainman`/`::Chain(state|)Active()` globals results in an increase in apparent references to `g_chainman`/`::Chain(state|)Active()`. However, it is important to note that these are not _new_ dependencies by any means, those dependency were always there -- they was just hidden by `Qux`'s use of the globals. Furthermore, all of these \"new\" apparent references to `g_chainman`/`::Chain(state|)Active()` will be dealt with as we prune the call graph upward.\r\n\r\n\r\nPlease also read the note in the commit message of 407faf2ff364cc778083c145a77b0f150232121d (validation: Move FindForkInGlobalIndex to BlockManager), and let me know your thoughts.",
          "user": {
            "login": "dongcarl",
            "id": 3445290,
            "node_id": "MDQ6VXNlcjM0NDUyOTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dongcarl",
            "html_url": "https://github.com/dongcarl",
            "followers_url": "https://api.github.com/users/dongcarl/followers",
            "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
            "organizations_url": "https://api.github.com/users/dongcarl/orgs",
            "repos_url": "https://api.github.com/users/dongcarl/repos",
            "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/dongcarl/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 118379652,
              "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
              "name": "Validation",
              "color": "6060aa",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 1,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20050",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/20050",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/20050.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/20050.patch"
          },
          "closed_at": "2020-10-15T20:09:57Z",
          "created_at": "2020-09-30T22:25:45Z",
          "updated_at": "2022-02-15T10:48:40Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-10-15T18:32:17Z",
      "updated_at": "2020-10-15T18:32:17Z",
      "source": {
        "issue": {
          "id": 722569048,
          "node_id": "MDExOlB1bGxSZXF1ZXN0NTA0Mjk2MzUx",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20158",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20158/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20158/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20158/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/20158",
          "number": 20158,
          "state": "closed",
          "state_reason": null,
          "title": "tree-wide: De-globalize ChainstateManager",
          "body": "## Prelude\r\n\r\n**Note to reviewers**: Currently looking Code Review on Sub-PRs (see below)\r\n\r\nOriginally: #20049\r\n\r\n### Sub-PRs\r\n\r\n_Last updated May 9th, 2020_\r\n\r\n- [x] #20323 | tests: Create or use existing properly initialized NodeContexts\r\n- [x] #20946 | fuzz: Consolidate fuzzing TestingSetup initialization\r\n- [x] #20972 | locks: Annotate CTxMemPool::check to require cs_main\r\n- [x] #20749 | [Bundle 1/n] Prune g_chainman usage related to ::LookupBlockIndex\r\n- [x] #20750 | [Bundle 2/n] Prune g_chainman usage in mempool-related validation functions\r\n- [x] #21055 | [Bundle 3/n] Prune remaining g_chainman usage in validation functions\r\n- [x] #21270 | [Bundle 4/n] Prune g_chainman usage in validation-adjacent modules\r\n- [x] #21391 | [Bundle 5/n] Prune g_chainman usage in RPC modules\r\n- [x] #21767 | [Bundle 6/n] Prune g_chainman usage in auxiliary modules\r\n- [x] #21866 | [Bundle 7/n] Farewell, global Chainstate!\r\n\r\n### Todo List\r\n\r\n_Last updated Feb 1st, 2020_\r\n\r\n- [x] Address ryanofsky's comments\r\n\t- [x] https://github.com/bitcoin/bitcoin/pull/20158#discussion_r520639845\r\n\r\n## Motivation\r\n\r\n###  Modularizing our consensus engine\r\n\r\nExcerpt from #20049\r\n> From my reading of past conversations and from a few offline chats, it seems that modularizing our consensus engine is a worthwhile first step towards a more complete isolation of said engine from non-consensus code.\r\n> \r\n> Modularizing our consensus engine means that:\r\n> \r\n> 1. We get clearer visibility into what currently lies in consensus codepaths **and** what depends on our consensus engine\r\n> 1. We can coalesce duplicate consensus initialization codepaths, mitigating against bugs that arise out of test/non-test initialization inconsistencies\r\n\r\n### De-globalizing `g_chainman`\r\n\r\nExcerpt from #20049\r\n> In order to modularize our consensus engine, we need to first de-globalize the global `ChainstateManager` -- namely `g_chainman` -- as it and its dependencies are what makes up the bulk of our consensus engine. A few direct references to `g_chainman` have already been removed in #19927, however, its indirect uses (mainly via `::Chain(state|)Active()`) are numerous in our codebase and often used to ~~cheat~~ avoid obtaining a `ChainstateManager` reference.\r\n\r\n## Description\r\n\r\nThis changeset moves the global `ChainstateManger` to `NodeContext` and removes `::Chain{state,}Active()` as a first step towards better modularization of our consensus engine. \r\n\r\nThe commits are ordered as such:\r\n1. Fixes to our existing codebase crucial to subsequent changes in this changeset\r\nhttps://github.com/bitcoin/bitcoin/compare/master...dongcarl:2020-10-chainman-fixes\r\n1. Remove all references to `g_chainman`, `::Chain{state,}Active()`\r\n\t1. In `src/validation.{cpp,h}`\r\n\t\t1. In a bundle of functions related to `::LookupBlockIndex` in the call graph\r\n\t\thttps://github.com/dongcarl/bitcoin/compare/2020-10-chainman-fixes...dongcarl:2020-09-libbitcoinruntime-v4\r\n\t\t1. In a bundle of functions that are mempool-related\r\n\t\thttps://github.com/dongcarl/bitcoin/compare/dongcarl:2020-09-libbitcoinruntime-v4...2020-09-reduce-validation-mempool-ccsactiveglobal-usage\r\n\t\t1. In a bundle of functions which do not belong in previous bundles\r\n\t\thttps://github.com/dongcarl/bitcoin/compare/2020-09-reduce-validation-mempool-ccsactiveglobal-usage...dongcarl:2020-09-reduce-validation-ccsactiveglobal-usage\r\n\t1. In \"validation-adjacent\" modules of the codebase\r\n\thttps://github.com/dongcarl/bitcoin/compare/dongcarl:2020-09-reduce-validation-ccsactiveglobal-usage...2020-09-libbitcoinruntime-v6\r\n\t\t1. In `src/txmempool.cpp`\r\n\t\t1. In `src/miner.cpp`\r\n\t\t1. In `src/node`\r\n\t\t1. In `src/net_processing.cpp`\r\n\t1. In RPC modules of the codebase\r\n\thttps://github.com/dongcarl/bitcoin/compare/2020-09-libbitcoinruntime-v6...dongcarl:2020-10-libbitcoinruntime-v7\r\n\t\t1. In `src/rpc`\r\n\t\t1. In `src/rest.cpp`\r\n\t1. In auxiliary modules of the codebase\r\n\thttps://github.com/dongcarl/bitcoin/compare/dongcarl:2020-10-libbitcoinruntime-v7...2020-10-libbitcoinruntime-v8\r\n\t\t1. In `src/bench`\r\n\t\t1. In `src/index`\r\n\t1. In initialization codepaths and tests\r\n\thttps://github.com/dongcarl/bitcoin/compare/2020-10-libbitcoinruntime-v8...dongcarl:2020-06-libbitcoinruntime\r\n\t\t1. In `src/init.cpp`\r\n\t\t1. In `src/test`\r\n\t\t1. In `src/wallet/test`\r\n\t\t1. In `src/qt/test`\r\n\r\nA few things to note:\r\n- The above ordering is constructed according to the overall call graph of our codebase such that we avoid touching the same function/module twice. \r\n- Due to the length of this overall change, each commit aims to be trivially-reviewable and only requires the reviewer to reason about the correctness of one function/module at a time.\r\n- There are a lot of review-only assertions which can be used to check for correctness. They are removed in 2236237070a45fe570cd0113f0025b0a46ac89be.\r\n",
          "user": {
            "login": "dongcarl",
            "id": 3445290,
            "node_id": "MDQ6VXNlcjM0NDUyOTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dongcarl",
            "html_url": "https://github.com/dongcarl",
            "followers_url": "https://api.github.com/users/dongcarl/followers",
            "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
            "organizations_url": "https://api.github.com/users/dongcarl/orgs",
            "repos_url": "https://api.github.com/users/dongcarl/repos",
            "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/dongcarl/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135946,
              "node_id": "MDU6TGFiZWwxMzU5NDY=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/GUI",
              "name": "GUI",
              "color": "02d7e1",
              "default": false
            },
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 97470796,
              "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
              "name": "UTXO Db and Indexes",
              "color": "fbca04",
              "default": false
            },
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            },
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            },
            {
              "id": 118378960,
              "node_id": "MDU6TGFiZWwxMTgzNzg5NjA=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Mining",
              "name": "Mining",
              "color": "c7def8",
              "default": false
            },
            {
              "id": 118379652,
              "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
              "name": "Validation",
              "color": "6060aa",
              "default": false
            },
            {
              "id": 164208572,
              "node_id": "MDU6TGFiZWwxNjQyMDg1NzI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Mempool",
              "name": "Mempool",
              "color": "fef2c0",
              "default": false
            },
            {
              "id": 192202000,
              "node_id": "MDU6TGFiZWwxOTIyMDIwMDA=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Consensus",
              "name": "Consensus",
              "color": "009800",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 17,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20158",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/20158",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/20158.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/20158.patch"
          },
          "closed_at": "2021-06-16T16:19:42Z",
          "created_at": "2020-10-15T18:28:35Z",
          "updated_at": "2022-11-27T09:59:55Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "referenced",
      "id": 4558542626,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQ1NTg1NDI2MjY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4558542626",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "ed479bb9b659b98aee159a0e75a81b3a35e78ee0",
      "commit_url": "https://api.github.com/repos/jamesob/bitcoin/commits/ed479bb9b659b98aee159a0e75a81b3a35e78ee0",
      "created_at": "2021-04-06T18:53:47Z"
    },
    {
      "event": "referenced",
      "id": 4558718765,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDQ1NTg3MTg3NjU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/4558718765",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "361dd79c27cb5760ad68fdacf346cc26b8f588c3",
      "commit_url": "https://api.github.com/repos/jamesob/bitcoin/commits/361dd79c27cb5760ad68fdacf346cc26b8f588c3",
      "created_at": "2021-04-06T19:36:33Z"
    },
    {
      "event": "referenced",
      "id": 5048418677,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUwNDg0MTg2Nzc=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5048418677",
      "actor": {
        "login": "deadalnix",
        "id": 854121,
        "node_id": "MDQ6VXNlcjg1NDEyMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/854121?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/deadalnix",
        "html_url": "https://github.com/deadalnix",
        "followers_url": "https://api.github.com/users/deadalnix/followers",
        "following_url": "https://api.github.com/users/deadalnix/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/deadalnix/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/deadalnix/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/deadalnix/subscriptions",
        "organizations_url": "https://api.github.com/users/deadalnix/orgs",
        "repos_url": "https://api.github.com/users/deadalnix/repos",
        "events_url": "https://api.github.com/users/deadalnix/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/deadalnix/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "37142f8783a605a4fa546d1cfff70496e4fc586b",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/37142f8783a605a4fa546d1cfff70496e4fc586b",
      "created_at": "2021-07-21T07:05:08Z"
    },
    {
      "event": "referenced",
      "id": 5048418679,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUwNDg0MTg2Nzk=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5048418679",
      "actor": {
        "login": "deadalnix",
        "id": 854121,
        "node_id": "MDQ6VXNlcjg1NDEyMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/854121?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/deadalnix",
        "html_url": "https://github.com/deadalnix",
        "followers_url": "https://api.github.com/users/deadalnix/followers",
        "following_url": "https://api.github.com/users/deadalnix/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/deadalnix/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/deadalnix/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/deadalnix/subscriptions",
        "organizations_url": "https://api.github.com/users/deadalnix/orgs",
        "repos_url": "https://api.github.com/users/deadalnix/repos",
        "events_url": "https://api.github.com/users/deadalnix/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/deadalnix/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "0082bd045768a6bbf03f30d39facca854b1c8e33",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/0082bd045768a6bbf03f30d39facca854b1c8e33",
      "created_at": "2021-07-21T07:05:08Z"
    },
    {
      "event": "referenced",
      "id": 5048418685,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUwNDg0MTg2ODU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5048418685",
      "actor": {
        "login": "deadalnix",
        "id": 854121,
        "node_id": "MDQ6VXNlcjg1NDEyMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/854121?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/deadalnix",
        "html_url": "https://github.com/deadalnix",
        "followers_url": "https://api.github.com/users/deadalnix/followers",
        "following_url": "https://api.github.com/users/deadalnix/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/deadalnix/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/deadalnix/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/deadalnix/subscriptions",
        "organizations_url": "https://api.github.com/users/deadalnix/orgs",
        "repos_url": "https://api.github.com/users/deadalnix/repos",
        "events_url": "https://api.github.com/users/deadalnix/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/deadalnix/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "046b04cb79e9902eccce76eb5adfccc6b5a5bb91",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/046b04cb79e9902eccce76eb5adfccc6b5a5bb91",
      "created_at": "2021-07-21T07:05:08Z"
    },
    {
      "event": "referenced",
      "id": 5048482884,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUwNDg0ODI4ODQ=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5048482884",
      "actor": {
        "login": "Fabcien",
        "id": 44533924,
        "node_id": "MDQ6VXNlcjQ0NTMzOTI0",
        "avatar_url": "https://avatars.githubusercontent.com/u/44533924?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Fabcien",
        "html_url": "https://github.com/Fabcien",
        "followers_url": "https://api.github.com/users/Fabcien/followers",
        "following_url": "https://api.github.com/users/Fabcien/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Fabcien/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Fabcien/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Fabcien/subscriptions",
        "organizations_url": "https://api.github.com/users/Fabcien/orgs",
        "repos_url": "https://api.github.com/users/Fabcien/repos",
        "events_url": "https://api.github.com/users/Fabcien/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Fabcien/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "a9ecaa69dc3cc3900973dc394b7cca99013148ba",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/a9ecaa69dc3cc3900973dc394b7cca99013148ba",
      "created_at": "2021-07-21T07:19:30Z"
    },
    {
      "event": "referenced",
      "id": 5048485575,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDUwNDg0ODU1NzU=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5048485575",
      "actor": {
        "login": "deadalnix",
        "id": 854121,
        "node_id": "MDQ6VXNlcjg1NDEyMQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/854121?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/deadalnix",
        "html_url": "https://github.com/deadalnix",
        "followers_url": "https://api.github.com/users/deadalnix/followers",
        "following_url": "https://api.github.com/users/deadalnix/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/deadalnix/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/deadalnix/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/deadalnix/subscriptions",
        "organizations_url": "https://api.github.com/users/deadalnix/orgs",
        "repos_url": "https://api.github.com/users/deadalnix/repos",
        "events_url": "https://api.github.com/users/deadalnix/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/deadalnix/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "e551bfacbff77458de6ac71f2ece857778dfdf91",
      "commit_url": "https://api.github.com/repos/Bitcoin-ABC/bitcoin-abc/commits/e551bfacbff77458de6ac71f2ece857778dfdf91",
      "created_at": "2021-07-21T07:20:07Z"
    },
    {
      "event": "locked",
      "id": 6073909534,
      "node_id": "LOE_lADOABII584pi16WzwAAAAFqCIEe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6073909534",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-02-15T10:48:39Z",
      "lock_reason": "resolved"
    },
    {
      "event": "subscribed",
      "id": 7547083800,
      "node_id": "SE_lADOABII584pi16WzwAAAAHB11wY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7547083800",
      "actor": {
        "login": "Leylimahmud",
        "id": 99537361,
        "node_id": "U_kgDOBe7R0Q",
        "avatar_url": "https://avatars.githubusercontent.com/u/99537361?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Leylimahmud",
        "html_url": "https://github.com/Leylimahmud",
        "followers_url": "https://api.github.com/users/Leylimahmud/followers",
        "following_url": "https://api.github.com/users/Leylimahmud/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Leylimahmud/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Leylimahmud/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Leylimahmud/subscriptions",
        "organizations_url": "https://api.github.com/users/Leylimahmud/orgs",
        "repos_url": "https://api.github.com/users/Leylimahmud/repos",
        "events_url": "https://api.github.com/users/Leylimahmud/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Leylimahmud/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-07T23:47:36Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485866325",
      "pull_request_review_id": 485345020,
      "id": 485866325,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTg2NjMyNQ==",
      "diff_hunk": "@@ -1559,7 +1559,7 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n                 chainman.m_total_coinstip_cache = nCoinCacheUsage;\n                 chainman.m_total_coinsdb_cache = nCoinDBCache;\n \n-                UnloadBlockIndex(node.mempool.get());\n+                UnloadBlockIndex(node.mempool.get(), &chainman);",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "bc872e44e29f7108720072a7d37ce06fb069ba4f",
      "in_reply_to_id": null,
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in commit bc872e44e29f7108720072a7d37ce06fb069ba4f: Doesn't it make more sense to pass it as `this` (i.e. make it a member function)?\r\n\r\nI've done that in #19909 (commit facd88a77189f6953d28a6743e0c68175bc18f9e)\r\n\r\nConceptually it makes little sense for chainman to be optional. Why would you want to run a node with validation disabled? So, if you don't like to make it a member function, I'd say to at least pass it as reference.",
      "created_at": "2020-09-09T19:36:08Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r485866325",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/485866325"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1562,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486483452",
      "pull_request_review_id": 486118979,
      "id": 486483452,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQ4MzQ1Mg==",
      "diff_hunk": "@@ -1559,7 +1559,7 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n                 chainman.m_total_coinstip_cache = nCoinCacheUsage;\n                 chainman.m_total_coinsdb_cache = nCoinDBCache;\n \n-                UnloadBlockIndex(node.mempool.get());\n+                UnloadBlockIndex(node.mempool.get(), &chainman);",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "bc872e44e29f7108720072a7d37ce06fb069ba4f",
      "in_reply_to_id": 485866325,
      "user": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think in this particular instance, I prefer the latter solution of passing `chainman` as a reference, simply because `UnloadBlockIndex` touches so many validation globals that are not owned by `chainman`. Perhaps in the future when we move those globals into `chainman` or some other validation-container class, it would make more sense to do so.\r\n\r\nI was worried about callers (to `UnloadBlockIndex`) who only have a pointer to `chainman`, but the only caller I see that only has a pointer to `chainman` is `~TestingSetup`, and it already looks like it makes the assumption that `m_node.chainman` is not null (see the `m_node.chainman->Reset()` line in `~TestingSetup`). Will make the change and take a look at your PR too.",
      "created_at": "2020-09-10T16:38:34Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r486483452",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486483452"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1562,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/487556665",
      "pull_request_review_id": 487326578,
      "id": 487556665,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU1NjY2NQ==",
      "diff_hunk": "@@ -407,6 +407,12 @@ class BlockManager {\n     /** Create a new block index entry for a given block hash */\n     CBlockIndex* InsertBlockIndex(const uint256& hash) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n \n+    //! Mark one block file as pruned (modify associated database entries)\n+    void PruneOneBlockFile(const int fileNumber) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n+\n+    // See definition for documentation",
      "path": "src/validation.h",
      "position": null,
      "original_position": 16,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "86cb85e77fb960452f904190a3eec892dc7185ef",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Move the doxygen comments here (this comment made sense when it was next to a forward declaration, but now that the declaration is in the header file, it should have the doxygen comment)",
      "created_at": "2020-09-13T17:42:19Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r487556665",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/487556665"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/487556828",
      "pull_request_review_id": 487326578,
      "id": 487556828,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU1NjgyOA==",
      "diff_hunk": "@@ -914,6 +917,15 @@ class ChainstateManager\n     //! Check to see if caches are out of balance and if so, call\n     //! ResizeCoinsCaches() as needed.\n     void MaybeRebalanceCaches() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\n+\n+    ~ChainstateManager() {",
      "path": "src/validation.h",
      "position": null,
      "original_position": 37,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "86cb85e77fb960452f904190a3eec892dc7185ef",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Did you consider moving this logic to the `BlockManager` dtor instead of here? There's only ever one `BlockManager` instance (inside `ChainstateManager`), so destruction will happen at the same time. All the logic in this function is on `BlockManager` data.",
      "created_at": "2020-09-13T17:44:02Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r487556828",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/487556828"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 921,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/487556868",
      "pull_request_review_id": 487326578,
      "id": 487556868,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU1Njg2OA==",
      "diff_hunk": "@@ -914,6 +917,15 @@ class ChainstateManager\n     //! Check to see if caches are out of balance and if so, call\n     //! ResizeCoinsCaches() as needed.\n     void MaybeRebalanceCaches() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\n+\n+    ~ChainstateManager() {\n+        // block headers",
      "path": "src/validation.h",
      "position": null,
      "original_position": 38,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "86cb85e77fb960452f904190a3eec892dc7185ef",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Remove useless comment.",
      "created_at": "2020-09-13T17:44:24Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r487556868",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/487556868"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 922,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/487556989",
      "pull_request_review_id": 487326578,
      "id": 487556989,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU1Njk4OQ==",
      "diff_hunk": "@@ -914,6 +917,15 @@ class ChainstateManager\n     //! Check to see if caches are out of balance and if so, call\n     //! ResizeCoinsCaches() as needed.\n     void MaybeRebalanceCaches() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\n+\n+    ~ChainstateManager() {\n+        // block headers\n+        BlockMap::iterator it1 = BlockIndex().begin();\n+        for (; it1 != BlockIndex().end(); it1++) {",
      "path": "src/validation.h",
      "position": null,
      "original_position": 40,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "86cb85e77fb960452f904190a3eec892dc7185ef",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        for (auto it = BlockIndex().begin; it != BlockIndex().end(); ++it) {\r\n```",
      "created_at": "2020-09-13T17:45:07Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r487556989",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/487556989"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": 923,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 924,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/487577035",
      "pull_request_review_id": 487339580,
      "id": 487577035,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU3NzAzNQ==",
      "diff_hunk": "@@ -914,6 +917,15 @@ class ChainstateManager\n     //! Check to see if caches are out of balance and if so, call\n     //! ResizeCoinsCaches() as needed.\n     void MaybeRebalanceCaches() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\n+\n+    ~ChainstateManager() {",
      "path": "src/validation.h",
      "position": null,
      "original_position": 37,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "86cb85e77fb960452f904190a3eec892dc7185ef",
      "in_reply_to_id": 487556828,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Actually, can't you just call `BlockManager::Unload()` in the `BlockManager` dtor?",
      "created_at": "2020-09-13T21:02:29Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r487577035",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/487577035"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 921,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488013284",
      "pull_request_review_id": 487878280,
      "id": 488013284,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAxMzI4NA==",
      "diff_hunk": "@@ -407,6 +407,12 @@ class BlockManager {\n     /** Create a new block index entry for a given block hash */\n     CBlockIndex* InsertBlockIndex(const uint256& hash) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n \n+    //! Mark one block file as pruned (modify associated database entries)\n+    void PruneOneBlockFile(const int fileNumber) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n+\n+    // See definition for documentation",
      "path": "src/validation.h",
      "position": null,
      "original_position": 16,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "86cb85e77fb960452f904190a3eec892dc7185ef",
      "in_reply_to_id": 487556665,
      "user": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Resolved in cdd2063bbe8b8df4db42c81ee7913e2dc0b2387a",
      "created_at": "2020-09-14T15:15:42Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r488013284",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488013284"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488013483",
      "pull_request_review_id": 487878533,
      "id": 488013483,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAxMzQ4Mw==",
      "diff_hunk": "@@ -914,6 +917,15 @@ class ChainstateManager\n     //! Check to see if caches are out of balance and if so, call\n     //! ResizeCoinsCaches() as needed.\n     void MaybeRebalanceCaches() EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\n+\n+    ~ChainstateManager() {",
      "path": "src/validation.h",
      "position": null,
      "original_position": 37,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "86cb85e77fb960452f904190a3eec892dc7185ef",
      "in_reply_to_id": 487556828,
      "user": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Resolved in 4668ded6d6ea4299d998abbb57543f37519812e2",
      "created_at": "2020-09-14T15:15:59Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r488013483",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488013483"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 921,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488599503",
      "pull_request_review_id": 488595575,
      "id": 488599503,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU5OTUwMw==",
      "diff_hunk": "@@ -3957,22 +3993,22 @@ void UnlinkPrunedFiles(const std::set<int>& setFilesToPrune)\n     }\n }\n \n-/* Calculate the block/rev files to delete based on height specified by user with RPC command pruneblockchain */\n-static void FindFilesToPruneManual(ChainstateManager& chainman, std::set<int>& setFilesToPrune, int nManualPruneHeight)\n+void BlockManager::FindFilesToPruneManual(std::set<int>& setFilesToPrune, int nManualPruneHeight, int chain_tip_height)\n {\n     assert(fPruneMode && nManualPruneHeight > 0);\n \n     LOCK2(cs_main, cs_LastBlockFile);\n-    if (::ChainActive().Tip() == nullptr)\n+    if (chain_tip_height < 0)\n         return;\n \n+",
      "path": "src/validation.cpp",
      "position": 69,
      "original_position": 111,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "cdd2063bbe8b8df4db42c81ee7913e2dc0b2387a",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "style: no need for extra line break.",
      "created_at": "2020-09-15T11:42:54Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r488599503",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488599503"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3965,
      "original_line": 3965,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488599779",
      "pull_request_review_id": 488595575,
      "id": 488599779,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODU5OTc3OQ==",
      "diff_hunk": "@@ -3957,22 +3993,22 @@ void UnlinkPrunedFiles(const std::set<int>& setFilesToPrune)\n     }\n }\n \n-/* Calculate the block/rev files to delete based on height specified by user with RPC command pruneblockchain */\n-static void FindFilesToPruneManual(ChainstateManager& chainman, std::set<int>& setFilesToPrune, int nManualPruneHeight)\n+void BlockManager::FindFilesToPruneManual(std::set<int>& setFilesToPrune, int nManualPruneHeight, int chain_tip_height)\n {\n     assert(fPruneMode && nManualPruneHeight > 0);\n \n     LOCK2(cs_main, cs_LastBlockFile);\n-    if (::ChainActive().Tip() == nullptr)\n+    if (chain_tip_height < 0)",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 108,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "cdd2063bbe8b8df4db42c81ee7913e2dc0b2387a",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "style: when touching lines, fix code to match style guide (here, join the line below with this or add braces)",
      "created_at": "2020-09-15T11:43:23Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r488599779",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488599779"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4001,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488604129",
      "pull_request_review_id": 488601128,
      "id": 488604129,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODYwNDEyOQ==",
      "diff_hunk": "@@ -1559,7 +1559,7 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n                 chainman.m_total_coinstip_cache = nCoinCacheUsage;\n                 chainman.m_total_coinsdb_cache = nCoinDBCache;\n \n-                UnloadBlockIndex(node.mempool.get());\n+                UnloadBlockIndex(node.mempool.get(), &chainman);",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "bc872e44e29f7108720072a7d37ce06fb069ba4f",
      "in_reply_to_id": 485866325,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I agree conceptually that UnloadBlockIndex should eventually be a member function of chainman, but also agree that we don't need to do everything in one PR.",
      "created_at": "2020-09-15T11:50:51Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r488604129",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488604129"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1562,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488737959",
      "pull_request_review_id": 488777314,
      "id": 488737959,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODczNzk1OQ==",
      "diff_hunk": "@@ -84,8 +84,11 @@ void AppTests::appTests()\n     // Reset global state to avoid interfering with later tests.\n     LogInstance().DisconnectTestLogger();\n     AbortShutdown();\n-    UnloadBlockIndex(/* mempool */ nullptr);\n-    WITH_LOCK(::cs_main, g_chainman.Reset());\n+    {\n+        LOCK(cs_main);\n+        UnloadBlockIndex(/* mempool */ nullptr, g_chainman);",
      "path": "src/qt/test/apptests.cpp",
      "position": 8,
      "original_position": 8,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "577ec184bd47b3e88a1d3e60b4d2045bd51328b4",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"validation: Pass in chainman to UnloadBlockIndex\" (577ec184bd47b3e88a1d3e60b4d2045bd51328b4)\r\n\r\nre: [META] This is a pure refactor commit.\r\n\r\nTrivial: I'd call this \"mostly pure refactor\" instead of \"pure refactor\" because cs_main is no longer released between UnloadBlockIndex and chainstate reset (which I think is nontrivial, closing various coin views)\r\n\r\nAm also curious about origin of `[META]` tags. They seems funny because I'd expect a meta comment in the commit description to be a comment about the commit description (:exploding_head:), not a comment about the commit. Anyway, I like the tags and they seem good for describing changes in a uniform way.",
      "created_at": "2020-09-15T14:59:46Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r488737959",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488737959"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 89,
      "original_line": 89,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488746432",
      "pull_request_review_id": 488777314,
      "id": 488746432,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODc0NjQzMg==",
      "diff_hunk": "@@ -2284,14 +2281,53 @@ bool CChainState::FlushStateToDisk(\n         CoinsCacheSizeState cache_state = GetCoinsCacheSizeState(&m_mempool);\n         LOCK(cs_LastBlockFile);\n         if (fPruneMode && (fCheckForPruning || nManualPruneHeight > 0) && !fReindex) {\n+            // Previously, we called the global function ::ChainActive() in\n+            // FindFilesToPrune{,Manual} to get the tip height and to determine\n+            // whether or not a tip even exists. Now, we are simply passing in\n+            // m_chain.Height() (which returns -1 if the tip doesn't exist). To\n+            // make sure we're not changing behaviour, let's check that\n+            // ::ChainActive() is the same object as m_chain (not just\n+            // identical).\n+            //\n+            // This comment and the following assert will be removed in a\n+            // subsequent commit, as they're just meant to demonstrate\n+            // correctness (you can run tests against it and see that nothing\n+            // exit unexpectedly).\n+            assert(std::addressof(::ChainActive()) == std::addressof(m_chain));",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 26,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "84d983656f1927955e516a94366b7c216bacded3",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In commit \"validation: Move FindFilesToPrune{,Manual} to BlockManager\" (84d983656f1927955e516a94366b7c216bacded3)\r\n\r\nNice way of verifying, and didn't know about std::addressof!",
      "created_at": "2020-09-15T15:10:45Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r488746432",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488746432"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2296,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488874237",
      "pull_request_review_id": 488949580,
      "id": 488874237,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg3NDIzNw==",
      "diff_hunk": "@@ -3957,22 +3993,22 @@ void UnlinkPrunedFiles(const std::set<int>& setFilesToPrune)\n     }\n }\n \n-/* Calculate the block/rev files to delete based on height specified by user with RPC command pruneblockchain */\n-static void FindFilesToPruneManual(ChainstateManager& chainman, std::set<int>& setFilesToPrune, int nManualPruneHeight)\n+void BlockManager::FindFilesToPruneManual(std::set<int>& setFilesToPrune, int nManualPruneHeight, int chain_tip_height)\n {\n     assert(fPruneMode && nManualPruneHeight > 0);\n \n     LOCK2(cs_main, cs_LastBlockFile);\n-    if (::ChainActive().Tip() == nullptr)\n+    if (chain_tip_height < 0)\n         return;\n \n+",
      "path": "src/validation.cpp",
      "position": 69,
      "original_position": 111,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "cdd2063bbe8b8df4db42c81ee7913e2dc0b2387a",
      "in_reply_to_id": 488599503,
      "user": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Resolved in fe07ba16511bd119b6ed744e68adfb3210a84254",
      "created_at": "2020-09-15T18:23:51Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r488874237",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488874237"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3965,
      "original_line": 3965,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488874403",
      "pull_request_review_id": 488949768,
      "id": 488874403,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg3NDQwMw==",
      "diff_hunk": "@@ -3957,22 +3993,22 @@ void UnlinkPrunedFiles(const std::set<int>& setFilesToPrune)\n     }\n }\n \n-/* Calculate the block/rev files to delete based on height specified by user with RPC command pruneblockchain */\n-static void FindFilesToPruneManual(ChainstateManager& chainman, std::set<int>& setFilesToPrune, int nManualPruneHeight)\n+void BlockManager::FindFilesToPruneManual(std::set<int>& setFilesToPrune, int nManualPruneHeight, int chain_tip_height)\n {\n     assert(fPruneMode && nManualPruneHeight > 0);\n \n     LOCK2(cs_main, cs_LastBlockFile);\n-    if (::ChainActive().Tip() == nullptr)\n+    if (chain_tip_height < 0)",
      "path": "src/validation.cpp",
      "position": null,
      "original_position": 108,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "cdd2063bbe8b8df4db42c81ee7913e2dc0b2387a",
      "in_reply_to_id": 488599779,
      "user": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Resolved in 597ec8a853df20fc68892b5f1131d27a1f2cf0e5",
      "created_at": "2020-09-15T18:24:07Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r488874403",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488874403"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4001,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488876301",
      "pull_request_review_id": 488952177,
      "id": 488876301,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODg3NjMwMQ==",
      "diff_hunk": "@@ -84,8 +84,11 @@ void AppTests::appTests()\n     // Reset global state to avoid interfering with later tests.\n     LogInstance().DisconnectTestLogger();\n     AbortShutdown();\n-    UnloadBlockIndex(/* mempool */ nullptr);\n-    WITH_LOCK(::cs_main, g_chainman.Reset());\n+    {\n+        LOCK(cs_main);\n+        UnloadBlockIndex(/* mempool */ nullptr, g_chainman);",
      "path": "src/qt/test/apptests.cpp",
      "position": 8,
      "original_position": 8,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "577ec184bd47b3e88a1d3e60b4d2045bd51328b4",
      "in_reply_to_id": 488737959,
      "user": {
        "login": "dongcarl",
        "id": 3445290,
        "node_id": "MDQ6VXNlcjM0NDUyOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dongcarl",
        "html_url": "https://github.com/dongcarl",
        "followers_url": "https://api.github.com/users/dongcarl/followers",
        "following_url": "https://api.github.com/users/dongcarl/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dongcarl/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dongcarl/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
        "organizations_url": "https://api.github.com/users/dongcarl/orgs",
        "repos_url": "https://api.github.com/users/dongcarl/repos",
        "events_url": "https://api.github.com/users/dongcarl/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dongcarl/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Resolved in 74f73c783d46b012f375d819e2cd09c792820cd5 (I just removed that comment since \"mostly pure refactor\" isn't too meaningful :smile: \r\n\r\nFor the `[META]` tags, I literally just came up with it randomly, mostly to describe high-level things that apply to the entire commit or things that reference other commits.",
      "created_at": "2020-09-15T18:27:29Z",
      "updated_at": "2020-09-21T17:33:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r488876301",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/488876301"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 89,
      "original_line": 89,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/493421238",
      "pull_request_review_id": 494515671,
      "id": 493421238,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzQyMTIzOA==",
      "diff_hunk": "@@ -356,7 +356,31 @@ struct CBlockIndexWorkComparator\n  * This data is used mostly in `CChainState` - information about, e.g.,\n  * candidate tips is not maintained here.\n  */\n-class BlockManager {\n+class BlockManager\n+{\n+    friend CChainState;\n+\n+private:\n+    /* Calculate the block/rev files to delete based on height specified by user with RPC command pruneblockchain */",
      "path": "src/validation.h",
      "position": 19,
      "original_position": 19,
      "commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "original_commit_id": "72a1d5c6f3834e206719ee5121df7727aed5b786",
      "in_reply_to_id": null,
      "user": {
        "login": "jnewbery",
        "id": 1063656,
        "node_id": "MDQ6VXNlcjEwNjM2NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jnewbery",
        "html_url": "https://github.com/jnewbery",
        "followers_url": "https://api.github.com/users/jnewbery/followers",
        "following_url": "https://api.github.com/users/jnewbery/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jnewbery/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jnewbery/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
        "organizations_url": "https://api.github.com/users/jnewbery/orgs",
        "repos_url": "https://api.github.com/users/jnewbery/repos",
        "events_url": "https://api.github.com/users/jnewbery/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jnewbery/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "(Only if you retouch the branch again) Make this a doxygen comment (start with `/**`). Also line-wrap this comment and the one below at something sensible :slightly_smiling_face: ",
      "created_at": "2020-09-23T10:26:07Z",
      "updated_at": "2020-09-23T10:26:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/19927#discussion_r493421238",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/493421238"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19927"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 364,
      "original_line": 364,
      "side": "RIGHT"
    }
  ]
}