{
  "type": "issue",
  "issue": {
    "id": 1268146148,
    "node_id": "I_kwDOABII585Lll_k",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25336",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25336/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25336/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25336/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/25336",
    "number": 25336,
    "state": "open",
    "state_reason": null,
    "title": "Onlynet=ipv4 disables Tor advertisements",
    "body": "I want my node to accept inbound IPv4 and Tor connections, but not make any outbound Tor connections. So I set:\r\n\r\n```\r\nlisten=1\r\nserver=1\r\nonlynet=ipv4\r\nonion=x.x.x.x:9050\r\nexternalip=x.x.x.x\r\nexternalip=xxx.onion\r\n```\r\n\r\nI expect that `onlynet` will limit the outgoing connections to IPv4 only, and `onion` combined with `externalip` allow for Tor incoming connections.\r\n\r\n**Actual behavior**\r\n\r\nTor gets completely disabled:\r\n\r\n```\r\n    {\r\n      \"name\": \"onion\",\r\n      \"limited\": true,\r\n      \"reachable\": false,\r\n      \"proxy\": \"x.x.x.x:9050\"\r\n    }\r\n\r\n```\r\nLimited is true and reachable is false. Also it does not advertise the onion address, just the IPv4:\r\n\r\n```\r\n  \"localaddresses\": [\r\n    {\r\n      \"address\": \"x.x.x.x\",\r\n      \"port\": 8333,\r\n      \"score\": 270\r\n    }\r\n    ]\r\n```\r\nAs soon as I remove the `onlynet` flag, Tor starts working and the address gets advertised.\r\n\r\nIt seems this behaviour is conflicting with the documentation (which state that `onlynet` affects outbound only).\r\n\r\nSo is this a bug and if not, how can I reach my goal of limiting outbound to non-tor addresses?",
    "user": {
      "login": "kroese",
      "id": 5763256,
      "node_id": "MDQ6VXNlcjU3NjMyNTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kroese",
      "html_url": "https://github.com/kroese",
      "followers_url": "https://api.github.com/users/kroese/followers",
      "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
      "organizations_url": "https://api.github.com/users/kroese/orgs",
      "repos_url": "https://api.github.com/users/kroese/repos",
      "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/kroese/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 64585,
        "node_id": "MDU6TGFiZWw2NDU4NQ==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug",
        "name": "Bug",
        "color": "FBBAAB",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 5,
    "created_at": "2022-06-11T03:08:31Z",
    "updated_at": "2022-07-28T13:48:53Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 6789489326,
      "node_id": "LE_lADOABII585Lll_kzwAAAAGUr2Ku",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6789489326",
      "actor": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-11T03:08:31Z",
      "label": {
        "name": "Bug",
        "color": "FBBAAB"
      }
    },
    {
      "event": "renamed",
      "id": 6789505555,
      "node_id": "RTE_lADOABII585Lll_kzwAAAAGUr6IT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/6789505555",
      "actor": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-06-11T03:29:25Z",
      "rename": {
        "from": "Onlynet=ipv4 disables incoming Tor",
        "to": "Onlynet=ipv4 disables Tor"
      }
    },
    {
      "event": "commented",
      "id": 1193351937,
      "node_id": "IC_kwDOABII585HIRsB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1193351937",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-24T16:28:08Z",
      "updated_at": "2022-07-24T16:28:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "@kroese Have you checked that there are really no incoming connections from onion peers? I think this should be already working as you would like it to, but the RPC responses that you are seeing may be confusing. \"reachable\" false means only not reachable in the context of outbound, I think. And that the onion address is not in \"localaddresses\" seems to be the same issue noted in #25669.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/25336#issuecomment-1193351937",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25336"
    },
    {
      "event": "mentioned",
      "id": 7051618549,
      "node_id": "MEE_lADOABII585Lll_kzwAAAAGkTyj1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7051618549",
      "actor": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-24T16:28:09Z"
    },
    {
      "event": "subscribed",
      "id": 7051618552,
      "node_id": "SE_lADOABII585Lll_kzwAAAAGkTyj4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7051618552",
      "actor": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-24T16:28:09Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-24T20:27:16Z",
      "updated_at": "2022-07-24T20:27:16Z",
      "source": {
        "issue": {
          "id": 1316001251,
          "node_id": "PR_kwDOABII5847_8o-",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25690",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25690/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25690/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25690/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25690",
          "number": 25690,
          "state": "closed",
          "state_reason": null,
          "title": "net: Add addresses to local addr map even if their network is unreachable",
          "body": "Closes #25669 and possibly also addresses #25336\r\n\r\nLocal addresses specified with `externalip` are currently not added to `mapLocalHost` if their network is set unreachable. This does not seem to be necessary because typically the network is set unreachable if outbound connections via the network are disabled via `onion=0`, `onlynet` etc. On the inbound side this does not necessarily mean there are any restrictions in place. For the use cases that Matt and kroese seem to have there rather seems to be a deliberate choice that a net is not reachable outbound although it is available inbound.\r\n\r\nFrom my understanding `mapLocalHost` is used to prevent the node from connecting to itself and getting a local address to announce to a peer. For the first use case this change may mean that there are some addresses in the map that are never checked because there are no outbound connections on that net. But that doesn't seem to be an issue. For the second use case the upside is that the address actually gets announced to peers. In the case of the open issues mentioned above this does seem to be the intention of the users. On the downside this may also mean that the address is announced even when this particular network is blocked in some way. This seems to have been the original intention by sipa when adding this check but also this was in 2012 and I am sure some of the context was different. In this case it makes more sense to me to assume that the users know what they are doing rather than assuming there is some network issue the user not aware of.\r\n\r\nAdditionally the change means that these addresses now appear in `getnetworkinfo`.\r\n\r\nI have considered and drafted other ways of addressing this issue but this seems to be the most straight forward approach unless I am overlooking something and the downside outlined above is too big of an issue.",
          "user": {
            "login": "fjahr",
            "id": 1322187,
            "node_id": "MDQ6VXNlcjEzMjIxODc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fjahr",
            "html_url": "https://github.com/fjahr",
            "followers_url": "https://api.github.com/users/fjahr/followers",
            "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
            "organizations_url": "https://api.github.com/users/fjahr/orgs",
            "repos_url": "https://api.github.com/users/fjahr/repos",
            "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/fjahr/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "comments": 4,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25690",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25690",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25690.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25690.patch"
          },
          "closed_at": "2022-07-24T21:51:17Z",
          "created_at": "2022-07-24T20:27:16Z",
          "updated_at": "2023-07-28T10:17:13Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T11:15:54Z",
      "updated_at": "2022-07-28T11:15:54Z",
      "source": {
        "issue": {
          "id": 1202044368,
          "node_id": "PR_kwDOABII5842HL1r",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24835",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24835/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24835/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24835/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/24835",
          "number": 24835,
          "state": "closed",
          "state_reason": null,
          "title": "Revert \"Do not consider blocked networks local\"",
          "body": "This reverts commit 1653f97c8f3c37cd96e03cf397c31c5caf81af08.\r\n\r\nThe output of `bitcoin-cli -netinfo` does not show local addresses for networks that the node itself would not make connections to, however the node might still receive incoming connections on addresses not shown by `-netinfo`. I would have expected `-netinfo` to list all local addresses that can receive incoming connections.\r\n\r\nThis can be observed when running a node that listens on multiple networks but also uses `-onlynet`. The local addresses of the networks **not** specified by `-onlynet` will be excluded from the output of `-netinfo`.",
          "user": {
            "login": "dergoegge",
            "id": 8077169,
            "node_id": "MDQ6VXNlcjgwNzcxNjk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dergoegge",
            "html_url": "https://github.com/dergoegge",
            "followers_url": "https://api.github.com/users/dergoegge/followers",
            "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
            "organizations_url": "https://api.github.com/users/dergoegge/orgs",
            "repos_url": "https://api.github.com/users/dergoegge/repos",
            "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/dergoegge/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 12,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/24835",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/24835",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/24835.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/24835.patch"
          },
          "closed_at": "2022-06-29T12:18:25Z",
          "created_at": "2022-04-12T15:50:26Z",
          "updated_at": "2023-07-28T10:17:14Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1198038378,
      "node_id": "IC_kwDOABII585HaJ1q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198038378",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T11:51:57Z",
      "updated_at": "2022-07-28T11:55:10Z",
      "author_association": "CONTRIBUTOR",
      "body": "`onion=` is only used to specify the SOCKS5 proxy for making outgoing connections to the Tor network. Because you do not want that you do not need to specify this option.\r\n\r\nJust `-externalip` should suffice to achieve your goal (or `-externalip` plus `-torcontrol` and `-torpassword` but I guess you already have those or the defaults work for you).\r\n\r\nThere are two ways to create a Tor service (for accepting incoming connections on the Tor network):\r\n\r\n1. Automatically using the Tor control API, I guess this is already happening in your case because you say \"Tor starts working...\". If `bitcoind` cannot find the Tor control, you would need to specify `-torcontrol` and `-torpassword`. See [Automatically create a Bitcoin Core onion service](https://github.com/bitcoin/bitcoin/blob/62c864605a3d082855dbbb839d969c2ffc7acace/doc/tor.md#2-automatically-create-a-bitcoin-core-onion-service) in `doc/tor.md`.\r\n2. Manually, by configuring the Tor daemon, described in [Manually create a Bitcoin Core onion service](https://github.com/bitcoin/bitcoin/blob/62c864605a3d082855dbbb839d969c2ffc7acace/doc/tor.md#3-manually-create-a-bitcoin-core-onion-service).\r\n\r\nAnd finally - you have found a bug! It will hopefully be resolved by https://github.com/bitcoin/bitcoin/pull/24835. `-onlynet` is supposed to only affect outgoing connections, but subtly, it also affects `-externalip` in a way that addresses supplied to `-externalip` are ignored if `-onlynet` is given and does not list the network of those addresses.\r\n\r\n@fjahr is right - the RPC output is confusing because reachable is only in the context of outbound. You should be able to get incoming Tor connections even now, but your Tor address is not advertised to the network, so nobody knows about it, which could be a reason why you do not see any incoming Tor connections.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/25336#issuecomment-1198038378",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25336"
    },
    {
      "event": "mentioned",
      "id": 7080725642,
      "node_id": "MEE_lADOABII585Lll_kzwAAAAGmC0yK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7080725642",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T11:55:10Z"
    },
    {
      "event": "subscribed",
      "id": 7080725647,
      "node_id": "SE_lADOABII585Lll_kzwAAAAGmC0yP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7080725647",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T11:55:10Z"
    },
    {
      "event": "renamed",
      "id": 7080910812,
      "node_id": "RTE_lADOABII585Lll_kzwAAAAGmDh_c",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7080910812",
      "actor": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T12:19:58Z",
      "rename": {
        "from": "Onlynet=ipv4 disables Tor",
        "to": "Onlynet=ipv4 disables Tor advertisements"
      }
    },
    {
      "event": "commented",
      "id": 1198078883,
      "node_id": "IC_kwDOABII585HaTuj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198078883",
      "actor": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T12:31:48Z",
      "updated_at": "2022-07-28T12:40:13Z",
      "author_association": "NONE",
      "body": "@vasild Thanks for the confirmation. I described the issue not right, because I didn't mean to say that it disables the incoming Tor connections (which would be impossible, because the tor proxy is a seperate process), but just that `onlynet` disables the address advertisements for Tor, which was unexpected because `onlynet` should only affect outbound connections. Good to hear that this bug is on the list to be resolved.\r\n\r\nFor the other issue (limiting outbound to IPv4) I agree with you that it would make much more sense if I just leave out the `onion=` line. That would have made it unnecessary to use `onlynet` in the first place.\r\n\r\n@fjahr That issue seems very similar. Only in my case Im setting `onion=` explicitly, and still have my `externaladdress` ignored. But it could be that because `onlynet` is set, the end-result is the same is not setting `onion=` at all. In that case my issue is a duplicate of #25669 ",
      "user": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/25336#issuecomment-1198078883",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25336"
    },
    {
      "event": "mentioned",
      "id": 7080993990,
      "node_id": "MEE_lADOABII585Lll_kzwAAAAGmD2TG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7080993990",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T12:31:48Z"
    },
    {
      "event": "subscribed",
      "id": 7080993999,
      "node_id": "SE_lADOABII585Lll_kzwAAAAGmD2TP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7080993999",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T12:31:48Z"
    },
    {
      "event": "mentioned",
      "id": 7081053278,
      "node_id": "MEE_lADOABII585Lll_kzwAAAAGmEExe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7081053278",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T12:40:13Z"
    },
    {
      "event": "subscribed",
      "id": 7081053291,
      "node_id": "SE_lADOABII585Lll_kzwAAAAGmEExr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/7081053291",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T12:40:13Z"
    },
    {
      "event": "commented",
      "id": 1198164617,
      "node_id": "IC_kwDOABII585HaoqJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198164617",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T13:45:44Z",
      "updated_at": "2022-07-28T13:45:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "> if I just leave out the `onion=` line\r\n\r\nIf `bitcoind` manages to find the Tor control, it will ask it where is the SOCKS5 proxy and will enable outgoing connections to Tor peers via it. To prevent that you need to either set `-onion=0` or `-onlynet=...values.other.than.onion...`",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/25336#issuecomment-1198164617",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25336"
    },
    {
      "event": "commented",
      "id": 1198167425,
      "node_id": "IC_kwDOABII585HapWB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1198167425",
      "actor": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-07-28T13:47:58Z",
      "updated_at": "2022-07-28T13:48:53Z",
      "author_association": "NONE",
      "body": "> If `bitcoind` manages to find the Tor control, it will ask it where is the SOCKS5 proxy and will enable outgoing connections to Tor peers via it. To prevent that you need to either set `-onion=0` or `-onlynet=...values.other.than.onion...`\r\n\r\nThanks, but I was not using `torcontrol=` at all (but a manually configured service).",
      "user": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/25336#issuecomment-1198167425",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25336"
    }
  ]
}