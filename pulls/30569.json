{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569",
    "id": 1999181445,
    "node_id": "PR_kwDOABII5853KRaF",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/30569",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/30569.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/30569.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30569",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30569/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/d7f866f90201b23016c9da17f367e45fd9ec9806",
    "number": 30569,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "node: reduce unsafe uint256S usage",
    "user": {
      "login": "stickies-v",
      "id": 69010457,
      "node_id": "MDQ6VXNlcjY5MDEwNDU3",
      "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stickies-v",
      "html_url": "https://github.com/stickies-v",
      "followers_url": "https://api.github.com/users/stickies-v/followers",
      "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
      "organizations_url": "https://api.github.com/users/stickies-v/orgs",
      "repos_url": "https://api.github.com/users/stickies-v/repos",
      "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/stickies-v/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Since fad2991ba073de0bd1f12e42bf0fbaca4a265508, `uint256S` has been [deprecated](https://github.com/bitcoin/bitcoin/pull/30482/commits/fad2991ba073de0bd1f12e42bf0fbaca4a265508#diff-800776e2dda39116e889839f69409571a5d397de048a141da7e4003bc099e3e2R138) because it is less robust than the `base_blob::FromHex()` introduced in [the same PR](https://github.com/bitcoin/bitcoin/pull/30482). Specifically, it tries to recover from length-mismatches, recover from untrimmed whitespace, 0x-prefix and garbage at the end, instead of simply requiring exactly 64 hex-only characters. _(see also #30532)_\r\n\r\nThis PR carves out the few `uint256S` callsites that may potentially prove a bit more controversial to change because they deal with user input and - potentially - backwards incompatible behaviour change.\r\n\r\nAfter this PR, the remaining work to remove `uint256S` completely is almost entirely mechanical and/or test related. I will open that PR once #30560 is merged because it builds on that.",
    "labels": [
      {
        "id": 5334691551,
        "node_id": "LA_kwDOABII588AAAABPfju3w",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
        "name": "CI failed",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2024-08-01T18:59:05Z",
    "updated_at": "2024-08-06T11:39:55Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "70e38c90662cde79a2d0d4713e7d8f2ae6d8dc7d",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "stickies-v:2024-08/hex-arg-parse",
      "ref": "2024-08/hex-arg-parse",
      "sha": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 431644530,
        "node_id": "R_kgDOGbpfcg",
        "name": "bitcoin",
        "full_name": "stickies-v/bitcoin",
        "owner": {
          "login": "stickies-v",
          "id": 69010457,
          "node_id": "MDQ6VXNlcjY5MDEwNDU3",
          "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/stickies-v",
          "html_url": "https://github.com/stickies-v",
          "followers_url": "https://api.github.com/users/stickies-v/followers",
          "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
          "organizations_url": "https://api.github.com/users/stickies-v/orgs",
          "repos_url": "https://api.github.com/users/stickies-v/repos",
          "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/stickies-v/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/stickies-v/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/stickies-v/bitcoin",
        "archive_url": "https://api.github.com/repos/stickies-v/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/stickies-v/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/stickies-v/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/stickies-v/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/stickies-v/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/stickies-v/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/stickies-v/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/stickies-v/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/stickies-v/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/stickies-v/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/stickies-v/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/stickies-v/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/stickies-v/bitcoin/events",
        "forks_url": "https://api.github.com/repos/stickies-v/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/stickies-v/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/stickies-v/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/stickies-v/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/stickies-v/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/stickies-v/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/stickies-v/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/stickies-v/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/stickies-v/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/stickies-v/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/stickies-v/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/stickies-v/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/stickies-v/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/stickies-v/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/stickies-v/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/stickies-v/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:stickies-v/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/stickies-v/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/stickies-v/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/stickies-v/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/stickies-v/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/stickies-v/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/stickies-v/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/stickies-v/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/stickies-v/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/stickies-v/bitcoin/hooks",
        "svn_url": "https://github.com/stickies-v/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 2,
        "watchers_count": 2,
        "size": 255389,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-08-06T10:41:50Z",
        "created_at": "2021-11-24T22:26:41Z",
        "updated_at": "2024-06-19T14:39:47Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "43740f4971f45cd5499470b6a085b3ecd8b96d28",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35955,
        "stargazers_count": 77741,
        "watchers_count": 77741,
        "size": 265081,
        "default_branch": "master",
        "open_issues_count": 666,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-08-06T11:57:48Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-08-06T11:23:30Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 120,
    "deletions": 43,
    "changed_files": 8,
    "commits": 5,
    "review_comments": 26,
    "comments": 2
  },
  "events": [
    {
      "event": "commented",
      "id": 2263761475,
      "node_id": "IC_kwDOABII586G7kJD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2263761475",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-01T18:59:09Z",
      "updated_at": "2024-08-03T11:44:12Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/30569).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#30571](https://github.com/bitcoin/bitcoin/pull/30571) (test: [refactor] Use g_rand_ctx directly by maflcko)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#issuecomment-2263761475",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30569"
    },
    {
      "event": "reviewed",
      "id": 2213720639,
      "node_id": "PRR_kwDOABII586D8rI_",
      "url": null,
      "actor": null,
      "commit_id": "c0d508e69ca8896fddf5c4d9516ee9f26f15b8a2",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Not sure about the breaking changes. `-noassumevalid` seems common https://github.com/search?q=noassumevalid&type=code",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#pullrequestreview-2213720639",
      "submitted_at": "2024-08-01T19:31:24Z",
      "state": "CHANGES_REQUESTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
    },
    {
      "event": "labeled",
      "id": 13731528261,
      "node_id": "LE_lADOABII586RoByHzwAAAAMydn5F",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13731528261",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-01T20:07:23Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13744302692,
      "node_id": "HRFPE_lADOABII586RoByHzwAAAAMzOWpk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13744302692",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-02T16:35:07Z"
    },
    {
      "event": "commented",
      "id": 2265777270,
      "node_id": "IC_kwDOABII586HDQR2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2265777270",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-02T16:44:44Z",
      "updated_at": "2024-08-02T16:44:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks a lot for the quick approach feedback, @maflcko. Force pushed to minimize breaking changes by repurposing `IsHexNumber()` to `TrySanitizeHexNumber()` and allowing < 64 characters for `-minimumchainwork` and `RANDOM_CTX_SEED`, and to address the broken `-no<parameter>`  behaviour.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#issuecomment-2265777270",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30569"
    },
    {
      "event": "mentioned",
      "id": 13744416016,
      "node_id": "MEE_lADOABII586RoByHzwAAAAMzOyUQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13744416016",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-02T16:44:46Z"
    },
    {
      "event": "subscribed",
      "id": 13744416038,
      "node_id": "SE_lADOABII586RoByHzwAAAAMzOyUm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13744416038",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-02T16:44:46Z"
    },
    {
      "event": "reviewed",
      "id": 2217100926,
      "node_id": "PRR_kwDOABII586EJkZ-",
      "url": null,
      "actor": null,
      "commit_id": "b38a259d1e2749876d4e3a15f218b4f257049320",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for clearing these up, please see my observations.",
      "user": {
        "login": "paplorinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paplorinc",
        "html_url": "https://github.com/paplorinc",
        "followers_url": "https://api.github.com/users/paplorinc/followers",
        "following_url": "https://api.github.com/users/paplorinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paplorinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paplorinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paplorinc/subscriptions",
        "organizations_url": "https://api.github.com/users/paplorinc/orgs",
        "repos_url": "https://api.github.com/users/paplorinc/repos",
        "events_url": "https://api.github.com/users/paplorinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paplorinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#pullrequestreview-2217100926",
      "submitted_at": "2024-08-03T19:19:42Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
    },
    {
      "event": "reviewed",
      "id": 2217172418,
      "node_id": "PRR_kwDOABII586EJ13C",
      "url": null,
      "actor": null,
      "commit_id": "b38a259d1e2749876d4e3a15f218b4f257049320",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "paplorinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paplorinc",
        "html_url": "https://github.com/paplorinc",
        "followers_url": "https://api.github.com/users/paplorinc/followers",
        "following_url": "https://api.github.com/users/paplorinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paplorinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paplorinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paplorinc/subscriptions",
        "organizations_url": "https://api.github.com/users/paplorinc/orgs",
        "repos_url": "https://api.github.com/users/paplorinc/repos",
        "events_url": "https://api.github.com/users/paplorinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paplorinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#pullrequestreview-2217172418",
      "submitted_at": "2024-08-03T19:22:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
    },
    {
      "event": "reviewed",
      "id": 2218701543,
      "node_id": "PRR_kwDOABII586EPrLn",
      "url": null,
      "actor": null,
      "commit_id": "b38a259d1e2749876d4e3a15f218b4f257049320",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#pullrequestreview-2218701543",
      "submitted_at": "2024-08-05T11:02:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU5ZGQ0N2M2NjQyNmMwNGZjNmYwNzgwZDY3YmEwYzA1ZjI2Zjk5MjA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e9dd47c66426c04fc6f0780d67ba0c05f26f9920",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e9dd47c66426c04fc6f0780d67ba0c05f26f9920",
      "tree": {
        "sha": "95f235a2345ea53a4e1dac40782d8b3830762482",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/95f235a2345ea53a4e1dac40782d8b3830762482"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 95f235a2345ea53a4e1dac40782d8b3830762482\nparent 9774a958b501a6d439a734e18b29e04f59f973f6\nauthor stickies-v <stickies-v@protonmail.com> 1722938155 +0100\ncommitter stickies-v <stickies-v@protonmail.com> 1722938771 +0100\n\ntest: unittest chainstatemanager_args\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE5g/ggIZt5fccjfOgXLHObl5mp1cFAmax9ZMACgkQXLHObl5m\np1eWjQ//R6GXei15bNNHN0tXSYPOEUtlVwdnc7GPeuWyvu8++KccnMMDum8C//mC\nl5OJ8kZ26RAd/67bq3xH/Nh72MbhDEolheRRr5TR2Wd/hMOEEr+AJG1G/bRvdbd3\n9Qp9MZcZEbxmXbnKUa56Xf4nMaAyX5/C9M2WP+TEYcAERLvturEVBMP9ZqOl18cJ\nE975tmsrOUvwsDzQTK+9+2eV5rAOtXrbDYFaari8ZL6fLWcGegtoJ7R2gbM95bfE\nLseWrEg6a3xk3Wes43Xg1GYc5Znkuevi/aC5mcExYoNfhtEl8aWFu7PZlz6KOTc4\nn+Y/ctDoLJdhZzIaBB2jVaB7OI6XPOecBfV3C2VClrKBDWD1SzCUi9UyLF04EgWG\nWvUH0k2KJc2/tu+jFmW0yzUhXgvVXwyu/ut8cn+UMMkxs8LHi29UKaoW1aPZBEL8\nPO6W9P95dsuGfQOIr5LorhjdPCThOWFzNcQtuhVdeu2p3IxhhGbWEqVjIFfkrMcO\nI6mlfxyDMV+LVZw8oA0XJ3ZaUMTd2E0IdkwTUu6isMVTptHed+pAk+n17vjtgFJ1\n9Ap+qc2ZGwAV451F+hmrsLWbf7PHuWcQ/G1uIU0VAVjG1n3jbzO7dut7/UHiizMN\nsLDz/6Qb3H9XZZbE9lfXET0SnrO61tXVcAZSroF9af/xdtQ23h8=\n=Jll0\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9774a958b501a6d439a734e18b29e04f59f973f6",
          "sha": "9774a958b501a6d439a734e18b29e04f59f973f6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9774a958b501a6d439a734e18b29e04f59f973f6"
        }
      ],
      "message": "test: unittest chainstatemanager_args",
      "committer": {
        "name": "stickies-v",
        "email": "stickies-v@protonmail.com",
        "date": "2024-08-06T10:06:11Z"
      },
      "author": {
        "name": "stickies-v",
        "email": "stickies-v@protonmail.com",
        "date": "2024-08-06T09:55:55Z"
      },
      "sha": "e9dd47c66426c04fc6f0780d67ba0c05f26f9920"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGI5MDgzN2RhMTRhY2JjNzg0Y2I2ZDNkMDJlZjVlZGU1YjRlZTZhZjM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b90837da14acbc784cb6d3d02ef5ede5b4ee6af3",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b90837da14acbc784cb6d3d02ef5ede5b4ee6af3",
      "tree": {
        "sha": "a29b6a2ddf605543952dfed99bb261fb89f19de2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a29b6a2ddf605543952dfed99bb261fb89f19de2"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree a29b6a2ddf605543952dfed99bb261fb89f19de2\nparent e9dd47c66426c04fc6f0780d67ba0c05f26f9920\nauthor stickies-v <stickies-v@protonmail.com> 1722613806 +0100\ncommitter stickies-v <stickies-v@protonmail.com> 1722940784 +0100\n\nutil: refactor: change IsHexNumber to TrySanitizeHexNumber\n\nThis refactor enables future commits to allow passing user input\nhex numbers into the strictly validated base_blob::FromHex().\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE5g/ggIZt5fccjfOgXLHObl5mp1cFAmax/XAACgkQXLHObl5m\np1fCVxAAp0Xhs4O8ldD1WH1Tmp+4Q1m8GTFOXejXAI4CZb5HGNlVzLNw1y/FRAtf\n8ukHvmnA5gSaOpJgZjVU/nejx0vFU8BHzndKcaVgcdcsfm/azREj3GvCF7xeu5n1\nMRe2WqlN0F8YBXMgJyqCB4S67CtOVI1wbrzD1aXtCTWDK+OFoZrRe5VGHBG+lOIv\nDIM7coGV/81/A5ZOoy4me8ut4iXaW5SfBYAf/tQTbLY3X6H4VYzl8XV8Idktcjk8\nXlOBk0p04W218jYdya3ZxzYWTQozlJD+dulkFzd6nza9oBTf5wxLrUOq98vCEIKi\n6jYw01wIKTJAF0i42VwS8n9Ozy5IxGBZPg1Nkk0MXsc1maMSyjzKvLnA/CKn/c2/\nzPgDOwYY+XvfTXItGouXzk1CD6MKQybKU/bx/OviC9Fte8rBwuaW0AU9hTN9beo+\nXNC145RMfkyK5wVIWrSW5100uuHXaIuaJKNFRcBAH+UY3kJIZXJxSofoJZPsyDfC\nI7XY7A7xHNSWGyE68jYgersJh0cvCaDwACCu1xC5gGgqT5FlpOR6zLms2GH1XV5V\nH41GlVuSepN3AksgONEp1l2Va4e/b5/oPPPBlhdZKg/CwY0Y1AI1qEsmrF8tcMe4\nQHnCZ1C5Ep57ZoxOhEEEDnB6ZkldeI91P2zTLmIO+yMfUGz+EpY=\n=bjcB\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e9dd47c66426c04fc6f0780d67ba0c05f26f9920",
          "sha": "e9dd47c66426c04fc6f0780d67ba0c05f26f9920",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e9dd47c66426c04fc6f0780d67ba0c05f26f9920"
        }
      ],
      "message": "util: refactor: change IsHexNumber to TrySanitizeHexNumber\n\nThis refactor enables future commits to allow passing user input\nhex numbers into the strictly validated base_blob::FromHex().",
      "committer": {
        "name": "stickies-v",
        "email": "stickies-v@protonmail.com",
        "date": "2024-08-06T10:39:44Z"
      },
      "author": {
        "name": "stickies-v",
        "email": "stickies-v@protonmail.com",
        "date": "2024-08-02T15:50:06Z"
      },
      "sha": "b90837da14acbc784cb6d3d02ef5ede5b4ee6af3"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDA2M2E4Y2RmYjU3NmYxNzhmZjMzYTY5NTY3NmZjODg4NTkyODhmZGQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/063a8cdfb576f178ff33a695676fc88859288fdd",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/063a8cdfb576f178ff33a695676fc88859288fdd",
      "tree": {
        "sha": "79aafd33383e3b76339b33ae01f38d363820e768",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/79aafd33383e3b76339b33ae01f38d363820e768"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 79aafd33383e3b76339b33ae01f38d363820e768\nparent b90837da14acbc784cb6d3d02ef5ede5b4ee6af3\nauthor stickies-v <stickies-v@protonmail.com> 1722002508 +0100\ncommitter stickies-v <stickies-v@protonmail.com> 1722940785 +0100\n\nnode: use uint256::FromHex for -minimumchainwork parsing\n\nRemoves dependency on unsafe and deprecated uint256S.\n\nThis makes parsing more strict, by explicitly returning an error\nwhen the input is longer than 64 hex characters.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE5g/ggIZt5fccjfOgXLHObl5mp1cFAmax/XEACgkQXLHObl5m\np1fKTg//WRTAYoOBfK0UWgXRCDXVFQ2LOAOIeMh/rmLajmkyZoNtIO1fSdlfHX43\nuQzvsa8ArIknwss+epAYSrEuMBU0xD5k+c+ycPA5Xtd63fO+mBbbj09Hnr42Cz1v\n8cNBGqjVjuk2nVfYukU9bp3eJ8mhYT/QEMeu55Y/acmnRaksw8a6XDEe45V24Ssf\n19/wauybY8zGKvr6eGpwYiguiMuPslP0xdk8W9NO1SQKVpUgF0n1Wy1mg3stsa6S\nPICbhytXVLmcLdbZ7+uDX4qOleD5RcSaIIc+UFrLP0GZC1e3ZRmLTGiKtpf0M3Jc\ny8TfYO0eWqI1uOfdnUAKcmrqGP+KS9i6HmqGuFrdOj8CjnwX3KF9JBZwsS8RzigC\niWNSv11OAlpzWrJR/jFnbQa4Kt2MPmu/gt3ZGK4A6xoYIN+4rBZXjpnyUY0R1t9o\n5HJYyH8whnzmpwUeksxA4m8l7npM9jGY1UheUiyMGnxDtnXaVR9PH1zLwjXkHXKv\n5V7GDwBwqkM/0jD5oEMLv7SEcEFFSsD8d2XDJzEXKGmP6lZ/oKJv7K3F45ZBBTqq\nnKG1z64EEc0AfXwXyThAvpOrpiUcQ0YZgOAhBWiw9wtJCvIE+rucAB8gBRpTqJlg\nFGEoaT7rzI1Y0r6fr/nxTqK+NfCr96CD/GG7w0/luGZ433aqQEM=\n=VkS8\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b90837da14acbc784cb6d3d02ef5ede5b4ee6af3",
          "sha": "b90837da14acbc784cb6d3d02ef5ede5b4ee6af3",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b90837da14acbc784cb6d3d02ef5ede5b4ee6af3"
        }
      ],
      "message": "node: use uint256::FromHex for -minimumchainwork parsing\n\nRemoves dependency on unsafe and deprecated uint256S.\n\nThis makes parsing more strict, by explicitly returning an error\nwhen the input is longer than 64 hex characters.",
      "committer": {
        "name": "stickies-v",
        "email": "stickies-v@protonmail.com",
        "date": "2024-08-06T10:39:45Z"
      },
      "author": {
        "name": "stickies-v",
        "email": "stickies-v@protonmail.com",
        "date": "2024-07-26T14:01:48Z"
      },
      "sha": "063a8cdfb576f178ff33a695676fc88859288fdd"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDdmM2NmN2QyMGY1NGQzNDM4NmYwY2M2ZDA4NTE3MDU4ODA3YWU4ZGY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7f3cf7d20f54d34386f0cc6d08517058807ae8df",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7f3cf7d20f54d34386f0cc6d08517058807ae8df",
      "tree": {
        "sha": "8a4ec182cc4a7f3db1997fa26f27690a67d02cb2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8a4ec182cc4a7f3db1997fa26f27690a67d02cb2"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 8a4ec182cc4a7f3db1997fa26f27690a67d02cb2\nparent 063a8cdfb576f178ff33a695676fc88859288fdd\nauthor stickies-v <stickies-v@protonmail.com> 1722003025 +0100\ncommitter stickies-v <stickies-v@protonmail.com> 1722940785 +0100\n\nnode: use uint256::FromHex for -assumevalid parsing\n\nRemoves dependency on unsafe and deprecated uint256S.\n\nThis makes parsing more strict, by explicitly returning an error\nwhen the input contains invalid hex characters, or when it is\nnot exactly 64 characters long.\n\nAlso make feature_assumevalid.py more robust by using CBlock.hash\nwhich is guaranteed to be 64 characters long, as opposed to the\nvariable-length hex(CBlock.sha256)\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE5g/ggIZt5fccjfOgXLHObl5mp1cFAmax/XEACgkQXLHObl5m\np1eZ4Q//Uqz/XO+e3lSG+X0UUl9nPi/EqJ4kth2BvWmqwMzZmEWYngVxcZ/4TSHK\nH++ceBf6pQpY6os9QoYn1rH92ulltMeRcWbIRS4uN1GxyUUbF+HhioeZa2T7r62m\nIY6isC6QvtaWr8/aH4MVBxakExiGDeA8xOIITzcUDkoM4iqursdLHeRpSNO4X1lh\nTIkq+QTr1pWzirXuLOJrkUBQbHyDbRXf2nJSoMrKtrJvy6SX+wWHAmdcYiLcWhOd\nYN10g2PT0EY15gn+TVhARSozLmuROZ/FtLm/zWuQqJlhXxzYHkCavGAA8mSp2O9/\nT3xzFWz3TwlrXyGa+Lcp6Xfw0Q10P73CHqxYFuV5sRwi1/pBlKtQ+3xZiD7nXpUX\nZEfBT+/wbsB++CsvgMls84ppTS+lqLNh1Lj188+/TwQ0MGZMYjGiYlecuJ0pyW2D\ne2dqDJnJtueecB35Xq3xXenp1sVddzp2f6X6yzIPhIwgyyl4JWNFj6zoHT5VadE0\nJ4/ZUPeV1CpfZJuuFa4Z3M+5xnlNGz6UMsvvVnA+Y0hxwhCCXpv5ChJ9H9/Hlj3W\nOM1ybpTD8aSXGvrmzroFv2XwBO3bgHI+esByMEaN0NJBTXHpRLqEnMmiBs7Zy2c8\nqHRSNS20LRmaRJsYhUDXoq7RBwaZysi8zX8muw3av8yM73Qcc74=\n=hVIi\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/063a8cdfb576f178ff33a695676fc88859288fdd",
          "sha": "063a8cdfb576f178ff33a695676fc88859288fdd",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/063a8cdfb576f178ff33a695676fc88859288fdd"
        }
      ],
      "message": "node: use uint256::FromHex for -assumevalid parsing\n\nRemoves dependency on unsafe and deprecated uint256S.\n\nThis makes parsing more strict, by explicitly returning an error\nwhen the input contains invalid hex characters, or when it is\nnot exactly 64 characters long.\n\nAlso make feature_assumevalid.py more robust by using CBlock.hash\nwhich is guaranteed to be 64 characters long, as opposed to the\nvariable-length hex(CBlock.sha256)",
      "committer": {
        "name": "stickies-v",
        "email": "stickies-v@protonmail.com",
        "date": "2024-08-06T10:39:45Z"
      },
      "author": {
        "name": "stickies-v",
        "email": "stickies-v@protonmail.com",
        "date": "2024-07-26T14:10:25Z"
      },
      "sha": "7f3cf7d20f54d34386f0cc6d08517058807ae8df"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQ3Zjg2NmY5MDIwMWIyMzAxNmM5ZGExN2YzNjdlNDVmZDllYzk4MDY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d7f866f90201b23016c9da17f367e45fd9ec9806",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d7f866f90201b23016c9da17f367e45fd9ec9806",
      "tree": {
        "sha": "08c5a3cfcde0bdaf9d1526d970262977b569b7b7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/08c5a3cfcde0bdaf9d1526d970262977b569b7b7"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 08c5a3cfcde0bdaf9d1526d970262977b569b7b7\nparent 7f3cf7d20f54d34386f0cc6d08517058807ae8df\nauthor stickies-v <stickies-v@protonmail.com> 1722357059 +0100\ncommitter stickies-v <stickies-v@protonmail.com> 1722940795 +0100\n\nrandom: use uint256::FromHex for RANDOM_CTX_SEED\n\nRemoves dependency on unsafe and deprecated uint256S.\n\nThis makes parsing more strict, by requiring RANDOM_CTX_SEED\nto be a 64 char hex string, whereas previously any string would\nbe accepted, with non-hex characters silently ignored and strings\nlonger than 64 characters silently trimmed.\n\nAdditionally, and unrelatedly, make RANDOM_CTX_SEED inline constexpr\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE5g/ggIZt5fccjfOgXLHObl5mp1cFAmax/YgACgkQXLHObl5m\np1c8og//VGnbT6qBpwkv8H8GHj9zpPFwvKJkFjh+CODQEBbhNk5mvO7lP3CTD1+M\nFjsO6AQm2W5c96SExv/2jIfurIjIA8DfKKCz6zv4k1vJPL9QsKO6YQQHPlXnzoKv\nrg0dzzZbkdoP1htEABOdBVuI+r51AwM0WH9FVg/jsxaTXxnNt8kVX9ClJH96errf\ngx9odtRazkTS+EKgeSm9XQAWMFfsHd0y/RkPumGHlh5RrWZ1XDHEGXM+T2WneUMj\n/jGFyIehMZnhPG1xjTzCMkP0IEg42qRqYDJFjOiOaJ98BssdRsuPytDhhkUzpl6f\nVOLdxKPVU0o7fWBKQ/8pxO7nOBaGK14w3OtDktkVwx7rjUT1gPTQzhWZYe9X6NBc\nwDnYbqiJTXpE2kGMAuPGKy0/Qktu4cV5GcB8UgBm/9U3fGw9eC0ovy5Kf9fX3T37\ngDbedlMn8dUg+imiTr9xEYNUKgekVPBQbjUb8Et7wDynMZ4ETvUjnrHrKgonmaNw\ncCnALCBIMHoDCVxU5dUVowmEOnDgvvrpQ7qxixx/naJfo8QBtDE9TZOFEYiVAYTL\n9r2zhlIYklvc5Ky3HkR6ow2KlG3/pjjRGLRXobn+vkic7YPeWckQZVvIG/8bmHno\nzra6NE1sFIH7Y54NM7KXAuHq4Q4D8hbf5DhJOy/Z8c0DswUxnfY=\n=N0K7\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7f3cf7d20f54d34386f0cc6d08517058807ae8df",
          "sha": "7f3cf7d20f54d34386f0cc6d08517058807ae8df",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7f3cf7d20f54d34386f0cc6d08517058807ae8df"
        }
      ],
      "message": "random: use uint256::FromHex for RANDOM_CTX_SEED\n\nRemoves dependency on unsafe and deprecated uint256S.\n\nThis makes parsing more strict, by requiring RANDOM_CTX_SEED\nto be a 64 char hex string, whereas previously any string would\nbe accepted, with non-hex characters silently ignored and strings\nlonger than 64 characters silently trimmed.\n\nAdditionally, and unrelatedly, make RANDOM_CTX_SEED inline constexpr",
      "committer": {
        "name": "stickies-v",
        "email": "stickies-v@protonmail.com",
        "date": "2024-08-06T10:39:55Z"
      },
      "author": {
        "name": "stickies-v",
        "email": "stickies-v@protonmail.com",
        "date": "2024-07-30T16:30:59Z"
      },
      "sha": "d7f866f90201b23016c9da17f367e45fd9ec9806"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13776620517,
      "node_id": "HRFPE_lADOABII586RoByHzwAAAAM1Jovl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13776620517",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-06T10:41:52Z"
    },
    {
      "event": "reviewed",
      "id": 2219106988,
      "node_id": "PRR_kwDOABII586EROKs",
      "url": null,
      "actor": null,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Force-pushed to address review comments, mainly:\r\n- [fixed](https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1702863593) buggy `-noassumedvalid` behaviour and added unit tests to cover this\r\n- [changed](https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1702863957) `result_size` to an int type and changed the disabled (default) state to `-1` instead of `0`\r\n- [changed](https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1703942199) `RANDOM_CTX_SEED` to now have to be a 64 char hex string",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#pullrequestreview-2219106988",
      "submitted_at": "2024-08-06T10:49:28Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700712603",
      "pull_request_review_id": 2213720639,
      "id": 1700712603,
      "node_id": "PRRC_kwDOABII585lXtCb",
      "diff_hunk": "@@ -32,13 +32,20 @@ util::Result<void> ApplyArgsManOptions(const ArgsManager& args, ChainstateManage\n     if (auto value{args.GetBoolArg(\"-checkpoints\")}) opts.checkpoints_enabled = *value;\n \n     if (auto value{args.GetArg(\"-minimumchainwork\")}) {\n-        if (!IsHexNumber(*value)) {\n-            return util::Error{strprintf(Untranslated(\"Invalid non-hex (%s) minimum chain work value specified\"), *value)};\n+        if (auto min_work{uint256::FromHex(util::RemovePrefixView(*value, \"0x\"))}) {\n+            opts.minimum_chain_work = UintToArith256(*min_work);\n+        } else {\n+            return util::Error{strprintf(Untranslated(\"Invalid minimum chain work value specified (%s), must be %d character hex\"), *value, uint256::size() * 2)};",
      "path": "src/node/chainstatemanager_args.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "c0d508e69ca8896fddf5c4d9516ee9f26f15b8a2",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I wonder if it makes sense to add an option to `FromHex` to allow parsing of \"hex numbers\", which would remove the prefix and only reject too large or junk input?\r\n\r\nIn any case, you can remove `IsHexNumber`?",
      "created_at": "2024-08-01T19:24:19Z",
      "updated_at": "2024-08-01T19:31:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1700712603",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700712603"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": 35,
      "start_side": "LEFT",
      "line": null,
      "original_line": 38,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700717783",
      "pull_request_review_id": 2213720639,
      "id": 1700717783,
      "node_id": "PRRC_kwDOABII585lXuTX",
      "diff_hunk": "@@ -32,13 +32,20 @@ util::Result<void> ApplyArgsManOptions(const ArgsManager& args, ChainstateManage\n     if (auto value{args.GetBoolArg(\"-checkpoints\")}) opts.checkpoints_enabled = *value;\n \n     if (auto value{args.GetArg(\"-minimumchainwork\")}) {\n-        if (!IsHexNumber(*value)) {\n-            return util::Error{strprintf(Untranslated(\"Invalid non-hex (%s) minimum chain work value specified\"), *value)};\n+        if (auto min_work{uint256::FromHex(util::RemovePrefixView(*value, \"0x\"))}) {\n+            opts.minimum_chain_work = UintToArith256(*min_work);\n+        } else {\n+            return util::Error{strprintf(Untranslated(\"Invalid minimum chain work value specified (%s), must be %d character hex\"), *value, uint256::size() * 2)};\n         }\n-        opts.minimum_chain_work = UintToArith256(uint256S(*value));\n     }\n \n-    if (auto value{args.GetArg(\"-assumevalid\")}) opts.assumed_valid_block = uint256S(*value);\n+    if (auto value{args.GetArg(\"-assumevalid\")}) {\n+        if (auto block_hash{uint256::FromHex(util::RemovePrefixView(*value, \"0x\"))}) {\n+            opts.assumed_valid_block = *block_hash;\n+        } else {\n+            return util::Error{strprintf(Untranslated(\"Invalid assumevalid block hash specified (%s), must be %d character hex\"), *value, uint256::size() * 2)};",
      "path": "src/node/chainstatemanager_args.cpp",
      "position": 18,
      "original_position": 19,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "c0d508e69ca8896fddf5c4d9516ee9f26f15b8a2",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I presume this will break, when someone sets `-noassumevalid`?\r\n\r\n```\r\nError: Invalid assumevalid block hash specified (0), must be 64 character hex\r\n",
      "created_at": "2024-08-01T19:29:35Z",
      "updated_at": "2024-08-01T19:31:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1700717783",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700717783"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 46,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700718302",
      "pull_request_review_id": 2213720639,
      "id": 1700718302,
      "node_id": "PRRC_kwDOABII585lXube",
      "diff_hunk": "@@ -9,24 +9,26 @@\n #include <uint256.h>\n \n #include <cstdlib>\n-#include <string>\n \n FastRandomContext g_insecure_rand_ctx;\n \n+inline constexpr const char* RANDOM_CTX_SEED{\"RANDOM_CTX_SEED\"};\n+\n extern void MakeRandDeterministicDANGEROUS(const uint256& seed) noexcept;\n \n void SeedRandomForTest(SeedRand seedtype)\n {\n-    static const std::string RANDOM_CTX_SEED{\"RANDOM_CTX_SEED\"};\n-\n     // Do this once, on the first call, regardless of seedtype, because once\n     // MakeRandDeterministicDANGEROUS is called, the output of GetRandHash is\n     // no longer truly random. It should be enough to get the seed once for the\n     // process.\n     static const uint256 ctx_seed = []() {\n         // If RANDOM_CTX_SEED is set, use that as seed.\n-        const char* num = std::getenv(RANDOM_CTX_SEED.c_str());\n-        if (num) return uint256S(num);\n+        if (const auto num{std::getenv(RANDOM_CTX_SEED)}) {\n+            uint256 rv;\n+            rv.SetHexDeprecated(num);\n+            return rv;",
      "path": "src/test/util/random.cpp",
      "position": null,
      "original_position": 27,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "c0d508e69ca8896fddf5c4d9516ee9f26f15b8a2",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Seems fine to just use `Assert(FromHex(...))`?",
      "created_at": "2024-08-01T19:30:07Z",
      "updated_at": "2024-08-01T19:31:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1700718302",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700718302"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": 28,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 30,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700826270",
      "pull_request_review_id": 2213904151,
      "id": 1700826270,
      "node_id": "PRRC_kwDOABII585lYIye",
      "diff_hunk": "@@ -32,13 +32,20 @@ util::Result<void> ApplyArgsManOptions(const ArgsManager& args, ChainstateManage\n     if (auto value{args.GetBoolArg(\"-checkpoints\")}) opts.checkpoints_enabled = *value;\n \n     if (auto value{args.GetArg(\"-minimumchainwork\")}) {\n-        if (!IsHexNumber(*value)) {\n-            return util::Error{strprintf(Untranslated(\"Invalid non-hex (%s) minimum chain work value specified\"), *value)};\n+        if (auto min_work{uint256::FromHex(util::RemovePrefixView(*value, \"0x\"))}) {\n+            opts.minimum_chain_work = UintToArith256(*min_work);\n+        } else {\n+            return util::Error{strprintf(Untranslated(\"Invalid minimum chain work value specified (%s), must be %d character hex\"), *value, uint256::size() * 2)};\n         }\n-        opts.minimum_chain_work = UintToArith256(uint256S(*value));\n     }\n \n-    if (auto value{args.GetArg(\"-assumevalid\")}) opts.assumed_valid_block = uint256S(*value);\n+    if (auto value{args.GetArg(\"-assumevalid\")}) {\n+        if (auto block_hash{uint256::FromHex(util::RemovePrefixView(*value, \"0x\"))}) {\n+            opts.assumed_valid_block = *block_hash;\n+        } else {\n+            return util::Error{strprintf(Untranslated(\"Invalid assumevalid block hash specified (%s), must be %d character hex\"), *value, uint256::size() * 2)};",
      "path": "src/node/chainstatemanager_args.cpp",
      "position": 18,
      "original_position": 19,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "c0d508e69ca8896fddf5c4d9516ee9f26f15b8a2",
      "in_reply_to_id": 1700717783,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ah thanks, didn't think of that. Will add a \"0\" check:\r\n\r\n<details>\r\n<summary>git diff on c0d508e69c</summary>\r\n\r\n```diff\r\ndiff --git a/src/node/chainstatemanager_args.cpp b/src/node/chainstatemanager_args.cpp\r\nindex 8085aa65dc..60cee3dd78 100644\r\n--- a/src/node/chainstatemanager_args.cpp\r\n+++ b/src/node/chainstatemanager_args.cpp\r\n@@ -31,7 +31,7 @@ util::Result<void> ApplyArgsManOptions(const ArgsManager& args, ChainstateManage\r\n \r\n     if (auto value{args.GetBoolArg(\"-checkpoints\")}) opts.checkpoints_enabled = *value;\r\n \r\n-    if (auto value{args.GetArg(\"-minimumchainwork\")}) {\r\n+    if (auto value{args.GetArg(\"-minimumchainwork\")}; value && *value != \"0\") {\r\n         if (auto min_work{uint256::FromHex(util::RemovePrefixView(*value, \"0x\"))}) {\r\n             opts.minimum_chain_work = UintToArith256(*min_work);\r\n         } else {\r\n@@ -39,7 +39,7 @@ util::Result<void> ApplyArgsManOptions(const ArgsManager& args, ChainstateManage\r\n         }\r\n     }\r\n \r\n-    if (auto value{args.GetArg(\"-assumevalid\")}) {\r\n+    if (auto value{args.GetArg(\"-assumevalid\")}; value && *value != \"0\") {\r\n         if (auto block_hash{uint256::FromHex(util::RemovePrefixView(*value, \"0x\"))}) {\r\n             opts.assumed_valid_block = *block_hash;\r\n         } else {\r\n\r\n```\r\n</details>\r\n",
      "created_at": "2024-08-01T20:47:54Z",
      "updated_at": "2024-08-01T20:47:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1700826270",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1700826270"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 46,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702084437",
      "pull_request_review_id": 2216001026,
      "id": 1702084437,
      "node_id": "PRRC_kwDOABII585lc79V",
      "diff_hunk": "@@ -32,13 +32,20 @@ util::Result<void> ApplyArgsManOptions(const ArgsManager& args, ChainstateManage\n     if (auto value{args.GetBoolArg(\"-checkpoints\")}) opts.checkpoints_enabled = *value;\n \n     if (auto value{args.GetArg(\"-minimumchainwork\")}) {\n-        if (!IsHexNumber(*value)) {\n-            return util::Error{strprintf(Untranslated(\"Invalid non-hex (%s) minimum chain work value specified\"), *value)};\n+        if (auto min_work{uint256::FromHex(util::RemovePrefixView(*value, \"0x\"))}) {\n+            opts.minimum_chain_work = UintToArith256(*min_work);\n+        } else {\n+            return util::Error{strprintf(Untranslated(\"Invalid minimum chain work value specified (%s), must be %d character hex\"), *value, uint256::size() * 2)};",
      "path": "src/node/chainstatemanager_args.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "c0d508e69ca8896fddf5c4d9516ee9f26f15b8a2",
      "in_reply_to_id": 1700712603,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks for the suggestion. I've been exploring different options here. Adding a `bool is_num` optional param to `uint256::FromHex()` is an option, but felt a bit awkward because it'd be a uint256-specific parameter (doesn't make sense for `transaction_identifier`).\r\n\r\nSince we only need this for user input validation, I've now taken a different approach where I've repurposed `IsHexNumber()` -> `TrySanitizeHexNumber()`. I think this minimizes churn (e.g. the test suite can largely be kept as is), isolates user input validation from code that's mostly used internally and benefits from being strict and simple.",
      "created_at": "2024-08-02T16:39:43Z",
      "updated_at": "2024-08-02T16:39:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1702084437",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702084437"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": 35,
      "start_side": "LEFT",
      "line": null,
      "original_line": 38,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702085339",
      "pull_request_review_id": 2216002612,
      "id": 1702085339,
      "node_id": "PRRC_kwDOABII585lc8Lb",
      "diff_hunk": "@@ -32,13 +32,20 @@ util::Result<void> ApplyArgsManOptions(const ArgsManager& args, ChainstateManage\n     if (auto value{args.GetBoolArg(\"-checkpoints\")}) opts.checkpoints_enabled = *value;\n \n     if (auto value{args.GetArg(\"-minimumchainwork\")}) {\n-        if (!IsHexNumber(*value)) {\n-            return util::Error{strprintf(Untranslated(\"Invalid non-hex (%s) minimum chain work value specified\"), *value)};\n+        if (auto min_work{uint256::FromHex(util::RemovePrefixView(*value, \"0x\"))}) {\n+            opts.minimum_chain_work = UintToArith256(*min_work);\n+        } else {\n+            return util::Error{strprintf(Untranslated(\"Invalid minimum chain work value specified (%s), must be %d character hex\"), *value, uint256::size() * 2)};\n         }\n-        opts.minimum_chain_work = UintToArith256(uint256S(*value));\n     }\n \n-    if (auto value{args.GetArg(\"-assumevalid\")}) opts.assumed_valid_block = uint256S(*value);\n+    if (auto value{args.GetArg(\"-assumevalid\")}) {\n+        if (auto block_hash{uint256::FromHex(util::RemovePrefixView(*value, \"0x\"))}) {\n+            opts.assumed_valid_block = *block_hash;\n+        } else {\n+            return util::Error{strprintf(Untranslated(\"Invalid assumevalid block hash specified (%s), must be %d character hex\"), *value, uint256::size() * 2)};",
      "path": "src/node/chainstatemanager_args.cpp",
      "position": 18,
      "original_position": 19,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "c0d508e69ca8896fddf5c4d9516ee9f26f15b8a2",
      "in_reply_to_id": 1700717783,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`-minimumchainwork` now accepts hex number input (including \"0\") again, and `-assumevalid` has an extra `*value != \"0\"` check. Marking as resolved.",
      "created_at": "2024-08-02T16:40:44Z",
      "updated_at": "2024-08-02T16:40:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1702085339",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702085339"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 46,
      "original_line": 46,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702086239",
      "pull_request_review_id": 2216004069,
      "id": 1702086239,
      "node_id": "PRRC_kwDOABII585lc8Zf",
      "diff_hunk": "@@ -9,24 +9,26 @@\n #include <uint256.h>\n \n #include <cstdlib>\n-#include <string>\n \n FastRandomContext g_insecure_rand_ctx;\n \n+inline constexpr const char* RANDOM_CTX_SEED{\"RANDOM_CTX_SEED\"};\n+\n extern void MakeRandDeterministicDANGEROUS(const uint256& seed) noexcept;\n \n void SeedRandomForTest(SeedRand seedtype)\n {\n-    static const std::string RANDOM_CTX_SEED{\"RANDOM_CTX_SEED\"};\n-\n     // Do this once, on the first call, regardless of seedtype, because once\n     // MakeRandDeterministicDANGEROUS is called, the output of GetRandHash is\n     // no longer truly random. It should be enough to get the seed once for the\n     // process.\n     static const uint256 ctx_seed = []() {\n         // If RANDOM_CTX_SEED is set, use that as seed.\n-        const char* num = std::getenv(RANDOM_CTX_SEED.c_str());\n-        if (num) return uint256S(num);\n+        if (const auto num{std::getenv(RANDOM_CTX_SEED)}) {\n+            uint256 rv;\n+            rv.SetHexDeprecated(num);\n+            return rv;",
      "path": "src/test/util/random.cpp",
      "position": null,
      "original_position": 27,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "c0d508e69ca8896fddf5c4d9516ee9f26f15b8a2",
      "in_reply_to_id": 1700718302,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done (and `RANDOM_CTX_SEED` now also accepts < 64 character input string), thanks.",
      "created_at": "2024-08-02T16:41:34Z",
      "updated_at": "2024-08-02T16:41:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1702086239",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702086239"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": 28,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 30,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702827034",
      "pull_request_review_id": 2217100926,
      "id": 1702827034,
      "node_id": "PRRC_kwDOABII585lfxQa",
      "diff_hunk": "@@ -27,7 +27,7 @@ FUZZ_TARGET(hex)\n     if (IsHex(random_hex_string)) {\n         assert(ToLower(random_hex_string) == hex_data);\n     }\n-    (void)IsHexNumber(random_hex_string);\n+    (void)TrySanitizeHexNumber(random_hex_string);",
      "path": "src/test/fuzz/hex.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "713d92e29f4f882031ede2903664e8e64952629d",
      "in_reply_to_id": null,
      "user": {
        "login": "paplorinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paplorinc",
        "html_url": "https://github.com/paplorinc",
        "followers_url": "https://api.github.com/users/paplorinc/followers",
        "following_url": "https://api.github.com/users/paplorinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paplorinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paplorinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paplorinc/subscriptions",
        "organizations_url": "https://api.github.com/users/paplorinc/orgs",
        "repos_url": "https://api.github.com/users/paplorinc/repos",
        "events_url": "https://api.github.com/users/paplorinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paplorinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "would it make sense to test the `result_size` param here, too?",
      "created_at": "2024-08-03T16:36:16Z",
      "updated_at": "2024-08-03T19:19:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1702827034",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702827034"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 30,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702836629",
      "pull_request_review_id": 2217100926,
      "id": 1702836629,
      "node_id": "PRRC_kwDOABII585lfzmV",
      "diff_hunk": "@@ -432,29 +432,33 @@ BOOST_AUTO_TEST_CASE(util_IsHex)\n     BOOST_CHECK(!IsHex(\"0x0000\"));\n }\n \n-BOOST_AUTO_TEST_CASE(util_IsHexNumber)\n+BOOST_AUTO_TEST_CASE(util_TrySanitizeHexNumber)\n {\n-    BOOST_CHECK(IsHexNumber(\"0x0\"));\n-    BOOST_CHECK(IsHexNumber(\"0\"));\n-    BOOST_CHECK(IsHexNumber(\"0x10\"));\n-    BOOST_CHECK(IsHexNumber(\"10\"));\n-    BOOST_CHECK(IsHexNumber(\"0xff\"));\n-    BOOST_CHECK(IsHexNumber(\"ff\"));\n-    BOOST_CHECK(IsHexNumber(\"0xFfa\"));\n-    BOOST_CHECK(IsHexNumber(\"Ffa\"));\n-    BOOST_CHECK(IsHexNumber(\"0x00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n-    BOOST_CHECK(IsHexNumber(\"00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n-\n-    BOOST_CHECK(!IsHexNumber(\"\"));   // empty string not allowed\n-    BOOST_CHECK(!IsHexNumber(\"0x\")); // empty string after prefix not allowed\n-    BOOST_CHECK(!IsHexNumber(\"0x0 \")); // no spaces at end,\n-    BOOST_CHECK(!IsHexNumber(\" 0x0\")); // or beginning,\n-    BOOST_CHECK(!IsHexNumber(\"0x 0\")); // or middle,\n-    BOOST_CHECK(!IsHexNumber(\" \"));    // etc.\n-    BOOST_CHECK(!IsHexNumber(\"0x0ga\")); // invalid character\n-    BOOST_CHECK(!IsHexNumber(\"x0\"));    // broken prefix\n-    BOOST_CHECK(!IsHexNumber(\"0x0x00\")); // two prefixes not allowed\n-\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0x0\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0x10\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"10\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0xff\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"ff\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0xFfa\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"Ffa\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0x00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n+\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"\"));       // empty string not allowed\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x\"));     // empty string after prefix not allowed\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x0 \"));   // no spaces at end,\n+    BOOST_CHECK(!TrySanitizeHexNumber(\" 0x0\"));   // or beginning,\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x 0\"));   // or middle,\n+    BOOST_CHECK(!TrySanitizeHexNumber(\" \"));      // etc.\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x0ga\"));  // invalid character\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"x0\"));     // broken prefix\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x0x00\")); // two prefixes not allowed\n+\n+    BOOST_CHECK_EQUAL(TrySanitizeHexNumber(\"0x1234\", /*target_size=*/0).value(), \"1234\");",
      "path": "src/test/util_tests.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "713d92e29f4f882031ede2903664e8e64952629d",
      "in_reply_to_id": null,
      "user": {
        "login": "paplorinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paplorinc",
        "html_url": "https://github.com/paplorinc",
        "followers_url": "https://api.github.com/users/paplorinc/followers",
        "following_url": "https://api.github.com/users/paplorinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paplorinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paplorinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paplorinc/subscriptions",
        "organizations_url": "https://api.github.com/users/paplorinc/orgs",
        "repos_url": "https://api.github.com/users/paplorinc/repos",
        "events_url": "https://api.github.com/users/paplorinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paplorinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I find it a bit surprising that a result size of 0 returns a value with size 4.\r\nDo you think it would make sense to ignore negative values instead, so that a `result_size` of 0 returns an empty string instead, to make it slightly more intuitive?",
      "created_at": "2024-08-03T16:42:54Z",
      "updated_at": "2024-08-03T19:22:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1702836629",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702836629"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 458,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702840728",
      "pull_request_review_id": 2217100926,
      "id": 1702840728,
      "node_id": "PRRC_kwDOABII585lf0mY",
      "diff_hunk": "@@ -46,14 +46,19 @@ bool IsHex(std::string_view str)\n     return (str.size() > 0) && (str.size()%2 == 0);\n }\n \n-bool IsHexNumber(std::string_view str)\n+std::optional<std::string> TrySanitizeHexNumber(std::string_view input, size_t result_size)\n {\n-    if (str.substr(0, 2) == \"0x\") str.remove_prefix(2);\n-    for (char c : str) {\n-        if (HexDigit(c) < 0) return false;\n+    input = util::RemovePrefixView(input, \"0x\");\n+    if (input.empty() || (result_size && input.size() > result_size)) return std::nullopt;\n+    for (char c : input) {\n+        if (HexDigit(c) < 0) return std::nullopt;\n     }\n-    // Return false for empty string or \"0x\".\n-    return str.size() > 0;\n+    std::string result{input};\n+    if (input.size() < result_size) {",
      "path": "src/util/strencodings.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "713d92e29f4f882031ede2903664e8e64952629d",
      "in_reply_to_id": null,
      "user": {
        "login": "paplorinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paplorinc",
        "html_url": "https://github.com/paplorinc",
        "followers_url": "https://api.github.com/users/paplorinc/followers",
        "following_url": "https://api.github.com/users/paplorinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paplorinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paplorinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paplorinc/subscriptions",
        "organizations_url": "https://api.github.com/users/paplorinc/orgs",
        "repos_url": "https://api.github.com/users/paplorinc/repos",
        "events_url": "https://api.github.com/users/paplorinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paplorinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "since we've checked `>` before, maybe it would be more self-explanatory to check whether we're equal or not, since it's a stronger guarantee:\r\n```suggestion\r\n    if (input.size() != result_size) {\r\n```",
      "created_at": "2024-08-03T16:47:13Z",
      "updated_at": "2024-08-03T19:19:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1702840728",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702840728"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 57,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702847680",
      "pull_request_review_id": 2217100926,
      "id": 1702847680,
      "node_id": "PRRC_kwDOABII585lf2TA",
      "diff_hunk": "@@ -46,14 +46,19 @@ bool IsHex(std::string_view str)\n     return (str.size() > 0) && (str.size()%2 == 0);\n }\n \n-bool IsHexNumber(std::string_view str)\n+std::optional<std::string> TrySanitizeHexNumber(std::string_view input, size_t result_size)",
      "path": "src/util/strencodings.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "713d92e29f4f882031ede2903664e8e64952629d",
      "in_reply_to_id": null,
      "user": {
        "login": "paplorinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paplorinc",
        "html_url": "https://github.com/paplorinc",
        "followers_url": "https://api.github.com/users/paplorinc/followers",
        "following_url": "https://api.github.com/users/paplorinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paplorinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paplorinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paplorinc/subscriptions",
        "organizations_url": "https://api.github.com/users/paplorinc/orgs",
        "repos_url": "https://api.github.com/users/paplorinc/repos",
        "events_url": "https://api.github.com/users/paplorinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paplorinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Does it still make sense to suffix it with `Number` after the change?\r\nAnd besides the `TryParseHex` below, it doesn't seem common to prefix optional returning methods with `Try` - the return type already states that the operation might not succeed, `Try` seems redundant.",
      "created_at": "2024-08-03T16:59:53Z",
      "updated_at": "2024-08-03T19:19:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1702847680",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702847680"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 49,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702847776",
      "pull_request_review_id": 2217100926,
      "id": 1702847776,
      "node_id": "PRRC_kwDOABII585lf2Ug",
      "diff_hunk": "@@ -71,9 +71,20 @@ std::vector<Byte> ParseHex(std::string_view hex_str)\n  * number of hex digits.*/\n bool IsHex(std::string_view str);\n /**\n-* Return true if the string is a hex number, optionally prefixed with \"0x\"\n-*/\n-bool IsHexNumber(std::string_view str);\n+ * @brief Return a sanitized hex string if input is a valid hex number.\n+ *        \"0x\" prefix is removed, and if result_size is specified, the\n+ *        result is padded with leading zeroes until result_size is\n+ *        reached, or std::nullopt returned if input is longer than\n+ *        result_size.\n+ *\n+ * @param input Hex encoding of a number, optionally prefixed with 0x.\n+ * @param result_size Size of the resulting string, causing zero-padding\n+ *                    if input is too short, or a std::nullopt return\n+ *                    value if input is too long. Disabled if <= 0.",
      "path": "src/util/strencodings.h",
      "position": null,
      "original_position": 16,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "713d92e29f4f882031ede2903664e8e64952629d",
      "in_reply_to_id": null,
      "user": {
        "login": "paplorinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paplorinc",
        "html_url": "https://github.com/paplorinc",
        "followers_url": "https://api.github.com/users/paplorinc/followers",
        "following_url": "https://api.github.com/users/paplorinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paplorinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paplorinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paplorinc/subscriptions",
        "organizations_url": "https://api.github.com/users/paplorinc/orgs",
        "repos_url": "https://api.github.com/users/paplorinc/repos",
        "events_url": "https://api.github.com/users/paplorinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paplorinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Can it be negative?",
      "created_at": "2024-08-03T17:00:58Z",
      "updated_at": "2024-08-03T19:19:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1702847776",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702847776"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 83,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702863593",
      "pull_request_review_id": 2217100926,
      "id": 1702863593,
      "node_id": "PRRC_kwDOABII585lf6Lp",
      "diff_hunk": "@@ -32,13 +32,20 @@ util::Result<void> ApplyArgsManOptions(const ArgsManager& args, ChainstateManage\n     if (auto value{args.GetBoolArg(\"-checkpoints\")}) opts.checkpoints_enabled = *value;\n \n     if (auto value{args.GetArg(\"-minimumchainwork\")}) {\n-        if (!IsHexNumber(*value)) {\n+        if (auto sanitized_hex{TrySanitizeHexNumber(*value, /*result_size=*/64)}) {\n+            opts.minimum_chain_work = UintToArith256(*uint256::FromHex(*sanitized_hex));\n+        } else {\n             return util::Error{strprintf(Untranslated(\"Invalid non-hex (%s) minimum chain work value specified\"), *value)};\n         }\n-        opts.minimum_chain_work = UintToArith256(uint256S(*value));\n     }\n \n-    if (auto value{args.GetArg(\"-assumevalid\")}) opts.assumed_valid_block = uint256S(*value);\n+    if (auto value{args.GetArg(\"-assumevalid\")}; value && *value != \"0\") {",
      "path": "src/node/chainstatemanager_args.cpp",
      "position": 14,
      "original_position": 14,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "b38a259d1e2749876d4e3a15f218b4f257049320",
      "in_reply_to_id": null,
      "user": {
        "login": "paplorinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paplorinc",
        "html_url": "https://github.com/paplorinc",
        "followers_url": "https://api.github.com/users/paplorinc/followers",
        "following_url": "https://api.github.com/users/paplorinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paplorinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paplorinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paplorinc/subscriptions",
        "organizations_url": "https://api.github.com/users/paplorinc/orgs",
        "repos_url": "https://api.github.com/users/paplorinc/repos",
        "events_url": "https://api.github.com/users/paplorinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paplorinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "shouldn't we still set the `assumed_valid_block` value when it's `0`, given that `defaultAssumeValid` isn't `0`?",
      "created_at": "2024-08-03T19:14:48Z",
      "updated_at": "2024-08-03T19:19:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1702863593",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702863593"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 42,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702863957",
      "pull_request_review_id": 2217100926,
      "id": 1702863957,
      "node_id": "PRRC_kwDOABII585lf6RV",
      "diff_hunk": "@@ -71,9 +71,20 @@ std::vector<Byte> ParseHex(std::string_view hex_str)\n  * number of hex digits.*/\n bool IsHex(std::string_view str);\n /**\n-* Return true if the string is a hex number, optionally prefixed with \"0x\"\n-*/\n-bool IsHexNumber(std::string_view str);\n+ * @brief Return a sanitized hex string if input is a valid hex number.\n+ *        \"0x\" prefix is removed, and if result_size is specified, the\n+ *        result is padded with leading zeroes until result_size is\n+ *        reached, or std::nullopt returned if input is longer than\n+ *        result_size.\n+ *\n+ * @param input Hex encoding of a number, optionally prefixed with 0x.\n+ * @param result_size Size of the resulting string, causing zero-padding",
      "path": "src/util/strencodings.h",
      "position": 14,
      "original_position": 14,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "b38a259d1e2749876d4e3a15f218b4f257049320",
      "in_reply_to_id": null,
      "user": {
        "login": "paplorinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paplorinc",
        "html_url": "https://github.com/paplorinc",
        "followers_url": "https://api.github.com/users/paplorinc/followers",
        "following_url": "https://api.github.com/users/paplorinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paplorinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paplorinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paplorinc/subscriptions",
        "organizations_url": "https://api.github.com/users/paplorinc/orgs",
        "repos_url": "https://api.github.com/users/paplorinc/repos",
        "events_url": "https://api.github.com/users/paplorinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paplorinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think we could document how to disable this param - currently with 0, I recommend considering negative numbers",
      "created_at": "2024-08-03T19:18:30Z",
      "updated_at": "2024-08-03T19:19:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1702863957",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702863957"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 81,
      "original_line": 81,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702864451",
      "pull_request_review_id": 2217172418,
      "id": 1702864451,
      "node_id": "PRRC_kwDOABII585lf6ZD",
      "diff_hunk": "@@ -432,29 +432,33 @@ BOOST_AUTO_TEST_CASE(util_IsHex)\n     BOOST_CHECK(!IsHex(\"0x0000\"));\n }\n \n-BOOST_AUTO_TEST_CASE(util_IsHexNumber)\n+BOOST_AUTO_TEST_CASE(util_TrySanitizeHexNumber)\n {\n-    BOOST_CHECK(IsHexNumber(\"0x0\"));\n-    BOOST_CHECK(IsHexNumber(\"0\"));\n-    BOOST_CHECK(IsHexNumber(\"0x10\"));\n-    BOOST_CHECK(IsHexNumber(\"10\"));\n-    BOOST_CHECK(IsHexNumber(\"0xff\"));\n-    BOOST_CHECK(IsHexNumber(\"ff\"));\n-    BOOST_CHECK(IsHexNumber(\"0xFfa\"));\n-    BOOST_CHECK(IsHexNumber(\"Ffa\"));\n-    BOOST_CHECK(IsHexNumber(\"0x00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n-    BOOST_CHECK(IsHexNumber(\"00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n-\n-    BOOST_CHECK(!IsHexNumber(\"\"));   // empty string not allowed\n-    BOOST_CHECK(!IsHexNumber(\"0x\")); // empty string after prefix not allowed\n-    BOOST_CHECK(!IsHexNumber(\"0x0 \")); // no spaces at end,\n-    BOOST_CHECK(!IsHexNumber(\" 0x0\")); // or beginning,\n-    BOOST_CHECK(!IsHexNumber(\"0x 0\")); // or middle,\n-    BOOST_CHECK(!IsHexNumber(\" \"));    // etc.\n-    BOOST_CHECK(!IsHexNumber(\"0x0ga\")); // invalid character\n-    BOOST_CHECK(!IsHexNumber(\"x0\"));    // broken prefix\n-    BOOST_CHECK(!IsHexNumber(\"0x0x00\")); // two prefixes not allowed\n-\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0x0\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0x10\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"10\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0xff\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"ff\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0xFfa\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"Ffa\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0x00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n+\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"\"));       // empty string not allowed\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x\"));     // empty string after prefix not allowed\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x0 \"));   // no spaces at end,\n+    BOOST_CHECK(!TrySanitizeHexNumber(\" 0x0\"));   // or beginning,\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x 0\"));   // or middle,\n+    BOOST_CHECK(!TrySanitizeHexNumber(\" \"));      // etc.\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x0ga\"));  // invalid character\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"x0\"));     // broken prefix\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x0x00\")); // two prefixes not allowed\n+\n+    BOOST_CHECK_EQUAL(TrySanitizeHexNumber(\"0x1234\", /*target_size=*/0).value(), \"1234\");\n+    BOOST_CHECK_EQUAL(TrySanitizeHexNumber(\"0x1234\", /*target_size=*/4).value(), \"1234\");",
      "path": "src/test/util_tests.cpp",
      "position": null,
      "original_position": 50,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "b38a259d1e2749876d4e3a15f218b4f257049320",
      "in_reply_to_id": null,
      "user": {
        "login": "paplorinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paplorinc",
        "html_url": "https://github.com/paplorinc",
        "followers_url": "https://api.github.com/users/paplorinc/followers",
        "following_url": "https://api.github.com/users/paplorinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paplorinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paplorinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paplorinc/subscriptions",
        "organizations_url": "https://api.github.com/users/paplorinc/orgs",
        "repos_url": "https://api.github.com/users/paplorinc/repos",
        "events_url": "https://api.github.com/users/paplorinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paplorinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    BOOST_CHECK_EQUAL(TrySanitizeHexNumber(\"0x1234\", /*result_size=*/4).value(), \"1234\");\r\n```",
      "created_at": "2024-08-03T19:22:33Z",
      "updated_at": "2024-08-03T19:22:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1702864451",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1702864451"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 459,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1703942199",
      "pull_request_review_id": 2218701543,
      "id": 1703942199,
      "node_id": "PRRC_kwDOABII585lkBg3",
      "diff_hunk": "@@ -7,26 +7,29 @@\n #include <logging.h>\n #include <random.h>\n #include <uint256.h>\n+#include <util/check.h>\n+#include <util/strencodings.h>\n \n #include <cstdlib>\n-#include <string>\n \n FastRandomContext g_insecure_rand_ctx;\n \n+inline constexpr const char* RANDOM_CTX_SEED{\"RANDOM_CTX_SEED\"};\n+\n extern void MakeRandDeterministicDANGEROUS(const uint256& seed) noexcept;\n \n void SeedRandomForTest(SeedRand seedtype)\n {\n-    static const std::string RANDOM_CTX_SEED{\"RANDOM_CTX_SEED\"};\n-\n     // Do this once, on the first call, regardless of seedtype, because once\n     // MakeRandDeterministicDANGEROUS is called, the output of GetRandHash is\n     // no longer truly random. It should be enough to get the seed once for the\n     // process.\n     static const uint256 ctx_seed = []() {\n         // If RANDOM_CTX_SEED is set, use that as seed.\n-        const char* num = std::getenv(RANDOM_CTX_SEED.c_str());\n-        if (num) return uint256S(num);\n+        if (const auto num{std::getenv(RANDOM_CTX_SEED)}) {\n+            auto sanitized{*Assert(TrySanitizeHexNumber(num, uint256::size() * 2))}; // RANDOM_CTX_SEED must be up to 64 char hex string",
      "path": "src/test/util/random.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "b38a259d1e2749876d4e3a15f218b4f257049320",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I just don't see the use case to accept accidentally truncated input silently. Why not just fa295215f6fa3b85b0387511920f75eeb3e12b58?",
      "created_at": "2024-08-05T11:02:23Z",
      "updated_at": "2024-08-05T11:02:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1703942199",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1703942199"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 30,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1704179447",
      "pull_request_review_id": 2219106988,
      "id": 1704179447,
      "node_id": "PRRC_kwDOABII585lk7b3",
      "diff_hunk": "@@ -432,29 +432,33 @@ BOOST_AUTO_TEST_CASE(util_IsHex)\n     BOOST_CHECK(!IsHex(\"0x0000\"));\n }\n \n-BOOST_AUTO_TEST_CASE(util_IsHexNumber)\n+BOOST_AUTO_TEST_CASE(util_TrySanitizeHexNumber)\n {\n-    BOOST_CHECK(IsHexNumber(\"0x0\"));\n-    BOOST_CHECK(IsHexNumber(\"0\"));\n-    BOOST_CHECK(IsHexNumber(\"0x10\"));\n-    BOOST_CHECK(IsHexNumber(\"10\"));\n-    BOOST_CHECK(IsHexNumber(\"0xff\"));\n-    BOOST_CHECK(IsHexNumber(\"ff\"));\n-    BOOST_CHECK(IsHexNumber(\"0xFfa\"));\n-    BOOST_CHECK(IsHexNumber(\"Ffa\"));\n-    BOOST_CHECK(IsHexNumber(\"0x00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n-    BOOST_CHECK(IsHexNumber(\"00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n-\n-    BOOST_CHECK(!IsHexNumber(\"\"));   // empty string not allowed\n-    BOOST_CHECK(!IsHexNumber(\"0x\")); // empty string after prefix not allowed\n-    BOOST_CHECK(!IsHexNumber(\"0x0 \")); // no spaces at end,\n-    BOOST_CHECK(!IsHexNumber(\" 0x0\")); // or beginning,\n-    BOOST_CHECK(!IsHexNumber(\"0x 0\")); // or middle,\n-    BOOST_CHECK(!IsHexNumber(\" \"));    // etc.\n-    BOOST_CHECK(!IsHexNumber(\"0x0ga\")); // invalid character\n-    BOOST_CHECK(!IsHexNumber(\"x0\"));    // broken prefix\n-    BOOST_CHECK(!IsHexNumber(\"0x0x00\")); // two prefixes not allowed\n-\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0x0\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0x10\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"10\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0xff\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"ff\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0xFfa\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"Ffa\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0x00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n+\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"\"));       // empty string not allowed\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x\"));     // empty string after prefix not allowed\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x0 \"));   // no spaces at end,\n+    BOOST_CHECK(!TrySanitizeHexNumber(\" 0x0\"));   // or beginning,\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x 0\"));   // or middle,\n+    BOOST_CHECK(!TrySanitizeHexNumber(\" \"));      // etc.\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x0ga\"));  // invalid character\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"x0\"));     // broken prefix\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x0x00\")); // two prefixes not allowed\n+\n+    BOOST_CHECK_EQUAL(TrySanitizeHexNumber(\"0x1234\", /*target_size=*/0).value(), \"1234\");\n+    BOOST_CHECK_EQUAL(TrySanitizeHexNumber(\"0x1234\", /*target_size=*/4).value(), \"1234\");",
      "path": "src/test/util_tests.cpp",
      "position": null,
      "original_position": 50,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "b38a259d1e2749876d4e3a15f218b4f257049320",
      "in_reply_to_id": 1702864451,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks, leftover from a previous version, updated now!",
      "created_at": "2024-08-05T14:07:04Z",
      "updated_at": "2024-08-06T10:49:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1704179447",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1704179447"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 459,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1704245347",
      "pull_request_review_id": 2219106988,
      "id": 1704245347,
      "node_id": "PRRC_kwDOABII585llLhj",
      "diff_hunk": "@@ -46,14 +46,19 @@ bool IsHex(std::string_view str)\n     return (str.size() > 0) && (str.size()%2 == 0);\n }\n \n-bool IsHexNumber(std::string_view str)\n+std::optional<std::string> TrySanitizeHexNumber(std::string_view input, size_t result_size)\n {\n-    if (str.substr(0, 2) == \"0x\") str.remove_prefix(2);\n-    for (char c : str) {\n-        if (HexDigit(c) < 0) return false;\n+    input = util::RemovePrefixView(input, \"0x\");\n+    if (input.empty() || (result_size && input.size() > result_size)) return std::nullopt;\n+    for (char c : input) {\n+        if (HexDigit(c) < 0) return std::nullopt;\n     }\n-    // Return false for empty string or \"0x\".\n-    return str.size() > 0;\n+    std::string result{input};\n+    if (input.size() < result_size) {",
      "path": "src/util/strencodings.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "713d92e29f4f882031ede2903664e8e64952629d",
      "in_reply_to_id": 1702840728,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Not sure about this. I don't find it more readable, and it also makes the code less robust to changes in other lines. Going to leave as is for now.",
      "created_at": "2024-08-05T14:52:53Z",
      "updated_at": "2024-08-06T10:49:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1704245347",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1704245347"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 57,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1704246003",
      "pull_request_review_id": 2219106988,
      "id": 1704246003,
      "node_id": "PRRC_kwDOABII585llLrz",
      "diff_hunk": "@@ -71,9 +71,20 @@ std::vector<Byte> ParseHex(std::string_view hex_str)\n  * number of hex digits.*/\n bool IsHex(std::string_view str);\n /**\n-* Return true if the string is a hex number, optionally prefixed with \"0x\"\n-*/\n-bool IsHexNumber(std::string_view str);\n+ * @brief Return a sanitized hex string if input is a valid hex number.\n+ *        \"0x\" prefix is removed, and if result_size is specified, the\n+ *        result is padded with leading zeroes until result_size is\n+ *        reached, or std::nullopt returned if input is longer than\n+ *        result_size.\n+ *\n+ * @param input Hex encoding of a number, optionally prefixed with 0x.\n+ * @param result_size Size of the resulting string, causing zero-padding",
      "path": "src/util/strencodings.h",
      "position": 14,
      "original_position": 14,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "b38a259d1e2749876d4e3a15f218b4f257049320",
      "in_reply_to_id": 1702863957,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Changed to an `int` type which takes a negative value to disable.",
      "created_at": "2024-08-05T14:53:22Z",
      "updated_at": "2024-08-06T10:49:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1704246003",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1704246003"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 81,
      "original_line": 81,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1704246877",
      "pull_request_review_id": 2219106988,
      "id": 1704246877,
      "node_id": "PRRC_kwDOABII585llL5d",
      "diff_hunk": "@@ -71,9 +71,20 @@ std::vector<Byte> ParseHex(std::string_view hex_str)\n  * number of hex digits.*/\n bool IsHex(std::string_view str);\n /**\n-* Return true if the string is a hex number, optionally prefixed with \"0x\"\n-*/\n-bool IsHexNumber(std::string_view str);\n+ * @brief Return a sanitized hex string if input is a valid hex number.\n+ *        \"0x\" prefix is removed, and if result_size is specified, the\n+ *        result is padded with leading zeroes until result_size is\n+ *        reached, or std::nullopt returned if input is longer than\n+ *        result_size.\n+ *\n+ * @param input Hex encoding of a number, optionally prefixed with 0x.\n+ * @param result_size Size of the resulting string, causing zero-padding\n+ *                    if input is too short, or a std::nullopt return\n+ *                    value if input is too long. Disabled if <= 0.",
      "path": "src/util/strencodings.h",
      "position": null,
      "original_position": 16,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "713d92e29f4f882031ede2903664e8e64952629d",
      "in_reply_to_id": 1702847776,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Sorry, leftover from previous version where it could be. Since `result_size` is now an `int` again, docs updated to say `Disabled if <= -1`",
      "created_at": "2024-08-05T14:53:59Z",
      "updated_at": "2024-08-06T10:49:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1704246877",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1704246877"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 83,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1704248989",
      "pull_request_review_id": 2219106988,
      "id": 1704248989,
      "node_id": "PRRC_kwDOABII585llMad",
      "diff_hunk": "@@ -432,29 +432,33 @@ BOOST_AUTO_TEST_CASE(util_IsHex)\n     BOOST_CHECK(!IsHex(\"0x0000\"));\n }\n \n-BOOST_AUTO_TEST_CASE(util_IsHexNumber)\n+BOOST_AUTO_TEST_CASE(util_TrySanitizeHexNumber)\n {\n-    BOOST_CHECK(IsHexNumber(\"0x0\"));\n-    BOOST_CHECK(IsHexNumber(\"0\"));\n-    BOOST_CHECK(IsHexNumber(\"0x10\"));\n-    BOOST_CHECK(IsHexNumber(\"10\"));\n-    BOOST_CHECK(IsHexNumber(\"0xff\"));\n-    BOOST_CHECK(IsHexNumber(\"ff\"));\n-    BOOST_CHECK(IsHexNumber(\"0xFfa\"));\n-    BOOST_CHECK(IsHexNumber(\"Ffa\"));\n-    BOOST_CHECK(IsHexNumber(\"0x00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n-    BOOST_CHECK(IsHexNumber(\"00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n-\n-    BOOST_CHECK(!IsHexNumber(\"\"));   // empty string not allowed\n-    BOOST_CHECK(!IsHexNumber(\"0x\")); // empty string after prefix not allowed\n-    BOOST_CHECK(!IsHexNumber(\"0x0 \")); // no spaces at end,\n-    BOOST_CHECK(!IsHexNumber(\" 0x0\")); // or beginning,\n-    BOOST_CHECK(!IsHexNumber(\"0x 0\")); // or middle,\n-    BOOST_CHECK(!IsHexNumber(\" \"));    // etc.\n-    BOOST_CHECK(!IsHexNumber(\"0x0ga\")); // invalid character\n-    BOOST_CHECK(!IsHexNumber(\"x0\"));    // broken prefix\n-    BOOST_CHECK(!IsHexNumber(\"0x0x00\")); // two prefixes not allowed\n-\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0x0\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0x10\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"10\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0xff\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"ff\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0xFfa\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"Ffa\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"0x00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n+    BOOST_CHECK(TrySanitizeHexNumber(\"00112233445566778899aabbccddeeffAABBCCDDEEFF\"));\n+\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"\"));       // empty string not allowed\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x\"));     // empty string after prefix not allowed\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x0 \"));   // no spaces at end,\n+    BOOST_CHECK(!TrySanitizeHexNumber(\" 0x0\"));   // or beginning,\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x 0\"));   // or middle,\n+    BOOST_CHECK(!TrySanitizeHexNumber(\" \"));      // etc.\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x0ga\"));  // invalid character\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"x0\"));     // broken prefix\n+    BOOST_CHECK(!TrySanitizeHexNumber(\"0x0x00\")); // two prefixes not allowed\n+\n+    BOOST_CHECK_EQUAL(TrySanitizeHexNumber(\"0x1234\", /*target_size=*/0).value(), \"1234\");",
      "path": "src/test/util_tests.cpp",
      "position": null,
      "original_position": 49,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "713d92e29f4f882031ede2903664e8e64952629d",
      "in_reply_to_id": 1702836629,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done (although `result_size=0` will always return `std::nullopt` because empty input strings are not allowed as per the existing `IsHexNumber` behaviour)",
      "created_at": "2024-08-05T14:55:29Z",
      "updated_at": "2024-08-06T10:49:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1704248989",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1704248989"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 458,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1705281963",
      "pull_request_review_id": 2219106988,
      "id": 1705281963,
      "node_id": "PRRC_kwDOABII585lpImr",
      "diff_hunk": "@@ -32,13 +32,20 @@ util::Result<void> ApplyArgsManOptions(const ArgsManager& args, ChainstateManage\n     if (auto value{args.GetBoolArg(\"-checkpoints\")}) opts.checkpoints_enabled = *value;\n \n     if (auto value{args.GetArg(\"-minimumchainwork\")}) {\n-        if (!IsHexNumber(*value)) {\n+        if (auto sanitized_hex{TrySanitizeHexNumber(*value, /*result_size=*/64)}) {\n+            opts.minimum_chain_work = UintToArith256(*uint256::FromHex(*sanitized_hex));\n+        } else {\n             return util::Error{strprintf(Untranslated(\"Invalid non-hex (%s) minimum chain work value specified\"), *value)};\n         }\n-        opts.minimum_chain_work = UintToArith256(uint256S(*value));\n     }\n \n-    if (auto value{args.GetArg(\"-assumevalid\")}) opts.assumed_valid_block = uint256S(*value);\n+    if (auto value{args.GetArg(\"-assumevalid\")}; value && *value != \"0\") {",
      "path": "src/node/chainstatemanager_args.cpp",
      "position": 14,
      "original_position": 14,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "b38a259d1e2749876d4e3a15f218b4f257049320",
      "in_reply_to_id": 1702863593,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ugh, you're right, thanks a lot for catching this. This approach would've silently ignored `-noassumevalid` and `-assumevalid=0` by using the `defaultAssumeValid` value instead. I think it's not great that this bug didn't cause any tests to fail. `feature_assumevalid.py` doesn't catch this because `defaultAssumeValid` on regtest [is null](https://github.com/bitcoin/bitcoin/blob/43740f4971f45cd5499470b6a085b3ecd8b96d28/src/kernel/chainparams.cpp#L452) (and I don't think there's a way around this), and we don't seem to have any unittesting on applying args to options.\r\n\r\nI've added e9dd47c66426c04fc6f0780d67ba0c05f26f9920 as a first commit (fails on b38a259d1e2749876d4e3a15f218b4f257049320) to add unittesting on `-assumevalid` and `-minimumchainwork`. ",
      "created_at": "2024-08-06T10:13:59Z",
      "updated_at": "2024-08-06T10:49:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1705281963",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1705281963"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 42,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1705285352",
      "pull_request_review_id": 2219106988,
      "id": 1705285352,
      "node_id": "PRRC_kwDOABII585lpJbo",
      "diff_hunk": "@@ -46,14 +46,19 @@ bool IsHex(std::string_view str)\n     return (str.size() > 0) && (str.size()%2 == 0);\n }\n \n-bool IsHexNumber(std::string_view str)\n+std::optional<std::string> TrySanitizeHexNumber(std::string_view input, size_t result_size)",
      "path": "src/util/strencodings.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "713d92e29f4f882031ede2903664e8e64952629d",
      "in_reply_to_id": 1702847680,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The `Number` part indicates that we're dealing with numerical values, where `0x00` means the same thing as `0x0000`, so I think that aligns with how the function behaves?\r\nReturn types are not immediately visible on in the callsite, and I think `Try` indicating that the function accepts malformed input is helpful for the reader, so I'm going to leave this as is.",
      "created_at": "2024-08-06T10:16:53Z",
      "updated_at": "2024-08-06T10:49:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1705285352",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1705285352"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 49,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1705293768",
      "pull_request_review_id": 2219106988,
      "id": 1705293768,
      "node_id": "PRRC_kwDOABII585lpLfI",
      "diff_hunk": "@@ -7,26 +7,29 @@\n #include <logging.h>\n #include <random.h>\n #include <uint256.h>\n+#include <util/check.h>\n+#include <util/strencodings.h>\n \n #include <cstdlib>\n-#include <string>\n \n FastRandomContext g_insecure_rand_ctx;\n \n+inline constexpr const char* RANDOM_CTX_SEED{\"RANDOM_CTX_SEED\"};\n+\n extern void MakeRandDeterministicDANGEROUS(const uint256& seed) noexcept;\n \n void SeedRandomForTest(SeedRand seedtype)\n {\n-    static const std::string RANDOM_CTX_SEED{\"RANDOM_CTX_SEED\"};\n-\n     // Do this once, on the first call, regardless of seedtype, because once\n     // MakeRandDeterministicDANGEROUS is called, the output of GetRandHash is\n     // no longer truly random. It should be enough to get the seed once for the\n     // process.\n     static const uint256 ctx_seed = []() {\n         // If RANDOM_CTX_SEED is set, use that as seed.\n-        const char* num = std::getenv(RANDOM_CTX_SEED.c_str());\n-        if (num) return uint256S(num);\n+        if (const auto num{std::getenv(RANDOM_CTX_SEED)}) {\n+            auto sanitized{*Assert(TrySanitizeHexNumber(num, uint256::size() * 2))}; // RANDOM_CTX_SEED must be up to 64 char hex string",
      "path": "src/test/util/random.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "b38a259d1e2749876d4e3a15f218b4f257049320",
      "in_reply_to_id": 1703942199,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I couldn't see `RANDOM_CTX_SEED` be documented anywhere as having to be a 64 char hex string, so I thought trying to be lenient would be good for backwards compatibility, but I don't have a view on how important that is so happy to go with your simplification. Adopted in latest force push.",
      "created_at": "2024-08-06T10:24:02Z",
      "updated_at": "2024-08-06T10:49:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1705293768",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1705293768"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 30,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1705382053",
      "pull_request_review_id": 2221052712,
      "id": 1705382053,
      "node_id": "PRRC_kwDOABII585lphCl",
      "diff_hunk": "@@ -46,14 +46,19 @@ bool IsHex(std::string_view str)\n     return (str.size() > 0) && (str.size()%2 == 0);\n }\n \n-bool IsHexNumber(std::string_view str)\n+std::optional<std::string> TrySanitizeHexNumber(std::string_view input, size_t result_size)\n {\n-    if (str.substr(0, 2) == \"0x\") str.remove_prefix(2);\n-    for (char c : str) {\n-        if (HexDigit(c) < 0) return false;\n+    input = util::RemovePrefixView(input, \"0x\");\n+    if (input.empty() || (result_size && input.size() > result_size)) return std::nullopt;\n+    for (char c : input) {\n+        if (HexDigit(c) < 0) return std::nullopt;\n     }\n-    // Return false for empty string or \"0x\".\n-    return str.size() > 0;\n+    std::string result{input};\n+    if (input.size() < result_size) {",
      "path": "src/util/strencodings.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "713d92e29f4f882031ede2903664e8e64952629d",
      "in_reply_to_id": 1702840728,
      "user": {
        "login": "paplorinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paplorinc",
        "html_url": "https://github.com/paplorinc",
        "followers_url": "https://api.github.com/users/paplorinc/followers",
        "following_url": "https://api.github.com/users/paplorinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paplorinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paplorinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paplorinc/subscriptions",
        "organizations_url": "https://api.github.com/users/paplorinc/orgs",
        "repos_url": "https://api.github.com/users/paplorinc/repos",
        "events_url": "https://api.github.com/users/paplorinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paplorinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "👍, thanks for considering",
      "created_at": "2024-08-06T11:35:45Z",
      "updated_at": "2024-08-06T11:35:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1705382053",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1705382053"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 57,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1705386853",
      "pull_request_review_id": 2221060518,
      "id": 1705386853,
      "node_id": "PRRC_kwDOABII585lpiNl",
      "diff_hunk": "@@ -46,14 +46,19 @@ bool IsHex(std::string_view str)\n     return (str.size() > 0) && (str.size()%2 == 0);\n }\n \n-bool IsHexNumber(std::string_view str)\n+std::optional<std::string> TrySanitizeHexNumber(std::string_view input, size_t result_size)",
      "path": "src/util/strencodings.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "d7f866f90201b23016c9da17f367e45fd9ec9806",
      "original_commit_id": "713d92e29f4f882031ede2903664e8e64952629d",
      "in_reply_to_id": 1702847680,
      "user": {
        "login": "paplorinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/paplorinc",
        "html_url": "https://github.com/paplorinc",
        "followers_url": "https://api.github.com/users/paplorinc/followers",
        "following_url": "https://api.github.com/users/paplorinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/paplorinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/paplorinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/paplorinc/subscriptions",
        "organizations_url": "https://api.github.com/users/paplorinc/orgs",
        "repos_url": "https://api.github.com/users/paplorinc/repos",
        "events_url": "https://api.github.com/users/paplorinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/paplorinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "ok, the number part can make sense, I'm still not sure about the `Try` part - seems like https://en.wikipedia.org/wiki/Hungarian_notation, which (as a Hungarian) I'm very much against :p\r\n\r\n> Return types are not immediately visible on in the callsite\r\n\r\nIt's part of the method's signature, I don't see how repeating it in the method's name helps.\r\nThe parameters also aren't visible on the call site, yet we're not encoding them in the method's name.\r\n\r\nIf you insist, I won't block you on this of course, but want to make sure that my arguments against it are clear.",
      "created_at": "2024-08-06T11:39:55Z",
      "updated_at": "2024-08-06T11:39:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30569#discussion_r1705386853",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1705386853"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30569"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 49,
      "side": "RIGHT"
    }
  ]
}