{
  "type": "issue",
  "issue": {
    "id": 1708710593,
    "node_id": "I_kwDOABII585l2NrB",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27652",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27652/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27652/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27652/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/27652",
    "number": 27652,
    "state": "open",
    "state_reason": null,
    "title": "Allow getblockfrompeer to use any peer",
    "body": "### Please describe the feature you'd like to see added.\n\nWhen you use `getblockfrompeer` you have to specify an index of a specific peer. But it would be much easier if it allowed you to use ANY peer.\r\n\r\nFor example, if you run a pruned node, and your first peer happens to be also pruned, the call will fail. If the call tried all nodes, until it finds a peer that has the block, it wouldn't require you that implement any logic for that.\n\n### Is your feature related to a problem, if so please describe it.\n\n_No response_\n\n### Describe the solution you'd like\n\nThe solution would be simple: if you don't specify any index, then try all peers untill you find one that does have block, otherwise fail.\n\n### Describe any alternatives you've considered\n\n_No response_\n\n### Please leave any additional context\n\n_No response_",
    "user": {
      "login": "kroese",
      "id": 5763256,
      "node_id": "MDQ6VXNlcjU3NjMyNTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kroese",
      "html_url": "https://github.com/kroese",
      "followers_url": "https://api.github.com/users/kroese/followers",
      "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
      "organizations_url": "https://api.github.com/users/kroese/orgs",
      "repos_url": "https://api.github.com/users/kroese/repos",
      "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/kroese/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 64583,
        "node_id": "MDU6TGFiZWw2NDU4Mw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature",
        "name": "Feature",
        "color": "7cf575",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 10,
    "created_at": "2023-05-13T18:44:59Z",
    "updated_at": "2023-05-16T17:16:11Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 9239063420,
      "node_id": "LE_lADOABII585l2NrBzwAAAAImsOt8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9239063420",
      "actor": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-13T18:44:59Z",
      "label": {
        "name": "Feature",
        "color": "7cf575"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-13T18:52:48Z",
      "updated_at": "2023-05-13T18:52:48Z",
      "source": {
        "issue": {
          "id": 1262882017,
          "node_id": "I_kwDOAjnsSM5LRgzh",
          "url": "https://api.github.com/repos/ElementsProject/lightning/issues/5310",
          "repository_url": "https://api.github.com/repos/ElementsProject/lightning",
          "labels_url": "https://api.github.com/repos/ElementsProject/lightning/issues/5310/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/ElementsProject/lightning/issues/5310/comments",
          "events_url": "https://api.github.com/repos/ElementsProject/lightning/issues/5310/events",
          "html_url": "https://github.com/ElementsProject/lightning/issues/5310",
          "number": 5310,
          "state": "open",
          "state_reason": null,
          "title": "Pruning problem",
          "body": "I did a fresh installation of bitcoind with pruning set to 100gb. I waited untill it was completely synced. Then I installed CLN and connected to the bitcoind node.\r\n\r\nThe problem is that for the last hour it keeps requesting the same block from 2018 every second in a loop:\r\n\r\n`UNUSUAL plugin-bcli: /usr/bin/bitcoin-cli -datadir=/data/.bitcoin -rpcconnect=172.17.0.2 -rpcport=8332 -rpcuser=... -rpcpassword=... getblock 00000000000000000005f7a06bd4efe545999aba00eeff9a49747a3cd1f3c9df 0 exited with status 1`\r\n\r\nI don't understand why it keeps on trying this same block, since it should realize it's not available after trying only once. I think it heard of this block through channel gossip, since I don't have any channels yet myself. \r\n\r\nBesides the problem with CLN getting stuck on this block, I think I will have another problem. \r\n\r\nNamely that my graph will miss all channels created more than a year ago? I thought a pruned node would be fully functional, but if I miss all the old channels it is a big downside. \r\n\r\nSo is my mistake that I should have already started CLN while Bitcoin was still syncing the chain? That way CLN would have had access to the blocks from 2018 that are now pruned. Or is there no solution?\r\n\r\n\r\n### `getinfo` output\r\n```\r\n{\r\n   \"id\": \"xxxx\",\r\n   \"alias\": \"xxxx\",\r\n   \"color\": \"xxxxxx\",\r\n   \"num_peers\": 1,\r\n   \"num_pending_channels\": 0,\r\n   \"num_active_channels\": 0,\r\n   \"num_inactive_channels\": 0,\r\n   \"address\": [\r\n      {\r\n         \"type\": \"ipv4\",\r\n         \"address\": \"xx.xx.xx.xx\",\r\n         \"port\": 9760\r\n      }\r\n   ],\r\n   \"binding\": [\r\n      {\r\n         \"type\": \"ipv4\",\r\n         \"address\": \"0.0.0.0\",\r\n         \"port\": 9735\r\n      }\r\n   ],\r\n   \"version\": \"v0.10.2\",\r\n   \"blockheight\": 739674,\r\n   \"network\": \"bitcoin\",\r\n   \"msatoshi_fees_collected\": 0,\r\n   \"fees_collected_msat\": \"0msat\",\r\n   \"lightning-dir\": \"/data/.lightning/bitcoin\"\r\n}\r\n```",
          "user": {
            "login": "kroese",
            "id": 5763256,
            "node_id": "MDQ6VXNlcjU3NjMyNTY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/kroese",
            "html_url": "https://github.com/kroese",
            "followers_url": "https://api.github.com/users/kroese/followers",
            "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
            "organizations_url": "https://api.github.com/users/kroese/orgs",
            "repos_url": "https://api.github.com/users/kroese/repos",
            "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/kroese/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 2692096788,
              "node_id": "MDU6TGFiZWwyNjkyMDk2Nzg4",
              "url": "https://api.github.com/repos/ElementsProject/lightning/labels/Feature%20Request",
              "name": "Feature Request",
              "description": "",
              "color": "4E85CB",
              "default": false
            }
          ],
          "assignee": {
            "login": "vincenzopalazzo",
            "id": 17150045,
            "node_id": "MDQ6VXNlcjE3MTUwMDQ1",
            "avatar_url": "https://avatars.githubusercontent.com/u/17150045?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vincenzopalazzo",
            "html_url": "https://github.com/vincenzopalazzo",
            "followers_url": "https://api.github.com/users/vincenzopalazzo/followers",
            "following_url": "https://api.github.com/users/vincenzopalazzo/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/vincenzopalazzo/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/vincenzopalazzo/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/vincenzopalazzo/subscriptions",
            "organizations_url": "https://api.github.com/users/vincenzopalazzo/orgs",
            "repos_url": "https://api.github.com/users/vincenzopalazzo/repos",
            "events_url": "https://api.github.com/users/vincenzopalazzo/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/vincenzopalazzo/received_events",
            "type": "User",
            "site_admin": false
          },
          "assignees": [
            {
              "login": "vincenzopalazzo",
              "id": 17150045,
              "node_id": "MDQ6VXNlcjE3MTUwMDQ1",
              "avatar_url": "https://avatars.githubusercontent.com/u/17150045?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/vincenzopalazzo",
              "html_url": "https://github.com/vincenzopalazzo",
              "followers_url": "https://api.github.com/users/vincenzopalazzo/followers",
              "following_url": "https://api.github.com/users/vincenzopalazzo/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/vincenzopalazzo/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/vincenzopalazzo/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/vincenzopalazzo/subscriptions",
              "organizations_url": "https://api.github.com/users/vincenzopalazzo/orgs",
              "repos_url": "https://api.github.com/users/vincenzopalazzo/repos",
              "events_url": "https://api.github.com/users/vincenzopalazzo/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/vincenzopalazzo/received_events",
              "type": "User",
              "site_admin": false
            }
          ],
          "author_association": "NONE",
          "milestone": {
            "url": "https://api.github.com/repos/ElementsProject/lightning/milestones/32",
            "html_url": "https://github.com/ElementsProject/lightning/milestone/32",
            "labels_url": "https://api.github.com/repos/ElementsProject/lightning/milestones/32/labels",
            "id": 9654662,
            "node_id": "MI_kwDOAjnsSM4Ak1GG",
            "number": 32,
            "state": "open",
            "title": "v23.11",
            "description": "",
            "creator": {
              "login": "rustyrussell",
              "id": 775844,
              "node_id": "MDQ6VXNlcjc3NTg0NA==",
              "avatar_url": "https://avatars.githubusercontent.com/u/775844?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/rustyrussell",
              "html_url": "https://github.com/rustyrussell",
              "followers_url": "https://api.github.com/users/rustyrussell/followers",
              "following_url": "https://api.github.com/users/rustyrussell/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/rustyrussell/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/rustyrussell/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/rustyrussell/subscriptions",
              "organizations_url": "https://api.github.com/users/rustyrussell/orgs",
              "repos_url": "https://api.github.com/users/rustyrussell/repos",
              "events_url": "https://api.github.com/users/rustyrussell/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/rustyrussell/received_events",
              "type": "User",
              "site_admin": false
            },
            "open_issues": 49,
            "closed_issues": 2,
            "created_at": "2023-07-14T02:19:35Z",
            "updated_at": "2023-08-01T03:56:06Z",
            "due_on": "2023-11-01T07:00:00Z"
          },
          "locked": false,
          "comments": 27,
          "created_at": "2022-06-07T07:58:15Z",
          "updated_at": "2023-07-31T04:05:05Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1546731833,
      "node_id": "IC_kwDOABII585cMUE5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1546731833",
      "actor": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-13T19:03:40Z",
      "updated_at": "2023-05-13T19:03:40Z",
      "author_association": "NONE",
      "body": "Maybe @Sjors can look into this?",
      "user": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27652#issuecomment-1546731833",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27652"
    },
    {
      "event": "mentioned",
      "id": 9239083105,
      "node_id": "MEE_lADOABII585l2NrBzwAAAAImsThh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9239083105",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-13T19:03:40Z"
    },
    {
      "event": "subscribed",
      "id": 9239083108,
      "node_id": "SE_lADOABII585l2NrBzwAAAAImsThk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9239083108",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-13T19:03:40Z"
    },
    {
      "event": "commented",
      "id": 1546733957,
      "node_id": "IC_kwDOABII585cMUmF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1546733957",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-13T19:17:24Z",
      "updated_at": "2023-05-13T19:17:24Z",
      "author_association": "MEMBER",
      "body": "> For example, if you run a pruned node, and your first peer happens to be also pruned, the call will fail. If the call tried all nodes, until it finds a peer that has the block, it wouldn't require you that implement any logic for that.\r\n\r\nBased on your words, guess that you are calling `getblockfrompeer` with a fixed index of `1`?\r\nYou could instead use `getpeerinfo` and filter the result by service. Only requesting the block to another full node.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27652#issuecomment-1546733957",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27652"
    },
    {
      "event": "commented",
      "id": 1546736533,
      "node_id": "IC_kwDOABII585cMVOV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1546736533",
      "actor": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-13T19:35:15Z",
      "updated_at": "2023-05-13T19:45:05Z",
      "author_association": "NONE",
      "body": "> Based on your words, guess that you are calling `getblockfrompeer` with a fixed index of `1`?\r\n> You could instead use `getpeerinfo` and filter the result by service. Only requesting the block to another full node.\r\n\r\nI'm aware you could workaround this issue by implementing a bunch of manual logic on the client-side. But even if you skip the pruned nodes and  this full node couldn't provide you the block (for whatever reason), it would be handy if the call would just try the next one.\r\n",
      "user": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27652#issuecomment-1546736533",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27652"
    },
    {
      "event": "commented",
      "id": 1546741712,
      "node_id": "IC_kwDOABII585cMWfQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1546741712",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-13T20:08:08Z",
      "updated_at": "2023-05-13T20:10:15Z",
      "author_association": "MEMBER",
      "body": "> I'm aware you could workaround this issue by implementing a bunch of manual logic on the client-side. But even if you skip the pruned nodes and this full node couldn't provide you the block, it would be handy if the call would just try the next one.\r\n\r\nSure. Was providing you a simple workaround to the described issue.\r\n\r\nI actually have done something similar for #21267 (in that case is a block filter tracker but here will be for blocks only).\r\nSo, I'm happy to work on it. Will tackle it soon.\r\n\r\nSmall note: the \"cannot provide block\" is actually a `getdata` request timeout. The RPC command isn't synchronously fetching the block from the other peer, so the command call will not be the one that tries it again.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27652#issuecomment-1546741712",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27652"
    },
    {
      "event": "commented",
      "id": 1549226748,
      "node_id": "IC_kwDOABII585cV1L8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1549226748",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-16T08:28:33Z",
      "updated_at": "2023-05-16T08:32:53Z",
      "author_association": "MEMBER",
      "body": "I would like this as well but I was too lazy to implement it.\r\n\r\nThe downside is that it would make the call asynchronous and potentially very long (needing `-rpcclienttimeout=0`). But this would only be the case if the user _doesn't_ specify a peer.\r\n\r\nIt would also need a progress indicator, which our RPC doesn't really offer. The debug log can of course be used for that. Or you could go all fancy and have the node track the status of the block fetch, including the ability to cancel it.\r\n\r\nThe upside is that it can fix the weird quirk that we disconnect from any peer that fails to deliver the block. This is because net_processing works under the assumption that we only ask blocks from peers that told us they have it, so if they don't deliver we assume there's a problem with the peer. But if we try the next peer before this timeout, `BlockRequested` clears the in flight map and no timeout will occur. Well, except for the last attempt.\r\n\r\nYou could also request the block from all peers at the same time, but not without a major refactor (more than #27626 probably).\r\n\r\nFor the pruned node case @furszy is working on things are potentially a bit simpler. All of our non-pruned peers should have the block. That means the user wouldn't need to specifify a peer and instead we can just pick _one_.\r\n\r\nYou could implement that special case for the `getblockfrompeer` RPC:\r\n1. if the user doesn't specify a peer and the block is not an ancestor of the tip, fail with \"must specify peer when fetching a stale block\"; otherwise\r\n2. pick a random non-pruned node and fetch it (fail if we only have pruned peers)",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27652#issuecomment-1549226748",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27652"
    },
    {
      "event": "mentioned",
      "id": 9255051969,
      "node_id": "MEE_lADOABII585l2NrBzwAAAAInpOLB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9255051969",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-16T08:29:39Z"
    },
    {
      "event": "subscribed",
      "id": 9255051981,
      "node_id": "SE_lADOABII585l2NrBzwAAAAInpOLN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9255051981",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-16T08:29:39Z"
    },
    {
      "event": "commented",
      "id": 1549464215,
      "node_id": "IC_kwDOABII585cWvKX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1549464215",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-16T11:13:47Z",
      "updated_at": "2023-05-16T11:13:47Z",
      "author_association": "MEMBER",
      "body": "I don't think this is hard to implement, and doesn't need #27626 (it wouldn't use compact blocks).\r\n\r\nWe effectively already have a background block download fetching algorithm, that regularly decides which blocks should be fetched from which peers (see `FindNextBlocksToDownload` in net_processing.cpp). I think it should be possible to have a list/set somewhere in the net processing state of CBlockIndexes/uint256s/... of blocks to-redownload. If any peer served by `FindNextBlocksToDownload` happens to have one of those refetch ones, they can get added to the fetching logic.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27652#issuecomment-1549464215",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27652"
    },
    {
      "event": "commented",
      "id": 1549635506,
      "node_id": "IC_kwDOABII585cXY-y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1549635506",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-16T13:07:01Z",
      "updated_at": "2023-05-16T13:09:01Z",
      "author_association": "MEMBER",
      "body": "Ok great sipa and Sjors. Notes taken.\r\n\r\nI started implementing this in a separate class `BlockRequestTracker` with its own scheduled task to detect the timeout and re-try + follow the requests progress (which also involves listening to the node disconnection signal). But, agree that can also add it to the `FindNextBlocksToDownload` existent mechanism as well.\r\nCould merge both worlds and slowly start decoupling the block downloading logic into a separate module while continue using the `SendMessages` thread to detect timeouts and queue requests.\r\n\r\n> For the pruned node case @furszy is working on things are potentially a bit simpler. All of our non-pruned peers should have the block. That means the user wouldn't need to specifify a peer and instead we can just pick one.\r\n\r\nWell, peers could delay the response or directly not answer. Stalling the post-filter-matching blocks sync mechanism. So, we also need a blocks tracking module in that branch too.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27652#issuecomment-1549635506",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27652"
    },
    {
      "event": "mentioned",
      "id": 9257932454,
      "node_id": "MEE_lADOABII585l2NrBzwAAAAIn0Nam",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9257932454",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-16T13:07:01Z"
    },
    {
      "event": "subscribed",
      "id": 9257932470,
      "node_id": "SE_lADOABII585l2NrBzwAAAAIn0Na2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9257932470",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-16T13:07:01Z"
    },
    {
      "event": "commented",
      "id": 1549867573,
      "node_id": "IC_kwDOABII585cYRo1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1549867573",
      "actor": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-16T15:11:44Z",
      "updated_at": "2023-05-16T15:11:44Z",
      "author_association": "NONE",
      "body": " > Well, peers could delay the response or directly not answer. Stalling the post-filter-matching blocks sync mechanism.\r\n\r\nYes, I think that peers who have reached their `maxuploadtarget` will also refuse to provide the block unless you have the whitelist / `download` permission. So there can be some edge-cases where non-pruned peers still fail to deliver it.",
      "user": {
        "login": "kroese",
        "id": 5763256,
        "node_id": "MDQ6VXNlcjU3NjMyNTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5763256?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kroese",
        "html_url": "https://github.com/kroese",
        "followers_url": "https://api.github.com/users/kroese/followers",
        "following_url": "https://api.github.com/users/kroese/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kroese/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kroese/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kroese/subscriptions",
        "organizations_url": "https://api.github.com/users/kroese/orgs",
        "repos_url": "https://api.github.com/users/kroese/repos",
        "events_url": "https://api.github.com/users/kroese/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kroese/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27652#issuecomment-1549867573",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27652"
    },
    {
      "event": "commented",
      "id": 1550028698,
      "node_id": "IC_kwDOABII585cY4-a",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1550028698",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-16T16:51:09Z",
      "updated_at": "2023-05-16T16:51:09Z",
      "author_association": "MEMBER",
      "body": "If it fails you have to try again. It would presumably auto-pick the same peer, so you'd have to revert to manually picking one. Agree that's not ideal.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27652#issuecomment-1550028698",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27652"
    },
    {
      "event": "commented",
      "id": 1550066620,
      "node_id": "IC_kwDOABII585cZCO8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1550066620",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-16T17:16:11Z",
      "updated_at": "2023-05-16T17:16:11Z",
      "author_association": "MEMBER",
      "body": "> If it fails you have to try again. It would presumably auto-pick the same peer, so you'd have to revert to manually picking one. Agree that's not ideal.\r\n\r\nIf the block request timeouts (fails), we disconnect the peer. So, if someone wants to use this as is now, it's ok to do another RPC call after 10 minutes, when the remote peer is no longer in the `getpeerinfo` response.\r\n\r\nStill, not ideal as it involves some extra RPC calls. Better to keep moving on providing a better tracking mechanism.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27652#issuecomment-1550066620",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27652"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-23T16:55:21Z",
      "updated_at": "2023-05-23T16:55:21Z",
      "source": {
        "issue": {
          "id": 1705885197,
          "node_id": "PR_kwDOABII585QS9YY",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27626",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27626/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27626/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27626/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/27626",
          "number": 27626,
          "state": "closed",
          "state_reason": null,
          "title": "Parallel compact block downloads, take 3",
          "body": "This is an attempt at mitigating https://github.com/bitcoin/bitcoin/issues/25258 , which is a revival of https://github.com/bitcoin/bitcoin/pull/10984, which is a revival of https://github.com/bitcoin/bitcoin/pull/9447.\r\n\r\nThis PR attempts to mitigate a single case, where high bandwidth peers can bail us out of a flakey\r\npeer not completing blocks for us. We allow up to 2 additional getblocktxns requests per unique block.\r\nThis would hopefully allow the chance for an honest high bandwidth peer to hand us the transactions\r\neven if the first in flight peer stalls out.\r\n\r\nIn contrast to previous effort:\r\n\r\n1) it will not help if subsequent peers send block headers only, so only high-bandwidth peers this time. See: https://github.com/bitcoin/bitcoin/pull/10984/files#diff-6875de769e90cec84d2e8a9c1b962cdbcda44d870d42e4215827e599e11e90e3R1411\r\n2)  `MAX_GETBLOCKTXN_TXN_AFTER_FIRST_IN_FLIGHT` is removed, in favor of aiding recovery during turbulent mempools\r\n3) We require one of the 3 block fetching slots to be an outbound peer. This can be the original offering peer, or subsequent compact blocks given by high bandwidth peers.\r\n",
          "user": {
            "login": "instagibbs",
            "id": 5767891,
            "node_id": "MDQ6VXNlcjU3Njc4OTE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/instagibbs",
            "html_url": "https://github.com/instagibbs",
            "followers_url": "https://api.github.com/users/instagibbs/followers",
            "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
            "organizations_url": "https://api.github.com/users/instagibbs/orgs",
            "repos_url": "https://api.github.com/users/instagibbs/repos",
            "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/instagibbs/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "milestone": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/60",
            "html_url": "https://github.com/bitcoin/bitcoin/milestone/60",
            "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones/60/labels",
            "id": 9286970,
            "node_id": "MI_kwDOABII584AjbU6",
            "number": 60,
            "state": "open",
            "title": "26.0",
            "description": "",
            "creator": {
              "login": "fanquake",
              "id": 863730,
              "node_id": "MDQ6VXNlcjg2MzczMA==",
              "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/fanquake",
              "html_url": "https://github.com/fanquake",
              "followers_url": "https://api.github.com/users/fanquake/followers",
              "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
              "organizations_url": "https://api.github.com/users/fanquake/orgs",
              "repos_url": "https://api.github.com/users/fanquake/repos",
              "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/fanquake/received_events",
              "type": "User",
              "site_admin": false
            },
            "open_issues": 7,
            "closed_issues": 23,
            "created_at": "2023-04-15T11:36:05Z",
            "updated_at": "2023-08-01T16:50:00Z"
          },
          "locked": false,
          "comments": 32,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27626",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/27626",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/27626.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/27626.patch"
          },
          "closed_at": "2023-05-24T09:09:27Z",
          "created_at": "2023-05-11T14:05:20Z",
          "updated_at": "2023-06-02T15:00:47Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-07T18:43:25Z",
      "updated_at": "2023-06-07T18:43:25Z",
      "source": {
        "issue": {
          "id": 1746475853,
          "node_id": "PR_kwDOABII585ScdjL",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27836",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27836/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27836/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27836/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/27836",
          "number": 27836,
          "state": "closed",
          "state_reason": null,
          "title": "rpc: getblockfrompeer, introduce fetch from \"any\" functionality",
          "body": "Coming from #27652. Implementing the first part of it.\r\n\r\nThe idea is to let users call `getblockfrompeer` without providing any peer id.\r\nThe node will internally select one peer at random and make the `getdata` request.\r\n\r\nThis also fixes a bug where the user is allowed to call `getblockfrompeer` providing\r\nan id of a peer that signals a \"limited\" service. As limited peers cannot provide historical\r\nblocks, it is not correct to allow the user to do that.",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27836",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/27836",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/27836.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/27836.patch"
          },
          "closed_at": "2023-08-02T12:28:32Z",
          "created_at": "2023-06-07T18:43:25Z",
          "updated_at": "2023-08-02T12:29:08Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-07T19:01:56Z",
      "updated_at": "2023-06-07T19:01:56Z",
      "source": {
        "issue": {
          "id": 1746501636,
          "node_id": "PR_kwDOABII585ScjM9",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27837",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27837/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27837/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27837/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/27837",
          "number": 27837,
          "state": "open",
          "state_reason": null,
          "title": "net: introduce block tracker to retry to download blocks after failure",
          "body": "Built on top of #28120 and #28170. Coming from #27652.\r\n\r\nThe general idea is to keep track of the user requested blocks so, in\r\ncase of a bad behaving peer or a network disconnection, they can be\r\nfetched from another one automatically without any further user interaction.\r\n\r\nThis was requested by users because the `getblockfrompeer` RPC command\r\nlacks the functionality to notify them about block request failures or peer\r\ndisconnections (which is expected due to the asynchronous nature of the block\r\nrequests).\r\n\r\nCurrently, this new functionality is limited to blocks requested by the\r\nuser via the 'getblockfrompeer' RPC command.\r\n\r\nIn the future, this class could expand its scope and be utilized in the\r\nregular chain synchronization process. Or, even could be employed in\r\nspecial procedures like a prune node rescan that uses BIP158 block filters,\r\nor even into BIP157 itself.",
          "user": {
            "login": "furszy",
            "id": 5377650,
            "node_id": "MDQ6VXNlcjUzNzc2NTA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/furszy",
            "html_url": "https://github.com/furszy",
            "followers_url": "https://api.github.com/users/furszy/followers",
            "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
            "organizations_url": "https://api.github.com/users/furszy/orgs",
            "repos_url": "https://api.github.com/users/furszy/repos",
            "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/furszy/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27837",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/27837",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/27837.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/27837.patch"
          },
          "created_at": "2023-06-07T19:01:56Z",
          "updated_at": "2023-08-02T09:50:15Z"
        },
        "type": "issue"
      }
    }
  ]
}