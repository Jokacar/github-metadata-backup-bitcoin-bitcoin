{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673",
    "id": 2024536912,
    "node_id": "PR_kwDOABII5854q_tQ",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/30673",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/30673.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/30673.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30673",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30673/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
    "number": 30673,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "coins: remove logic for spent-and-FRESH cache entries and writing non-DIRTY entries",
    "user": {
      "login": "andrewtoth",
      "id": 237213,
      "node_id": "MDQ6VXNlcjIzNzIxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/andrewtoth",
      "html_url": "https://github.com/andrewtoth",
      "followers_url": "https://api.github.com/users/andrewtoth/followers",
      "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
      "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
      "repos_url": "https://api.github.com/users/andrewtoth/repos",
      "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Following up from https://github.com/bitcoin/bitcoin/pull/28280#discussion_r1655477509, which suggested a revival of #18746.\r\n\r\n`GetCoin` will never return `true` for a spent entry, so we can safely assume that any entry we fetch will not be spent. This lets us remove the only non-test code path which adds a FRESH-but-not-DIRTY entry to the flagged linked list. This in turn ensures all entries being sent to `BatchWrite` are `DIRTY` entries.\r\n\r\nThis is a pure refactor removing dead code which handles a non-existent corner case of a FRESH-but-not-DIRTY entry in the `CCoinsViewCache` or a spent entry in `CCoinsViewDB`. There is a lot of test code which tries to exercise this corner case, which is also updated in this PR to behave like non-test code.",
    "labels": [
      {
        "id": 97470796,
        "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
        "name": "UTXO Db and Indexes",
        "color": "fbca04",
        "default": false
      }
    ],
    "created_at": "2024-08-18T21:31:11Z",
    "updated_at": "2024-08-21T09:24:46Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "7904c7536be91bf8123f6bc62ef00bc7edd8fe4e",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "andrewtoth:no-spent-and-fresh",
      "ref": "no-spent-and-fresh",
      "sha": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 156145027,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNTYxNDUwMjc=",
        "name": "bitcoin",
        "full_name": "andrewtoth/bitcoin",
        "owner": {
          "login": "andrewtoth",
          "id": 237213,
          "node_id": "MDQ6VXNlcjIzNzIxMw==",
          "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/andrewtoth",
          "html_url": "https://github.com/andrewtoth",
          "followers_url": "https://api.github.com/users/andrewtoth/followers",
          "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
          "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
          "repos_url": "https://api.github.com/users/andrewtoth/repos",
          "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/andrewtoth/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/andrewtoth/bitcoin",
        "archive_url": "https://api.github.com/repos/andrewtoth/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/andrewtoth/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/andrewtoth/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/andrewtoth/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/andrewtoth/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/andrewtoth/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/andrewtoth/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/andrewtoth/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/andrewtoth/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/andrewtoth/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/andrewtoth/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/andrewtoth/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/andrewtoth/bitcoin/events",
        "forks_url": "https://api.github.com/repos/andrewtoth/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/andrewtoth/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/andrewtoth/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/andrewtoth/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/andrewtoth/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/andrewtoth/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/andrewtoth/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/andrewtoth/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/andrewtoth/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/andrewtoth/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/andrewtoth/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/andrewtoth/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/andrewtoth/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/andrewtoth/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/andrewtoth/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/andrewtoth/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:andrewtoth/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/andrewtoth/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/andrewtoth/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/andrewtoth/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/andrewtoth/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/andrewtoth/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/andrewtoth/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/andrewtoth/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/andrewtoth/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/andrewtoth/bitcoin/hooks",
        "svn_url": "https://github.com/andrewtoth/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 245338,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-08-19T12:38:26Z",
        "created_at": "2018-11-05T01:43:59Z",
        "updated_at": "2022-12-23T04:16:30Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "ee367170cb2acf82b6ff8e0ccdbc1cce09730662",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 36053,
        "stargazers_count": 77961,
        "watchers_count": 77961,
        "size": 265584,
        "default_branch": "master",
        "open_issues_count": 665,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-08-21T09:20:06Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-08-21T09:57:35Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 67,
    "deletions": 103,
    "changed_files": 6,
    "commits": 7,
    "review_comments": 19,
    "comments": 3
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDk2MzgwNGM1ZjFmNzIyZGQxNGYwN2Y4YmNjYjkwYmQ0ODI1ZmJmOWU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/963804c5f1f722dd14f07f8bccb90bd4825fbf9e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/963804c5f1f722dd14f07f8bccb90bd4825fbf9e",
      "tree": {
        "sha": "15aa44de54a0c20ed80b336766eaa50060c9d546",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/15aa44de54a0c20ed80b336766eaa50060c9d546"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 15aa44de54a0c20ed80b336766eaa50060c9d546\nparent ee367170cb2acf82b6ff8e0ccdbc1cce09730662\nauthor Andrew Toth <andrewstoth@gmail.com> 1724014969 -0400\ncommitter Andrew Toth <andrewstoth@gmail.com> 1724014969 -0400\n\ntest: never return true from GetCoins for spent entries\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEISytpz6vNK/yCogaYAB6/Ik4sBgFAmbCYXkACgkQYAB6/Ik4\nsBgCvhAAmhnGELhUq4rdJMdSmCuSXpqrA93MANMd0Bi/BGqME1pFAXZQUjBTYGvX\nInTt16j5vp9PdBw2f42CTL15ZSA17H68u57L+uzUDZLPesCMMvrdj8SFAJB4UCzi\nZ22PZbKtnKbVBR2s2oWcUujeMMuLYndrTKxCPa5N3tuCIVbwYPdQ/l/3RN6KJqrX\nCYKtzjfh4APjOZTcUmmgplkF2ai2cCUQgnFUzWIi1uRv4Z3/IK9hvrsE+SqKt3CH\njGMJLdSM/0D7PIIfejFid6ilP15sHLoVyAyBLHbkw1Vj3oEQRsLoCjlupL/KeCVZ\ndvzus9ebY+h3SshTr756/czlAJSxDVVOh6wOh5VW2PxDNpz6GZOPSt8uoTdUT597\nCaHWk4DLubO0h5KPpmAURqHEiWQq9qPD7CBL9du/Fb37mA4KO0rjWsLN7Sdi1IyD\nMzqHw6irgiSu9R9K3JyErAg/dDqzL1sea9SowjoSu2VHXcPu+FzBEg61YQyDR4HU\n+fSTG9k+qCi8O+ws6va3eXsSzabvWx42QrlHS/GmPgPufnxJe+v7Kg7qeUXDdpQF\nUq9C3Z7XROplkpqLhI+0jOfDUagkVFJz4i2JWCgbuufmP2RuT/OJgCtBldLemASQ\nmNnQ2d4oqC7f+GtyrSnX8pI1lNFWDBW579xjzY4Evo0yk5E6kAE=\n=7OTY\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ee367170cb2acf82b6ff8e0ccdbc1cce09730662",
          "sha": "ee367170cb2acf82b6ff8e0ccdbc1cce09730662",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ee367170cb2acf82b6ff8e0ccdbc1cce09730662"
        }
      ],
      "message": "test: never return true from GetCoins for spent entries",
      "committer": {
        "name": "Andrew Toth",
        "email": "andrewstoth@gmail.com",
        "date": "2024-08-18T21:02:49Z"
      },
      "author": {
        "name": "Andrew Toth",
        "email": "andrewstoth@gmail.com",
        "date": "2024-08-18T21:02:49Z"
      },
      "sha": "963804c5f1f722dd14f07f8bccb90bd4825fbf9e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGEzNDc3NjJkMjdiOTM4NzQxMjM1NzZhZjcwYzhlOTU1OWQzMzM5NGY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a347762d27b93874123576af70c8e9559d33394f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a347762d27b93874123576af70c8e9559d33394f",
      "tree": {
        "sha": "614d1598dfd0937c4ae769d18cc941472340dc1e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/614d1598dfd0937c4ae769d18cc941472340dc1e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 614d1598dfd0937c4ae769d18cc941472340dc1e\nparent 963804c5f1f722dd14f07f8bccb90bd4825fbf9e\nauthor Andrew Toth <andrewstoth@gmail.com> 1724015034 -0400\ncommitter Andrew Toth <andrewstoth@gmail.com> 1724015034 -0400\n\ncoins: Assume coins returned from GetCoin cannot be spent\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEISytpz6vNK/yCogaYAB6/Ik4sBgFAmbCYboACgkQYAB6/Ik4\nsBjcWBAAth8WwUoNdkLuoEhZe8n82POUFkUmk+e/DUmFJUBFGUgIB2ML3/Fk0qO0\nCsM0dM6dvFZw7Yx07b9Zs5itLlHTcZxRWTrwClkthuY7HaxZVKJdlTsKhzdNU+MA\nyeBXMpexs7WoYv1TOMvysh2Z7eMjvaDGShd0tD3IFMhN5Ajc1DVr9OFi406DKzL3\nmJ6X7IgxMOjtMerDJGq6nfff9nNbPrxUk8XnmBTnp58lOLTJpL8v/PvrDW0X9diR\n7Dhy9G1MucWy3isRvJi+wXWPhzgCr/59SpiPARhKExITX/JsZCvpM1jwBmJkflJ/\n2N4mS6y8TaKQXitLa8lkji9A/bxPG/XGvQ5/YuP+Cttq9p5XG6guIF9KoTaZgDiN\n81rU0DY38ZVqknNSvBSezeHwjVL7pl5/T8E6AJlyiwOCxUHxq8RJI70iT4TjhBrU\nh7ZG4W65a6eaODKYHHbt6VXOxHv9NuKy/Tl31FPjdZI8V+rmsXV608HLbChhgY+i\nsdu8pSu0AQAaDtRilq8vBUIectmDr2H8Bc3H7kJSLy0gb4xMPZBjS0eashEbbWRo\nCxg5bFYWVhglyWfG7GmSX3OjxeUY+G/dFuGMU0yPwHh7BE0WdqYzqdRGHwiwzvmn\nMtPMKOQnV/63KCEKs3DTgu2pRJsxsbUMLuPY0UpBT41MGYEuJVY=\n=gAXB\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/963804c5f1f722dd14f07f8bccb90bd4825fbf9e",
          "sha": "963804c5f1f722dd14f07f8bccb90bd4825fbf9e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/963804c5f1f722dd14f07f8bccb90bd4825fbf9e"
        }
      ],
      "message": "coins: Assume coins returned from GetCoin cannot be spent",
      "committer": {
        "name": "Andrew Toth",
        "email": "andrewstoth@gmail.com",
        "date": "2024-08-18T21:03:54Z"
      },
      "author": {
        "name": "Andrew Toth",
        "email": "andrewstoth@gmail.com",
        "date": "2024-08-18T21:03:54Z"
      },
      "sha": "a347762d27b93874123576af70c8e9559d33394f"
    },
    {
      "event": "commented",
      "id": 2295400070,
      "node_id": "IC_kwDOABII586I0QaG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2295400070",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-18T21:31:13Z",
      "updated_at": "2024-08-21T09:24:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/30673).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [paplorinc](https://github.com/bitcoin/bitcoin/pull/30673#pullrequestreview-2245093564) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#30571](https://github.com/bitcoin/bitcoin/pull/30571) (test: [refactor] Use m_rng directly by maflcko)\n* [#29641](https://github.com/bitcoin/bitcoin/pull/29641) (scripted-diff: Use LogInfo/LogDebug over LogPrintf/LogPrint by maflcko)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#issuecomment-2295400070",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30673"
    },
    {
      "event": "labeled",
      "id": 13922977193,
      "node_id": "LE_lADOABII586TWhHVzwAAAAM938Wp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13922977193",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-18T21:31:15Z",
      "label": {
        "name": "UTXO Db and Indexes",
        "color": "fbca04"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13922990638,
      "node_id": "HRFPE_lADOABII586TWhHVzwAAAAM93_ou",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13922990638",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-18T21:39:28Z"
    },
    {
      "event": "labeled",
      "id": 13922990762,
      "node_id": "LE_lADOABII586TWhHVzwAAAAM93_qq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13922990762",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-18T21:39:32Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2295403510,
      "node_id": "IC_kwDOABII586I0RP2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2295403510",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-18T21:39:33Z",
      "updated_at": "2024-08-18T21:39:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n🚧 At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/28917867890</sub>\n\n<details><summary>Hints</summary>\n\nMake sure to run all tests locally, according to the documentation.\n\nThe failure may happen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#issuecomment-2295403510",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30673"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13923041141,
      "node_id": "HRFPE_lADOABII586TWhHVzwAAAAM94L91",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13923041141",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-18T22:08:53Z"
    },
    {
      "event": "unlabeled",
      "id": 13923182717,
      "node_id": "UNLE_lADOABII586TWhHVzwAAAAM94uh9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13923182717",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-18T23:25:05Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE4NDM1ODYyZDJjMjI2NzdmMmRhOWQyN2FkNjU1ZDE0YjQ3YTdiZjI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/18435862d2c22677f2da9d27ad655d14b47a7bf2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/18435862d2c22677f2da9d27ad655d14b47a7bf2",
      "tree": {
        "sha": "81f3fdd2f00bf282af56f29f37cccb37a8ca3b7e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/81f3fdd2f00bf282af56f29f37cccb37a8ca3b7e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 81f3fdd2f00bf282af56f29f37cccb37a8ca3b7e\nparent a347762d27b93874123576af70c8e9559d33394f\nauthor Andrew Toth <andrewstoth@gmail.com> 1724015231 -0400\ncommitter Andrew Toth <andrewstoth@gmail.com> 1724071077 -0400\n\ncoins: throw errors for non-DIRTY or spent and FRESH coins in BatchWrite\n\nThere are no code paths which add a non-DIRTY entry to the cursor in\nBatchWrite, so we can safely make this a logic error and test for it.\n\nThere are no code paths which add a spent and FRESH coin to the cursor\nin BatchWrite, so we can safely make this a logic error and test for it.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEISytpz6vNK/yCogaYAB6/Ik4sBgFAmbDPKUACgkQYAB6/Ik4\nsBhjmhAAqSIqRTab5HxkhghvQZ+FD7JK3roOzzz4zo9dGkeLEmWKjrneXlJPM71o\n3/yNBLke0+NzWsJTB5N0txsyM+ZeKp4dG/tkwkHIhskDwh3hz7kTRm0xI/kAtnFK\n6XOj2sogpmbAUof709h9txJLI0YBAUztPIKX03V7Uxbq3ijiFTUViVdu5qcCG5UV\ncIIq6bwUHei7kPvoiIyJnS267N2Ai2+faL/0duWHLpeYNF9BNlf18jXweu3MN0Jn\nTCBdHepq1dsC8kbAq9d9TAp5XFSOldhiAjEeCdKpyV+0wBNwfaxL4L0UBai5Hz+U\nSkBLK8GDzhoUs+LdU62180YWMknVppufgTFPugYHhIdylWs6j8+ucjUNNtXtcmRV\nfStLx6+Hi5AMpDGXr/K8eupuDxQ7MYl+xhfl+iTK7GUUjiokDzw+wXEYYGQJG2C9\nlGC8XGolAJpBgyukH7fhXQ/bwBWYkl1LOtuyyzxQfrhzsZrh4w8gPaRIizav/vgp\najwEht6dczrNZyitg03BogioNC6qBB0xTY0o66TWjD/LUXanXOBEJqc+Tvkad7rP\nVTQ5I4nNWsbDRLcGeaZWBoUPylikdwfE0UOWi5SVLHik6D8zwJ/fKtGEATWGMAUB\nng+dsIvcMlPIC7IE27PiUQo6SpDlkwmJvqM9hpncj+PqgXthmLM=\n=YDvt\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a347762d27b93874123576af70c8e9559d33394f",
          "sha": "a347762d27b93874123576af70c8e9559d33394f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a347762d27b93874123576af70c8e9559d33394f"
        }
      ],
      "message": "coins: throw errors for non-DIRTY or spent and FRESH coins in BatchWrite\n\nThere are no code paths which add a non-DIRTY entry to the cursor in\nBatchWrite, so we can safely make this a logic error and test for it.\n\nThere are no code paths which add a spent and FRESH coin to the cursor\nin BatchWrite, so we can safely make this a logic error and test for it.",
      "committer": {
        "name": "Andrew Toth",
        "email": "andrewstoth@gmail.com",
        "date": "2024-08-19T12:37:57Z"
      },
      "author": {
        "name": "Andrew Toth",
        "email": "andrewstoth@gmail.com",
        "date": "2024-08-18T21:07:11Z"
      },
      "sha": "18435862d2c22677f2da9d27ad655d14b47a7bf2"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZmYWJiMmRkY2QzYzMxZTU0YjExYTU2YzdlMzk1YWY2YjgzMGU0NDM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ffabb2ddcd3c31e54b11a56c7e395af6b830e443",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ffabb2ddcd3c31e54b11a56c7e395af6b830e443",
      "tree": {
        "sha": "ce85e14f583e4fcaa26f0cf3593ec57d7c16ba20",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ce85e14f583e4fcaa26f0cf3593ec57d7c16ba20"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree ce85e14f583e4fcaa26f0cf3593ec57d7c16ba20\nparent 18435862d2c22677f2da9d27ad655d14b47a7bf2\nauthor Andrew Toth <andrewstoth@gmail.com> 1724015566 -0400\ncommitter Andrew Toth <andrewstoth@gmail.com> 1724071077 -0400\n\ndoc: update comments to reflect possible code paths\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEISytpz6vNK/yCogaYAB6/Ik4sBgFAmbDPKUACgkQYAB6/Ik4\nsBgmzRAAtc1VXKyeZUwGrpGiofBLljvUjn0CNgVUIWK2+flVGTAv3bBjfJCQ7Mnt\nP2kYnDG1AKBWj0vxA18PDp9CTNG6XCYo0i2GZgLiwuPQmOV5CxeQC92U6sKGOM6I\nSoG52D4cNUV+g9kq1yrtRuJbsgaEeAv2V1Hzjua6fI98Ag7pOpBTeq/BM3bXcr3D\nNDd+pZnhL4yk6zEbAPzDXyyLvvAvarysnMj9BJ+paxZFPpwEb0IoJlihx0JRjm0r\nDCdyqHA4/UFFiKVP3Sb3y6aCGrhsEuR2UXgCLNDtJYkg54gZipB+8wGvS8ChGos3\n/5UULUYggmWlAAfR8bKZ9dUp2FF8hUPENdoabUyMo2bZjAy2fros+SURdE6GPZ0r\nFZAxtfLnho8m+E0PBW7YJra8CZy9eE6cAuZyXTAzs7V6luRLI0OmK8qJcPdv2/RE\nFEN7/9Hsp1NbyIJPVDlGcrJ42OtBZBE/+29Yq0yyrzw52HF87z7SWAgJyH9TxHXP\nLasUmjKIEGjheWIOthGOVCkq6ARL886RpGJsp7EnYNskT6//t5ifvFkqwOUiPOXK\nab3Y8QVYNf7w6A+M+03614diHaizoFJvV0/vy84bccMSZ72q4ZbTA1JOidnROKcJ\n2ksgC6EN/osMsJHI0zjqRS2CHJG/Kc/g+Z3X/JdMNdwdKtpG+Rc=\n=WRQP\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/18435862d2c22677f2da9d27ad655d14b47a7bf2",
          "sha": "18435862d2c22677f2da9d27ad655d14b47a7bf2",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/18435862d2c22677f2da9d27ad655d14b47a7bf2"
        }
      ],
      "message": "doc: update comments to reflect possible code paths",
      "committer": {
        "name": "Andrew Toth",
        "email": "andrewstoth@gmail.com",
        "date": "2024-08-19T12:37:57Z"
      },
      "author": {
        "name": "Andrew Toth",
        "email": "andrewstoth@gmail.com",
        "date": "2024-08-18T21:12:46Z"
      },
      "sha": "ffabb2ddcd3c31e54b11a56c7e395af6b830e443"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDk0NmEwMzVjZGMyOThjMzE2OGIxMTY0MDc5ODkyYTg1OTAyYzk2NmY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/946a035cdc298c3168b1164079892a85902c966f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/946a035cdc298c3168b1164079892a85902c966f",
      "tree": {
        "sha": "eff077fd367f769174b61792815cbf72c3fa6690",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/eff077fd367f769174b61792815cbf72c3fa6690"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree eff077fd367f769174b61792815cbf72c3fa6690\nparent ffabb2ddcd3c31e54b11a56c7e395af6b830e443\nauthor Andrew Toth <andrewstoth@gmail.com> 1724015624 -0400\ncommitter Andrew Toth <andrewstoth@gmail.com> 1724071077 -0400\n\ncoins: remove redundant IsDirty checks in BatchWrite\n\nIt is no longer possible to get non-DIRTY entries in BatchWrite\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEISytpz6vNK/yCogaYAB6/Ik4sBgFAmbDPKUACgkQYAB6/Ik4\nsBjwPQ/5AbpUmK09JnO60NaO+cQtNt1h/3yIfOQflW2lItWjGwGXXREUHIl1qfWD\nEqgFizTRRagBitXrzLJE9rhXZcZkhziJVKKm8SuY68fCrrN5CFTxlzz3kSYysXtJ\nfkHJy8AECQHmsDEeXqQd9za9dfzlWum8ijhbzwwv9nsYYzOkk7TYPnzZQmlvieWd\n61+wmauU06KcqBMXitnmSiqvSA7bATFZYytYhskdWqHnxNBH3zJNZuzRMUSRKff6\naYM/bwcxVWWgxeAE7GEbc0nkkdhVIJlIbmi5d+7YhtHo/R5xVggnfNIPIMw05+Rs\nqDA8K0NzmMqzqlKkU6LBT+bfbj1rcutRb2Ncgv++81C2zIE35/LADessCDSidPMP\n0KDs0grcG33vCZ6u/A89tB6QP2BXOxF1CYZgY3rN241wnGkkPy7LfOfqz0+kSsXh\n96J+UZyNztrn/5AVZR4NZPn20iutKUP5ZUaitR48OVa/dOoyUNFEkHTJHfeiY5R4\ncf+ibeW56Gnz1hsFor6d6mIP8t4n554H53iytLCvhbUHaewqZYu0VrgQ8/v5jN8j\nuSjw7pBa7J//i3fEIn770v2ddDMHIpzjONpxJO5TNoFg8YyCewM1Qxd6MKcPkGif\nlgBxviBak/E6nwNWZIaHAGVHCuS0R/3K/+hSd2CPC+VAdUT0SCk=\n=2q/u\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ffabb2ddcd3c31e54b11a56c7e395af6b830e443",
          "sha": "ffabb2ddcd3c31e54b11a56c7e395af6b830e443",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ffabb2ddcd3c31e54b11a56c7e395af6b830e443"
        }
      ],
      "message": "coins: remove redundant IsDirty checks in BatchWrite\n\nIt is no longer possible to get non-DIRTY entries in BatchWrite",
      "committer": {
        "name": "Andrew Toth",
        "email": "andrewstoth@gmail.com",
        "date": "2024-08-19T12:37:57Z"
      },
      "author": {
        "name": "Andrew Toth",
        "email": "andrewstoth@gmail.com",
        "date": "2024-08-18T21:13:44Z"
      },
      "sha": "946a035cdc298c3168b1164079892a85902c966f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDI4NmY4NDFjOGU2Mzk4NzY2NjYwOTAyMzM4YTRkMWRiMDA2OTA3MWY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/286f841c8e6398766660902338a4d1db0069071f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/286f841c8e6398766660902338a4d1db0069071f",
      "tree": {
        "sha": "405166cbe9fb19aa0a68f667087db67f6250ed59",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/405166cbe9fb19aa0a68f667087db67f6250ed59"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 405166cbe9fb19aa0a68f667087db67f6250ed59\nparent 946a035cdc298c3168b1164079892a85902c966f\nauthor Andrew Toth <andrewstoth@gmail.com> 1724015712 -0400\ncommitter Andrew Toth <andrewstoth@gmail.com> 1724071077 -0400\n\ncoins: remove IsFresh check in Uncache\n\nIt is not possible for an entry to be FRESH if not already DIRTY.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEISytpz6vNK/yCogaYAB6/Ik4sBgFAmbDPKUACgkQYAB6/Ik4\nsBirnBAAqSrJPGfgilWUxR78g2v2/D57bNvQ9MlsCZl6fA/+hiD6q2QqZT8gUNAY\nnaYU1PwB10jY/v9zHNYUo9MUfCyqkMbkVDcDBPjpmYMbHu3PWktMb/MqVLCc4j2V\n3bgwsqTJv8wYiI6g2NhaW3L1jTQ0TMVgK7l7HvU9NwaOmmyh67NrFOi8pdvV0UYA\nhd/7r40oHsj7ybjtSQ9lJIv5osU351VgiOL2LH3DT9/UEXIBE2QPbcAgNBxQ93ir\nbUr5kRMYiu4awhMfoLT8fW0zfEZaSR0l61H0rSpdyBxVjlUEA/A2Ypx86EpPRgyO\nITTRnrH3xFJ7QIRgoe2p4lyFtC2YVI5p1RLUBKwxAl1e7yfXY9WDtTqGA5SZDmLp\nqs3Vcy5jVNkrDe0RY5LdJYlXsJ7vZ6jpwveWlriCYdqmVUzW1i4wdksz5T2HPkcQ\n7hCb64SsgUO/uZfKO/SDLRvM7w2aRumo1F9Nv9Uz4QUKeptzdRflf4LuaAiJGKxA\nGcsjJCCcZFr2EJQu8e+ZgWMyZdEkgn6aKcLFVdI7PKAbYGFgPelg5e1cbAV0uBML\nfk7SvAJwmZgjzx4GolTDt8vF4sgAjYLuomgeDmPHGoDUCZT1AV7LhpxN5IMuuEub\nqyVN75LjYpHPbWnh0qqyzwx+4HrFuhPIDUZyoo/pFMOENXywlbE=\n=kRvb\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/946a035cdc298c3168b1164079892a85902c966f",
          "sha": "946a035cdc298c3168b1164079892a85902c966f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/946a035cdc298c3168b1164079892a85902c966f"
        }
      ],
      "message": "coins: remove IsFresh check in Uncache\n\nIt is not possible for an entry to be FRESH if not already DIRTY.",
      "committer": {
        "name": "Andrew Toth",
        "email": "andrewstoth@gmail.com",
        "date": "2024-08-19T12:37:57Z"
      },
      "author": {
        "name": "Andrew Toth",
        "email": "andrewstoth@gmail.com",
        "date": "2024-08-18T21:15:12Z"
      },
      "sha": "286f841c8e6398766660902338a4d1db0069071f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDFmMmY4ZTUxNmI4NmQ0YTczYmFjMGJlZGFkNzUzZGEzZTMwN2JmOGE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "tree": {
        "sha": "d6bce9d4ead10844a2f47b026d51ae3bc443b28b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d6bce9d4ead10844a2f47b026d51ae3bc443b28b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree d6bce9d4ead10844a2f47b026d51ae3bc443b28b\nparent 286f841c8e6398766660902338a4d1db0069071f\nauthor Andrew Toth <andrewstoth@gmail.com> 1724015831 -0400\ncommitter Andrew Toth <andrewstoth@gmail.com> 1724071077 -0400\n\ntest: don't check for FRESH but not DIRTY entries in SanityCheck\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEISytpz6vNK/yCogaYAB6/Ik4sBgFAmbDPKUACgkQYAB6/Ik4\nsBg7tRAAn15YG9nRVK4SSNEUmS0YYizSQoSLyonM3P7i7ndFq6VhrgmE3HH5YSKa\nQeG/kwXa8M89UafRHbI9f4UInD6AM3xxoD7htVBsjlHp0jG4LBDeY2pMduvIdZKP\ndMtdefIuYh8u63SXFyPa4YyLyHnZ4BwmzKeTRMDrfLTHw4MjR+A7aS2nMr8B0ZJc\n+dgdySWfiGJwfa159nNHFjMxmRzgKMQJLN2peTKXW2Jsk4Y9h1XvqYEA7+H0+TPh\nyDe+630BcaZ3mBIdQdyupH6/wxFmqMfS7U20KwzQgkIzgSTi21HITDEIDUCtuTwM\ndKM6TOqKGKuqK2UJx2bDCFkeXUgqmY/t4kV5qFhKEnll1WbhlpSAHLBvxcG4cG1A\nu5XUpH8fdM6oVqK79Yd3D9loP5XpAzsnQDtlkY1AxlXqhsvPxIrPhxd/ggbOAyet\nd9UHyINy2RCR5ahm7wW4vyzzQ+EVA1NVqua04RR1iObr/t7HUvNhgL2Pm8UK1jDb\n6dGHHZXYvf+BgStk05IvGdfWCUSDUggak6UYbC31wgR9QL6ywwMRTIFBtXTRQ6aF\nMF3ZDdv37d9udlhiBJ1KOKNWX8vjeUzDZ39KtwpVGRS6mC2HXlfaOpVPBcRSDYTD\n0hgV/xY26qOidThNfWc55+6kctDmGHEJdraPcDu+PzR5ApDJiEA=\n=5E70\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/286f841c8e6398766660902338a4d1db0069071f",
          "sha": "286f841c8e6398766660902338a4d1db0069071f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/286f841c8e6398766660902338a4d1db0069071f"
        }
      ],
      "message": "test: don't check for FRESH but not DIRTY entries in SanityCheck",
      "committer": {
        "name": "Andrew Toth",
        "email": "andrewstoth@gmail.com",
        "date": "2024-08-19T12:37:57Z"
      },
      "author": {
        "name": "Andrew Toth",
        "email": "andrewstoth@gmail.com",
        "date": "2024-08-18T21:17:11Z"
      },
      "sha": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13929814318,
      "node_id": "HRFPE_lADOABII586TWhHVzwAAAAM-SBku",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13929814318",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-19T12:38:28Z"
    },
    {
      "event": "reviewed",
      "id": 2245093564,
      "node_id": "PRR_kwDOABII586F0Wi8",
      "url": null,
      "actor": null,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "The code became a lot simpler now - have a few suggestion I'd like us to consider, but I understand if you think it's out of scope.\r\n\r\nOnce we get to a state that is ACK-worthy, I'll enable hard assertions everywhere and run an IBD and check if it crashes anywhere.",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#pullrequestreview-2245093564",
      "submitted_at": "2024-08-19T12:54:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
    },
    {
      "event": "reviewed",
      "id": 2246358443,
      "node_id": "PRR_kwDOABII586F5LWr",
      "url": null,
      "actor": null,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#pullrequestreview-2246358443",
      "submitted_at": "2024-08-19T20:01:26Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
    },
    {
      "event": "commented",
      "id": 2299500214,
      "node_id": "IC_kwDOABII586JD5a2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2299500214",
      "actor": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-08-20T18:36:46Z",
      "updated_at": "2024-08-20T18:36:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Once we get to a state that is ACK-worthy, I'll enable hard assertions everywhere and run an IBD and check if it crashes anywhere.\r\n\r\nI think for a change like this, spending time fuzzing would be more valuable. I believe it already runs in debug mode for that so `Assume`s would trigger crashes.",
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#issuecomment-2299500214",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30673"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721510656",
      "pull_request_review_id": 2245093564,
      "id": 1721510656,
      "node_id": "PRRC_kwDOABII585mnCsA",
      "diff_hunk": "@@ -49,10 +49,8 @@ CCoinsMap::iterator CCoinsViewCache::FetchCoin(const COutPoint &outpoint) const\n             cacheCoins.erase(ret);\n             return cacheCoins.end();\n         }\n-        if (ret->second.coin.IsSpent()) {\n-            // The parent only has an empty entry for this outpoint; we can consider our version as fresh.\n-            ret->second.AddFlags(CCoinsCacheEntry::FRESH, *ret, m_sentinel);\n-        }\n+        // GetCoin will never return true if the coin is spent\n+        Assume(!ret->second.coin.IsSpent());",
      "path": "src/coins.cpp",
      "position": 9,
      "original_position": 9,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "feaea74b049834f5388c477df3c985c202e491dd",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "when do we throw and when do we `Assume` here?\r\n> \\* Assume is the identity function.\r\n> \\*\r\n> \\* - Should be used to run non-fatal checks. In debug builds it behaves like\r\n> \\*   Assert()/assert() to notify developers and testers about non-fatal errors.\r\n> \\*   In production it doesn't warn or log anything.\r\n> \\* - For fatal errors, use Assert().\r\n\r\nWouldn't this be a fatal error?\r\n\r\nAlternatively, if we want to separate the test runs from production runs, would it maybe make sense to call `SanityCheck` in test&debug mode every time we want to be absolutely sure the state is correct? I know it's expensive, but might be reassuring during testing - and similarly to Assume, would be skipped in prod.",
      "created_at": "2024-08-19T09:47:54Z",
      "updated_at": "2024-08-19T12:55:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1721510656",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721510656"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 53,
      "original_line": 53,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721668812",
      "pull_request_review_id": 2245093564,
      "id": 1721668812,
      "node_id": "PRRC_kwDOABII585mnpTM",
      "diff_hunk": "@@ -325,14 +321,14 @@ void CCoinsViewCache::SanityCheck() const\n         if (entry.IsDirty()) attr |= 1;\n         if (entry.IsFresh()) attr |= 2;\n         if (entry.coin.IsSpent()) attr |= 4;\n-        // Only 5 combinations are possible.\n-        assert(attr != 2 && attr != 4 && attr != 7);\n+        // Only 4 combinations are possible.\n+        assert(attr != 2 && attr != 4 && attr != 6 && attr != 7);",
      "path": "src/coins.cpp",
      "position": 86,
      "original_position": 86,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "feaea74b049834f5388c477df3c985c202e491dd",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "So basically if we lay out the allowed combinations we'd get:\r\n```C++\r\nassert((!entry.IsDirty() & !entry.IsFresh() & !entry.coin.IsSpent())  |  // attr = 0\r\n        (entry.IsDirty() & !entry.IsFresh() & !entry.coin.IsSpent())  |  // attr = 1\r\n        (entry.IsDirty() &  entry.IsFresh() & !entry.coin.IsSpent())  |  // attr = 3\r\n        (entry.IsDirty() & !entry.IsFresh() &  entry.coin.IsSpent()));   // attr = 5\r\n```\r\nWhich could be simplified to\r\n```C++\r\nassert((entry.IsDirty() && !(entry.coin.IsSpent() && entry.IsFresh())) || !(entry.coin.IsSpent() || entry.IsFresh()));\r\n```\r\nwhich can be laid out as an if expression which would probably document the situation better than `!= 2 && != 4 && != 6 && != 7`:\r\n```C++\r\nif (entry.IsDirty()) {\r\n    assert(!(entry.coin.IsSpent() && entry.IsFresh()));\r\n} else {\r\n    assert(!(entry.coin.IsSpent() || entry.IsFresh()));\r\n}\r\n```\r\n\r\n<details><summary>sanity_check_assertions test</summary>\r\n<p>\r\nBOOST_AUTO_TEST_CASE(sanity_check_assertions)\r\n{\r\n    for (int is_dirty = 0; is_dirty <= 1; ++is_dirty) {\r\n        for (int is_fresh = 0; is_fresh <= 1; ++is_fresh) {\r\n            for (int is_spent = 0; is_spent <= 1; ++is_spent) {\r\n                // Original check\r\n                unsigned attr = 0;\r\n                if (is_dirty) attr |= 1;\r\n                if (is_fresh) attr |= 2;\r\n                if (is_spent) attr |= 4;\r\n                bool original_result = (attr != 2 && attr != 4 && attr != 6 && attr != 7);\r\n\r\n                bool new_result = (!is_dirty & !is_fresh & !is_spent) |  // attr = 0\r\n                                  (is_dirty & !is_fresh & !is_spent) |   // attr = 1\r\n                                  (is_dirty & is_fresh & !is_spent) |    // attr = 3\r\n                                  (is_dirty & !is_fresh & is_spent);     // attr = 5\r\n                BOOST_CHECK_EQUAL(original_result, new_result);\r\n\r\n                new_result = ((is_dirty && !(is_spent && is_fresh)) || !(is_spent || is_fresh));\r\n                BOOST_CHECK_EQUAL(original_result, new_result);\r\n\r\n                if (is_dirty) {\r\n                    new_result = !(is_spent && is_fresh);\r\n                } else {\r\n                    new_result = !(is_spent || is_fresh);\r\n                }\r\n                BOOST_CHECK_EQUAL(original_result, new_result);\r\n            }\r\n        }\r\n    }\r\n}\r\n</p>\r\n</details> \r\n",
      "created_at": "2024-08-19T11:51:32Z",
      "updated_at": "2024-08-19T13:18:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1721668812",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721668812"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": 322,
      "original_start_line": 321,
      "start_side": "RIGHT",
      "line": 326,
      "original_line": 326,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721727681",
      "pull_request_review_id": 2245093564,
      "id": 1721727681,
      "node_id": "PRRC_kwDOABII585mn3rB",
      "diff_hunk": "@@ -151,14 +148,10 @@ class CoinsViewBottom final : public CCoinsView\n     {",
      "path": "src/test/fuzz/coinscache_sim.cpp",
      "position": 13,
      "original_position": 13,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "963804c5f1f722dd14f07f8bccb90bd4825fbf9e",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I was surprised to see that the method called `GetCoin` now:\r\n* overwrites the dummy coin parameter with the value found in the cache\r\n* returns a boolean indicating whether the coin exists in the cache and is not spent (the name doesn't have any hints about it being spent or not)\r\n\r\nI don't mind if you think it's outside the scope of the current change, but checking the usages it seems to me we can now simplify `GetCoin` to actually return the coin and let the callsite check for spent and it might simplify the usages as well:\r\n```C++\r\nstd::optional<Coin> CCoinsViewCache::GetCoin(const COutPoint& outpoint) const\r\n{\r\n    auto it = FetchCoin(outpoint);\r\n    if (it != cacheCoins.end()) {\r\n        return it->second.coin;\r\n    }\r\n    return std::nullopt;\r\n}\r\n```\r\n\r\n<details>\r\n<summary>... and in tests</summary>\r\n```C++\r\nstd::optional<Coin> GetCoin(const COutPoint& outpoint) const\r\n{\r\n    if (const auto [it, found] = m_data.find(outpoint); found) {\r\n        return it->second;\r\n    }\r\n    return std::nullopt;\r\n}\r\n```\r\n</details>\r\n\r\nWhich would simplify usages from e.g.\r\n```C++\r\nCoin coin_using_get_coin;\r\nconst bool exists_using_get_coin = coins_view_cache.GetCoin(random_out_point, coin_using_get_coin);\r\nif (exists_using_get_coin) {\r\n    assert(coin_using_get_coin == coin_using_access_coin);\r\n}\r\nassert((exists_using_access_coin && exists_using_have_coin_in_cache && exists_using_have_coin && exists_using_get_coin) ||\r\n       (!exists_using_access_coin && !exists_using_have_coin_in_cache && !exists_using_have_coin && !exists_using_get_coin));\r\n```\r\nto something like:\r\n```C++\r\nif (auto coin_optional = coins_view_cache.GetCoin(random_out_point); coin_optional && !coin_optional->IsSpent()) {\r\n    assert(*coin_optional == coin_using_access_coin);\r\n    assert(exists_using_access_coin && exists_using_have_coin_in_cache && exists_using_have_coin);\r\n} else {\r\n    assert(!exists_using_access_coin && !exists_using_have_coin_in_cache && !exists_using_have_coin);\r\n}\r\n```\r\n\r\nWhat do you think?",
      "created_at": "2024-08-19T12:41:42Z",
      "updated_at": "2024-08-19T13:19:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1721727681",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721727681"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 148,
      "original_line": 148,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721733726",
      "pull_request_review_id": 2245093564,
      "id": 1721733726,
      "node_id": "PRRC_kwDOABII585mn5Je",
      "diff_hunk": "@@ -184,13 +177,13 @@ struct CCoinsCacheEntry\n     inline bool IsDirty() const noexcept { return m_flags & DIRTY; }\n     inline bool IsFresh() const noexcept { return m_flags & FRESH; }\n \n-    //! Only call Next when this entry is DIRTY, FRESH, or both\n+    //! Only call Next when this entry is DIRTY\n     inline CoinsCachePair* Next() const noexcept {\n         Assume(m_flags);",
      "path": "src/coins.h",
      "position": 28,
      "original_position": 28,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "ffabb2ddcd3c31e54b11a56c7e395af6b830e443",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n        Assume(IsDirty());\r\n```\r\n\r\nnit: it's a cheap call, why not make it an assert instead?",
      "created_at": "2024-08-19T12:46:37Z",
      "updated_at": "2024-08-19T12:54:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1721733726",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721733726"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 182,
      "original_line": 182,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721738283",
      "pull_request_review_id": 2245093564,
      "id": 1721738283,
      "node_id": "PRRC_kwDOABII585mn6Qr",
      "diff_hunk": "@@ -53,14 +53,11 @@ class CCoinsViewTest : public CCoinsView\n \n     bool BatchWrite(CoinsViewCacheCursor& cursor, const uint256& hashBlock) override\n     {\n-        for (auto it{cursor.Begin()}; it != cursor.End(); it = cursor.NextAndMaybeErase(*it)){\n-            if (it->second.IsDirty()) {",
      "path": "src/test/coins_tests.cpp",
      "position": 17,
      "original_position": 5,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "946a035cdc298c3168b1164079892a85902c966f",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "is this is always the case, consider adding an assertion\r\n```C++\r\nassert(it->second.IsDirty());\r\n```\r\n\r\n(we can remove them in the last commit, but would be useful for the intermediary commits at least)",
      "created_at": "2024-08-19T12:50:13Z",
      "updated_at": "2024-08-19T12:54:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1721738283",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721738283"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 61,
      "original_line": 57,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721740165",
      "pull_request_review_id": 2245093564,
      "id": 1721740165,
      "node_id": "PRRC_kwDOABII585mn6uF",
      "diff_hunk": "@@ -275,7 +275,7 @@ bool CCoinsViewCache::Sync()\n void CCoinsViewCache::Uncache(const COutPoint& hash)\n {\n     CCoinsMap::iterator it = cacheCoins.find(hash);\n-    if (it != cacheCoins.end() && !it->second.IsDirty() && !it->second.IsFresh()) {",
      "path": "src/coins.cpp",
      "position": 74,
      "original_position": 4,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "286f841c8e6398766660902338a4d1db0069071f",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "same, can we add a (temporary) assertion for the removed check?",
      "created_at": "2024-08-19T12:51:40Z",
      "updated_at": "2024-08-19T13:21:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1721740165",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721740165"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 281,
      "original_line": 278,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721800990",
      "pull_request_review_id": 2245569284,
      "id": 1721800990,
      "node_id": "PRRC_kwDOABII585moJke",
      "diff_hunk": "@@ -151,14 +148,10 @@ class CoinsViewBottom final : public CCoinsView\n     {",
      "path": "src/test/fuzz/coinscache_sim.cpp",
      "position": 13,
      "original_position": 13,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "963804c5f1f722dd14f07f8bccb90bd4825fbf9e",
      "in_reply_to_id": 1721727681,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This behavior is documented [here](https://github.com/bitcoin/bitcoin/blob/master/src/coins.h#L306-L310), so not sure why test code bothered to do this. Indeed, switching to `std::optional` would be cleaner, but I think a much bigger refactor. This is also suggested in the original PR [here](https://github.com/bitcoin/bitcoin/pull/18746#issuecomment-842393167).",
      "created_at": "2024-08-19T13:35:15Z",
      "updated_at": "2024-08-19T13:35:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1721800990",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721800990"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 148,
      "original_line": 148,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721809523",
      "pull_request_review_id": 2245583004,
      "id": 1721809523,
      "node_id": "PRRC_kwDOABII585moLpz",
      "diff_hunk": "@@ -151,14 +148,10 @@ class CoinsViewBottom final : public CCoinsView\n     {",
      "path": "src/test/fuzz/coinscache_sim.cpp",
      "position": 13,
      "original_position": 13,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "963804c5f1f722dd14f07f8bccb90bd4825fbf9e",
      "in_reply_to_id": 1721727681,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> but I think a much bigger refactor\r\n\r\nMaybe, would it help if I did that in a different PR?",
      "created_at": "2024-08-19T13:40:25Z",
      "updated_at": "2024-08-19T13:40:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1721809523",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721809523"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 148,
      "original_line": 148,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721817389",
      "pull_request_review_id": 2245596138,
      "id": 1721817389,
      "node_id": "PRRC_kwDOABII585moNkt",
      "diff_hunk": "@@ -151,14 +148,10 @@ class CoinsViewBottom final : public CCoinsView\n     {",
      "path": "src/test/fuzz/coinscache_sim.cpp",
      "position": 13,
      "original_position": 13,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "963804c5f1f722dd14f07f8bccb90bd4825fbf9e",
      "in_reply_to_id": 1721727681,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, but it would conflict heavily with this one. Many of the tests would have to be removed as well.",
      "created_at": "2024-08-19T13:45:09Z",
      "updated_at": "2024-08-19T13:45:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1721817389",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721817389"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 148,
      "original_line": 148,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721879299",
      "pull_request_review_id": 2245697067,
      "id": 1721879299,
      "node_id": "PRRC_kwDOABII585mocsD",
      "diff_hunk": "@@ -151,14 +148,10 @@ class CoinsViewBottom final : public CCoinsView\n     {",
      "path": "src/test/fuzz/coinscache_sim.cpp",
      "position": 13,
      "original_position": 13,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "963804c5f1f722dd14f07f8bccb90bd4825fbf9e",
      "in_reply_to_id": 1721727681,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm fine with that, extracted to a branch for now, will push as a draft after your PR stabilizes ",
      "created_at": "2024-08-19T14:24:09Z",
      "updated_at": "2024-08-19T14:24:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1721879299",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1721879299"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 148,
      "original_line": 148,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1722285129",
      "pull_request_review_id": 2246356092,
      "id": 1722285129,
      "node_id": "PRRC_kwDOABII585mp_xJ",
      "diff_hunk": "@@ -151,14 +148,10 @@ class CoinsViewBottom final : public CCoinsView\n     {",
      "path": "src/test/fuzz/coinscache_sim.cpp",
      "position": 13,
      "original_position": 13,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "963804c5f1f722dd14f07f8bccb90bd4825fbf9e",
      "in_reply_to_id": 1721727681,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "you can resolve this comment, I see now that this should definitely be investigated in a separate PR (it's a big change).",
      "created_at": "2024-08-19T19:59:56Z",
      "updated_at": "2024-08-19T19:59:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1722285129",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1722285129"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 148,
      "original_line": 148,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1722286606",
      "pull_request_review_id": 2246358443,
      "id": 1722286606,
      "node_id": "PRRC_kwDOABII585mqAIO",
      "diff_hunk": "@@ -49,10 +49,8 @@ CCoinsMap::iterator CCoinsViewCache::FetchCoin(const COutPoint &outpoint) const\n             cacheCoins.erase(ret);\n             return cacheCoins.end();\n         }\n-        if (ret->second.coin.IsSpent()) {\n-            // The parent only has an empty entry for this outpoint; we can consider our version as fresh.\n-            ret->second.AddFlags(CCoinsCacheEntry::FRESH, *ret, m_sentinel);\n-        }\n+        // GetCoin will never return true if the coin is spent",
      "path": "src/coins.cpp",
      "position": 8,
      "original_position": 8,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "in_reply_to_id": null,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It doesn't sound like it's `GetCoin`'s responsibility, I think the call-sites should be checking for whether the coins are spent or not, not the cache accessor method",
      "created_at": "2024-08-19T20:01:26Z",
      "updated_at": "2024-08-19T21:20:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1722286606",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1722286606"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 52,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1722535036",
      "pull_request_review_id": 2246751794,
      "id": 1722535036,
      "node_id": "PRRC_kwDOABII585mq8x8",
      "diff_hunk": "@@ -151,14 +148,10 @@ class CoinsViewBottom final : public CCoinsView\n     {",
      "path": "src/test/fuzz/coinscache_sim.cpp",
      "position": 13,
      "original_position": 13,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "963804c5f1f722dd14f07f8bccb90bd4825fbf9e",
      "in_reply_to_id": 1721727681,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think you can resolve your own comment threads too 😉",
      "created_at": "2024-08-20T00:18:18Z",
      "updated_at": "2024-08-20T00:18:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1722535036",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1722535036"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 148,
      "original_line": 148,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1722578637",
      "pull_request_review_id": 2246814506,
      "id": 1722578637,
      "node_id": "PRRC_kwDOABII585mrHbN",
      "diff_hunk": "@@ -49,10 +49,8 @@ CCoinsMap::iterator CCoinsViewCache::FetchCoin(const COutPoint &outpoint) const\n             cacheCoins.erase(ret);\n             return cacheCoins.end();\n         }\n-        if (ret->second.coin.IsSpent()) {\n-            // The parent only has an empty entry for this outpoint; we can consider our version as fresh.\n-            ret->second.AddFlags(CCoinsCacheEntry::FRESH, *ret, m_sentinel);\n-        }\n+        // GetCoin will never return true if the coin is spent",
      "path": "src/coins.cpp",
      "position": 8,
      "original_position": 8,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "in_reply_to_id": 1722286606,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It's specifically documented that this is the behavior. Why shouldn't we be able to rely on it?",
      "created_at": "2024-08-20T01:39:34Z",
      "updated_at": "2024-08-20T01:39:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1722578637",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1722578637"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 52,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1722716550",
      "pull_request_review_id": 2247013328,
      "id": 1722716550,
      "node_id": "PRRC_kwDOABII585mrpGG",
      "diff_hunk": "@@ -151,14 +148,10 @@ class CoinsViewBottom final : public CCoinsView\n     {",
      "path": "src/test/fuzz/coinscache_sim.cpp",
      "position": 13,
      "original_position": 13,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "963804c5f1f722dd14f07f8bccb90bd4825fbf9e",
      "in_reply_to_id": 1721727681,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't have write access to your PR:\r\nhttps://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/about-pull-request-reviews#resolving-conversations",
      "created_at": "2024-08-20T05:42:04Z",
      "updated_at": "2024-08-20T05:42:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1722716550",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1722716550"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 148,
      "original_line": 148,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1722725094",
      "pull_request_review_id": 2247026258,
      "id": 1722725094,
      "node_id": "PRRC_kwDOABII585mrrLm",
      "diff_hunk": "@@ -49,10 +49,8 @@ CCoinsMap::iterator CCoinsViewCache::FetchCoin(const COutPoint &outpoint) const\n             cacheCoins.erase(ret);\n             return cacheCoins.end();\n         }\n-        if (ret->second.coin.IsSpent()) {\n-            // The parent only has an empty entry for this outpoint; we can consider our version as fresh.\n-            ret->second.AddFlags(CCoinsCacheEntry::FRESH, *ret, m_sentinel);\n-        }\n+        // GetCoin will never return true if the coin is spent",
      "path": "src/coins.cpp",
      "position": 8,
      "original_position": 8,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "in_reply_to_id": 1722286606,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If we need to document the behavior of a method, it suggests that we’ve acknowledged it may not be intuitive for everyone, indicating that we’ve conceded on finding a better design.\r\nI think there's a way we can avoid the comment: by separating the two concerns of getting a value from cache and checking if it's spent or not.\r\nOr if you insist, we can call it \"GetUnspent\" in which case we can also get rid of the comment and call-site asserts and keep the current behavior.\r\nWhat do you think?",
      "created_at": "2024-08-20T05:53:30Z",
      "updated_at": "2024-08-20T05:53:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1722725094",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1722725094"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 52,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1723632249",
      "pull_request_review_id": 2248528707,
      "id": 1723632249,
      "node_id": "PRRC_kwDOABII585mvIp5",
      "diff_hunk": "@@ -49,10 +49,8 @@ CCoinsMap::iterator CCoinsViewCache::FetchCoin(const COutPoint &outpoint) const\n             cacheCoins.erase(ret);\n             return cacheCoins.end();\n         }\n-        if (ret->second.coin.IsSpent()) {\n-            // The parent only has an empty entry for this outpoint; we can consider our version as fresh.\n-            ret->second.AddFlags(CCoinsCacheEntry::FRESH, *ret, m_sentinel);\n-        }\n+        // GetCoin will never return true if the coin is spent",
      "path": "src/coins.cpp",
      "position": 8,
      "original_position": 8,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "in_reply_to_id": 1722286606,
      "user": {
        "login": "andrewtoth",
        "id": 237213,
        "node_id": "MDQ6VXNlcjIzNzIxMw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/237213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andrewtoth",
        "html_url": "https://github.com/andrewtoth",
        "followers_url": "https://api.github.com/users/andrewtoth/followers",
        "following_url": "https://api.github.com/users/andrewtoth/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andrewtoth/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andrewtoth/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andrewtoth/subscriptions",
        "organizations_url": "https://api.github.com/users/andrewtoth/orgs",
        "repos_url": "https://api.github.com/users/andrewtoth/repos",
        "events_url": "https://api.github.com/users/andrewtoth/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andrewtoth/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "What you are suggesting is basically a concept NACK on this PR. If we aren't confident that we will never get a spent coin from GetCoin, then we need to keep the logic to handle spent and FRESH coins.",
      "created_at": "2024-08-20T16:40:22Z",
      "updated_at": "2024-08-20T16:40:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1723632249",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1723632249"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 52,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1723636084",
      "pull_request_review_id": 2248534125,
      "id": 1723636084,
      "node_id": "PRRC_kwDOABII585mvJl0",
      "diff_hunk": "@@ -49,10 +49,8 @@ CCoinsMap::iterator CCoinsViewCache::FetchCoin(const COutPoint &outpoint) const\n             cacheCoins.erase(ret);\n             return cacheCoins.end();\n         }\n-        if (ret->second.coin.IsSpent()) {\n-            // The parent only has an empty entry for this outpoint; we can consider our version as fresh.\n-            ret->second.AddFlags(CCoinsCacheEntry::FRESH, *ret, m_sentinel);\n-        }\n+        // GetCoin will never return true if the coin is spent",
      "path": "src/coins.cpp",
      "position": 8,
      "original_position": 8,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "in_reply_to_id": 1722286606,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "@paplorinc I feel your criticism here is about the naming/expectations/documentation of the existing code, rather than about this PR. Do you feel that addressing that first should be a blocker for this PR?",
      "created_at": "2024-08-20T16:43:09Z",
      "updated_at": "2024-08-20T16:43:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1723636084",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1723636084"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 52,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1723665550",
      "pull_request_review_id": 2248581119,
      "id": 1723665550,
      "node_id": "PRRC_kwDOABII585mvQyO",
      "diff_hunk": "@@ -49,10 +49,8 @@ CCoinsMap::iterator CCoinsViewCache::FetchCoin(const COutPoint &outpoint) const\n             cacheCoins.erase(ret);\n             return cacheCoins.end();\n         }\n-        if (ret->second.coin.IsSpent()) {\n-            // The parent only has an empty entry for this outpoint; we can consider our version as fresh.\n-            ret->second.AddFlags(CCoinsCacheEntry::FRESH, *ret, m_sentinel);\n-        }\n+        // GetCoin will never return true if the coin is spent",
      "path": "src/coins.cpp",
      "position": 8,
      "original_position": 8,
      "commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "original_commit_id": "1f2f8e516b86d4a73bac0bedad753da3e307bf8a",
      "in_reply_to_id": 1722286606,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I won't block this since I'm fine with discussing/addressing any issues in later commits as well. \r\nI also don't yet understand the second order effects of these changes, so treat my comments as curious observations.\r\n\r\nSo my concern is that in this PR we're tying `coin.IsSpent()` with retrieving values from the cache.\r\nSo if my understanding is correct we should either:\r\n* be able to get a coin from the cache and ignore/assert whether it's spent or not - e.g. [`HaveCoin`](https://github.com/bitcoin/bitcoin/blob/master/src/coins.cpp#L21) will now return false when the cache contains it but it's spent... and if that's not possible in certain situations I would assert instead of returning the boolean.\r\nSo in that case `GetCoin` would just get it from the cache and the call-site will decide whether it should assert for `IsSpent` or branch based on it, something like this: https://github.com/bitcoin/bitcoin/blob/9db8b30788eff2b8e9c9f629a6a03886a28a3281/src/test/fuzz/coins_view.cpp#L167\r\n* rename the method to reflect the new responsibility that it has\r\n\r\nThere's also a third possibility that I'm completely off on what this PR does - your patience is appreciated :)",
      "created_at": "2024-08-20T17:06:19Z",
      "updated_at": "2024-08-20T17:06:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30673#discussion_r1723665550",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1723665550"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30673"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 52,
      "original_line": 52,
      "side": "RIGHT"
    }
  ]
}