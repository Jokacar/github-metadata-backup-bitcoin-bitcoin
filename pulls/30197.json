{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197",
    "id": 1895754531,
    "node_id": "PR_kwDOABII585w_usj",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/30197",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/30197.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/30197.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30197",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30197/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/63f62b50d2a10b3118f56d49228a862011450f19",
    "number": 30197,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "fuzz: bound some miniscript operations to avoid fuzz timeouts",
    "user": {
      "login": "darosior",
      "id": 22457751,
      "node_id": "MDQ6VXNlcjIyNDU3NzUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/darosior",
      "html_url": "https://github.com/darosior",
      "followers_url": "https://api.github.com/users/darosior/followers",
      "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
      "organizations_url": "https://api.github.com/users/darosior/orgs",
      "repos_url": "https://api.github.com/users/darosior/repos",
      "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/darosior/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Some of the logic in the miniscript module is quadratic. It only becomes an issue for very large uninteresting descriptors (like a `thresh` with 130k sub-fragments or a fragment with more than 60k nested `j:` wrappers).\r\n\r\nThis PR fixes the two types of fuzz timeouts reported by Marco in https://github.com/bitcoin/bitcoin/issues/28812 by trying to pinpoint the problematic descriptors through a simple analysis of the string, without limiting the size of the string itself. This is the same approach as was adopted for limiting the depth of derivation paths.",
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      }
    ],
    "created_at": "2024-05-30T11:07:55Z",
    "updated_at": "2024-07-11T18:54:51Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "5eaf0577ab8a9823044747c9136b29886fda8dae",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "darosior:2405_desc_fuzz_timeouts",
      "ref": "2405_desc_fuzz_timeouts",
      "sha": "63f62b50d2a10b3118f56d49228a862011450f19",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 168868367,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNjg4NjgzNjc=",
        "name": "bitcoin",
        "full_name": "darosior/bitcoin",
        "owner": {
          "login": "darosior",
          "id": 22457751,
          "node_id": "MDQ6VXNlcjIyNDU3NzUx",
          "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/darosior",
          "html_url": "https://github.com/darosior",
          "followers_url": "https://api.github.com/users/darosior/followers",
          "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
          "organizations_url": "https://api.github.com/users/darosior/orgs",
          "repos_url": "https://api.github.com/users/darosior/repos",
          "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/darosior/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/darosior/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/darosior/bitcoin",
        "archive_url": "https://api.github.com/repos/darosior/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/darosior/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/darosior/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/darosior/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/darosior/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/darosior/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/darosior/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/darosior/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/darosior/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/darosior/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/darosior/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/darosior/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/darosior/bitcoin/events",
        "forks_url": "https://api.github.com/repos/darosior/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/darosior/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/darosior/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/darosior/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/darosior/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/darosior/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/darosior/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/darosior/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/darosior/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/darosior/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/darosior/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/darosior/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/darosior/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/darosior/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/darosior/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/darosior/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:darosior/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/darosior/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/darosior/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/darosior/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/darosior/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/darosior/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/darosior/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/darosior/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/darosior/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/darosior/bitcoin/hooks",
        "svn_url": "https://github.com/darosior/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 243922,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-07-11T18:54:46Z",
        "created_at": "2019-02-02T19:20:27Z",
        "updated_at": "2023-11-07T12:50:46Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "00feabf6c59c954c1e3a5a46e58cb80cd8d55911",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35629,
        "stargazers_count": 77157,
        "watchers_count": 77157,
        "size": 263004,
        "default_branch": "master",
        "open_issues_count": 683,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-07-11T18:54:49Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-07-11T18:21:21Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 92,
    "deletions": 1,
    "changed_files": 3,
    "commits": 2,
    "review_comments": 29,
    "comments": 5
  },
  "events": [
    {
      "event": "commented",
      "id": 2139317768,
      "node_id": "IC_kwDOABII585_g2YI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2139317768",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-30T11:07:58Z",
      "updated_at": "2024-07-11T18:54:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/30197).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Stale ACK | [dergoegge](https://github.com/bitcoin/bitcoin/pull/30197#pullrequestreview-2162956899), [marcofleon](https://github.com/bitcoin/bitcoin/pull/30197#pullrequestreview-2172193524), [stickies-v](https://github.com/bitcoin/bitcoin/pull/30197#pullrequestreview-2172444820) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#issuecomment-2139317768",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30197"
    },
    {
      "event": "labeled",
      "id": 12984274151,
      "node_id": "LE_lADOABII586KmojZzwAAAAMF7Ezn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12984274151",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-30T11:08:01Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "labeled",
      "id": 12987792205,
      "node_id": "LE_lADOABII586KmojZzwAAAAMGIftN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12987792205",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-30T15:14:11Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2139887768,
      "node_id": "IC_kwDOABII585_jBiY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2139887768",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-30T15:14:12Z",
      "updated_at": "2024-05-30T15:14:12Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\n🚧 At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/25599793054</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#issuecomment-2139887768",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30197"
    },
    {
      "event": "review_requested",
      "id": 12997573044,
      "node_id": "RRE_lADOABII586KmojZzwAAAAMGtzm0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12997573044",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T09:36:47Z",
      "requested_reviewer": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "review_requested",
      "id": 12997573059,
      "node_id": "RRE_lADOABII586KmojZzwAAAAMGtznD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12997573059",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T09:36:48Z",
      "requested_reviewer": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "reviewed",
      "id": 2090646854,
      "node_id": "PRR_kwDOABII5858nL1G",
      "url": null,
      "actor": null,
      "commit_id": "79c2bc919187631ba336bc180351c7d5141db872",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#pullrequestreview-2090646854",
      "submitted_at": "2024-05-31T11:46:32Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
    },
    {
      "event": "reviewed",
      "id": 2098953897,
      "node_id": "PRR_kwDOABII5859G36p",
      "url": null,
      "actor": null,
      "commit_id": "79c2bc919187631ba336bc180351c7d5141db872",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#pullrequestreview-2098953897",
      "submitted_at": "2024-06-05T12:09:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13054322322,
      "node_id": "HRFPE_lADOABII586KmojZzwAAAAMKGSaS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13054322322",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-05T16:33:21Z"
    },
    {
      "event": "subscribed",
      "id": 13062948005,
      "node_id": "SE_lADOABII586KmojZzwAAAAMKnMSl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13062948005",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-06T08:27:44Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13064704764,
      "node_id": "HRFPE_lADOABII586KmojZzwAAAAMKt5L8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13064704764",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-06T10:44:49Z"
    },
    {
      "event": "unlabeled",
      "id": 13066506107,
      "node_id": "UNLE_lADOABII586KmojZzwAAAAMK0w97",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13066506107",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-06T13:08:18Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2165010123,
      "node_id": "IC_kwDOABII586BC27L",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2165010123",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-13T08:39:25Z",
      "updated_at": "2024-06-13T08:39:25Z",
      "author_association": "MEMBER",
      "body": "#30229 was merged if you want to rebase",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#issuecomment-2165010123",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30197"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13318659209,
      "node_id": "HRFPE_lADOABII586KmojZzwAAAAMZ2pyJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13318659209",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-27T14:37:27Z"
    },
    {
      "event": "commented",
      "id": 2194915751,
      "node_id": "IC_kwDOABII586C08Gn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2194915751",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-27T14:42:28Z",
      "updated_at": "2024-06-27T14:42:28Z",
      "author_association": "MEMBER",
      "body": "Rebased on master to take advantage of #30229.",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#issuecomment-2194915751",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30197"
    },
    {
      "event": "reviewed",
      "id": 2162956899,
      "node_id": "PRR_kwDOABII586A7Bpj",
      "url": null,
      "actor": null,
      "commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "utACK 178a1da9c4da955c3dc78e6b03f110f687e82508",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#pullrequestreview-2162956899",
      "submitted_at": "2024-07-08T10:54:39Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
    },
    {
      "event": "reviewed",
      "id": 2163854874,
      "node_id": "PRR_kwDOABII586A-c4a",
      "url": null,
      "actor": null,
      "commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#pullrequestreview-2163854874",
      "submitted_at": "2024-07-08T21:49:19Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
    },
    {
      "event": "reviewed",
      "id": 2172193524,
      "node_id": "PRR_kwDOABII586BeQr0",
      "url": null,
      "actor": null,
      "commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Lightly tested ACK 178a1da9c4da955c3dc78e6b03f110f687e82508. I tested on the three inputs brought up in https://github.com/bitcoin/bitcoin/issues/28812 and they all executed in 1ms. I can run the target for a while and see if any other timeouts come up. But looks good to me.",
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#pullrequestreview-2172193524",
      "submitted_at": "2024-07-11T15:16:41Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
    },
    {
      "event": "review_requested",
      "id": 13473476998,
      "node_id": "RRE_lADOABII586KmojZzwAAAAMjFPGG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13473476998",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-11T15:16:45Z",
      "requested_reviewer": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "reviewed",
      "id": 2172444820,
      "node_id": "PRR_kwDOABII586BfOCU",
      "url": null,
      "actor": null,
      "commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Light ACK 178a1da9c4da955c3dc78e6b03f110f687e82508\r\n\r\nCode LGTM and approach seems reasonable, but there may be fuzzing and miniscript nuances I'm not considering.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#pullrequestreview-2172444820",
      "submitted_at": "2024-07-11T16:47:41Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBkOTYxYzFkOTdhNDY5Y2MxNTVkMzA5ZDUxZDYwMTVmMTdkNGY1NjY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0d961c1d97a469cc155d309d51d6015f17d4f566",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0d961c1d97a469cc155d309d51d6015f17d4f566",
      "tree": {
        "sha": "ef56d3181e512bb89735b6bbb8578810c3310af6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ef56d3181e512bb89735b6bbb8578810c3310af6"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree ef56d3181e512bb89735b6bbb8578810c3310af6\nparent 00feabf6c59c954c1e3a5a46e58cb80cd8d55911\nauthor Antoine Poinsot <darosior@protonmail.com> 1717060457 +0200\ncommitter Antoine Poinsot <darosior@protonmail.com> 1720723087 +0200\n\nfuzz: limit the number of sub-fragments per fragment for descriptors\n\nThis target may call into logic quadratic over the number of\nsub-fragments. Limit the number of sub-fragments to keep the runtime\nreasonable.\n\nThanks to Marco Falke for reporting the fuzz timeouts with a minimized\ninput.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEEWQtykmla/6W2csuy4T/BRc0/QwQFAmaQJo8ACgkQ4T/BRc0/\nQwQDxwwAtPPwc2NR0D0E8O2qC8/xF43h+gN3ueM0zb2CpFAvfCjleoeb9dSxtht1\nfNKbLuNrJXJCotDBaNcV5nqhASK98pr0gYQl0QfGwV4ikrWtUTnyLWfpukt0l9y1\nj8nsuuNFqnXr7Y1xBxqm14gZI5w2psPHuQnNi/E41/0awKn61j72iVCD9oouNXvs\nwxEbu8yMIR3Fxvq/sPB797tCpev8LRjosyBl9fUfkswAUCUzHlc09k30uETAjIX5\nQkwxm8PVuNAKDt1/g0mo9zREaym5/57JcRqjhDkK+/BOuDlvLldQsyoCGV9fJP6R\niOq9HBWEhgfo7lEdVrHW75OCxGuE774n5V7urVuBT0MeoqoWFcJ3PhUzCmslEuz8\nyLrYB4SCMvH4VTTSGGeq4VSplt99n3pwCK2TKLLzJbSbd0ZqEKVH0+LFTThHIvuC\nswlvUAt0A3TscPB2iDJX66cJDh68vrg7cHMYiJkn5GYDqBC76NpeA4ZJnS1BXdim\naPRUenOX\n=jdJL\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/00feabf6c59c954c1e3a5a46e58cb80cd8d55911",
          "sha": "00feabf6c59c954c1e3a5a46e58cb80cd8d55911",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/00feabf6c59c954c1e3a5a46e58cb80cd8d55911"
        }
      ],
      "message": "fuzz: limit the number of sub-fragments per fragment for descriptors\n\nThis target may call into logic quadratic over the number of\nsub-fragments. Limit the number of sub-fragments to keep the runtime\nreasonable.\n\nThanks to Marco Falke for reporting the fuzz timeouts with a minimized\ninput.",
      "committer": {
        "name": "Antoine Poinsot",
        "email": "darosior@protonmail.com",
        "date": "2024-07-11T18:38:07Z"
      },
      "author": {
        "name": "Antoine Poinsot",
        "email": "darosior@protonmail.com",
        "date": "2024-05-30T09:14:17Z"
      },
      "sha": "0d961c1d97a469cc155d309d51d6015f17d4f566"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDYzZjYyYjUwZDJhMTBiMzExOGY1NmQ0OTIyOGE4NjIwMTE0NTBmMTk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/63f62b50d2a10b3118f56d49228a862011450f19",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/63f62b50d2a10b3118f56d49228a862011450f19",
      "tree": {
        "sha": "0fd1de2ceef69ab206e6391da091143818a354d1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0fd1de2ceef69ab206e6391da091143818a354d1"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 0fd1de2ceef69ab206e6391da091143818a354d1\nparent 0d961c1d97a469cc155d309d51d6015f17d4f566\nauthor Antoine Poinsot <darosior@protonmail.com> 1717066364 +0200\ncommitter Antoine Poinsot <darosior@protonmail.com> 1720723088 +0200\n\nfuzz: limit the number of nested wrappers in descriptors\n\nThe script building logic performs a quadratic number of copies in the\nnumber of nested wrappers in the miniscript. Limit the number of nested\nwrappers to avoid fuzz timeouts.\n\nThanks to Marco Falke for reporting the fuzz timeouts and providing a\nminimal input to reproduce.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEEWQtykmla/6W2csuy4T/BRc0/QwQFAmaQJpAACgkQ4T/BRc0/\nQwReUwv/XxRmm+jLCR4wmNotYxpKI8GhpPQPoc43BbjlSF3XdS4GFqZfXv3nO5BS\nI7GIalVJ9HE0UR2/IGldMMRye5aIThd6kPrrV3fjnQAhK/Hf/6/HPN6uNeoypyUe\neiKWx+YJP9PDl0vAxTXYOQbpzkCSH0Bxf1Q6zPwgpEaROxsyjVaZh97/lF2YyVXf\nSP79L9ayFNKjQt5TgHUF5XibGEbJkY7NlqWdyc+bdLk+cMvYHXEPVEL+CkMl/WbY\npngvn/OY1fjGHyMaL4DW4ecfanAEO1WVgOIa+1hiRklV2G3jai5DzDCRn/vjFqB9\nJdc/BEJtxR634iyOXAtr2Ki853aEA9J5oXojSPV2YSxyGSEdvA5PCNnY6WqdrR/3\noDkkBdLXSbH9nzIAtQJQys8RjgkDgQqGmukuxcFauI/XVL/vLNr4YTKpqaM+wDds\njxqHoLoea6j17tHStsBq8rJwmfr3rwkeJTAWIJ/gDqSKnAYPQOlRLvS2rgn7vXu+\nrojKXuQ3\n=/PYG\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0d961c1d97a469cc155d309d51d6015f17d4f566",
          "sha": "0d961c1d97a469cc155d309d51d6015f17d4f566",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0d961c1d97a469cc155d309d51d6015f17d4f566"
        }
      ],
      "message": "fuzz: limit the number of nested wrappers in descriptors\n\nThe script building logic performs a quadratic number of copies in the\nnumber of nested wrappers in the miniscript. Limit the number of nested\nwrappers to avoid fuzz timeouts.\n\nThanks to Marco Falke for reporting the fuzz timeouts and providing a\nminimal input to reproduce.",
      "committer": {
        "name": "Antoine Poinsot",
        "email": "darosior@protonmail.com",
        "date": "2024-07-11T18:38:08Z"
      },
      "author": {
        "name": "Antoine Poinsot",
        "email": "darosior@protonmail.com",
        "date": "2024-05-30T10:52:44Z"
      },
      "sha": "63f62b50d2a10b3118f56d49228a862011450f19"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13476204113,
      "node_id": "HRFPE_lADOABII586KmojZzwAAAAMjPo5R",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13476204113",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-11T18:54:47Z"
    },
    {
      "event": "commented",
      "id": 2223670550,
      "node_id": "IC_kwDOABII586EioUW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2223670550",
      "actor": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-11T18:54:50Z",
      "updated_at": "2024-07-11T18:54:50Z",
      "author_association": "MEMBER",
      "body": "Thank you both for the review. I addressed your comments and heavily documented the code. I think it can be helpful as it indeed relies on being familiar with the descriptor/miniscript syntax. If only to make the assumptions in the counting logic explicit, or for when we'll all have forgotten about the details of this syntax.\r\n\r\nI also modified two small things:\r\n- I introduced a limit to the number of nested sub-fragments a fragment may have. Since we are pushing an element on top of a stack for every occurrence of a `(`, the fuzzer might just spit a `-max_len` (about 1M in my experience) string of `(((((((...` and we'd create a stack of 1 million integers. It'd waste resources and anyways 10k subs is more than enough for anything interesting.\r\n- I corrected `HasTooManySubs` to not start counting at `1` since technically `:` isn't a wrapper. Instead i use an optional to detect whether we are counting or not. This also made the code slightly clearer and allowed to better document it.",
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#issuecomment-2223670550",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30197"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1622309134",
      "pull_request_review_id": 2090646854,
      "id": 1622309134,
      "node_id": "PRRC_kwDOABII585gsnkO",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto& ch: buff | std::views::reverse) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "79c2bc919187631ba336bc180351c7d5141db872",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This isn't available yet. You'll have to use a reverse iterator manually for now.",
      "created_at": "2024-05-31T11:46:32Z",
      "updated_at": "2024-05-31T11:46:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1622309134",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1622309134"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1627639850",
      "pull_request_review_id": 2098953897,
      "id": 1627639850,
      "node_id": "PRRC_kwDOABII585hA9Aq",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto& ch: buff | std::views::reverse) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "79c2bc919187631ba336bc180351c7d5141db872",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    for (const auto& ch: reverse_iterate(buff)) {\r\n```",
      "created_at": "2024-06-05T12:09:21Z",
      "updated_at": "2024-06-05T12:09:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1627639850",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1627639850"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1627643940",
      "pull_request_review_id": 2098959908,
      "id": 1627643940,
      "node_id": "PRRC_kwDOABII585hA-Ak",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto& ch: buff | std::views::reverse) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "79c2bc919187631ba336bc180351c7d5141db872",
      "in_reply_to_id": 1627639850,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Alternative, if it doesn't compile with `Span`:\r\n\r\n```suggestion\r\n    for (const auto& ch: reverse_iterate(std::span{buff}) {\r\n```",
      "created_at": "2024-06-05T12:12:09Z",
      "updated_at": "2024-06-05T12:12:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1627643940",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1627643940"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1627668193",
      "pull_request_review_id": 2098995222,
      "id": 1627668193,
      "node_id": "PRRC_kwDOABII585hBD7h",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto& ch: buff | std::views::reverse) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "79c2bc919187631ba336bc180351c7d5141db872",
      "in_reply_to_id": 1627639850,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Sorry, i saw your comment earlier, just didn't have time to address earlier. Thanks, will push soon.",
      "created_at": "2024-06-05T12:28:02Z",
      "updated_at": "2024-06-05T12:28:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1627668193",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1627668193"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1627691575",
      "pull_request_review_id": 2099033807,
      "id": 1627691575,
      "node_id": "PRRC_kwDOABII585hBJo3",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto& ch: buff | std::views::reverse) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "79c2bc919187631ba336bc180351c7d5141db872",
      "in_reply_to_id": 1627639850,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Sure, no rush. See also https://github.com/bitcoin/bitcoin/pull/30229",
      "created_at": "2024-06-05T12:45:17Z",
      "updated_at": "2024-06-05T12:45:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1627691575",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1627691575"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1628090346",
      "pull_request_review_id": 2099717929,
      "id": 1628090346,
      "node_id": "PRRC_kwDOABII585hCq_q",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto& ch: buff | std::views::reverse) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "79c2bc919187631ba336bc180351c7d5141db872",
      "in_reply_to_id": 1627639850,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done (through `.rbegin()` instead as your `std::reverse_iterate` suggestion didn't compile).",
      "created_at": "2024-06-05T16:34:10Z",
      "updated_at": "2024-06-05T16:34:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1628090346",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1628090346"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1628935823",
      "pull_request_review_id": 2101125960,
      "id": 1628935823,
      "node_id": "PRRC_kwDOABII585hF5aP",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto& ch: buff | std::views::reverse) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "79c2bc919187631ba336bc180351c7d5141db872",
      "in_reply_to_id": 1627639850,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`reverse_iterate` is a helper in this repo, not in `std::`. You'll have to include it to use it.\r\n\r\nAlso, it looks like taking a `std::span` from a `Span` is not possible, at least on clang-15, according to the CI.\r\n\r\nI think if you instead rebase on fabc9b02331ad6d5cbae3d351721e7e5d9585df0, it should fix itself, as that removes `Span`.",
      "created_at": "2024-06-06T07:43:26Z",
      "updated_at": "2024-06-06T07:43:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1628935823",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1628935823"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1629427388",
      "pull_request_review_id": 2101792337,
      "id": 1629427388,
      "node_id": "PRRC_kwDOABII585hHxa8",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto& ch: buff | std::views::reverse) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "79c2bc919187631ba336bc180351c7d5141db872",
      "in_reply_to_id": 1627639850,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Changed to use our own `reverse_iterator`. Opted to instanciate the `std::span` from an iterator instead of adding a dependency on https://github.com/bitcoin/bitcoin/pull/30229. Happy to rebase on top of it if it's merged first.",
      "created_at": "2024-06-06T12:21:11Z",
      "updated_at": "2024-06-06T12:21:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1629427388",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1629427388"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1668971771",
      "pull_request_review_id": 2163854874,
      "id": 1668971771,
      "node_id": "PRRC_kwDOABII585jenz7",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto& ch: buff | std::views::reverse) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "79c2bc919187631ba336bc180351c7d5141db872",
      "in_reply_to_id": 1627639850,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "note: with #30263 merged, you can now use `std::reverse::views` again (see #28687)\r\n\r\n<details>\r\n<summary>git diff on 178a1da9c4</summary>\r\n\r\n```diff\r\ndiff --git a/src/test/fuzz/util/descriptor.cpp b/src/test/fuzz/util/descriptor.cpp\r\nindex 1ead54f254..d0ed6ee94c 100644\r\n--- a/src/test/fuzz/util/descriptor.cpp\r\n+++ b/src/test/fuzz/util/descriptor.cpp\r\n@@ -3,8 +3,8 @@\r\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\r\n \r\n #include <test/fuzz/util/descriptor.h>\r\n-#include <reverse_iterator.h>\r\n \r\n+#include <ranges>\r\n #include <stack>\r\n \r\n void MockedDescriptorConverter::Init() {\r\n@@ -107,7 +107,7 @@ bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\r\n {\r\n     auto count{0};\r\n     // We iterate in reverse order to start counting when we encounter a colon.\r\n-    for (const auto ch: reverse_iterate(buff)) {\r\n+    for (const auto ch: buff | std::views::reverse) {\r\n         if (ch == ':') {\r\n             count++;\r\n         } else if (ch == ',' || ch == '(' || ch == '{') {\r\n\r\n```\r\n</details>\r\n",
      "created_at": "2024-07-08T16:51:25Z",
      "updated_at": "2024-07-08T21:49:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1668971771",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1668971771"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1668972900",
      "pull_request_review_id": 2163854874,
      "id": 1668972900,
      "node_id": "PRRC_kwDOABII585jeoFk",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto ch: reverse_iterate(buff)) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It's not obvious to me why we need/prefer to iterate in reverse, here?",
      "created_at": "2024-07-08T16:52:07Z",
      "updated_at": "2024-07-08T21:49:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1668972900",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1668972900"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1668978835",
      "pull_request_review_id": 2163854874,
      "id": 1668978835,
      "node_id": "PRRC_kwDOABII585jepiT",
      "diff_hunk": "@@ -55,4 +55,22 @@ constexpr int MAX_DEPTH{2};\n  */\n bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth = MAX_DEPTH);\n \n+//! Default maximum number of sub-fragments.\n+constexpr int MAX_SUBS{1'000};\n+\n+/**\n+ * Whether the buffer, if it represents a valid descriptor, contains a fragment with more\n+ * sub-fragments than the given maximum.\n+ */\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs = MAX_SUBS);",
      "path": "src/test/fuzz/util/descriptor.h",
      "position": null,
      "original_position": 11,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: `HasTooManySubFrags` seems like a more accurate name?\r\n```suggestion\r\nbool HasTooManySubFrags(const FuzzBufferType& buff, const int max_subs = MAX_SUBS);\r\n```",
      "created_at": "2024-07-08T16:56:32Z",
      "updated_at": "2024-07-08T21:49:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1668978835",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1668978835"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 65,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1669371925",
      "pull_request_review_id": 2163854874,
      "id": 1669371925,
      "node_id": "PRRC_kwDOABII585jgJgV",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto ch: reverse_iterate(buff)) {\n+        if (ch == ':') {\n+            count++;\n+        } else if (ch == ',' || ch == '(' || ch == '{') {\n+            count = 0;\n+        } else if (count > 0 && ++count > max_wrappers) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is this correct? I'd expect something like:\r\n\r\n<details>\r\n<summary>git diff on 178a1da9c4</summary>\r\n\r\n```diff\r\ndiff --git a/src/test/fuzz/util/descriptor.cpp b/src/test/fuzz/util/descriptor.cpp\r\nindex 1ead54f254..434df93994 100644\r\n--- a/src/test/fuzz/util/descriptor.cpp\r\n+++ b/src/test/fuzz/util/descriptor.cpp\r\n@@ -108,12 +108,10 @@ bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\r\n     auto count{0};\r\n     // We iterate in reverse order to start counting when we encounter a colon.\r\n     for (const auto ch: reverse_iterate(buff)) {\r\n-        if (ch == ':') {\r\n-            count++;\r\n+        if (ch == ':' && (++count > max_wrappers)) {\r\n+            return true;\r\n         } else if (ch == ',' || ch == '(' || ch == '{') {\r\n             count = 0;\r\n-        } else if (count > 0 && ++count > max_wrappers) {\r\n-            return true;\r\n         }\r\n     }\r\n     return false;\r\n\r\n```\r\n</details>\r\n",
      "created_at": "2024-07-08T21:48:31Z",
      "updated_at": "2024-07-08T21:49:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1669371925",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1669371925"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 115,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674183937",
      "pull_request_review_id": 2172193524,
      "id": 1674183937,
      "node_id": "PRRC_kwDOABII585jygUB",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto ch: reverse_iterate(buff)) {\n+        if (ch == ':') {\n+            count++;\n+        } else if (ch == ',' || ch == '(' || ch == '{') {\n+            count = 0;\n+        } else if (count > 0 && ++count > max_wrappers) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": 1669371925,
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Based on the two inputs that caused the timeouts:\r\n[clusterfuzz-testcase-mocked_descriptor_parse-5224675118481408.bin.not.txt](https://github.com/bitcoin/bitcoin/files/13877884/clusterfuzz-testcase-mocked_descriptor_parse-5224675118481408.bin.not.txt)\r\n    [clusterfuzz-testcase-minimized-descriptor_parse-5888623437217792.bin.txt](https://github.com/bitcoin/bitcoin/files/15238132/clusterfuzz-testcase-minimized-descriptor_parse-5888623437217792.bin.txt)\r\n\r\nI think it's supposed to be counting the characters before the colon, not colons themselves. This is also why it iterates in reverse. I don't know quite enough to be sure that all timeout inputs would end up in this format, but based on those two, the function as is seems good.",
      "created_at": "2024-07-11T15:08:46Z",
      "updated_at": "2024-07-11T15:26:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674183937",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674183937"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 115,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674334965",
      "pull_request_review_id": 2172443295,
      "id": 1674334965,
      "node_id": "PRRC_kwDOABII585jzFL1",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto ch: reverse_iterate(buff)) {\n+        if (ch == ':') {\n+            count++;\n+        } else if (ch == ',' || ch == '(' || ch == '{') {\n+            count = 0;\n+        } else if (count > 0 && ++count > max_wrappers) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": 1669371925,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ooh, right, because each character _is_ a wrapper, and multiple colons in the same fragment are not allowed. That also answers my [question](https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1668972900) about why we iterate in reverse, and why this implementation is correct.\r\n\r\nThis is probably fairly obvious to people familiar with Miniscript, but feel free to adopt this docstring anyway if it's helpful:\r\n\r\n```cpp\r\n    auto count{0};\r\n    // A wrapper is a single character followed by a colon, e.g. `t:`.\r\n    // The colon is dropped between subsequent wrappers; e.g. `dv:` is\r\n    // the `d` wrapper applied to the `v:` wrapper. For that reason, we\r\n    // iterate in reverse and start counting when a colon is found until\r\n    // the start of the fragment is reached.\r\n    for (const auto ch: reverse_iterate(buff)) {\r\n        if (ch == ':') {\r\n            ++count;\r\n        } else if (ch == ',' || ch == '(' || ch == '{') {\r\n            count = 0;  // start of fragment\r\n        } else if (count > 0 && ++count > max_wrappers) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n```",
      "created_at": "2024-07-11T16:37:24Z",
      "updated_at": "2024-07-11T16:38:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674334965",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674334965"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 115,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674335378",
      "pull_request_review_id": 2172443802,
      "id": 1674335378,
      "node_id": "PRRC_kwDOABII585jzFSS",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto ch: reverse_iterate(buff)) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": 1668972900,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Resolved as per https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674334965",
      "created_at": "2024-07-11T16:37:42Z",
      "updated_at": "2024-07-11T16:37:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674335378",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674335378"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674336256",
      "pull_request_review_id": 2172444820,
      "id": 1674336256,
      "node_id": "PRRC_kwDOABII585jzFgA",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto ch: reverse_iterate(buff)) {\n+        if (ch == ':') {\n+            count++;",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "developer-notes-nit:\r\n```suggestion\r\n            ++count;\r\n```",
      "created_at": "2024-07-11T16:38:13Z",
      "updated_at": "2024-07-11T16:47:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674336256",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674336256"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 112,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674340428",
      "pull_request_review_id": 2172444820,
      "id": 1674340428,
      "node_id": "PRRC_kwDOABII585jzGhM",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto ch: reverse_iterate(buff)) {\n+        if (ch == ':') {\n+            count++;\n+        } else if (ch == ',' || ch == '(' || ch == '{') {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I can't find any reference to fragments starting with '{' in the [BIP](https://github.com/bitcoin/bips/blob/master/bip-0379.md), is `|| ch == '{'` necessary?",
      "created_at": "2024-07-11T16:41:47Z",
      "updated_at": "2024-07-11T16:47:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674340428",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674340428"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674344702",
      "pull_request_review_id": 2172444820,
      "id": 1674344702,
      "node_id": "PRRC_kwDOABII585jzHj-",
      "diff_hunk": "@@ -55,4 +55,22 @@ constexpr int MAX_DEPTH{2};\n  */\n bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth = MAX_DEPTH);\n \n+//! Default maximum number of sub-fragments.\n+constexpr int MAX_SUBS{1'000};\n+\n+/**\n+ * Whether the buffer, if it represents a valid descriptor, contains a fragment with more\n+ * sub-fragments than the given maximum.\n+ */\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs = MAX_SUBS);",
      "path": "src/test/fuzz/util/descriptor.h",
      "position": null,
      "original_position": 11,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: I think making `max_subs` and `max_wrappers` required args (and calling them with the `MAX_SUBS` and `MAX_WRAPPERS` consts) makes for a bit more intuitive code imo, since the max number is arbitrary. ",
      "created_at": "2024-07-11T16:45:45Z",
      "updated_at": "2024-07-11T17:06:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674344702",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674344702"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 65,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674368832",
      "pull_request_review_id": 2172498979,
      "id": 1674368832,
      "node_id": "PRRC_kwDOABII585jzNdA",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto& ch: buff | std::views::reverse) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 34,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "79c2bc919187631ba336bc180351c7d5141db872",
      "in_reply_to_id": 1627639850,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Cool, will do since i'll retouch.",
      "created_at": "2024-07-11T17:01:33Z",
      "updated_at": "2024-07-11T17:01:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674368832",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674368832"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674372001",
      "pull_request_review_id": 2172503132,
      "id": 1674372001,
      "node_id": "PRRC_kwDOABII585jzOOh",
      "diff_hunk": "@@ -55,4 +55,22 @@ constexpr int MAX_DEPTH{2};\n  */\n bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth = MAX_DEPTH);\n \n+//! Default maximum number of sub-fragments.\n+constexpr int MAX_SUBS{1'000};\n+\n+/**\n+ * Whether the buffer, if it represents a valid descriptor, contains a fragment with more\n+ * sub-fragments than the given maximum.\n+ */\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs = MAX_SUBS);",
      "path": "src/test/fuzz/util/descriptor.h",
      "position": null,
      "original_position": 11,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": 1668978835,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yeah, i guess a fragment with too many sub-fragments is a too large fragment. I'll update since i'll retouch.",
      "created_at": "2024-07-11T17:03:49Z",
      "updated_at": "2024-07-11T17:03:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674372001",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674372001"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 65,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674373270",
      "pull_request_review_id": 2172505114,
      "id": 1674373270,
      "node_id": "PRRC_kwDOABII585jzOiW",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto ch: reverse_iterate(buff)) {\n+        if (ch == ':') {\n+            count++;\n+        } else if (ch == ',' || ch == '(' || ch == '{') {\n+            count = 0;\n+        } else if (count > 0 && ++count > max_wrappers) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": 1669371925,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Will do. Documentation good.",
      "created_at": "2024-07-11T17:04:49Z",
      "updated_at": "2024-07-11T17:04:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674373270",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674373270"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 115,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674376365",
      "pull_request_review_id": 2172510229,
      "id": 1674376365,
      "node_id": "PRRC_kwDOABII585jzPSt",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto ch: reverse_iterate(buff)) {\n+        if (ch == ':') {\n+            count++;\n+        } else if (ch == ',' || ch == '(' || ch == '{') {\n+            count = 0;\n+        } else if (count > 0 && ++count > max_wrappers) {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 39,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": 1669371925,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> I don't know quite enough to be sure that all timeout inputs would end up in this format, but based on those two, the function as is seems good.\r\n\r\nI can't guarantee it'd avoid all timeouts, but i'm pretty sure it would catch all timeouts which are due to too many nested wrappers.",
      "created_at": "2024-07-11T17:07:35Z",
      "updated_at": "2024-07-11T17:07:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674376365",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674376365"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 115,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674377322",
      "pull_request_review_id": 2172511821,
      "id": 1674377322,
      "node_id": "PRRC_kwDOABII585jzPhq",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto ch: reverse_iterate(buff)) {\n+        if (ch == ':') {\n+            count++;",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": 1674336256,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Arg! It slipped through. Will address as i'll retouch.",
      "created_at": "2024-07-11T17:08:30Z",
      "updated_at": "2024-07-11T17:08:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674377322",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674377322"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 112,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674383009",
      "pull_request_review_id": 2172521284,
      "id": 1674383009,
      "node_id": "PRRC_kwDOABII585jzQ6h",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto ch: reverse_iterate(buff)) {\n+        if (ch == ':') {\n+            count++;\n+        } else if (ch == ',' || ch == '(' || ch == '{') {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": 1674340428,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Taproot leaves. It's to avoid overcounting if for instance you have `tr(d971308d5463ddc82addd897f6ebfa8a88e86de0664a66b9e9cf5e873459c528,{dvdvdvdvdv:1,1))`.\r\n\r\nEDIT: hmm it seems you'd always hit the comma anyways so you'd only overcount by the number of nested `{`. But it's cleaner to just not overcount.",
      "created_at": "2024-07-11T17:13:57Z",
      "updated_at": "2024-07-11T17:14:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674383009",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674383009"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674385763",
      "pull_request_review_id": 2172525790,
      "id": 1674385763,
      "node_id": "PRRC_kwDOABII585jzRlj",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto ch: reverse_iterate(buff)) {\n+        if (ch == ':') {\n+            count++;\n+        } else if (ch == ',' || ch == '(' || ch == '{') {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": 1674340428,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Okay, thanks. No strong opinion as to which approach, but since I couldn't find any reference to it perhaps good to add this example as a docstring in this else if path?",
      "created_at": "2024-07-11T17:16:41Z",
      "updated_at": "2024-07-11T17:16:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674385763",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674385763"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674388962",
      "pull_request_review_id": 2172531142,
      "id": 1674388962,
      "node_id": "PRRC_kwDOABII585jzSXi",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto ch: reverse_iterate(buff)) {\n+        if (ch == ':') {\n+            count++;\n+        } else if (ch == ',' || ch == '(' || ch == '{') {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": 1674340428,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Or alternatively, add a separate else if branch for ignored characters (e.g. \"{\"), just for clarity?",
      "created_at": "2024-07-11T17:19:36Z",
      "updated_at": "2024-07-11T17:19:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674388962",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674388962"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674425730",
      "pull_request_review_id": 2172592977,
      "id": 1674425730,
      "node_id": "PRRC_kwDOABII585jzbWC",
      "diff_hunk": "@@ -55,4 +55,22 @@ constexpr int MAX_DEPTH{2};\n  */\n bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth = MAX_DEPTH);\n \n+//! Default maximum number of sub-fragments.\n+constexpr int MAX_SUBS{1'000};\n+\n+/**\n+ * Whether the buffer, if it represents a valid descriptor, contains a fragment with more\n+ * sub-fragments than the given maximum.\n+ */\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs = MAX_SUBS);",
      "path": "src/test/fuzz/util/descriptor.h",
      "position": null,
      "original_position": 11,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": 1674344702,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit stack overflow: @darosior crashed and won't be able to process any further nit",
      "created_at": "2024-07-11T17:48:27Z",
      "updated_at": "2024-07-11T17:48:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674425730",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674425730"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 65,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674457669",
      "pull_request_review_id": 2172658463,
      "id": 1674457669,
      "node_id": "PRRC_kwDOABII585jzjJF",
      "diff_hunk": "@@ -84,3 +87,34 @@ bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth)\n     }\n     return false;\n }\n+\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs)\n+{\n+    std::stack<int> counts;\n+    for (const auto& ch: buff) {\n+        if (ch == '(') {\n+            counts.push(1);\n+        } else if (ch == ',' && !counts.empty()) {\n+            if (++counts.top() > max_subs) return true;\n+        } else if (ch == ')' && !counts.empty()) {\n+            counts.pop();\n+        }\n+    }\n+    return false;\n+}\n+\n+bool HasTooManyWrappers(const FuzzBufferType& buff, const int max_wrappers)\n+{\n+    auto count{0};\n+    // We iterate in reverse order to start counting when we encounter a colon.\n+    for (const auto ch: reverse_iterate(buff)) {\n+        if (ch == ':') {\n+            count++;\n+        } else if (ch == ',' || ch == '(' || ch == '{') {",
      "path": "src/test/fuzz/util/descriptor.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": 1674340428,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It's in doc/descriptors.md but sure i'll expand a bit in a comment.",
      "created_at": "2024-07-11T18:13:58Z",
      "updated_at": "2024-07-11T18:13:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674457669",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674457669"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674506073",
      "pull_request_review_id": 2172745229,
      "id": 1674506073,
      "node_id": "PRRC_kwDOABII585jzu9Z",
      "diff_hunk": "@@ -55,4 +55,22 @@ constexpr int MAX_DEPTH{2};\n  */\n bool HasDeepDerivPath(const FuzzBufferType& buff, const int max_depth = MAX_DEPTH);\n \n+//! Default maximum number of sub-fragments.\n+constexpr int MAX_SUBS{1'000};\n+\n+/**\n+ * Whether the buffer, if it represents a valid descriptor, contains a fragment with more\n+ * sub-fragments than the given maximum.\n+ */\n+bool HasLargeFrag(const FuzzBufferType& buff, const int max_subs = MAX_SUBS);",
      "path": "src/test/fuzz/util/descriptor.h",
      "position": null,
      "original_position": 11,
      "commit_id": "63f62b50d2a10b3118f56d49228a862011450f19",
      "original_commit_id": "178a1da9c4da955c3dc78e6b03f110f687e82508",
      "in_reply_to_id": 1674344702,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "More seriously: i considered doing it but it would not match the existing style for `HasDeepDerivPath` and would require duplicating the `MAX_SUBS` and `MAX_WRAPPERS` args (once in descriptor and once in descriptor_parse). So IMO it would be less neat and therefore i didn't do it.",
      "created_at": "2024-07-11T18:37:21Z",
      "updated_at": "2024-07-11T18:37:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30197#discussion_r1674506073",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1674506073"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30197"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 65,
      "side": "RIGHT"
    }
  ]
}