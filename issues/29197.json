{
  "type": "issue",
  "issue": {
    "id": 2069184619,
    "node_id": "I_kwDOABII5857VUBr",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29197",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29197/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29197/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29197/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/29197",
    "number": 29197,
    "state": "open",
    "state_reason": null,
    "title": "I2P: Change encryption type",
    "body": "### Is there an existing issue for this?\n\n- [X] I have searched the existing issues\n\n### Current behaviour\n\nSimilar to signature types, I2P supports multiple encryption types.\r\nSAM defaults to the oldest type for both, for backward compatibility.\r\nUnfortunately I forgot about this for encryption types.\r\n\r\nThe qbittorrent / libtorrent projects just discovered encryption types\r\nin this issue:\r\nhttps://github.com/qbittorrent/qBittorrent/issues/19625\r\n\r\nThe encryption type is a property of the session, not the destination.\r\nSessions may support multiple types.\r\nYou may only connect to a destination if both sides have sessions\r\nwith a common encryption type.\r\n\r\nAs you are not setting the encryption type, you are using ElGamal (type 0).\r\nYou should change that to use both ElGamal and ECIES-X25519 (types 0 and 4).\r\nThe newer, faster type will be preferred.\r\n\r\n\n\n### Expected behaviour\n\nTo fix, in i2p.cpp, add the config in two places (SESSION CREATE for both transient and fixed):\r\n\r\ni2cp.leaseSetEncType=4,0\r\n\r\nas in this patch for libtorrent:\r\n\r\nhttps://github.com/qbittorrent/qBittorrent/issues/19625#issuecomment-1879582395\r\n\r\nThis will allow you to connect to clients with either type.\r\nAt some point a year in the future, after everybody has upgraded, you can\r\nchange it to i2cp.leaseSetEncType=4 if you like.\r\n\r\nNote that i2pd has a bug where they do not report immediate failure\r\nif trying to connect to an incompatible destination;\r\nthat issue is https://github.com/PurpleI2P/i2pd/issues/2004\r\nbut you will not hit this issue because your old clients (0) can talk to new ones (4,0).\r\n\r\nI have updated our SAM doc with these recommendations: https://geti2p.net/en/docs/api/samv3\r\n\n\n### Steps to reproduce\n\nIn the java i2p console,\r\nyou can verify the leaseset types on the client leasesets netdb tab\r\nif you have routerconsole.advanced=true in router.config.\r\n\r\nIn the i2pd console, it reports the actual encryption type used,\r\nunder LeaseSets for a particular destination.\r\nFor example:\r\n\r\n5xeoyfvtddmo5k3kxzv7b3d5risil6333ntqrr3yvx3yubz5tk3a âœ˜ 3 4\r\n\r\nthe last number 4 is the encryption type selected.\r\nIf you have any questions on where to look in the i2pd console please ask @orignal.\r\n\r\nRecommended testing: Test with both i2pd and Java I2P, and confirm that you can connect\r\nbetween all combinations of new (4,0) and old (0) clients.\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nv26\n\n### Operating system and version\n\nall\n\n### Machine specifications\n\n_No response_",
    "user": {
      "login": "zzzi2p",
      "id": 62618568,
      "node_id": "MDQ6VXNlcjYyNjE4NTY4",
      "avatar_url": "https://avatars.githubusercontent.com/u/62618568?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zzzi2p",
      "html_url": "https://github.com/zzzi2p",
      "followers_url": "https://api.github.com/users/zzzi2p/followers",
      "following_url": "https://api.github.com/users/zzzi2p/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/zzzi2p/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/zzzi2p/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/zzzi2p/subscriptions",
      "organizations_url": "https://api.github.com/users/zzzi2p/orgs",
      "repos_url": "https://api.github.com/users/zzzi2p/repos",
      "events_url": "https://api.github.com/users/zzzi2p/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/zzzi2p/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 1,
    "created_at": "2024-01-07T16:02:30Z",
    "updated_at": "2024-01-08T13:20:12Z"
  },
  "events": [
    {
      "event": "mentioned",
      "id": 11411485238,
      "node_id": "MEE_lADOABII5857VUBrzwAAAAKoLXI2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11411485238",
      "actor": {
        "login": "orignal",
        "id": 5358364,
        "node_id": "MDQ6VXNlcjUzNTgzNjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5358364?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/orignal",
        "html_url": "https://github.com/orignal",
        "followers_url": "https://api.github.com/users/orignal/followers",
        "following_url": "https://api.github.com/users/orignal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/orignal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/orignal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/orignal/subscriptions",
        "organizations_url": "https://api.github.com/users/orignal/orgs",
        "repos_url": "https://api.github.com/users/orignal/repos",
        "events_url": "https://api.github.com/users/orignal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/orignal/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-07T16:02:31Z"
    },
    {
      "event": "subscribed",
      "id": 11411485239,
      "node_id": "SE_lADOABII5857VUBrzwAAAAKoLXI3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11411485239",
      "actor": {
        "login": "orignal",
        "id": 5358364,
        "node_id": "MDQ6VXNlcjUzNTgzNjQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5358364?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/orignal",
        "html_url": "https://github.com/orignal",
        "followers_url": "https://api.github.com/users/orignal/followers",
        "following_url": "https://api.github.com/users/orignal/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/orignal/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/orignal/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/orignal/subscriptions",
        "organizations_url": "https://api.github.com/users/orignal/orgs",
        "repos_url": "https://api.github.com/users/orignal/repos",
        "events_url": "https://api.github.com/users/orignal/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/orignal/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-07T16:02:31Z"
    },
    {
      "event": "commented",
      "id": 1880122065,
      "node_id": "IC_kwDOABII585wEGLR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1880122065",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-07T17:40:11Z",
      "updated_at": "2024-01-07T17:40:11Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thank you, @zzzi2p. Am looking now at reproducing and fixing this.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29197#issuecomment-1880122065",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29197"
    },
    {
      "event": "mentioned",
      "id": 11411658559,
      "node_id": "MEE_lADOABII5857VUBrzwAAAAKoMBc_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11411658559",
      "actor": {
        "login": "zzzi2p",
        "id": 62618568,
        "node_id": "MDQ6VXNlcjYyNjE4NTY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/62618568?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/zzzi2p",
        "html_url": "https://github.com/zzzi2p",
        "followers_url": "https://api.github.com/users/zzzi2p/followers",
        "following_url": "https://api.github.com/users/zzzi2p/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/zzzi2p/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/zzzi2p/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/zzzi2p/subscriptions",
        "organizations_url": "https://api.github.com/users/zzzi2p/orgs",
        "repos_url": "https://api.github.com/users/zzzi2p/repos",
        "events_url": "https://api.github.com/users/zzzi2p/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/zzzi2p/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-07T17:40:11Z"
    },
    {
      "event": "subscribed",
      "id": 11411658562,
      "node_id": "SE_lADOABII5857VUBrzwAAAAKoMBdC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11411658562",
      "actor": {
        "login": "zzzi2p",
        "id": 62618568,
        "node_id": "MDQ6VXNlcjYyNjE4NTY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/62618568?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/zzzi2p",
        "html_url": "https://github.com/zzzi2p",
        "followers_url": "https://api.github.com/users/zzzi2p/followers",
        "following_url": "https://api.github.com/users/zzzi2p/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/zzzi2p/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/zzzi2p/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/zzzi2p/subscriptions",
        "organizations_url": "https://api.github.com/users/zzzi2p/orgs",
        "repos_url": "https://api.github.com/users/zzzi2p/repos",
        "events_url": "https://api.github.com/users/zzzi2p/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/zzzi2p/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-07T17:40:11Z"
    },
    {
      "event": "referenced",
      "id": 11412070418,
      "node_id": "REFE_lADOABII5857VUBrzwAAAAKoNmAS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11412070418",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "1db8002205599c6936fc94adba225223ce380f7f",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/1db8002205599c6936fc94adba225223ce380f7f",
      "created_at": "2024-01-07T22:08:05Z"
    },
    {
      "event": "referenced",
      "id": 11412101268,
      "node_id": "REFE_lADOABII5857VUBrzwAAAAKoNtiU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11412101268",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "9d728916b27e18efc6f8839770ed5ec14789fc08",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/9d728916b27e18efc6f8839770ed5ec14789fc08",
      "created_at": "2024-01-07T22:24:44Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-07T22:39:34Z",
      "updated_at": "2024-01-07T22:39:34Z",
      "source": {
        "issue": {
          "id": 2069324721,
          "node_id": "PR_kwDOABII585jajIK",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29200",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29200/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29200/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29200/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29200",
          "number": 29200,
          "state": "open",
          "state_reason": null,
          "title": "net: create I2P sessions using both ECIES-X25519 and ElGamal encryption",
          "body": "A Bitcoin Core node may only connect to a peer destination via I2P if both sides have sessions with the same encryption type.  Encryption type is a property of the session, not the destination.  Sessions may support multiple encryption types.\r\n\r\nAs Bitcoin Core is not currently setting the encryption type when creating I2P sessions, it uses the older default, ElGamal (type 0).\r\n\r\nThis pull updates our I2P session creation to use both ECIES-X25519 and ElGamal (types 4 and 0, respectively). This allows to connect to I2P peers of either type, and the newer, faster ECIES-X25519 will be preferred.\r\n\r\nSee also:\r\n\r\n- discussion around https://github.com/qbittorrent/qBittorrent/issues/19625#issuecomment-1879582395\r\n- recently updated \"Signature and Encryption Types\" in https://geti2p.net/en/docs/api/samv3\r\n\r\nThank you and credit to zzzi2p for reporting and to vort for the patch.\r\n\r\nCloses https://github.com/bitcoin/bitcoin/issues/29197.\r\n",
          "user": {
            "login": "jonatack",
            "id": 2415484,
            "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jonatack",
            "html_url": "https://github.com/jonatack",
            "followers_url": "https://api.github.com/users/jonatack/followers",
            "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
            "organizations_url": "https://api.github.com/users/jonatack/orgs",
            "repos_url": "https://api.github.com/users/jonatack/repos",
            "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jonatack/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98298007,
              "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
              "name": "P2P",
              "color": "006b75",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 3,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29200",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29200",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29200.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29200.patch"
          },
          "created_at": "2024-01-07T22:39:33Z",
          "updated_at": "2024-01-08T09:45:43Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 11417533323,
      "node_id": "LE_lADOABII5857VUBrzwAAAAKoibuL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11417533323",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-08T13:20:12Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    }
  ]
}