{
  "type": "issue",
  "issue": {
    "id": 1036970575,
    "node_id": "I_kwDOABII5849zupP",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/23366",
    "number": 23366,
    "state": "open",
    "state_reason": null,
    "title": "CI failure: `ThreadSanitizer: data race /usr/lib/llvm-12/bin/../include/c++/v1/ios:523:12 in std::__1::ios_base::width() const`",
    "body": "I'm seeing this race failure in two unrelated PRs during the `validation_chainstate_tests/chainstate_update_tip` case:\r\n\r\nhttps://cirrus-ci.com/task/5125235994263552?logs=ci#L4140 from #22702\r\nhttps://cirrus-ci.com/task/5269464468946944?logs=ci#L4142 from #21206\r\n\r\n```\r\ntest/validation_chainstate_tests.cpp(83): Entering test case \"chainstate_update_tip\"\r\n\r\n...\r\n\r\n[Makefile:18480: test/validation_chainstate_tests.cpp.test] Error 1\r\n\r\n...\r\n\r\nWARNING: ThreadSanitizer: data race (pid=23076)\r\nRead of size 8 at 0x7f23d669c6d0 by main thread:\r\n#0 std::__1::ios_base::width() const /usr/lib/llvm-12/bin/../include/c++/v1/ios:523:12 (test_bitcoin+0x17826c)\r\n\r\n...\r\n\r\n  Location is global 'std::__1::cout' of size 160 at 0x7f23d669c6b0 (libc++.so.1+0x0000000cd6d0)\r\n\r\n...\r\n\r\nSUMMARY: ThreadSanitizer: data race /usr/lib/llvm-12/bin/../include/c++/v1/ios:523:12 in std::__1::ios_base::width() const\r\n```\r\n\r\nI'm not sure if this is a real bug or spurious, but I did work around a similar problem previously (in #15719) by adding a suppression:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/81be7ff5215eb2f21ca7bc73e565c13215dda7bb/test/sanitizer_suppressions/tsan#L33-L40\r\n",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 64585,
        "node_id": "MDU6TGFiZWw2NDU4NQ==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug",
        "name": "Bug",
        "color": "FBBAAB",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 12,
    "created_at": "2021-10-27T04:43:14Z",
    "updated_at": "2023-06-12T14:38:54Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 5524754489,
      "node_id": "LE_lADOABII5849zupPzwAAAAFJTRA5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5524754489",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-27T04:43:14Z",
      "label": {
        "name": "Bug",
        "color": "FBBAAB"
      }
    },
    {
      "event": "commented",
      "id": 952542538,
      "node_id": "IC_kwDOABII5844xqVK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/952542538",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-27T05:06:55Z",
      "updated_at": "2021-10-27T05:17:03Z",
      "author_association": "MEMBER",
      "body": "Also the same bug was observed on the master branch recently:\r\n- https://github.com/bitcoin/bitcoin/commit/22a90186496aea8025316bc5616905ffcf1aeb29 -- [log](https://api.cirrus-ci.com/v1/task/6008336282812416/logs/ci.log)\r\n- https://github.com/bitcoin/bitcoin/commit/23a7d56df2dd42b16e5d9748aad5630e448becd7 -- [log](https://api.cirrus-ci.com/v1/task/6464283501395968/logs/ci.log)",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/23366#issuecomment-952542538",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366"
    },
    {
      "event": "commented",
      "id": 952659398,
      "node_id": "IC_kwDOABII5844yG3G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/952659398",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-27T08:21:54Z",
      "updated_at": "2021-10-27T08:21:54Z",
      "author_association": "MEMBER",
      "body": "Indeed, this is not an issue with  #15719, but with master",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/23366#issuecomment-952659398",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-27T08:44:22Z",
      "updated_at": "2021-10-27T08:44:22Z",
      "source": {
        "issue": {
          "id": 1037141829,
          "node_id": "PR_kwDOABII584tukT6",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23370",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23370/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23370/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23370/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/23370",
          "number": 23370,
          "state": "closed",
          "state_reason": null,
          "title": "test: Add ios_base::width tsan suppression",
          "body": "This PR:\r\n- adds tsan suppression for intermittent failures in CI\r\n```\r\nSUMMARY: ThreadSanitizer: data race /usr/lib/llvm-12/bin/../include/c++/v1/ios:523:12 in std::__1::ios_base::width() const\r\n```\r\n\r\n- fixes #23366",
          "user": {
            "login": "hebasto",
            "id": 32963518,
            "node_id": "MDQ6VXNlcjMyOTYzNTE4",
            "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/hebasto",
            "html_url": "https://github.com/hebasto",
            "followers_url": "https://api.github.com/users/hebasto/followers",
            "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
            "organizations_url": "https://api.github.com/users/hebasto/orgs",
            "repos_url": "https://api.github.com/users/hebasto/repos",
            "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/hebasto/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": true,
          "comments": 2,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23370",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/23370",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/23370.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/23370.patch"
          },
          "closed_at": "2021-11-10T12:19:33Z",
          "created_at": "2021-10-27T08:44:22Z",
          "updated_at": "2022-11-10T17:38:14Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 952681950,
      "node_id": "IC_kwDOABII5844yMXe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/952681950",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-27T08:45:09Z",
      "updated_at": "2021-10-27T08:45:09Z",
      "author_association": "MEMBER",
      "body": "> Indeed, this is not an issue with #15719, but with master\r\n\r\nSuggested suppression in #23370.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/23366#issuecomment-952681950",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366"
    },
    {
      "event": "commented",
      "id": 952830424,
      "node_id": "IC_kwDOABII5844ywnY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/952830424",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-27T11:36:56Z",
      "updated_at": "2021-10-27T11:36:56Z",
      "author_association": "CONTRIBUTOR",
      "body": "Looking at https://cirrus-ci.com/github/bitcoin/bitcoin/master, I guess this problem does not happen reliably on master, but is nondeterministic? IIRC, when I was seeing similar TSAN errors months ago in #15719, the problem seemed to be deterministic and would happen every time.\r\n\r\nThe `chainstate_update_tip` was added a month ago in 673a5bd3377929a0a6a62eda8b560e47bc2cca0c from #21526 by @jamesob, so maybe James could look at stack traces and clarify whether it is expected that there might be multiple threads writing to cout at same time.\r\n\r\n**I think the TSAN suppression seems safe, but am not completely confident about it. And even if it is thread safe it still means multiple threads could be writing to stdout at the same time and producing garbled output.**\r\n\r\nAlso, I'm not sure why this bug would start happening now if #21526 was merged a month ago, so wondering if something else might have changed recently? Or if this happens infrequently enough to not be noticed? Or if this was noticed but was just ignored a little while?\r\n\r\nWould be nice if there was a way to easily grep cirrus logs and find all the instances of this.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/23366#issuecomment-952830424",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366"
    },
    {
      "event": "mentioned",
      "id": 5526814250,
      "node_id": "MEE_lADOABII5849zupPzwAAAAFJbH4q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5526814250",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-27T11:36:56Z"
    },
    {
      "event": "subscribed",
      "id": 5526814255,
      "node_id": "SE_lADOABII5849zupPzwAAAAFJbH4v",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5526814255",
      "actor": {
        "login": "jamesob",
        "id": 73197,
        "node_id": "MDQ6VXNlcjczMTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jamesob",
        "html_url": "https://github.com/jamesob",
        "followers_url": "https://api.github.com/users/jamesob/followers",
        "following_url": "https://api.github.com/users/jamesob/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jamesob/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jamesob/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
        "organizations_url": "https://api.github.com/users/jamesob/orgs",
        "repos_url": "https://api.github.com/users/jamesob/repos",
        "events_url": "https://api.github.com/users/jamesob/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jamesob/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-27T11:36:56Z"
    },
    {
      "event": "commented",
      "id": 962643450,
      "node_id": "IC_kwDOABII5845YMX6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/962643450",
      "actor": {
        "login": "martinus",
        "id": 14386,
        "node_id": "MDQ6VXNlcjE0Mzg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/martinus",
        "html_url": "https://github.com/martinus",
        "followers_url": "https://api.github.com/users/martinus/followers",
        "following_url": "https://api.github.com/users/martinus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/martinus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/martinus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
        "organizations_url": "https://api.github.com/users/martinus/orgs",
        "repos_url": "https://api.github.com/users/martinus/repos",
        "events_url": "https://api.github.com/users/martinus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/martinus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-07T16:45:53Z",
      "updated_at": "2021-11-07T16:45:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "As mentioned `std::cout` is supposed to be threadsafe: https://eel.is/c++draft/iostream.objects#overview-7\r\n\r\nThe problem is, it seems that io manipulators are *not* threadsafe: the stream members are not atomic, and there are no locks: https://github.com/llvm/llvm-project/blob/release/12.x/libcxx/include/ios#L372\r\n\r\nBut many methods call `ios.width(0)` so that `std::setw()` is only valid for one output: https://en.cppreference.com/w/cpp/io/ios_base/width\r\n\r\nThis is done here: https://github.com/llvm/llvm-project/blob/main/libcxx/include/locale#L1400 which is called whenever e.g. `operator<<(char const*)` is called. \r\n\r\nSo even when the standard says that concurrent access to `cout` isn't supposed to have any data races, this is one right there. Not sure what to do about that.",
      "user": {
        "login": "martinus",
        "id": 14386,
        "node_id": "MDQ6VXNlcjE0Mzg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/martinus",
        "html_url": "https://github.com/martinus",
        "followers_url": "https://api.github.com/users/martinus/followers",
        "following_url": "https://api.github.com/users/martinus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/martinus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/martinus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
        "organizations_url": "https://api.github.com/users/martinus/orgs",
        "repos_url": "https://api.github.com/users/martinus/repos",
        "events_url": "https://api.github.com/users/martinus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/martinus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/23366#issuecomment-962643450",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366"
    },
    {
      "event": "commented",
      "id": 962941266,
      "node_id": "IC_kwDOABII5845ZVFS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/962941266",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-08T09:01:22Z",
      "updated_at": "2021-11-08T09:01:22Z",
      "author_association": "MEMBER",
      "body": "Interesting that no one else ran into this before us. Maybe a bug should be reported, since I couldn't find any https://bugs.llvm.org/buglist.cgi?quicksearch=race%20ios_base&list_id=226152",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/23366#issuecomment-962941266",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366"
    },
    {
      "event": "closed",
      "id": 5596652072,
      "node_id": "CE_lADOABII5849zupPzwAAAAFNliIo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5596652072",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "8f86820ff8664ffcb4116a51e6c0b7e6efd47b1f",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8f86820ff8664ffcb4116a51e6c0b7e6efd47b1f",
      "created_at": "2021-11-10T12:19:23Z"
    },
    {
      "event": "referenced",
      "id": 5598318409,
      "node_id": "REFE_lADOABII5849zupPzwAAAAFNr49J",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5598318409",
      "actor": {
        "login": "sidhujag",
        "id": 6238042,
        "node_id": "MDQ6VXNlcjYyMzgwNDI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6238042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sidhujag",
        "html_url": "https://github.com/sidhujag",
        "followers_url": "https://api.github.com/users/sidhujag/followers",
        "following_url": "https://api.github.com/users/sidhujag/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sidhujag/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sidhujag/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sidhujag/subscriptions",
        "organizations_url": "https://api.github.com/users/sidhujag/orgs",
        "repos_url": "https://api.github.com/users/sidhujag/repos",
        "events_url": "https://api.github.com/users/sidhujag/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sidhujag/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "6d02f3b61f5ee049270424209bdda6cbbb80e7b1",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/6d02f3b61f5ee049270424209bdda6cbbb80e7b1",
      "created_at": "2021-11-10T16:22:36Z"
    },
    {
      "event": "commented",
      "id": 969164207,
      "node_id": "IC_kwDOABII5845xEWv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/969164207",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-15T17:51:31Z",
      "updated_at": "2021-11-15T17:51:31Z",
      "author_association": "CONTRIBUTOR",
      "body": "I guess #23370 resolved CI failures, but from Martin's comment https://github.com/bitcoin/bitcoin/issues/23366#issuecomment-962643450, it seems like the suppression isn't ideal because there is a real data race. I think good followups would be to: \r\n\r\n- Improve comment added in [#23370](https://github.com/bitcoin/bitcoin/issues/23370), so instead of being a blind link, it has some explanation and at least mentions std::cout. A good template could be comment from [`81be7ff5`](https://github.com/bitcoin/bitcoin/blob/81be7ff5215eb2f21ca7bc73e565c13215dda7bb/test/sanitizer_suppressions/tsan#L33-L40) with updated information from [#23366 (comment)](https://github.com/bitcoin/bitcoin/issues/23366#issuecomment-962643450)\r\n- Add a new lock around uses of `std::cout` to remove the TSAN suppression. Or replace `cout` calls triggering this with calls that go through the logging framework to remove the suppression. Doing either of these would also prevent interleaved output from multiple threads in addition to avoiding need for the suppression.\r\n- Maybe check upstream and see if library implementation is violating the standard. From Martin's comment, it does seem like there is a bug in either the library or the standard, though it's not clear what a good fix would be.\r\n\r\nCould maybe mark this issue up for grabs if this makes sense and is of interest.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/23366#issuecomment-969164207",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366"
    },
    {
      "event": "commented",
      "id": 969992427,
      "node_id": "IC_kwDOABII58450Ojr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/969992427",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-16T08:10:16Z",
      "updated_at": "2021-11-16T08:10:16Z",
      "author_association": "MEMBER",
      "body": "> Or replace cout calls triggering this with calls that go through the logging framework to remove the suppression.\r\n\r\nIf the boost test logging has internal locking, that seems a fine alternative. Are you referring to `BOOST_TEST_MESSAGE` https://www.boost.org/doc/libs/1_77_0/libs/test/doc/html/boost_test/utf_reference/testout_reference/test_output_macro_message.html ?",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/23366#issuecomment-969992427",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366"
    },
    {
      "event": "reopened",
      "id": 5623255636,
      "node_id": "REE_lADOABII5849zupPzwAAAAFPLBJU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/5623255636",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-16T08:35:31Z"
    },
    {
      "event": "commented",
      "id": 971124886,
      "node_id": "IC_kwDOABII58454jCW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/971124886",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-17T02:48:08Z",
      "updated_at": "2021-11-17T02:48:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > Or replace cout calls triggering this with calls that go through the logging framework to remove the suppression.\r\n> \r\n> If the boost test logging has internal locking, that seems a fine alternative. Are you referring to `BOOST_TEST_MESSAGE` https://www.boost.org/doc/libs/1_77_0/libs/test/doc/html/boost_test/utf_reference/testout_reference/test_output_macro_message.html ?\r\n\r\nI was being vague because I didn't look into where these cout writes were coming from. But from the cirrus TSAN output above, one `cout` call is coming `G_TEST_LOG_FUN` and the other one is coming from a boost method `boost::unit_test::unit_test_log_t::operator<<(boost::unit_test::lazy_ostream const&)`. We also do have a few scattered `BOOST_TEST_MESSAGE` calls which would be a third source of cout writes.\r\n\r\nTo be able to remove the suppression, all these these cout writes would need to be protect with a lock. We can lock  `G_TEST_LOG_FUN` ourselves since it is our own code. It looks like we could synchronize the boost cout output by redirecting it with `boost::unit_test::unit_test_log.set_stream( std::ostream& );` https://www.boost.org/doc/libs/1_77_0/libs/test/doc/html/boost_test/test_output/logging_api/log_ct_output_stream_redirection.html with a custom `std::ostream` subclass that locks a mutex and forwards to cout.\r\n\r\nI'm not sure if this would be worth it, but it seems something like this would be needed to remove the suppression.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/23366#issuecomment-971124886",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366"
    },
    {
      "event": "commented",
      "id": 971208417,
      "node_id": "IC_kwDOABII584543bh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/971208417",
      "actor": {
        "login": "martinus",
        "id": 14386,
        "node_id": "MDQ6VXNlcjE0Mzg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/martinus",
        "html_url": "https://github.com/martinus",
        "followers_url": "https://api.github.com/users/martinus/followers",
        "following_url": "https://api.github.com/users/martinus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/martinus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/martinus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
        "organizations_url": "https://api.github.com/users/martinus/orgs",
        "repos_url": "https://api.github.com/users/martinus/repos",
        "events_url": "https://api.github.com/users/martinus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/martinus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-11-17T05:39:00Z",
      "updated_at": "2021-11-17T05:39:00Z",
      "author_association": "CONTRIBUTOR",
      "body": "Someone (not me) created a bug for exactly this issue, with a nice short reproducer: https://bugs.llvm.org/show_bug.cgi?id=52509\r\n\r\nIn C++20 there will be `std::osyncstream`: https://en.cppreference.com/w/cpp/io/basic_osyncstream So I think it would be nice to have something with the same API that's eventually replaced with `std::osyncstream` once we switch to C++20",
      "user": {
        "login": "martinus",
        "id": 14386,
        "node_id": "MDQ6VXNlcjE0Mzg2",
        "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/martinus",
        "html_url": "https://github.com/martinus",
        "followers_url": "https://api.github.com/users/martinus/followers",
        "following_url": "https://api.github.com/users/martinus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/martinus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/martinus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
        "organizations_url": "https://api.github.com/users/martinus/orgs",
        "repos_url": "https://api.github.com/users/martinus/repos",
        "events_url": "https://api.github.com/users/martinus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/martinus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/23366#issuecomment-971208417",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366"
    },
    {
      "event": "commented",
      "id": 1010173785,
      "node_id": "IC_kwDOABII5848NgdZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1010173785",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-01-11T17:05:01Z",
      "updated_at": "2022-01-11T17:05:01Z",
      "author_association": "MEMBER",
      "body": "bugs.llvm was deleted. The bug is now here: https://github.com/llvm/llvm-project/issues/51851",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/23366#issuecomment-1010173785",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-04-10T16:42:28Z",
      "updated_at": "2022-04-10T16:42:28Z",
      "source": {
        "issue": {
          "id": 1199095089,
          "node_id": "I_kwDOABII585HeL0x",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24819",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24819/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24819/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/24819/events",
          "html_url": "https://github.com/bitcoin/bitcoin/issues/24819",
          "number": 24819,
          "state": "closed",
          "state_reason": "completed",
          "title": "data race in SimpleRoundTripTest logging for macOS",
          "body": "**OS:** macOS 10.15.4\r\n**Compiler:** brew installed clang-13\r\n**Build command:**\r\n- `make clean; ./autogen.sh; CC=/usr/local/Cellar/llvm/13.0.1/bin/clang CXX=/usr/local/Cellar/llvm/13.0.1/bin/clang++ LDFLAGS=\"-fuse-ld=/usr/local/Cellar/llvm/bin/13.0.1/ld.lld\" ./configure --disable-wallet --with-sanitizers=thread; make; make check`\r\n\r\n<details>\r\n<summary>TSAN log</summary>\r\n\r\n\r\n```\r\nWARNING: ThreadSanitizer: data race (pid=85054)\r\n  Read of size 4 at 0x7fff9a2cd770 by thread T1 (mutexes: write M1762):\r\n    #0 std::__1::basic_ostream<char, std::__1::char_traits<char> >& std::__1::__put_character_sequence<char, std::__1::char_traits<char> >(std::__1::basic_ostream<char, std::__1::char_traits<char> >&, char const*, unsigned long) ostream:720 (test_bitcoin:x86_64+0x100074c35)\r\n    #1 std::__1::__function::__func<$_0, std::__1::allocator<$_0>, void (std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&)>::operator()(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) function.h:345 (test_bitcoin:x86_64+0x100080508)\r\n    #2 BCLog::Logger::LogPrintStr(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int) logging.cpp:281 (test_bitcoin:x86_64+0x100be645b)\r\n    #3 void LogPrintf_<char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, char const*, char const* const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) logging.h:186 (test_bitcoin:x86_64+0x100aefb10)\r\n    #4 std::__1::__function::__func<CMainSignals::TransactionRemovedFromMempool(std::__1::shared_ptr<CTransaction const> const&, MemPoolRemovalReason, unsigned long long)::$_7, std::__1::allocator<CMainSignals::TransactionRemovedFromMempool(std::__1::shared_ptr<CTransaction const> const&, MemPoolRemovalReason, unsigned long long)::$_7>, void ()>::operator()() function.h:345 (test_bitcoin:x86_64+0x100af682a)\r\n    #5 SingleThreadedSchedulerClient::ProcessQueue() scheduler.cpp:177 (test_bitcoin:x86_64+0x100b8a175)\r\n    #6 std::__1::__function::__func<std::__1::__bind<void (SingleThreadedSchedulerClient::*)(), SingleThreadedSchedulerClient*>, std::__1::allocator<std::__1::__bind<void (SingleThreadedSchedulerClient::*)(), SingleThreadedSchedulerClient*> >, void ()>::operator()() function.h:345 (test_bitcoin:x86_64+0x100b8c15a)\r\n    #7 CScheduler::serviceQueue() scheduler.cpp:64 (test_bitcoin:x86_64+0x100b89454)\r\n    #8 std::__1::__function::__func<ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0, std::__1::allocator<ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0>, void ()>::operator()() function.h:345 (test_bitcoin:x86_64+0x1007bf5f8)\r\n    #9 util::TraceThread(char const*, std::__1::function<void ()>) thread.cpp:18 (test_bitcoin:x86_64+0x100c13ecf)\r\n    #10 void* std::__1::__thread_proxy<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(char const*, std::__1::function<void ()>), char const*, ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&)::$_0> >(void*) thread:291 (test_bitcoin:x86_64+0x1007bf19f)\r\n\r\n  Previous write of size 4 at 0x7fff9a2cd770 by main thread (mutexes: write M455, write M132977):\r\n    #0 boost::unit_test::unit_test_log_t::operator<<(boost::unit_test::log::begin const&) unit_test_log.ipp:412 (test_bitcoin:x86_64+0x10001d2e6)\r\n    #1 boost::test_tools::tt_detail::report_assertion(boost::test_tools::assertion_result const&, boost::unit_test::lazy_ostream const&, boost::unit_test::basic_cstring<char const>, unsigned long, boost::test_tools::tt_detail::tool_level, boost::test_tools::tt_detail::check_type, unsigned long, ...) test_tools.ipp:359 (test_bitcoin:x86_64+0x100029f5e)\r\n    #2 blockencodings_tests::SimpleRoundTripTest::test_method() blockencodings_tests.cpp:101 (test_bitcoin:x86_64+0x10016b0ff)\r\n    #3 blockencodings_tests::SimpleRoundTripTest_invoker() blockencodings_tests.cpp:55 (test_bitcoin:x86_64+0x100169311)\r\n    #4 boost::detail::function::void_function_invoker0<void (*)(), void>::invoke(boost::detail::function::function_buffer&) function_template.hpp:117 (test_bitcoin:x86_64+0x10010017d)\r\n    #5 boost::detail::function::function_obj_invoker0<boost::detail::forward, int>::invoke(boost::detail::function::function_buffer&) function_template.hpp:137 (test_bitcoin:x86_64+0x10007d8ba)\r\n    #6 boost::execution_monitor::catch_signals(boost::function<int ()> const&) execution_monitor.ipp:901 (test_bitcoin:x86_64+0x100023379)\r\n    #7 boost::execution_monitor::execute(boost::function<int ()> const&) execution_monitor.ipp:1299 (test_bitcoin:x86_64+0x10002366a)\r\n    #8 boost::unit_test::unit_test_monitor_t::execute_and_translate(boost::function<void ()> const&, unsigned long) unit_test_monitor.ipp:49 (test_bitcoin:x86_64+0x10001c5be)\r\n    #9 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) framework.ipp:815 (test_bitcoin:x86_64+0x10001e993)\r\n    #10 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) framework.ipp:740 (test_bitcoin:x86_64+0x10001fa1c)\r\n    #11 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) framework.ipp:740 (test_bitcoin:x86_64+0x10001fa1c)\r\n    #12 boost::unit_test::framework::run(unsigned long, bool) framework.ipp:1721 (test_bitcoin:x86_64+0x10001b158)\r\n    #13 boost::unit_test::unit_test_main(boost::unit_test::test_suite* (*)(int, char**), int, char**) unit_test_main.ipp:250 (test_bitcoin:x86_64+0x10003447b)\r\n    #14 main unit_test_main.ipp:306 (test_bitcoin:x86_64+0x100034b1b)\r\n\r\n  Location is global 'std::__1::cout' at 0x7fff9a2cd760 (libc++.1.dylib+0x000029394770)\r\n\r\n  Mutex M1762 (0x7b2c000000b0) created at:\r\n    #0 pthread_mutex_lock <null>:2 (libclang_rt.tsan_osx_dynamic.dylib:x86_64+0x19840)\r\n    #1 std::__1::mutex::lock() <null>:2 (libc++.1.dylib:x86_64+0x36538)\r\n    #2 BasicTestingSetup::BasicTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&) setup_common.cpp:121 (test_bitcoin:x86_64+0x1007b92e6)\r\n    #3 ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&) setup_common.cpp:151 (test_bitcoin:x86_64+0x1007ba2e2)\r\n    #4 TestingSetup::TestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&) setup_common.cpp:190 (test_bitcoin:x86_64+0x1007bab35)\r\n    #5 blockencodings_tests::SimpleRoundTripTest_invoker() blockencodings_tests.cpp:55 (test_bitcoin:x86_64+0x100168e7c)\r\n    #6 boost::detail::function::void_function_invoker0<void (*)(), void>::invoke(boost::detail::function::function_buffer&) function_template.hpp:117 (test_bitcoin:x86_64+0x10010017d)\r\n    #7 boost::detail::function::function_obj_invoker0<boost::detail::forward, int>::invoke(boost::detail::function::function_buffer&) function_template.hpp:137 (test_bitcoin:x86_64+0x10007d8ba)\r\n    #8 boost::execution_monitor::catch_signals(boost::function<int ()> const&) execution_monitor.ipp:901 (test_bitcoin:x86_64+0x100023379)\r\n    #9 boost::execution_monitor::execute(boost::function<int ()> const&) execution_monitor.ipp:1299 (test_bitcoin:x86_64+0x10002366a)\r\n    #10 boost::unit_test::unit_test_monitor_t::execute_and_translate(boost::function<void ()> const&, unsigned long) unit_test_monitor.ipp:49 (test_bitcoin:x86_64+0x10001c5be)\r\n    #11 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) framework.ipp:815 (test_bitcoin:x86_64+0x10001e993)\r\n    #12 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) framework.ipp:740 (test_bitcoin:x86_64+0x10001fa1c)\r\n    #13 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) framework.ipp:740 (test_bitcoin:x86_64+0x10001fa1c)\r\n    #14 boost::unit_test::framework::run(unsigned long, bool) framework.ipp:1721 (test_bitcoin:x86_64+0x10001b158)\r\n    #15 boost::unit_test::unit_test_main(boost::unit_test::test_suite* (*)(int, char**), int, char**) unit_test_main.ipp:250 (test_bitcoin:x86_64+0x10003447b)\r\n    #16 main unit_test_main.ipp:306 (test_bitcoin:x86_64+0x100034b1b)\r\n\r\n  Mutex M455 (0x00010f089170) created at:\r\n    #0 pthread_mutex_init <null>:2 (libclang_rt.tsan_osx_dynamic.dylib:x86_64+0xb1a5)\r\n    #1 std::__1::recursive_mutex::recursive_mutex() <null>:2 (libc++.1.dylib:x86_64+0x365db)\r\n    #2 ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&) <null>:2 (dyld:x86_64+0x1b1e2)\r\n\r\n  Mutex M132977 (0x7ffee1ba44b8) created at:\r\n    #0 pthread_mutex_init <null>:2 (libclang_rt.tsan_osx_dynamic.dylib:x86_64+0xb1a5)\r\n    #1 std::__1::recursive_mutex::recursive_mutex() <null>:2 (libc++.1.dylib:x86_64+0x365db)\r\n    #2 CTxMemPool::CTxMemPool(CBlockPolicyEstimator*, int) txmempool.cpp:456 (test_bitcoin:x86_64+0x100a708fb)\r\n    #3 blockencodings_tests::SimpleRoundTripTest::test_method() blockencodings_tests.cpp:57 (test_bitcoin:x86_64+0x10016991e)\r\n    #4 blockencodings_tests::SimpleRoundTripTest_invoker() blockencodings_tests.cpp:55 (test_bitcoin:x86_64+0x100169311)\r\n    #5 boost::detail::function::void_function_invoker0<void (*)(), void>::invoke(boost::detail::function::function_buffer&) function_template.hpp:117 (test_bitcoin:x86_64+0x10010017d)\r\n    #6 boost::detail::function::function_obj_invoker0<boost::detail::forward, int>::invoke(boost::detail::function::function_buffer&) function_template.hpp:137 (test_bitcoin:x86_64+0x10007d8ba)\r\n    #7 boost::execution_monitor::catch_signals(boost::function<int ()> const&) execution_monitor.ipp:901 (test_bitcoin:x86_64+0x100023379)\r\n    #8 boost::execution_monitor::execute(boost::function<int ()> const&) execution_monitor.ipp:1299 (test_bitcoin:x86_64+0x10002366a)\r\n    #9 boost::unit_test::unit_test_monitor_t::execute_and_translate(boost::function<void ()> const&, unsigned long) unit_test_monitor.ipp:49 (test_bitcoin:x86_64+0x10001c5be)\r\n    #10 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) framework.ipp:815 (test_bitcoin:x86_64+0x10001e993)\r\n    #11 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) framework.ipp:740 (test_bitcoin:x86_64+0x10001fa1c)\r\n    #12 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) framework.ipp:740 (test_bitcoin:x86_64+0x10001fa1c)\r\n    #13 boost::unit_test::framework::run(unsigned long, bool) framework.ipp:1721 (test_bitcoin:x86_64+0x10001b158)\r\n    #14 boost::unit_test::unit_test_main(boost::unit_test::test_suite* (*)(int, char**), int, char**) unit_test_main.ipp:250 (test_bitcoin:x86_64+0x10003447b)\r\n    #15 main unit_test_main.ipp:306 (test_bitcoin:x86_64+0x100034b1b)\r\n\r\n  Thread T1 (tid=18855157, running) created by main thread at:\r\n    #0 pthread_create <null>:2 (libclang_rt.tsan_osx_dynamic.dylib:x86_64+0x9fdf)\r\n    #1 ChainTestingSetup::ChainTestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&) setup_common.cpp:156 (test_bitcoin:x86_64+0x1007ba3c2)\r\n    #2 TestingSetup::TestingSetup(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<char const*, std::__1::allocator<char const*> > const&) setup_common.cpp:190 (test_bitcoin:x86_64+0x1007bab35)\r\n    #3 blockencodings_tests::SimpleRoundTripTest_invoker() blockencodings_tests.cpp:55 (test_bitcoin:x86_64+0x100168e7c)\r\n    #4 boost::detail::function::void_function_invoker0<void (*)(), void>::invoke(boost::detail::function::function_buffer&) function_template.hpp:117 (test_bitcoin:x86_64+0x10010017d)\r\n    #5 boost::detail::function::function_obj_invoker0<boost::detail::forward, int>::invoke(boost::detail::function::function_buffer&) function_template.hpp:137 (test_bitcoin:x86_64+0x10007d8ba)\r\n    #6 boost::execution_monitor::catch_signals(boost::function<int ()> const&) execution_monitor.ipp:901 (test_bitcoin:x86_64+0x100023379)\r\n    #7 boost::execution_monitor::execute(boost::function<int ()> const&) execution_monitor.ipp:1299 (test_bitcoin:x86_64+0x10002366a)\r\n    #8 boost::unit_test::unit_test_monitor_t::execute_and_translate(boost::function<void ()> const&, unsigned long) unit_test_monitor.ipp:49 (test_bitcoin:x86_64+0x10001c5be)\r\n    #9 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) framework.ipp:815 (test_bitcoin:x86_64+0x10001e993)\r\n    #10 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) framework.ipp:740 (test_bitcoin:x86_64+0x10001fa1c)\r\n    #11 boost::unit_test::framework::state::execute_test_tree(unsigned long, unsigned long, boost::unit_test::framework::state::random_generator_helper const*) framework.ipp:740 (test_bitcoin:x86_64+0x10001fa1c)\r\n    #12 boost::unit_test::framework::run(unsigned long, bool) framework.ipp:1721 (test_bitcoin:x86_64+0x10001b158)\r\n    #13 boost::unit_test::unit_test_main(boost::unit_test::test_suite* (*)(int, char**), int, char**) unit_test_main.ipp:250 (test_bitcoin:x86_64+0x10003447b)\r\n    #14 main unit_test_main.ipp:306 (test_bitcoin:x86_64+0x100034b1b)\r\n\r\nSUMMARY: ThreadSanitizer: data race ostream:720 in std::__1::basic_ostream<char, std::__1::char_traits<char> >& std::__1::__put_character_sequence<char, std::__1::char_traits<char> >(std::__1::basic_ostream<char, std::__1::char_traits<char> >&, char const*, unsigned long)\r\n```\r\n</details>\r\n\r\nI was only able to reproduce this with `make check` instead of running the test individually via `test_bitcoin`. I also tried on ubuntu:impish with clang-13 and the issue doesn't happen. It seems to be logging-related, similar to https://github.com/bitcoin/bitcoin/issues/23366. The following diff suppresses the error, but as I could only reproduce on macOS, I'm not sure if it's worth merging:\r\n```\r\ndiff --git a/test/sanitizer_suppressions/tsan b/test/sanitizer_suppressions/tsan\r\nindex 3acf575d0..35732c611 100644\r\n--- a/test/sanitizer_suppressions/tsan\r\n+++ b/test/sanitizer_suppressions/tsan\r\n@@ -40,3 +40,5 @@ race:epoll_ctl\r\n \r\n # https://github.com/bitcoin/bitcoin/issues/23366\r\n race:std::__1::ios_base::*\r\n+\r\n+race:std::__1::basic_ostream*\r\n```",
          "user": {
            "login": "Crypt-iQ",
            "id": 15145615,
            "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
            "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Crypt-iQ",
            "html_url": "https://github.com/Crypt-iQ",
            "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
            "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
            "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
            "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
            "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 2,
          "closed_at": "2022-08-10T09:53:52Z",
          "created_at": "2022-04-10T16:42:27Z",
          "updated_at": "2022-08-10T09:53:52Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "referenced",
      "id": 9018612064,
      "node_id": "REFE_lADOABII5849zupPzwAAAAIZjRlg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9018612064",
      "actor": {
        "login": "PastaPastaPasta",
        "id": 6443210,
        "node_id": "MDQ6VXNlcjY0NDMyMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PastaPastaPasta",
        "html_url": "https://github.com/PastaPastaPasta",
        "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
        "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
        "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
        "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
        "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "d9a186ca9a6f871ef83c24a73cd3e501d97c4320",
      "commit_url": "https://api.github.com/repos/PastaPastaPasta/dash/commits/d9a186ca9a6f871ef83c24a73cd3e501d97c4320",
      "created_at": "2023-04-16T23:04:08Z"
    },
    {
      "event": "referenced",
      "id": 9018615994,
      "node_id": "REFE_lADOABII5849zupPzwAAAAIZjSi6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9018615994",
      "actor": {
        "login": "PastaPastaPasta",
        "id": 6443210,
        "node_id": "MDQ6VXNlcjY0NDMyMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PastaPastaPasta",
        "html_url": "https://github.com/PastaPastaPasta",
        "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
        "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
        "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
        "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
        "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "aa34bd6a49349e599659a9eaeb65e0dfd8180d6f",
      "commit_url": "https://api.github.com/repos/PastaPastaPasta/dash/commits/aa34bd6a49349e599659a9eaeb65e0dfd8180d6f",
      "created_at": "2023-04-16T23:07:04Z"
    },
    {
      "event": "referenced",
      "id": 9026675506,
      "node_id": "REFE_lADOABII5849zupPzwAAAAIaCCMy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9026675506",
      "actor": {
        "login": "PastaPastaPasta",
        "id": 6443210,
        "node_id": "MDQ6VXNlcjY0NDMyMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PastaPastaPasta",
        "html_url": "https://github.com/PastaPastaPasta",
        "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
        "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
        "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
        "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
        "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "076e0528efe1cfb62f380d360b50157e00752d0f",
      "commit_url": "https://api.github.com/repos/PastaPastaPasta/dash/commits/076e0528efe1cfb62f380d360b50157e00752d0f",
      "created_at": "2023-04-17T16:17:40Z"
    },
    {
      "event": "commented",
      "id": 1587218489,
      "node_id": "IC_kwDOABII585emwg5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1587218489",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-12T12:12:51Z",
      "updated_at": "2023-06-12T14:38:54Z",
      "author_association": "MEMBER",
      "body": "Maybe we can set https://en.cppreference.com/w/cpp/io/ios_base/sync_with_stdio as a work-around to get thread-safety?\r\n\r\nEdit: nvm, this should already be set by default?",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/23366#issuecomment-1587218489",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23366"
    }
  ]
}