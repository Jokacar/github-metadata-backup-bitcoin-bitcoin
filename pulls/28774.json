{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28774",
    "id": 1584279061,
    "node_id": "PR_kwDOABII585ebi4V",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/28774",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/28774.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/28774.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28774",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28774/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28774/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28774/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/e13401084f18a43aa429232af23c1d28e55288e8",
    "number": 28774,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "Avoid returning references to mutex guarded members",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Avoid this unsafe pattern from `ArgsManager` and `CWallet`:\r\n\r\n```cpp\r\nclass A\r\n{\r\n    Mutex mutex;\r\n    Foo member GUARDED_BY(mutex);\r\n    const Foo& Get()\r\n    {\r\n        LOCK(mutex);\r\n        return member;\r\n    } // callers of `Get()` will have access to `member` without owning the mutex.\r\n```",
    "labels": [
      {
        "id": 5334691551,
        "node_id": "LA_kwDOABII588AAAABPfju3w",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
        "name": "CI failed",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2023-11-02T13:01:03Z",
    "updated_at": "2023-11-02T13:55:15Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "ccc82ba98773b270f85a3ba0cf977e1145ac3dd5",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "vasild:avoid_returning_reference_to_mutex_guarded_member",
      "ref": "avoid_returning_reference_to_mutex_guarded_member",
      "sha": "e13401084f18a43aa429232af23c1d28e55288e8",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 120608826,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMjA2MDg4MjY=",
        "name": "bitcoin",
        "full_name": "vasild/bitcoin",
        "owner": {
          "login": "vasild",
          "id": 266751,
          "node_id": "MDQ6VXNlcjI2Njc1MQ==",
          "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/vasild",
          "html_url": "https://github.com/vasild",
          "followers_url": "https://api.github.com/users/vasild/followers",
          "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
          "organizations_url": "https://api.github.com/users/vasild/orgs",
          "repos_url": "https://api.github.com/users/vasild/repos",
          "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/vasild/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/vasild/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/vasild/bitcoin",
        "archive_url": "https://api.github.com/repos/vasild/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/vasild/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/vasild/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/vasild/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/vasild/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/vasild/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/vasild/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/vasild/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/vasild/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/vasild/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/vasild/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/vasild/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/vasild/bitcoin/events",
        "forks_url": "https://api.github.com/repos/vasild/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/vasild/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/vasild/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/vasild/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/vasild/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/vasild/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/vasild/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/vasild/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/vasild/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/vasild/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/vasild/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/vasild/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/vasild/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/vasild/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/vasild/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/vasild/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:vasild/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/vasild/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/vasild/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/vasild/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/vasild/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/vasild/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/vasild/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/vasild/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/vasild/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/vasild/bitcoin/hooks",
        "svn_url": "https://github.com/vasild/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 5,
        "watchers_count": 5,
        "size": 220532,
        "default_branch": "master",
        "open_issues_count": 2,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-11-02T12:56:24Z",
        "created_at": "2018-02-07T11:52:47Z",
        "updated_at": "2023-10-27T09:02:31Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "2e9454a633462604cfafdf685cc9b3ad7d0e56ef",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35919,
        "stargazers_count": 72012,
        "watchers_count": 72012,
        "size": 244167,
        "default_branch": "master",
        "open_issues_count": 626,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-11-02T13:45:24Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-11-02T13:42:44Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28774"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 21,
    "deletions": 10,
    "changed_files": 6,
    "commits": 2,
    "review_comments": 0,
    "comments": 2
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQ3MDFiMjEyNzkyYzQ2ZDkwZDg2MjZmNTZmZGY0NmY0Y2Q5NjVhZTg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4701b212792c46d90d8626f56fdf46f4cd965ae8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4701b212792c46d90d8626f56fdf46f4cd965ae8",
      "tree": {
        "sha": "e830d32dfbe6687cfb1bd8e6236e1f7ee382f689",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e830d32dfbe6687cfb1bd8e6236e1f7ee382f689"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree e830d32dfbe6687cfb1bd8e6236e1f7ee382f689\nparent 2e9454a633462604cfafdf685cc9b3ad7d0e56ef\nauthor Vasil Dimov <vd@FreeBSD.org> 1698927617 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1698928699 +0100\n\nArgsManager: return path by value from GetBlocksDirPath()\n\n`ArgsManager::m_cached_blocks_path` is protected by\n`ArgsManager::cs_args` and returning a reference to it after releasing\nthe mutex is unsafe.\n\nTo resolve this, return a copy of the path. This has some performance\npenalty which is presumably ok, given that paths are a few 100s bytes\nat most and `GetBlocksDirPath()` is not called often.\n\nThis silences the following (clang 18):\n\n```\ncommon/args.cpp:288:31: error: returning variable 'm_cached_blocks_path' by reference requires holding mutex 'cs_args' [-Werror,-Wthread-safety-reference-return]\n  288 |     if (!path.empty()) return path;\n      |                               ^\n```\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmVDmDsACgkQVN8G9ktV\ny7/k6R/9GiLEh/8vSBjG1oQ12KPrXM+CuYodOeV9xBd5PoKVX8KNEQC0Ifd70rus\nHOd1nrqtcpIhw6n1fvY9F7HJh17QEWMG8Mya8OG/9skbldwvNPKh0McSCzdA3Bpq\nccHWRnwY5dmQ8IvLq2VOq+6tx8FFFdrMAk3ZwHMYDj8aJ27gaL0MmVDdzLAaOKkY\nFCrTROs1wKBNQ4Oz2MeY3mijpkVxLlTnYzUDbSvCIgIhnLC7myMuJsu45XIVylSP\neZB/XfVhcV3rvzLgCl++NivGbBtSmaDtvJ4I27S59RBjc3RuOBe/5pybPiR1NfQ1\ny0Eu3Wkwxf3US+MWocqBO+WhG8IqL8YwL87DO5Srq2x2HeBRbay9/kZ0g6cDxayu\nH6UYvpI3ODNX+JsZ6A0Yxd3a9oA1o/oyWIE6mcSZcBN+4KTEjS4hLYcULYAXrbbe\ny/FqQJUHpazthkf6vg5GrNaJSgUMsxvJY5fDOvbeJKae+FpBaelmMe/hHEZh/zfy\nRNl92jk4A2Y9R87GTag1iYQn9/vHZxWaZnYQJCgcaLUi75TNHD6JfeiFbYDUG0Vl\n7LaguS7pSzSZiQO+HdBuYjrtqk91PSXqZK5voxj6VzEnPIfjvpbSc+U08vwRozqw\nC2YJ6QG+9TVek04I5mZMsSK3HJ3HIucW9/khMYVfpbpPm1ZCCArCHbjwxQP2eOzb\nNACCW+G+eQVN6WMsD0B7mTj31wsTYyOzOQx8+l0R2L5ZMxrmH2fmhQH4fKfm4wZz\nYCE3MCAeTwUHTrWVJ1W6wkbneqfPXFt4HpBgSgM0f8bQFGcMpGIHiMon1TpvXmPF\nai+7XVkHPh9jnLl15TfqeOy2KfRy9Ecxjqm7wYaPDS6izKARlpBBZA9nd5J8ZMEH\nkOmSFUiqJdARBvT8c9/VD8voA2fPSdE5LYq06bZocBbFNmUsPOFX9EJYPSsbTbWL\nVtmAPlJ+DQgGIsIc2yPch8wGHlD7JeYcqcC1fDoQq8jqme5XqY5vuuxQzgeit5gB\nRcUHb7POKQFR6TEy4v0gh+zClL6wIeZmeOJ3aOe9a4t9+7ESB38/pl864trV1ELs\nXi9DR7XHbvuydkM2gRUEFNvRRKLK70yQX7ErZR6FD1fCP9VQyfs33eVHm8xlNwCZ\nI6jEMwyRO7XaAJNdXMa3gidlFzivDxMPTPpttqce+fxRJJJPItCQBkZ2jYjG95s+\nnke9DCQGwIwjKZGaXOiZIH4J2nABaU/1+wPRLr51mAWLEIh8d3Yq4pCwfrOGr09l\nwvubYwqvfDaaMNtdnpXxpDBI9cj1qBOvTAIc/w00RYKXD91W8E+vRYnCJ/uCUUD3\nrWKYTB3BQK/jU1pFY2KN6AvabN3pow==\n=nqzU\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2e9454a633462604cfafdf685cc9b3ad7d0e56ef",
          "sha": "2e9454a633462604cfafdf685cc9b3ad7d0e56ef",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2e9454a633462604cfafdf685cc9b3ad7d0e56ef"
        }
      ],
      "message": "ArgsManager: return path by value from GetBlocksDirPath()\n\n`ArgsManager::m_cached_blocks_path` is protected by\n`ArgsManager::cs_args` and returning a reference to it after releasing\nthe mutex is unsafe.\n\nTo resolve this, return a copy of the path. This has some performance\npenalty which is presumably ok, given that paths are a few 100s bytes\nat most and `GetBlocksDirPath()` is not called often.\n\nThis silences the following (clang 18):\n\n```\ncommon/args.cpp:288:31: error: returning variable 'm_cached_blocks_path' by reference requires holding mutex 'cs_args' [-Werror,-Wthread-safety-reference-return]\n  288 |     if (!path.empty()) return path;\n      |                               ^\n```",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-11-02T12:38:19Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-11-02T12:20:17Z"
      },
      "sha": "4701b212792c46d90d8626f56fdf46f4cd965ae8"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGUxMzQwMTA4NGYxOGE0M2FhNDI5MjMyYWYyM2MxZDI4ZTU1Mjg4ZTg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e13401084f18a43aa429232af23c1d28e55288e8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e13401084f18a43aa429232af23c1d28e55288e8",
      "tree": {
        "sha": "272c6805da77e9b3c1eb830288970b6a6b0db2c4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/272c6805da77e9b3c1eb830288970b6a6b0db2c4"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 272c6805da77e9b3c1eb830288970b6a6b0db2c4\nparent 4701b212792c46d90d8626f56fdf46f4cd965ae8\nauthor Vasil Dimov <vd@FreeBSD.org> 1698928017 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1698928699 +0100\n\nwallet: avoid returning a reference to vMasterKey after releasing the mutex that guards it\n\n`CWallet::GetEncryptionKey()` would return a reference to the internal\n`CWallet::vMasterKey`, guarded by `CWallet::cs_wallet`, which is unsafe.\n\nReturning a copy would be a shorter solution, but could have security\nimplications of the master key remaining somewhere in the memory even\nafter `CWallet::Lock()` (the current calls to\n`CWallet::GetEncryptionKey()` are safe, but that is not future proof).\n\nSo, instead of `EncryptSecret(m_storage.GetEncryptionKey(), ...`\nintroduce a wallet method `CWallet::EncryptSecret()` which locks the\nmutex and calls the external `EncryptSecret()` with the master key. Same\nfor `DecryptKey()`.\n\nThis silences the following (clang 18):\n\n```\nwallet/wallet.cpp:3520:12: error: returning variable 'vMasterKey' by reference requires holding mutex 'cs_wallet' [-Werror,-Wthread-safety-reference-return]\n 3520 |     return vMasterKey;\n      |            ^\n```\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmVDmDwACgkQVN8G9ktV\ny78PNx/+L7/GZDC74AO6b740BIWYqOsp+9WWF812YKP+Uc6BNyiAz0Q4oDqDECrs\nPoPN0DGLQjCJEx2qvSvkT9aCwoRCutxMCT/UnxdHt2s/nK3/w13eMK5Y5WSuOC3p\nJkocizDOUnG8hFe3J7aX8vdbO859dIyXEbZr2Mf3izVNAH19BW7EVAeTE06tJkHU\n7lLSt8Wce2PZWZXRmu3UjzdJg+sCKSDL6uJc4mhYmtBkRMase17/56PPQq4RXl7Y\n2TarNKSg039ew5++g/nW0wkGBvKTkfj5JTtT4SWHyC2nPSGnqaaxflVHTRz2nkhO\nHfCfwlQjrywewOoQtE10NVCFh5T2xsO/6DG9ypyDY2avUEC+SH74s9BJvENecskW\nfaxjVuRJkth0WUm+NzYpXcSA/n6/ZwFqLv6iU++C+5fCQssOq6GnMsGzy3Eenk8T\n1HZffMp9fokoQgeyqnjoJrV4q+5vTL4qWxKdE86vHig3ma4Uf5hjdnMsNzeGtIgP\nqd5mpImXY3k5lrxCmedhmvK79aDk29f9/L9kIW+3XTOVQ2ZqR/PszIlXkoDGv3SS\n+2Qv5lcameO3JRHPQT2il//XIWbGi3jYXc7loEuXwmUWkQth6w91bSDijNfZIO5P\nwGUP4g7o1CIMyT+GylkUqCrYglkFre6AzvnvZgBoKOhvE3sEPPIY/6uhdOhiE96I\n9wxKk3LNVay3l0z5dpflQUCzCfhIWh0dbodzINLidoMj5oMv3TWOSTj4B7j6n5Mb\nscWOzCP/5e4qD+AlOppZfirPyk9R+xM+B5y/9UvB+OJZ0WLDMo+2Mod1b+t+7YDb\nMNJJdXlhKk2ytH0KuQSXTwrUaJzIV+FElxx5ZuaUhHhMi6ZZdlo4QmLe41jZAF+j\nSfyOgAk5eLVMYvyDw7EjQapCkqVCP1dbJMw/A9aDN/Db/PQatj+xZFgWauk+yL0C\npyVChqp0w+5csRYEARSrdZah5Zvalz/3eNYyrb3QZttpCx7nRlfTYk8j5ms0oz4F\n5nCAYCPn2+HrRU3BosTAOYUWfzDope2Fx1kwdgdA4wfCygOD2P2s1m/VBtKpC583\n2aWVQeXr8qcThe5iz1tP6EZQUXWFMq1dVBxHjueJD+1QsdjFL8tS01wXKoIthc4T\nRefV+UmHJXwMHVnt7N7Wqw9FKA1hp51CewCBC+q7cKoFvB8SjK5UJJONI6LuwNbi\nug7CHUcPsLbE6T6w87OvBeMLN7p3XQ6rH29t0FgYJ6nX7PVXuSE+u30FMOUgXGUa\nNdKrb2SjiwdTNr4Qn/aIBVLgarZsyg5Lfz3srJV3hceUUCzem+jnsGnXLJCo/fWl\nYF4sOVF2gRjoQNYjVsWsTlTFe/rW9w==\n=XBDu\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4701b212792c46d90d8626f56fdf46f4cd965ae8",
          "sha": "4701b212792c46d90d8626f56fdf46f4cd965ae8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4701b212792c46d90d8626f56fdf46f4cd965ae8"
        }
      ],
      "message": "wallet: avoid returning a reference to vMasterKey after releasing the mutex that guards it\n\n`CWallet::GetEncryptionKey()` would return a reference to the internal\n`CWallet::vMasterKey`, guarded by `CWallet::cs_wallet`, which is unsafe.\n\nReturning a copy would be a shorter solution, but could have security\nimplications of the master key remaining somewhere in the memory even\nafter `CWallet::Lock()` (the current calls to\n`CWallet::GetEncryptionKey()` are safe, but that is not future proof).\n\nSo, instead of `EncryptSecret(m_storage.GetEncryptionKey(), ...`\nintroduce a wallet method `CWallet::EncryptSecret()` which locks the\nmutex and calls the external `EncryptSecret()` with the master key. Same\nfor `DecryptKey()`.\n\nThis silences the following (clang 18):\n\n```\nwallet/wallet.cpp:3520:12: error: returning variable 'vMasterKey' by reference requires holding mutex 'cs_wallet' [-Werror,-Wthread-safety-reference-return]\n 3520 |     return vMasterKey;\n      |            ^\n```",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-11-02T12:38:19Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-11-02T12:26:57Z"
      },
      "sha": "e13401084f18a43aa429232af23c1d28e55288e8"
    },
    {
      "event": "commented",
      "id": 1790682860,
      "node_id": "IC_kwDOABII585qu6bs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1790682860",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-02T13:01:06Z",
      "updated_at": "2023-11-02T13:01:07Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28774).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28774#issuecomment-1790682860",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28774"
    },
    {
      "event": "labeled",
      "id": 10844355472,
      "node_id": "LE_lADOABII5851q-cPzwAAAAKGX7uQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10844355472",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-02T13:50:16Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1790785177,
      "node_id": "IC_kwDOABII585qvTaZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1790785177",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-02T13:55:14Z",
      "updated_at": "2023-11-02T13:55:14Z",
      "author_association": "MEMBER",
      "body": "https://cirrus-ci.com/task/6687992417353728:\r\n```bash\r\nclang-tidy-17 -p=/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu -quiet -load=/tidy-build/libbitcoin-tidy.so /ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/common/args.cpp\r\ncommon/args.cpp:281:1: error: return type 'const fs::path' is 'const'-qualified at the top level, which may reduce code readability without improving const correctness [readability-const-return-type,-warnings-as-errors]\r\n  281 | const fs::path ArgsManager::GetBlocksDirPath() const\r\n      | ^~~~~\r\n```",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28774#issuecomment-1790785177",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28774"
    }
  ],
  "comments": []
}