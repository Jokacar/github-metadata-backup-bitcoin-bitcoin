{
  "type": "issue",
  "issue": {
    "id": 2187429294,
    "node_id": "I_kwDOABII586CYYWu",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29655",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29655/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29655/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29655/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/29655",
    "number": 29655,
    "state": "open",
    "state_reason": null,
    "title": "CFilters reject and disconnect peers with a valid block hash",
    "body": "### Is there an existing issue for this?\n\n- [X] I have searched the existing issues\n\n### Current behaviour\n\nFor quite some time now, I've noticed that neutrino clients connected to my Bitcoin Core instance would have issues connecting after a while. Today, I turned on debug logging for `[net]` and discovered these messages (see log section). Peers were being disconnected! But strangely, it seems like even though these peers are requesting valid block hashes, Bitcoin Core is rejecting the serving of CFilters to them. No other disconnect messages for CFilters have been observed. I checked validity two ways: by checking against bitcoin-cli getblock as well as using a block explorer (mempool.space).\n\n### Expected behaviour\n\nIf a BIP-157 client requests a valid block hash as set forth by `BlockRequestAllowed`, it should receive a response from Bitcoin Core.\n\n### Steps to reproduce\n\n1. Setup Bitcoin Core node with `peerbloomfilters=1` and `peerblockfilters=1`, ensure port `8333` is open. Also set `debug=net` for debug level for networking logs.\r\n2. Connect neutrino peer to Bitcoin Core node and wait.\r\n3. Eventually, you will see the debug network message above.\n\n### Relevant log output\n\n```\r\n2024-03-14T16:25:48Z [net] received: getcfheaders (37 bytes) peer=35\r\n2024-03-14T16:25:48Z [net] peer 35 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:25:48Z [net] received: verack (0 bytes) peer=71\r\n--\r\n2024-03-14T16:25:48Z [net] received: getcfheaders (37 bytes) peer=12\r\n2024-03-14T16:25:48Z [net] peer 12 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:25:49Z [net] received: getdata (37 bytes) peer=37\r\n--\r\n2024-03-14T16:25:49Z [net] received: getcfheaders (37 bytes) peer=13\r\n2024-03-14T16:25:49Z [net] peer 13 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:25:49Z [net] disconnecting peer=13\r\n--\r\n2024-03-14T16:25:58Z [net] received: getcfilters (37 bytes) peer=75\r\n2024-03-14T16:25:58Z [net] peer 75 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:25:58Z [net] received: getdata (73 bytes) peer=54\r\n--\r\n2024-03-14T16:25:58Z [net] received: getcfilters (37 bytes) peer=72\r\n2024-03-14T16:25:58Z [net] peer 72 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:25:58Z [net] received: tx (372 bytes) peer=11\r\n--\r\n2024-03-14T16:26:14Z [net] received: getcfheaders (37 bytes) peer=50\r\n2024-03-14T16:26:14Z [net] peer 50 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:26:14Z [net] sending inv (37 bytes) peer=54\r\n--\r\n2024-03-14T16:26:14Z [net] received: getcfheaders (37 bytes) peer=1\r\n2024-03-14T16:26:14Z [net] peer 1 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:26:14Z [net] received: getcfheaders (37 bytes) peer=71\r\n2024-03-14T16:26:14Z [net] peer 71 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:26:14Z [net] received: getcfheaders (37 bytes) peer=6\r\n2024-03-14T16:26:14Z [net] peer 6 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:26:14Z [net] received: getcfheaders (37 bytes) peer=3\r\n2024-03-14T16:26:14Z [net] peer 3 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:26:14Z [net] received: tx (327 bytes) peer=25\r\n--\r\n2024-03-14T16:26:15Z [net] Cleared nodestate for peer=71\r\n2024-03-14T16:26:15Z [net] peer 26 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:26:15Z [net] sending inv (109 bytes) peer=54\r\n--\r\n2024-03-14T16:26:15Z [net] received: getcfheaders (37 bytes) peer=9\r\n2024-03-14T16:26:15Z [net] peer 9 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:26:15Z [net] received: tx (345 bytes) peer=46\r\n--\r\n2024-03-14T16:26:15Z [net] received: getcfheaders (37 bytes) peer=67\r\n2024-03-14T16:26:15Z [net] peer 67 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:26:15Z [net] received: getdata (37 bytes) peer=37\r\n--\r\n2024-03-14T16:26:24Z [net] received: getcfilters (37 bytes) peer=84\r\n2024-03-14T16:26:24Z [net] peer 84 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:26:24Z [net] received: getdata (37 bytes) peer=37\r\n--\r\n2024-03-14T16:26:24Z [net] received: getcfilters (37 bytes) peer=87\r\n2024-03-14T16:26:24Z [net] peer 87 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:26:24Z [net] sending inv (577 bytes) peer=57\r\n--\r\n2024-03-14T16:26:25Z [net] received: getcfilters (37 bytes) peer=85\r\n2024-03-14T16:26:25Z [net] peer 85 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:26:25Z [net] Requesting tx c4d0491f6f1d12c2c2f7d3fef9501150b7a4e7f6346dd68308c41050567d5c64 peer=81\r\n--\r\n2024-03-14T16:26:26Z [net] received: getcfilters (37 bytes) peer=90\r\n2024-03-14T16:26:26Z [net] peer 90 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:26:26Z [net] sending inv (109 bytes) peer=68\r\n--\r\n2024-03-14T16:26:53Z [net] received: getcfheaders (37 bytes) peer=98\r\n2024-03-14T16:26:53Z [net] peer 98 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:26:53Z [net] received: ping (8 bytes) peer=28\r\n--\r\n2024-03-14T16:29:23Z [net] received: getcfheaders (37 bytes) peer=126\r\n2024-03-14T16:29:23Z [net] peer 126 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:29:23Z [net] disconnecting peer=126\r\n--\r\n2024-03-14T16:29:51Z [net] received: getcfilters (37 bytes) peer=128\r\n2024-03-14T16:29:51Z [net] peer 128 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:29:51Z [net] sending inv (541 bytes) peer=120\r\n--\r\n2024-03-14T16:30:44Z [net] received: getcfcheckpt (33 bytes) peer=139\r\n2024-03-14T16:30:44Z [net] peer 139 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:30:44Z [net] disconnecting peer=139\r\n--\r\n2024-03-14T16:30:56Z [net] received: getcfheaders (37 bytes) peer=146\r\n2024-03-14T16:30:56Z [net] peer 146 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:30:56Z [net] disconnecting peer=146\r\n--\r\n2024-03-14T16:31:11Z [net] received: getcfheaders (37 bytes) peer=151\r\n2024-03-14T16:31:11Z [net] peer 151 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:31:11Z [net] disconnecting peer=151\r\n--\r\n2024-03-14T16:31:21Z [net] received: getcfilters (37 bytes) peer=154\r\n2024-03-14T16:31:21Z [net] peer 154 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:31:21Z [net] disconnecting peer=154\r\n--\r\n2024-03-14T16:31:39Z [net] received: getcfheaders (37 bytes) peer=153\r\n2024-03-14T16:31:39Z [net] peer 153 requested invalid block hash: 0000000000000000000132006d75c39161b70fd058da1b740ab02c3f1df4470d\r\n2024-03-14T16:31:39Z [net] disconnecting peer=153\r\n--\r\n2024-03-14T16:40:31Z [net] received: getcfheaders (37 bytes) peer=74\r\n2024-03-14T16:40:31Z [net] peer 74 requested invalid block hash: 000000000000000000017ff36e3f004964cdaea7d5e397965673ec5ef9ce9337\r\n2024-03-14T16:40:31Z [net] disconnecting peer=74\r\n--\r\n2024-03-14T16:40:31Z [net] received: getcfheaders (37 bytes) peer=184\r\n2024-03-14T16:40:31Z [net] peer 184 requested invalid block hash: 000000000000000000017ff36e3f004964cdaea7d5e397965673ec5ef9ce9337\r\n2024-03-14T16:40:31Z [net] disconnecting peer=184\r\n--\r\n2024-03-14T16:40:31Z [net] received: getcfheaders (37 bytes) peer=73\r\n2024-03-14T16:40:31Z [net] peer 73 requested invalid block hash: 000000000000000000017ff36e3f004964cdaea7d5e397965673ec5ef9ce9337\r\n2024-03-14T16:40:31Z [net] disconnecting peer=73\r\n--\r\n2024-03-14T16:40:31Z [net] received: getcfheaders (37 bytes) peer=202\r\n2024-03-14T16:40:31Z [net] peer 202 requested invalid block hash: 000000000000000000017ff36e3f004964cdaea7d5e397965673ec5ef9ce9337\r\n2024-03-14T16:40:31Z [net] disconnecting peer=202\r\n--\r\n2024-03-14T16:40:32Z [net] received: getcfheaders (37 bytes) peer=78\r\n2024-03-14T16:40:32Z [net] peer 78 requested invalid block hash: 000000000000000000017ff36e3f004964cdaea7d5e397965673ec5ef9ce9337\r\n2024-03-14T16:40:32Z [net] received: getheaders (69 bytes) peer=222\r\n--\r\n2024-03-14T16:40:32Z [net] received: getcfheaders (37 bytes) peer=229\r\n2024-03-14T16:40:32Z [net] peer 229 requested invalid block hash: 000000000000000000017ff36e3f004964cdaea7d5e397965673ec5ef9ce9337\r\n2024-03-14T16:40:32Z [net] socket closed for peer=192\r\n--\r\n2024-03-14T16:40:32Z [net] received: getcfheaders (37 bytes) peer=77\r\n2024-03-14T16:40:32Z [net] peer 77 requested invalid block hash: 000000000000000000017ff36e3f004964cdaea7d5e397965673ec5ef9ce9337\r\n2024-03-14T16:40:32Z [net] disconnecting peer=77\r\n--\r\n2024-03-14T16:46:29Z [net] received: getcfheaders (37 bytes) peer=259\r\n2024-03-14T16:46:29Z [net] peer 259 requested invalid block hash: 00000000000000000001a680cb297921d300dadaab79df9876303b6c0bd9dd69\r\n2024-03-14T16:46:29Z [net] disconnecting peer=259\r\n--\r\n2024-03-14T16:46:29Z [net] received: getcfheaders (37 bytes) peer=241\r\n2024-03-14T16:46:29Z [net] peer 241 requested invalid block hash: 00000000000000000001a680cb297921d300dadaab79df9876303b6c0bd9dd69\r\n2024-03-14T16:46:29Z [net] sending inv (37 bytes) peer=265\r\n--\r\n2024-03-14T17:01:49Z [net] received: getcfheaders (37 bytes) peer=400\r\n2024-03-14T17:01:49Z [net] peer 400 requested invalid block hash: 0000000000000000000026ebf8f613a1ce69849f12e2c5f8fd9867c2402e60fc\r\n2024-03-14T17:01:49Z [net] disconnecting peer=400\r\n--\r\n2024-03-14T17:01:49Z [net] received: getcfheaders (37 bytes) peer=303\r\n2024-03-14T17:01:49Z [net] peer 303 requested invalid block hash: 0000000000000000000026ebf8f613a1ce69849f12e2c5f8fd9867c2402e60fc\r\n2024-03-14T17:01:50Z [net] disconnecting peer=303\r\n--\r\n2024-03-14T17:01:50Z [net] received: getcfheaders (37 bytes) peer=337\r\n2024-03-14T17:01:50Z [net] peer 337 requested invalid block hash: 0000000000000000000026ebf8f613a1ce69849f12e2c5f8fd9867c2402e60fc\r\n2024-03-14T17:01:50Z [net] disconnecting peer=337\r\n--\r\n2024-03-14T17:01:50Z [net] received: getcfheaders (37 bytes) peer=391\r\n2024-03-14T17:01:50Z [net] peer 391 requested invalid block hash: 0000000000000000000026ebf8f613a1ce69849f12e2c5f8fd9867c2402e60fc\r\n2024-03-14T17:01:50Z [net] disconnecting peer=391\r\n--\r\n2024-03-14T18:02:26Z [net] received: getcfheaders (37 bytes) peer=828\r\n2024-03-14T18:02:26Z [net] peer 828 requested invalid block hash: 000000000000000000032b3666aa4da769d272e90a3b95819433ef1ad8cf0f91\r\n2024-03-14T18:02:26Z [net] disconnecting peer=828\r\n--\r\n2024-03-14T18:02:26Z [net] received: getcfheaders (37 bytes) peer=500\r\n2024-03-14T18:02:26Z [net] peer 500 requested invalid block hash: 000000000000000000032b3666aa4da769d272e90a3b95819433ef1ad8cf0f91\r\n2024-03-14T18:02:26Z [net] disconnecting peer=500\r\n--\r\n2024-03-14T18:02:27Z [net] received: getcfheaders (37 bytes) peer=426\r\n2024-03-14T18:02:27Z [net] peer 426 requested invalid block hash: 000000000000000000032b3666aa4da769d272e90a3b95819433ef1ad8cf0f91\r\n2024-03-14T18:02:27Z [net] disconnecting peer=426\r\n2024-03-14T18:02:27Z [net] received: getcfheaders (37 bytes) peer=606\r\n2024-03-14T18:02:27Z [net] peer 606 requested invalid block hash: 000000000000000000032b3666aa4da769d272e90a3b95819433ef1ad8cf0f91\r\n2024-03-14T18:02:27Z [net] disconnecting peer=606\r\n--\r\n2024-03-14T18:02:27Z [net] received: getcfheaders (37 bytes) peer=429\r\n2024-03-14T18:02:27Z [net] peer 429 requested invalid block hash: 000000000000000000032b3666aa4da769d272e90a3b95819433ef1ad8cf0f91\r\n2024-03-14T18:02:27Z [net] disconnecting peer=429\r\n--\r\n2024-03-14T18:02:27Z [net] received: getcfheaders (37 bytes) peer=425\r\n2024-03-14T18:02:27Z [net] peer 425 requested invalid block hash: 000000000000000000032b3666aa4da769d272e90a3b95819433ef1ad8cf0f91\r\n2024-03-14T18:02:27Z [net] disconnecting peer=425\r\n--\r\n2024-03-14T18:26:18Z [net] received: getcfheaders (37 bytes) peer=905\r\n2024-03-14T18:26:18Z [net] peer 905 requested invalid block hash: 000000000000000000003b869494f4d6e7de0436d5ecd1b9e897728cdf5ca940\r\n2024-03-14T18:26:18Z [net] disconnecting peer=905\r\n--\r\n2024-03-14T18:26:18Z [net] received: getcfheaders (37 bytes) peer=1003\r\n2024-03-14T18:26:18Z [net] peer 1003 requested invalid block hash: 000000000000000000003b869494f4d6e7de0436d5ecd1b9e897728cdf5ca940\r\n2024-03-14T18:26:18Z [net] disconnecting peer=1003\r\n--\r\n2024-03-14T19:08:54Z [net] received: getcfheaders (37 bytes) peer=1363\r\n2024-03-14T19:08:54Z [net] peer 1363 requested invalid block hash: 000000000000000000014e6470d64f5f9e9c370325adaa8628841feb07a62ad0\r\n2024-03-14T19:08:54Z [net] disconnecting peer=1363\r\n--\r\n2024-03-14T19:16:00Z [net] received: getcfheaders (37 bytes) peer=1244\r\n2024-03-14T19:16:00Z [net] peer 1244 requested invalid block hash: 0000000000000000000262970ea32768668aba73aba631b9a17871fbe988b6c5\r\n2024-03-14T19:16:00Z [net] disconnecting peer=1244\r\n--\r\n2024-03-14T19:47:31Z [net] received: getcfheaders (37 bytes) peer=942\r\n2024-03-14T19:47:31Z [net] peer 942 requested invalid block hash: 0000000000000000000197ca35169bbd71bacab0258d773398720a23d0fb4a58\r\n2024-03-14T19:47:31Z [net] disconnecting peer=942\r\n--\r\n2024-03-14T19:47:31Z [net] received: getcfheaders (37 bytes) peer=1066\r\n2024-03-14T19:47:31Z [net] peer 1066 requested invalid block hash: 0000000000000000000197ca35169bbd71bacab0258d773398720a23d0fb4a58\r\n2024-03-14T19:47:31Z [net] disconnecting peer=1066\r\n--\r\n2024-03-14T19:47:31Z [net] received: getcfheaders (37 bytes) peer=907\r\n2024-03-14T19:47:31Z [net] peer 907 requested invalid block hash: 0000000000000000000197ca35169bbd71bacab0258d773398720a23d0fb4a58\r\n2024-03-14T19:47:31Z [net] disconnecting peer=907\r\n--\r\n2024-03-14T19:47:31Z [net] received: getcfheaders (37 bytes) peer=906\r\n2024-03-14T19:47:31Z [net] peer 906 requested invalid block hash: 0000000000000000000197ca35169bbd71bacab0258d773398720a23d0fb4a58\r\n2024-03-14T19:47:31Z [net] sending inv (181 bytes) peer=114\r\n--\r\n2024-03-14T19:51:17Z [net] received: getcfheaders (37 bytes) peer=1822\r\n2024-03-14T19:51:17Z [net] peer 1822 requested invalid block hash: 00000000000000000000c855dc4e0cc69918aed13ed048d38018b63e7b9b071c\r\n2024-03-14T19:51:17Z [net] disconnecting peer=1822\r\n--\r\n2024-03-14T19:51:17Z [net] received: getcfheaders (37 bytes) peer=1798\r\n2024-03-14T19:51:17Z [net] peer 1798 requested invalid block hash: 00000000000000000000c855dc4e0cc69918aed13ed048d38018b63e7b9b071c\r\n2024-03-14T19:51:17Z [net] disconnecting peer=1798\r\n--\r\n2024-03-14T19:51:58Z [net] received: getcfheaders (37 bytes) peer=1836\r\n2024-03-14T19:51:58Z [net] peer 1836 requested invalid block hash: 0000000000000000000170d2609f1b73735872a2242789f2190d846f585bddda\r\n2024-03-14T19:51:58Z [net] disconnecting peer=1836\r\n--\r\n2024-03-14T20:03:34Z [net] received: getcfheaders (37 bytes) peer=1841\r\n2024-03-14T20:03:34Z [net] peer 1841 requested invalid block hash: 0000000000000000000219dfc58b29fbf268e0d2c3b0bbf164e34527e3c03c3b\r\n2024-03-14T20:03:34Z [net] sending inv (253 bytes) peer=25\r\n--\r\n2024-03-14T20:03:34Z [net] received: getcfheaders (37 bytes) peer=1875\r\n2024-03-14T20:03:34Z [net] peer 1875 requested invalid block hash: 0000000000000000000219dfc58b29fbf268e0d2c3b0bbf164e34527e3c03c3b\r\n2024-03-14T20:03:34Z [net] disconnecting peer=1875\r\n--\r\n2024-03-14T20:11:27Z [net] received: getcfheaders (37 bytes) peer=1837\r\n2024-03-14T20:11:27Z [net] peer 1837 requested invalid block hash: 00000000000000000000292964b4b00d1d414583bd18d1ebea7a8041d4409c6d\r\n2024-03-14T20:11:27Z [net] disconnecting peer=1837\r\n--\r\n2024-03-14T21:06:43Z [net] received: getcfheaders (37 bytes) peer=2002\r\n2024-03-14T21:06:43Z [net] peer 2002 requested invalid block hash: 00000000000000000001b224ba634525a3263cda1f8cac13209f7c52b800a275\r\n2024-03-14T21:06:43Z [net] disconnecting peer=2002\r\n--\r\n2024-03-14T22:51:15Z [net] received: getcfheaders (37 bytes) peer=1842\r\n2024-03-14T22:51:15Z [net] peer 1842 requested invalid block hash: 0000000000000000000069998432cdfe3f87dda9bcd1d33c239fa775fbdfaed4\r\n2024-03-14T22:51:15Z [net] disconnecting peer=1842\r\n```\n\n### How did you obtain Bitcoin Core\n\nPre-built binaries\n\n### What version of Bitcoin Core are you using?\n\nv26.0.0\n\n### Operating system and version\n\nUbuntu 20.04 LTS\n\n### Machine specifications\n\n_No response_",
    "user": {
      "login": "djkazic",
      "id": 3331929,
      "node_id": "MDQ6VXNlcjMzMzE5Mjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3331929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djkazic",
      "html_url": "https://github.com/djkazic",
      "followers_url": "https://api.github.com/users/djkazic/followers",
      "following_url": "https://api.github.com/users/djkazic/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/djkazic/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/djkazic/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/djkazic/subscriptions",
      "organizations_url": "https://api.github.com/users/djkazic/orgs",
      "repos_url": "https://api.github.com/users/djkazic/repos",
      "events_url": "https://api.github.com/users/djkazic/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/djkazic/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 3,
    "created_at": "2024-03-14T23:09:21Z",
    "updated_at": "2024-03-15T12:18:38Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 1998670261,
      "node_id": "IC_kwDOABII5853IUm1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1998670261",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-15T00:03:11Z",
      "updated_at": "2024-03-15T00:03:27Z",
      "author_association": "CONTRIBUTOR",
      "body": "Comparing the timestamps to those when my node received the respective blocks, it looks to me like these filters are requested immediately after the block was newly found in the network, but at a time when the block hash wasn't validated and connected yet at your node.\r\nIs it possible that the disconnected clients didn't adhere to this part from BIP157, where they are expected to wait for a headers message before sending the request?\r\n`StopHash MUST be known to belong to a block accepted by the receiving peer. This is the case if the peer had previously sent a headers or inv message with that block or any descendents. A node that receives getcfilters with an unknown StopHash SHOULD NOT respond.\r\n`",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29655#issuecomment-1998670261",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29655"
    },
    {
      "event": "commented",
      "id": 1999066275,
      "node_id": "IC_kwDOABII5853J1Sj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1999066275",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-15T07:14:23Z",
      "updated_at": "2024-03-15T07:14:23Z",
      "author_association": "MEMBER",
      "body": "IIRC the filters are built in a background thread, which is not waited on, so this may happen even if the remote knows that the block was connected already.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29655#issuecomment-1999066275",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29655"
    },
    {
      "event": "commented",
      "id": 1999547465,
      "node_id": "IC_kwDOABII5853LqxJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1999547465",
      "actor": {
        "login": "djkazic",
        "id": 3331929,
        "node_id": "MDQ6VXNlcjMzMzE5Mjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3331929?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/djkazic",
        "html_url": "https://github.com/djkazic",
        "followers_url": "https://api.github.com/users/djkazic/followers",
        "following_url": "https://api.github.com/users/djkazic/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/djkazic/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/djkazic/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/djkazic/subscriptions",
        "organizations_url": "https://api.github.com/users/djkazic/orgs",
        "repos_url": "https://api.github.com/users/djkazic/repos",
        "events_url": "https://api.github.com/users/djkazic/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/djkazic/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-15T12:18:37Z",
      "updated_at": "2024-03-15T12:18:37Z",
      "author_association": "NONE",
      "body": "OK sounds like this is normal behavior. I'll take a look at the neutrino side of things.\r\n\r\nThanks for taking a look @maflcko and @mzumsande!",
      "user": {
        "login": "djkazic",
        "id": 3331929,
        "node_id": "MDQ6VXNlcjMzMzE5Mjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3331929?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/djkazic",
        "html_url": "https://github.com/djkazic",
        "followers_url": "https://api.github.com/users/djkazic/followers",
        "following_url": "https://api.github.com/users/djkazic/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/djkazic/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/djkazic/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/djkazic/subscriptions",
        "organizations_url": "https://api.github.com/users/djkazic/orgs",
        "repos_url": "https://api.github.com/users/djkazic/repos",
        "events_url": "https://api.github.com/users/djkazic/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/djkazic/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29655#issuecomment-1999547465",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29655"
    },
    {
      "event": "mentioned",
      "id": 12130863826,
      "node_id": "MEE_lADOABII586CYYWuzwAAAALTDkrS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12130863826",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-15T12:18:38Z"
    },
    {
      "event": "subscribed",
      "id": 12130863844,
      "node_id": "SE_lADOABII586CYYWuzwAAAALTDkrk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12130863844",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-15T12:18:38Z"
    },
    {
      "event": "mentioned",
      "id": 12130863866,
      "node_id": "MEE_lADOABII586CYYWuzwAAAALTDkr6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12130863866",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-15T12:18:38Z"
    },
    {
      "event": "subscribed",
      "id": 12130863872,
      "node_id": "SE_lADOABII586CYYWuzwAAAALTDksA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12130863872",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-15T12:18:38Z"
    }
  ]
}