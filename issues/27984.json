{
  "type": "issue",
  "issue": {
    "id": 1776731720,
    "node_id": "I_kwDOABII585p5sZI",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27984",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27984/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27984/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27984/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/27984",
    "number": 27984,
    "state": "closed",
    "state_reason": "completed",
    "title": "An option for a shell command that runs just before bitcoind completes shutting down.",
    "body": "### Please describe the feature you'd like to see added.\n\nIt basically works similar to the blocknotify config option which runs a shell script when a block is mined, but the purpose of this new option is different.\r\n\r\nIt can be called something like \"shutdowncomplete\" and a shell command is passed to it as an argument, which then runs just before the following message is printed in debug.log:\r\n\r\n```\r\n2023-06-26T14:00:07Z Shutdown: done\r\n```\r\n\r\nIt can be ran utilizing a function such as `runCommand`.\r\n\r\nThe reason such an option will be useful is to support automatic updates of Bitcoin Core to newer version. Some 3rd-party program used for detecting new Bitcoin Core releases on bitcoincore.org, downloading/verifying them, installing them to /usr/local or wherever the user-specified path is or alternatively running an installer, needs to be able to stop Bitcoin Core first and know when the process is about to quit so that it can proceed with installing (following which it simply runs the new version of Bitcoin daemon and exits).\r\n\r\nCurrently this can be done by detecting the bitcoind process, but it's not portable across multiple operating systems, which all have wildly different Process APIs.\n\n### Is your feature related to a problem, if so please describe it.\n\nThe problem is: How can Bitcoin Core make it easier to create external programs for automatically updating installations to the newest version?\n\n### Describe the solution you'd like\n\nAs specified above, a command-line & config option for running a shell script right before shutdown is the solution for facilitating automatic updates of bitcoin core (similar to stuff like Livepatch and k-splice for the linux kernel).\n\n### Describe any alternatives you've considered\n\nAs noted, the bitcoind process can be detected in the running process lists, but this can cause a deadlock inside applications if Bitcoin Core takes a long time to shut down (eg. a network thread takes too long to exit).\n\n### Please leave any additional context\n\nNone.",
    "user": {
      "login": "ZenulAbidin",
      "id": 42585895,
      "node_id": "MDQ6VXNlcjQyNTg1ODk1",
      "avatar_url": "https://avatars.githubusercontent.com/u/42585895?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZenulAbidin",
      "html_url": "https://github.com/ZenulAbidin",
      "followers_url": "https://api.github.com/users/ZenulAbidin/followers",
      "following_url": "https://api.github.com/users/ZenulAbidin/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/ZenulAbidin/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/ZenulAbidin/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/ZenulAbidin/subscriptions",
      "organizations_url": "https://api.github.com/users/ZenulAbidin/orgs",
      "repos_url": "https://api.github.com/users/ZenulAbidin/repos",
      "events_url": "https://api.github.com/users/ZenulAbidin/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/ZenulAbidin/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 64583,
        "node_id": "MDU6TGFiZWw2NDU4Mw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature",
        "name": "Feature",
        "color": "7cf575",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 1,
    "closed_at": "2023-06-28T06:00:32Z",
    "created_at": "2023-06-27T11:43:19Z",
    "updated_at": "2023-06-28T06:12:19Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 9650997545,
      "node_id": "LE_lADOABII585p5sZIzwAAAAI_Pokp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9650997545",
      "actor": {
        "login": "ZenulAbidin",
        "id": 42585895,
        "node_id": "MDQ6VXNlcjQyNTg1ODk1",
        "avatar_url": "https://avatars.githubusercontent.com/u/42585895?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ZenulAbidin",
        "html_url": "https://github.com/ZenulAbidin",
        "followers_url": "https://api.github.com/users/ZenulAbidin/followers",
        "following_url": "https://api.github.com/users/ZenulAbidin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ZenulAbidin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ZenulAbidin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ZenulAbidin/subscriptions",
        "organizations_url": "https://api.github.com/users/ZenulAbidin/orgs",
        "repos_url": "https://api.github.com/users/ZenulAbidin/repos",
        "events_url": "https://api.github.com/users/ZenulAbidin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ZenulAbidin/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-27T11:43:19Z",
      "label": {
        "name": "Feature",
        "color": "7cf575"
      }
    },
    {
      "event": "commented",
      "id": 1609340699,
      "node_id": "IC_kwDOABII585f7Jcb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1609340699",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-27T11:48:48Z",
      "updated_at": "2023-06-27T11:48:48Z",
      "author_association": "MEMBER",
      "body": "We already have `shutdownnotify`.",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/27984#issuecomment-1609340699",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27984"
    },
    {
      "event": "closed",
      "id": 9660300751,
      "node_id": "CE_lADOABII585p5sZIzwAAAAI_zH3P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9660300751",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-28T06:00:32Z"
    },
    {
      "event": "unsubscribed",
      "id": 9663198038,
      "node_id": "UE_lADOABII585p5sZIzwAAAAI_-LNW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9663198038",
      "actor": {
        "login": "joostjager",
        "id": 4638168,
        "node_id": "MDQ6VXNlcjQ2MzgxNjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4638168?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/joostjager",
        "html_url": "https://github.com/joostjager",
        "followers_url": "https://api.github.com/users/joostjager/followers",
        "following_url": "https://api.github.com/users/joostjager/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/joostjager/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/joostjager/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/joostjager/subscriptions",
        "organizations_url": "https://api.github.com/users/joostjager/orgs",
        "repos_url": "https://api.github.com/users/joostjager/repos",
        "events_url": "https://api.github.com/users/joostjager/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/joostjager/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-28T10:58:00Z"
    }
  ]
}