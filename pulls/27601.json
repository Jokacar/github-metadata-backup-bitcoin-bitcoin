{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601",
    "id": 1342790968,
    "node_id": "PR_kwDOABII585QCV04",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/27601",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/27601.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/27601.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27601",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27601/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
    "number": 27601,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "wallet: don't duplicate change output if already exist",
    "user": {
      "login": "furszy",
      "id": 5377650,
      "node_id": "MDQ6VXNlcjUzNzc2NTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/furszy",
      "html_url": "https://github.com/furszy",
      "followers_url": "https://api.github.com/users/furszy/followers",
      "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
      "organizations_url": "https://api.github.com/users/furszy/orgs",
      "repos_url": "https://api.github.com/users/furszy/repos",
      "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/furszy/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "If the transaction includes an output that goes to the custom change\r\naddress (`CoinControl::destChange`), the transaction creation process\r\nshould avoid creating duplicate outputs to the same address.\r\n\r\nInstead, it should reuse the existing output to prevent revealing which\r\naddress is the change address, which could compromise privacy.\r\n\r\nThis will also be useful to make other wallet processes less confusing\r\nand error-prone. For instance, within the bumpfee functionality, we\r\nmanually extract the change recipient from the transaction before calling\r\n'CreateTransaction' to ensure that the change output is not duplicated.\r\n\r\nSide note:\r\nThis is something that will be using for the #26732 rework.",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      }
    ],
    "created_at": "2023-05-08T21:03:48Z",
    "updated_at": "2023-07-19T13:35:31Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "6aef7af716a86c73d42cf88e6a6f1ccd76c05760",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "furszy:2023_wallet_double_change_output",
      "ref": "2023_wallet_double_change_output",
      "sha": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 143624913,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDM2MjQ5MTM=",
        "name": "bitcoin-core",
        "full_name": "furszy/bitcoin-core",
        "owner": {
          "login": "furszy",
          "id": 5377650,
          "node_id": "MDQ6VXNlcjUzNzc2NTA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/furszy",
          "html_url": "https://github.com/furszy",
          "followers_url": "https://api.github.com/users/furszy/followers",
          "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
          "organizations_url": "https://api.github.com/users/furszy/orgs",
          "repos_url": "https://api.github.com/users/furszy/repos",
          "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/furszy/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/furszy/bitcoin-core",
        "description": "Bitcoin-Core",
        "fork": true,
        "url": "https://api.github.com/repos/furszy/bitcoin-core",
        "archive_url": "https://api.github.com/repos/furszy/bitcoin-core/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/furszy/bitcoin-core/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/furszy/bitcoin-core/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/furszy/bitcoin-core/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/furszy/bitcoin-core/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/furszy/bitcoin-core/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/furszy/bitcoin-core/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/furszy/bitcoin-core/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/furszy/bitcoin-core/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/furszy/bitcoin-core/contributors",
        "deployments_url": "https://api.github.com/repos/furszy/bitcoin-core/deployments",
        "downloads_url": "https://api.github.com/repos/furszy/bitcoin-core/downloads",
        "events_url": "https://api.github.com/repos/furszy/bitcoin-core/events",
        "forks_url": "https://api.github.com/repos/furszy/bitcoin-core/forks",
        "git_commits_url": "https://api.github.com/repos/furszy/bitcoin-core/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/furszy/bitcoin-core/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/furszy/bitcoin-core/git/tags%7B/sha%7D",
        "git_url": "git://github.com/furszy/bitcoin-core.git",
        "issue_comment_url": "https://api.github.com/repos/furszy/bitcoin-core/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/furszy/bitcoin-core/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/furszy/bitcoin-core/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/furszy/bitcoin-core/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/furszy/bitcoin-core/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/furszy/bitcoin-core/languages",
        "merges_url": "https://api.github.com/repos/furszy/bitcoin-core/merges",
        "milestones_url": "https://api.github.com/repos/furszy/bitcoin-core/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/furszy/bitcoin-core/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/furszy/bitcoin-core/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/furszy/bitcoin-core/releases%7B/id%7D",
        "ssh_url": "git@github.com:furszy/bitcoin-core.git",
        "stargazers_url": "https://api.github.com/repos/furszy/bitcoin-core/stargazers",
        "statuses_url": "https://api.github.com/repos/furszy/bitcoin-core/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/furszy/bitcoin-core/subscribers",
        "subscription_url": "https://api.github.com/repos/furszy/bitcoin-core/subscription",
        "tags_url": "https://api.github.com/repos/furszy/bitcoin-core/tags",
        "teams_url": "https://api.github.com/repos/furszy/bitcoin-core/teams",
        "trees_url": "https://api.github.com/repos/furszy/bitcoin-core/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/furszy/bitcoin-core.git",
        "hooks_url": "https://api.github.com/repos/furszy/bitcoin-core/hooks",
        "svn_url": "https://github.com/furszy/bitcoin-core",
        "homepage": "",
        "language": "C++",
        "forks_count": 2,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 382608,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-07-19T13:56:51Z",
        "created_at": "2018-08-05T15:28:43Z",
        "updated_at": "2023-02-27T18:01:49Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "78a983f597af224e017f522443112cec81422fe6",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35406,
        "stargazers_count": 70416,
        "watchers_count": 70416,
        "size": 235847,
        "default_branch": "master",
        "open_issues_count": 654,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-07-19T13:27:29Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-07-19T13:58:57Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 186,
    "deletions": 97,
    "changed_files": 7,
    "commits": 8,
    "review_comments": 15,
    "comments": 5
  },
  "events": [
    {
      "event": "commented",
      "id": 1539047166,
      "node_id": "IC_kwDOABII585bu_7-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1539047166",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-08T21:03:51Z",
      "updated_at": "2023-07-17T07:32:25Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [murchandamus](https://github.com/bitcoin/bitcoin/pull/27601#pullrequestreview-1480176356), [luke-jr](https://github.com/bitcoin/bitcoin/pull/27601#issuecomment-1604559997) |\n| Approach ACK | [S3RK](https://github.com/bitcoin/bitcoin/pull/27601#issuecomment-1637521709) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25273](https://github.com/bitcoin/bitcoin/pull/25273) (wallet: Pass through transaction locktime and preset input sequences and scripts to CreateTransaction by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#issuecomment-1539047166",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27601"
    },
    {
      "event": "labeled",
      "id": 9194443829,
      "node_id": "LE_lADOABII585lYjWozwAAAAIkCBQ1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9194443829",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-08T21:03:53Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "labeled",
      "id": 9194810890,
      "node_id": "LE_lADOABII585lYjWozwAAAAIkDa4K",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9194810890",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-08T22:03:16Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 9196994012,
      "node_id": "UNLE_lADOABII585lYjWozwAAAAIkLv3c",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9196994012",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-09T06:34:13Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1480176356,
      "node_id": "PRR_kwDOABII585YObLk",
      "url": null,
      "actor": null,
      "commit_id": "7ec42848aa6033ae982dbf90ef33348c979c83e0",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#pullrequestreview-1480176356",
      "submitted_at": "2023-06-14T19:57:15Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
    },
    {
      "event": "unsubscribed",
      "id": 9536663165,
      "node_id": "UE_lADOABII585lYjWozwAAAAI4be59",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9536663165",
      "actor": {
        "login": "joostjager",
        "id": 4638168,
        "node_id": "MDQ6VXNlcjQ2MzgxNjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4638168?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/joostjager",
        "html_url": "https://github.com/joostjager",
        "followers_url": "https://api.github.com/users/joostjager/followers",
        "following_url": "https://api.github.com/users/joostjager/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/joostjager/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/joostjager/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/joostjager/subscriptions",
        "organizations_url": "https://api.github.com/users/joostjager/orgs",
        "repos_url": "https://api.github.com/users/joostjager/repos",
        "events_url": "https://api.github.com/users/joostjager/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/joostjager/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-15T07:26:01Z"
    },
    {
      "event": "commented",
      "id": 1604559997,
      "node_id": "IC_kwDOABII585fo6R9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1604559997",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-23T17:01:28Z",
      "updated_at": "2023-06-23T17:01:28Z",
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#issuecomment-1604559997",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27601"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9688607417,
      "node_id": "HRFPE_lADOABII585lYjWozwAAAAJBfGq5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9688607417",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-30T14:37:53Z"
    },
    {
      "event": "reviewed",
      "id": 1507352028,
      "node_id": "PRR_kwDOABII585Z2F3c",
      "url": null,
      "actor": null,
      "commit_id": "e46c1276b222a27e46c8be635af6211588107471",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Updated per feedback, thanks @Xekyo.\r\n\r\nAdded test coverage verifying that the same fee is paid when the wallet creates a change output automatically vs when the user provides the change output and the wallet just use it as recipient for the fee surplus.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#pullrequestreview-1507352028",
      "submitted_at": "2023-06-30T14:53:01Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9688911750,
      "node_id": "HRFPE_lADOABII585lYjWozwAAAAJBgQ-G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9688911750",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-30T15:06:47Z"
    },
    {
      "event": "labeled",
      "id": 9688913660,
      "node_id": "LE_lADOABII585lYjWozwAAAAJBgRb8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9688913660",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-30T15:06:54Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9689404185,
      "node_id": "HRFPE_lADOABII585lYjWozwAAAAJBiJMZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9689404185",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-30T15:56:05Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9697886876,
      "node_id": "HRFPE_lADOABII585lYjWozwAAAAJCCgKc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9697886876",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-01T22:40:11Z"
    },
    {
      "event": "commented",
      "id": 1617526433,
      "node_id": "IC_kwDOABII585gaX6h",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1617526433",
      "actor": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-03T07:29:38Z",
      "updated_at": "2023-07-03T07:29:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "How would it work if coinselection produced result without change output? ",
      "user": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#issuecomment-1617526433",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27601"
    },
    {
      "event": "reviewed",
      "id": 1511239594,
      "node_id": "PRR_kwDOABII585aE6-q",
      "url": null,
      "actor": null,
      "commit_id": "a8ac2ad88e15b7bc3dd90d92c26793c12bd20cb1",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "> How would it work if coinselection produced result without change output?\r\n\r\nThere is a test exercising the behavior inside a8ac2ad8 and also an explanation there.\r\n\r\nBut essentially, the process must adhere to the outputs specified by the user. If the change destination option in 'fundrawtransaction' matches one of the output scripts, the wallet is instructed to 'increase the specified output only if there is any change' and must not discard outputs predefined by the user under any circumstances",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#pullrequestreview-1511239594",
      "submitted_at": "2023-07-03T14:09:42Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
    },
    {
      "event": "commented",
      "id": 1620572868,
      "node_id": "IC_kwDOABII585gl_rE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1620572868",
      "actor": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-04T17:38:11Z",
      "updated_at": "2023-07-04T17:38:11Z",
      "author_association": "MEMBER",
      "body": "From CI https://cirrus-ci.com/task/4675435070488576?logs=ci#L3365:\r\n\r\n```\r\n                                     File \"/tmp/cirrus-ci-build/ci/scratch/build/bitcoin-i686-pc-linux-gnu/test/functional/wallet_fundrawtransaction.py\", line 337, in test_double_change\r\n                                       assert_equal(wallet.gettransaction(desc_tx['vin'][0]['txid'])['amount'], Decimal(50))  # assert input value\r\n                                     File \"/tmp/cirrus-ci-build/ci/scratch/build/bitcoin-i686-pc-linux-gnu/test/functional/test_framework/util.py\", line 57, in assert_equal\r\n                                       raise AssertionError(\"not(%s)\" % \" == \".join(str(arg) for arg in (thing1, thing2) + args))\r\n                                   AssertionError: not(0E-8 == 50)",
      "user": {
        "login": "MarcoFalke",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/MarcoFalke",
        "html_url": "https://github.com/MarcoFalke",
        "followers_url": "https://api.github.com/users/MarcoFalke/followers",
        "following_url": "https://api.github.com/users/MarcoFalke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/MarcoFalke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/MarcoFalke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
        "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
        "repos_url": "https://api.github.com/users/MarcoFalke/repos",
        "events_url": "https://api.github.com/users/MarcoFalke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#issuecomment-1620572868",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27601"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDAxZjg4NzZjNWJmZGRlN2IxNjYxMDVlZjFhMmY3MTE3NzM4MzA2NzE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/01f8876c5bfdde7b166105ef1a2f711773830671",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/01f8876c5bfdde7b166105ef1a2f711773830671",
      "tree": {
        "sha": "872b3dfe390882baa03ddbc82596c0e06ea4515a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/872b3dfe390882baa03ddbc82596c0e06ea4515a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 872b3dfe390882baa03ddbc82596c0e06ea4515a\nparent b4794740f82e1a08294c8a5f5d586bc1925412f3\nauthor furszy <matiasfurszyfer@protonmail.com> 1683390603 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1689207092 -0300\n\nwallet: refactor, move recipients sum loop after change script creation\n\nthis will be used in the follow-up commit to detect whether one of the\nrecipients matches the change script or not.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmSvQTQACgkQXdI8zGhq\npiNisQ//U8tuoH0O7dwrN/nb9V6ETMD3DnwvJJt9Ijat9MJnb0j/J/aDOUjsBEdJ\ne7Cn/A7YrtKyNEvkRC5G2yn6eDbOblxmUJlIrWPrsb6gc78Vg8WYqbFmQaiVBYey\n6LbqLI0D2EL7HAanJaekSiycAlZ5s0a/F1Bi+v8p0C6Vy1igqNPpYpT/cv+d5XSd\nVhZe8poJjlkk2d/vnjQiiKTJ2Zdu934chXOJfBfgrrsw+oPp5UHnYIxhMy+1/zHg\nCZ8ahqbS2JeqH4BYDg/tw2tcCgQnFuri12yXGfNwqk5DkRMQYMmI/lrdoGtf8G09\niHTDHB5w8+lTJ8GkqP3DUbg2NzrFuWOcY0ejB5/IUL90C8JmlCvHnBKeFN9dWInH\n3w1PerRNzVkMRf6rcvuQoruI81kRWbc6I/3oS9DGI0c4nK2OSCi/YhTfelU5HfxD\nW6u9/XXcGCb6D+l3NteXLjRcrAw4xKotsyktrW1hWuh+FXO90W5UWOG1ecSZC+8A\nyRhzRwxfJJkjYT/cHZYLmvYZUUVsYUkw5rIqY2WF4CQHEpMHUrqFIS8ahDe9zcJH\nX+YH7eXQ3Wt7eUNrIOSkp3aTn15JvnQugaGdNwMc/teEGAvZDXy7VulOXIlVK7BY\ngLkDR0qX6ZsUaCahPo20C40XhyUvXqSvmYfs6B9EtXj5L80WlHM=\n=Qjqd\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b4794740f82e1a08294c8a5f5d586bc1925412f3",
          "sha": "b4794740f82e1a08294c8a5f5d586bc1925412f3",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b4794740f82e1a08294c8a5f5d586bc1925412f3"
        }
      ],
      "message": "wallet: refactor, move recipients sum loop after change script creation\n\nthis will be used in the follow-up commit to detect whether one of the\nrecipients matches the change script or not.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-07-13T00:11:32Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-05-06T16:30:03Z"
      },
      "sha": "01f8876c5bfdde7b166105ef1a2f711773830671"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9812585612,
      "node_id": "HRFPE_lADOABII585lYjWozwAAAAJI4CyM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9812585612",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-13T15:23:59Z"
    },
    {
      "event": "unlabeled",
      "id": 9813949635,
      "node_id": "UNLE_lADOABII585lYjWozwAAAAJI9PzD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9813949635",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-13T17:44:12Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDdlYWI1OWMzMDFjMjY0YmVmODc0NzUzYjViMzZhOGI3NTI0NDg0ZDI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7eab59c301c264bef874753b5b36a8b7524484d2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7eab59c301c264bef874753b5b36a8b7524484d2",
      "tree": {
        "sha": "dc1e53139ebaf3782d1363311b28c35e674ef046",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/dc1e53139ebaf3782d1363311b28c35e674ef046"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree dc1e53139ebaf3782d1363311b28c35e674ef046\nparent 01f8876c5bfdde7b166105ef1a2f711773830671\nauthor furszy <matiasfurszyfer@protonmail.com> 1682718291 +0100\ncommitter furszy <matiasfurszyfer@protonmail.com> 1689343185 -0300\n\nwallet: FundTransaction, don't add change as another recipient if exists\n\nIf the transaction includes an output that goes to the custom change\naddress (CoinControl::destChange), the transaction creation process\nshould avoid creating duplicate outputs to the same address.\n\nInstead, it should reuse the existing output to prevent revealing\nwhich address is the change address, which could compromise privacy.\n\nThis will also be useful to make other wallet processes less\nconfusing and error-prone. For instance, within the bumpfee\nfunctionality, we are extracting the change recipient from the\ntransaction before calling 'CreateTransaction' to ensure that the\nchange output is not duplicated.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmSxVNEACgkQXdI8zGhq\npiPbaQ/+N4Qj+Nk9zO5Am9nrv6YQCZXzBqCdLb6f7/7PjACVRDuI+q+AS0YhhuGK\nXlQ9XskmBXTvvf3iiGkhnaltmdRxBYurlFULPAvhFPusDb9OgGL5uDakERxZW9e9\nB7nqGzzTWOf8R23Z36nZHIHPh3Jq06hVe6BebrIe2dhOGywLL57i3slvuqueZlO4\nirgQDJcXr6PfI9boxrGaMmrmgUspfzsFtwxU28KMELislqKfT/Hdc8JzGDE4SM44\nH9hz0LEe9T1KQPVlHzQLWZhLdGG6acSkJa2vxAgd6346sxRpOfkHdcYiHy9S3K/z\na1wYRrrJ2uxIKRzOmQctBzPDnzZDJmcGnpsJlUDedSCiSGYR7lrFbMlQ3niOhmdO\n1bsntr05hsWIPNnWr4QDhg37dnJllIhRdbh01xcYhadQSAW5cdr+9+O+f8lB3YQt\nNU78ORXCafgHarmxe4+sQ4pwY8g1hgUMdj6BcHOO/E2Gcoce9C69X9kqDVc960wp\nJQPgIf2wRcommD+ph8ZL/zcyFM+Rwztu6B///S3lfd6jSpA/UCM2A7SKVEoyUBxI\n3n8leoCa293JD5psf+Yz499+S9n48UUHliDpE3Z2QEJ8cSgzHMIiMxLt7JFd1sm4\nwwGR2VE+y1/Nye4yj1vlGh8LFaj5ArfadPtH6c0TmyzpCP/07k8=\n=x8l2\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/01f8876c5bfdde7b166105ef1a2f711773830671",
          "sha": "01f8876c5bfdde7b166105ef1a2f711773830671",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/01f8876c5bfdde7b166105ef1a2f711773830671"
        }
      ],
      "message": "wallet: FundTransaction, don't add change as another recipient if exists\n\nIf the transaction includes an output that goes to the custom change\naddress (CoinControl::destChange), the transaction creation process\nshould avoid creating duplicate outputs to the same address.\n\nInstead, it should reuse the existing output to prevent revealing\nwhich address is the change address, which could compromise privacy.\n\nThis will also be useful to make other wallet processes less\nconfusing and error-prone. For instance, within the bumpfee\nfunctionality, we are extracting the change recipient from the\ntransaction before calling 'CreateTransaction' to ensure that the\nchange output is not duplicated.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-07-14T13:59:45Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-04-28T21:44:51Z"
      },
      "sha": "7eab59c301c264bef874753b5b36a8b7524484d2"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDcxMWJiODc4MDdkOTMwZTliOWU4YTJhYTQ2ZDM4MmU2YjZiZjdjMWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/711bb87807d930e9b9e8a2aa46d382e6b6bf7c1a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/711bb87807d930e9b9e8a2aa46d382e6b6bf7c1a",
      "tree": {
        "sha": "fe16829c7bb14ad7777bc6375267aed073f70970",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fe16829c7bb14ad7777bc6375267aed073f70970"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree fe16829c7bb14ad7777bc6375267aed073f70970\nparent 7eab59c301c264bef874753b5b36a8b7524484d2\nauthor furszy <matiasfurszyfer@protonmail.com> 1683384685 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1689344023 -0300\n\ntest: fundrawtxn, add coverage for double change output creation\n\nCoverage for fundrawtxn:\n\n1) Should not create a second change output if there is\n   one already going to that address.\n\n2) The wallet changeless predilection should never discard\n   a manually set output by the user.\n   e.g. the user manually crafted a tx that already contain a\n   change output with certain value. This output shouldn't get\n   lost as it was predefined by the user. Only should be used\n   as recipient of the \"inputs - outputs\" surplus during\n   'fundrawtransaction'.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmSxWBgACgkQXdI8zGhq\npiNDgA//RGtw2xoG3jfs6+WDee0pHHdD8zEHK5rl56b0KNWsFOf5gI8xc1J5d9Xy\nA/6H+NF9yxWHCXfT+xCr9lFSKJdaKlWECVlhXZiP3RZXhkpkRc99CeqouQSO3BUo\nr2cuVun/gsM9sOHtSv881omiPJ5DI2V00M6ohVlPJch9nuhsttpBfLhbuZzb1Y4A\nQ57PbrDYakLUUwF1KMHrhzMJsdtC2BImipCikRuWKNv5YWcMa3b40gNXHlD7+7Dc\nTDAyioSO2kmjuQWi7llDn1zTnIW/9VOArMGzgnAMlYUEZpD3U+4exFpKUbrf7r0O\nKaXi5oDcrj+/nbN0lhBFZKTYtHt+XIqe/T8vfEXG0yuUAkNDYP+FtDHzmy2jv9bP\nDPZcqyoWIcNFmDzrCHIyUgixzG26nx3HOMqRRC6jodf+Rd2mKp64PMmYT8eVYzvN\nx8Q3/jTLENpPXBWejpltUo4lxMyBv5Md4oJGF1pyqqYhlNGk7aY4SSFIj9K7vQVb\noOeIRWDVO7jgbJWJyCQQS15x6Qdiy6/f5AZyslt/jNywnK7jhWuCf2Y7+5VG1gXU\nvJFupAuFnU97BMfRKfRGXYNXAJbxcEqFOAx9vOkL9Fu8269Q2RLzdj0VAMmZPobG\nx2C+t5vAEX0K6LlS1ITm5dY7xTdSHZnPipZpeMlGoPHGhYnNaBw=\n=oheq\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7eab59c301c264bef874753b5b36a8b7524484d2",
          "sha": "7eab59c301c264bef874753b5b36a8b7524484d2",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7eab59c301c264bef874753b5b36a8b7524484d2"
        }
      ],
      "message": "test: fundrawtxn, add coverage for double change output creation\n\nCoverage for fundrawtxn:\n\n1) Should not create a second change output if there is\n   one already going to that address.\n\n2) The wallet changeless predilection should never discard\n   a manually set output by the user.\n   e.g. the user manually crafted a tx that already contain a\n   change output with certain value. This output shouldn't get\n   lost as it was predefined by the user. Only should be used\n   as recipient of the \"inputs - outputs\" surplus during\n   'fundrawtransaction'.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-07-14T14:13:43Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-05-06T14:51:25Z"
      },
      "sha": "711bb87807d930e9b9e8a2aa46d382e6b6bf7c1a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDVkMzEzYzMyM2VlMWUwMTdhZTU3MzViMzk2OWVhMGIzMTA5ODg4NWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5d313c323ee1e017ae5735b3969ea0b31098885d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5d313c323ee1e017ae5735b3969ea0b31098885d",
      "tree": {
        "sha": "884b2b738e4696f66d9e9d42f63d3a3202daafb1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/884b2b738e4696f66d9e9d42f63d3a3202daafb1"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 884b2b738e4696f66d9e9d42f63d3a3202daafb1\nparent 711bb87807d930e9b9e8a2aa46d382e6b6bf7c1a\nauthor furszy <matiasfurszyfer@protonmail.com> 1688759945 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1689344024 -0300\n\nrefactor: remove change_spend_size field from CoinSelectionParams\n\nThe field is an intermediate result used to calculate other values\nand not read anywhere inside coin selection.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmSxWBgACgkQXdI8zGhq\npiO1VA//YzyIgpZaJV7vlbixjV207QiebZqC+ReCxh5CPq3ARu+uFqMd6iyk/tdH\nmfmKqD/iDI4Ig97YLzYFkEWPYjiE/dBTHFeo90e+W5961TJ4jS5v4zGSh/Kd2aSB\nIoMKmqkXPznfZGn+/KjdAvfaOLzOJdTMKzKETwLeQOTCUS35BLO7gMYEmI/zPLlv\nO21kGjm2J8I2+kxL1fGCMY7seQopfAUBw06H/d0TlpR3GMqAtasxvTYq7NrABiwt\nzas196yi/KOL5iylJtkbZl19IehbOa1hbM7qfWAURSsu6nQjU+T3wdnzYj3zXfsE\nFgJw6ppJX54TlSIIdh+p/ForzqYy65xV+7GW8btVEJVTcGskeiGzyU7PS1/m/Sni\nJP5cJK52tVgVaQVG+d7Msh8rCGRAni1+OMWM4sBxSG8GW4x8azjLPIhQ4vVNlZjo\n6dckXxcyQyuID1j2Yr3kFSaCg3H2QHXxPZD1JRxIx3u+iORo8oTMF56BsnDCZwsg\nNTGVuF5bNrjDJafhdS892pT7eOUReosQSTOmgISAVmbtbmSqilZg9pQLaJMn/IzU\n7D0V8w7pMZaVc85VHiZ7zYUfcYTHXAJ1prLL9fYzXAUFHiEXpcn8LaybMr/h7ZGq\nAO01mcdJH7NZUx/qKpSL5WNGBVqmVTNeueo042N0lgofns3KFOI=\n=HswO\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/711bb87807d930e9b9e8a2aa46d382e6b6bf7c1a",
          "sha": "711bb87807d930e9b9e8a2aa46d382e6b6bf7c1a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/711bb87807d930e9b9e8a2aa46d382e6b6bf7c1a"
        }
      ],
      "message": "refactor: remove change_spend_size field from CoinSelectionParams\n\nThe field is an intermediate result used to calculate other values\nand not read anywhere inside coin selection.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-07-14T14:13:44Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-07-07T19:59:05Z"
      },
      "sha": "5d313c323ee1e017ae5735b3969ea0b31098885d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDlkYzViYmUwNDJmNGQxZmViZGU4NzUzYThjNTZkYTM1ZWVkZDlkM2U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9dc5bbe042f4d1febde8753a8c56da35eedd9d3e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9dc5bbe042f4d1febde8753a8c56da35eedd9d3e",
      "tree": {
        "sha": "c8b5fc05f6a1527ef6455abfdb8c5dcd7bdc44fd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c8b5fc05f6a1527ef6455abfdb8c5dcd7bdc44fd"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree c8b5fc05f6a1527ef6455abfdb8c5dcd7bdc44fd\nparent 5d313c323ee1e017ae5735b3969ea0b31098885d\nauthor furszy <matiasfurszyfer@protonmail.com> 1689256976 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1689344024 -0300\n\nrefactor: remove discard_feerate field from CoinSelectionParams\n\nThe field is an intermediate result used to calculate other values\nand not read anywhere inside coin selection.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmSxWBgACgkQXdI8zGhq\npiNkHw/9Gn9c/J2eEkIV9ZEHuS07Ht12AobT5a2pVLDzGlnBBZ/MtJZh0+QKBd3B\nS5X6wlHBhnLOE8z0spt33w4AsuJ53ci7FLzgkkhpkFVxVyXAVyxwg/6+YfY6Wrkt\n13MzJN/fdVY75gBA2AKiupFNMKFp4CjlVJWe9TgVVmRlzLflYaX1cQeWwSX/FwK8\nSaXSFNnZegrpEQbIpSGljuVZnPWUhsI7sSq7hn3mgKU9lyC2oHgq7Gf5+xth9eNz\nd2niuld7ewzqw5FcN12k6jwMNOPCUd8G3SHBxdD5qqCpZdMqDQOktmixbrLSgpSm\nj1ekSDiagcpQ4KwOik3O7rS6g7bGUKRzeAk9k7t34bMQCxTdmlVX+8yAEJR2juWn\nvIY68a1W3xpW3nYJFQKjqeKfBQ6tk6jQKhhN11oj+L/IeqNLMS+cVmc4gePay5ir\nUEVpgHZ25VKG/Pmr4OBhb+e0fLO2cDmYWrOjK9LZ+fTKlsoxUcshZXB/pdAd9F2a\nZTWhCutNMHkrfxRf+OaMwniciDjdaZEOV9ThYUB4DsxwbUmkdX3iiOth2eZDM7Go\nZ2tfbwDHF+jTFxNehpmtHgCPbkiz1D4bnvfat3LZsbkHz1djCTr3SjiVo1bot1V4\n/rx+snj4AdTx4TeTpf21XmPVzsZ85oiRPtBJZ6qQI1tIh/0jHW4=\n=ad4L\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5d313c323ee1e017ae5735b3969ea0b31098885d",
          "sha": "5d313c323ee1e017ae5735b3969ea0b31098885d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5d313c323ee1e017ae5735b3969ea0b31098885d"
        }
      ],
      "message": "refactor: remove discard_feerate field from CoinSelectionParams\n\nThe field is an intermediate result used to calculate other values\nand not read anywhere inside coin selection.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-07-14T14:13:44Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-07-13T14:02:56Z"
      },
      "sha": "9dc5bbe042f4d1febde8753a8c56da35eedd9d3e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDUxZjMzYjBiM2NiNjJjMGU4ZDQ0MTkyYjhlOGE5OWJjMWU3ZDMwYWU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/51f33b0b3cb62c0e8d44192b8e8a99bc1e7d30ae",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/51f33b0b3cb62c0e8d44192b8e8a99bc1e7d30ae",
      "tree": {
        "sha": "cfe5e900b495c7af1610352886833f20270bdeba",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cfe5e900b495c7af1610352886833f20270bdeba"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree cfe5e900b495c7af1610352886833f20270bdeba\nparent 9dc5bbe042f4d1febde8753a8c56da35eedd9d3e\nauthor furszy <matiasfurszyfer@protonmail.com> 1688761206 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1689344024 -0300\n\ncoinselection: option to exclude change cost from waste score\n\nUseful when the transaction already accounted for the change cost.\nWhich happens when the user, or wallet process, set the coin control\ncustom change address equal to one of the existing output addresses.\n\nIn other words, when the user selects one of the transaction existing\noutputs to be increased by the difference between inputs - output.\n\nThis will be connected to the transaction creation process in the\nfollowing-up commit.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmSxWBgACgkQXdI8zGhq\npiPzxRAAmDw7YX70ksBs2GOrpEDxarN0iQdo5vLgLGnfgUTU1NNeMFKV0qLTQ52i\nb6mkJZa7OhmVeiUhn9FgdGYTJ1M7sY92Hdf8sP7d4i0Z7iaR2GQNfUAR5wvT7BHf\nqpYNoFMLdyJ7m2E1XBaWf7K6482aMKn1hH48TjHOOA5Hgq9WR/4lVnZnFSrq+Jl6\ndtYEwqMJgf6M5SXQRSycxCiuizUrWMbFQvGNJBJhk/98aLVlPnRAI7rewE2Kvr9h\nPzLsUOYwFseXVqz3P2D3pebYSDSOVUFfw8OYPOtFYSUPf8pxT79Ove2lqo7fURr+\n/+4qsUBcTw6Ztu5VKjrMGbiHGlHaESmjFiL/m9VWk8E2dkVAvhtWxiEyxF2w6hIG\nMTiq9479qUD1htjYsir8iGThdR4zcj7HOv17o9J+1z/OjufSKRYZKL+QoW0eObjl\nBo4m7gi5tUUYMq3hN/FUcVkNZBckRVs5dqZYGxcj1WIrXs6PbRrDOKEIbZCmx27Q\nbzqGnskLJ51jDhdA0TfGIr3v84LqWSffH2XVwoEbCB4FnzspX6IQd1VjUPEySrZs\njXLs35cwdc5SR7euwmZGq72RuBxfoSZFlSGmVgSM2QYQh8og4hkQ+bH+XPaAln25\n8aOkBTzhhwl0pr8rEFE7ncgaFgJZItlwsJnOioOBRSwri69FxJU=\n=08Xt\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9dc5bbe042f4d1febde8753a8c56da35eedd9d3e",
          "sha": "9dc5bbe042f4d1febde8753a8c56da35eedd9d3e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9dc5bbe042f4d1febde8753a8c56da35eedd9d3e"
        }
      ],
      "message": "coinselection: option to exclude change cost from waste score\n\nUseful when the transaction already accounted for the change cost.\nWhich happens when the user, or wallet process, set the coin control\ncustom change address equal to one of the existing output addresses.\n\nIn other words, when the user selects one of the transaction existing\noutputs to be increased by the difference between inputs - output.\n\nThis will be connected to the transaction creation process in the\nfollowing-up commit.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-07-14T14:13:44Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-07-07T20:20:06Z"
      },
      "sha": "51f33b0b3cb62c0e8d44192b8e8a99bc1e7d30ae"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9822397832,
      "node_id": "HRFPE_lADOABII585lYjWozwAAAAJJdeWI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9822397832",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-14T14:14:18Z"
    },
    {
      "event": "reviewed",
      "id": 1530430019,
      "node_id": "PRR_kwDOABII585bOIJD",
      "url": null,
      "actor": null,
      "commit_id": "06e0248cb87db14c54bd4e4f4256ce955c150c57",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Updated.  Added required changes to make coin selection, change and fee calculations take into consideration the presence of an existing change output. Avoiding cases where we end up having to increase the change output at the end of the process by the fee surplus.\r\n\r\nChanges:\r\n* Cleaned two change related members from the `CoinSelectedParams` struct that are not used inside the coin selection process. They were only intermediate results used to calculate other values.\r\n* Excluded the change cost from the waste score when the transaction already accounts for it.\r\n* In transactions with an existing change output, the spending process will no longer compute all the change related coin selection params. By setting them to 0, we instruct coin selection to produce results closer to the target.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#pullrequestreview-1530430019",
      "submitted_at": "2023-07-14T14:36:31Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
    },
    {
      "event": "reviewed",
      "id": 1532133649,
      "node_id": "PRR_kwDOABII585bUoER",
      "url": null,
      "actor": null,
      "commit_id": "9dc5bbe042f4d1febde8753a8c56da35eedd9d3e",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#pullrequestreview-1532133649",
      "submitted_at": "2023-07-17T07:15:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
    },
    {
      "event": "reviewed",
      "id": 1532142635,
      "node_id": "PRR_kwDOABII585bUqQr",
      "url": null,
      "actor": null,
      "commit_id": "ea57562b4ab4071fd1a716f09e13d19ff68e99f1",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#pullrequestreview-1532142635",
      "submitted_at": "2023-07-17T07:22:15Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
    },
    {
      "event": "commented",
      "id": 1637521709,
      "node_id": "IC_kwDOABII585hmpkt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1637521709",
      "actor": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-17T07:32:22Z",
      "updated_at": "2023-07-17T07:32:22Z",
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK\r\n\r\nI think setting change related params to 0 in case where we reuse existing output is the correct way to go.",
      "user": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#issuecomment-1637521709",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27601"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGY4NWMwMDY4Mjg3NjBlYTllZTY0Mzg0ZjVkNjMwMTc4M2MxN2E4MTQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f85c006828760ea9ee64384f5d6301783c17a814",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f85c006828760ea9ee64384f5d6301783c17a814",
      "tree": {
        "sha": "0d8f18076cbf1b416e70ad1c4b653c352893684f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0d8f18076cbf1b416e70ad1c4b653c352893684f"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 0d8f18076cbf1b416e70ad1c4b653c352893684f\nparent 51f33b0b3cb62c0e8d44192b8e8a99bc1e7d30ae\nauthor furszy <matiasfurszyfer@protonmail.com> 1689208066 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1689773220 -0300\n\nrefactor: wallet spend, decouple change params initialization\n\nNo behavior change.\n\nThe initialization of all the CoinSelectionParams fields related\nto 'change' were moved to its own standalone function.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmS35KUACgkQXdI8zGhq\npiOzBQ//RsRQGOIdHpFpjeeHWZbv6o0rjdTf3WAldnbwwdLSGDUdYRLQlSW7maiW\n9W/S3/9IKKagygwHggzwLnkGvs/1LcfV13R/xH9Al+OyHngCqFhZP5W6FXMc3giQ\nI2QFF8BelUSRhnzc4qy+dHdMTQ3hMfQVKoh1B+FV4LZf/tuL1PZCq6M6Aw+BS3Jm\nHB2cj/VFDfkJWzx+X6KKlHH2uIX03M9PREdCRuZWlMKrhkj5n2mmVcQyNflCxFWa\nl3274kknZUkGMdAvwIY9fm9gylFzQhh0x2f1h+QuBaltsn6zcGnQFEl0wkFoR72x\ny5+JIUgYJIcAkUZoBEly3TsOP+fdyZr2Kea0/Jd4kV5hDAX+1E2En+pu2cDJuMdx\nXLacnmL4Ob0uj3bY94abKu5m/xBGvB0c4RP7UwvJe2Me+oUIcZqm9TmqzNJWJfmq\nbBPqIO8RMlpLpJwb7QSGIj4EbMeXnOe9yI3wczkCDkQk01lZxEjFNeodnJxByaQW\nJTLdIIv3SK+KOALDEwfowCVDkbcu6O1bc2FVtKlxIajW0S/MVtx3cS/wooC+ykt8\n2ZGP53EMcOeGI+ivyi4v6NGirLsvl6RVGvQcsPro8eNFMtVXtsLIpJAwI7XV5VHp\n78vYwwbRhnVmxzVXxOaNES1wpg9wxPfFGP+eYAk6ZskaA7Z0Cf4=\n=A728\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/51f33b0b3cb62c0e8d44192b8e8a99bc1e7d30ae",
          "sha": "51f33b0b3cb62c0e8d44192b8e8a99bc1e7d30ae",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/51f33b0b3cb62c0e8d44192b8e8a99bc1e7d30ae"
        }
      ],
      "message": "refactor: wallet spend, decouple change params initialization\n\nNo behavior change.\n\nThe initialization of all the CoinSelectionParams fields related\nto 'change' were moved to its own standalone function.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-07-19T13:27:00Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-07-13T00:27:46Z"
      },
      "sha": "f85c006828760ea9ee64384f5d6301783c17a814"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDg4OTE2YjFmNmRkNDIwZDgyZjY2YzFlMWZkNmNkMmE3ZDM3MjhiMTU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "tree": {
        "sha": "18218a0149de7219d88316cb584c33bbfd18772c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/18218a0149de7219d88316cb584c33bbfd18772c"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 18218a0149de7219d88316cb584c33bbfd18772c\nparent f85c006828760ea9ee64384f5d6301783c17a814\nauthor furszy <matiasfurszyfer@protonmail.com> 1689211057 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1689773221 -0300\n\nwallet: compute change params only when we might produce change output\n\nInstructing coin selection to not account for the 'change' costs.\n\nFor example:\n\n* The minimum viable change will be 0, which means that the surplus\n  between inputs and outputs will never be sent to fees.\n\n* With change_fee=0:\n  - The target value being sought will be the exact target (and not\n     target + change_fee).\n  - 'GetChange' will not deduce the change_fee from the value\n     calculation.\n\n* The waste score calculation will exclude the change cost.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmS35KUACgkQXdI8zGhq\npiMuJw/+MlSuUGcitUM5ooHd3IYE6sElhyQEZZnn60SOsFvOup2tFuPknev7y6ac\njntP6ySsLII3oTH7YnBRy7SXz0TkaJvs47cINOrck8vBwSSk2AXwkz5Y3g1aOAla\n5jgRhVvEpqzb8qSJ3mmXMYXjEvskLaCEXVklbglwOII3uQf1/8NYsUcCNxyxR8bw\ni7jFEDMFutzFDEpSBuRXW8IdRW8vbkJ0gR8eKchLr2HJA+hlX85rHytFGoSSlKxt\nhgivzuhdiiMnvnI6pkisCzMqarg/UDAFIEpNZUKyByRoBfgD8JgFoHc2Ca9ikViK\nf8MYcB98IBPaaOaSoBg+gKASoYjsrvutZB2r6iTvUoCgD8N46MRU1Nj/LspVNMZG\nkM5xl08cpUNCFaFTyHoiwnIcymJ5E4Y8jMPiHdoT6g25xe21x3wDXAjknHfIMNt9\nxUukSeXP8l7yHo/fyXtkfqHQviy3ijexvd5Q7GRk3ECSaU59JBmGyfYRH+1tC9Jp\nXucTUYhq79d5d1uLINIq7kCMbZtxQrjLLc3Lj4+mA8FqIn/d8rGFcZKoiy0ZJWxV\nAD/ptSBapSAjbt1iaSDwSzkvP/kTxn8ZhZ9fvL7ZAc//V5TZyHvP8QoTeIGhJo3D\nVdIg4mSg2dpR30/izMH+CowwoK+J6k7Y9mDDZXB38MhK0uzuJrI=\n=7G6c\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f85c006828760ea9ee64384f5d6301783c17a814",
          "sha": "f85c006828760ea9ee64384f5d6301783c17a814",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f85c006828760ea9ee64384f5d6301783c17a814"
        }
      ],
      "message": "wallet: compute change params only when we might produce change output\n\nInstructing coin selection to not account for the 'change' costs.\n\nFor example:\n\n* The minimum viable change will be 0, which means that the surplus\n  between inputs and outputs will never be sent to fees.\n\n* With change_fee=0:\n  - The target value being sought will be the exact target (and not\n     target + change_fee).\n  - 'GetChange' will not deduce the change_fee from the value\n     calculation.\n\n* The waste score calculation will exclude the change cost.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-07-19T13:27:01Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-07-13T01:17:37Z"
      },
      "sha": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9862575014,
      "node_id": "HRFPE_lADOABII585lYjWozwAAAAJL2vOm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9862575014",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-19T13:27:27Z"
    },
    {
      "event": "reviewed",
      "id": 1537117279,
      "node_id": "PRR_kwDOABII585bnoxf",
      "url": null,
      "actor": null,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Updated per feedback. Thanks.\r\n\r\nAdded docs for the `ComputeChangeParams` new function.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#pullrequestreview-1537117279",
      "submitted_at": "2023-07-19T13:35:31Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230085873",
      "pull_request_review_id": 1480176356,
      "id": 1230085873,
      "node_id": "PRRC_kwDOABII585JUZ7x",
      "diff_hunk": "@@ -884,6 +874,19 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n         // change keypool ran out, but change is required.\n         CHECK_NONFATAL(IsValidDestination(dest) != scriptChange.empty());\n     }\n+\n+    // Gather total out and whether SFFO is enabled or not",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "cc82f6f65a43711a36ab6b4635fc8d34082c0d4b",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n    // Gather sum of recipient output amounts and count number of outputs to subtract fees from\r\n```",
      "created_at": "2023-06-14T19:42:33Z",
      "updated_at": "2023-06-14T19:57:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1230085873",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230085873"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 878,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230096522",
      "pull_request_review_id": 1480176356,
      "id": 1230096522,
      "node_id": "PRRC_kwDOABII585JUciK",
      "diff_hunk": "@@ -987,14 +991,21 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n \n     const CAmount change_amount = result.GetChange(coin_selection_params.min_viable_change, coin_selection_params.m_change_fee);\n     if (change_amount > 0) {\n-        CTxOut newTxOut(change_amount, scriptChange);\n-        if (nChangePosInOut == -1) {\n-            // Insert change txn at random position:\n-            nChangePosInOut = rng_fast.randrange(txNew.vout.size() + 1);\n-        } else if ((unsigned int)nChangePosInOut > txNew.vout.size()) {\n-            return util::Error{_(\"Transaction change output index out of range\")};\n+        if (existent_change_out_index) {\n+            // If there is an output with the change address already, increase that one instead of creating a new output\n+            txNew.vout.at(*existent_change_out_index).nValue += change_amount;",
      "path": "src/wallet/spend.cpp",
      "position": 157,
      "original_position": 42,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "6499c4c007019945f1f42c40f70c19b781a7ae64",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I would expect `GetChange(…)` to deduct the fee for the change, but if you already have a change output, wouldn’t that mean that you account for the change fee twice? You might need to add the change_fee back in the case where you just increase an existing change output.",
      "created_at": "2023-06-14T19:54:19Z",
      "updated_at": "2023-06-14T19:57:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1230096522",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230096522"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1007,
      "original_line": 1007,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230098983",
      "pull_request_review_id": 1480176356,
      "id": 1230098983,
      "node_id": "PRRC_kwDOABII585JUdIn",
      "diff_hunk": "@@ -315,6 +316,67 @@ def test_change_type(self):\n         dec_tx = self.nodes[2].decoderawtransaction(rawtx['hex'])\n         assert_equal('witness_v0_keyhash', dec_tx['vout'][rawtx['changepos']]['scriptPubKey']['type'])\n \n+    def test_double_change(self):\n+        self.log.info(\"Test fundrawtxn funding a tx with an existent change output and the same custom change addr\")\n+        wallet = self.nodes[0]\n+\n+        # 1) fundrawtxn shouldn't create a second change output if there is one already going to that address\n+        change_addr = wallet.getrawchangeaddress()\n+        external_addr = wallet.getnewaddress()\n+        outputs = {external_addr: Decimal(40.0), change_addr: Decimal(3)}\n+        rawtx = wallet.createrawtransaction([], outputs)\n+        funded_tx = wallet.fundrawtransaction(hexstring=rawtx, options={'changeAddress': change_addr})\n+\n+        # Verify change output existence\n+        change_pos = funded_tx['changepos']\n+        assert change_pos != -1\n+\n+        # Verify outputs now; the wallet must have increased the existent change out value instead of creating a new one\n+        dec_tx = wallet.decoderawtransaction(funded_tx['hex'])\n+        assert_equal(wallet.gettransaction(dec_tx['vin'][0]['txid'])['amount'], Decimal(50))  # assert input value\n+        assert_equal(len(dec_tx['vout']), 2)\n+        for index in range(2):\n+            out = dec_tx['vout'][index]\n+            if index == change_pos:\n+                # Change must have increased its value, change = input - outputs - fee.\n+                assert_equal(out['value'], Decimal(50) - outputs[external_addr] - funded_tx['fee'])\n+                assert_equal(out['scriptPubKey']['address'], change_addr)\n+            else:\n+                # Non-change output must remain the same\n+                assert_equal(out['value'], outputs[external_addr])\n+                assert_equal(out['scriptPubKey']['address'], external_addr)\n+\n+        # 2) Fund tx and verify that the second output going to the change address is not discarded by the wallet\n+        #    changeless txs predilection. Even when the output is \"change\" under the wallet perspective, the user has\n+        #    set it manually, so it must not be discarded.\n+        outputs = {external_addr: Decimal(\"49.998\"), change_addr: Decimal(3)}\n+        rawtx = wallet.createrawtransaction([], outputs)\n+        funded_tx = wallet.fundrawtransaction(hexstring=rawtx, options={'changeAddress': change_addr})\n+\n+        # Verify change output existence\n+        change_pos = funded_tx['changepos']\n+        assert change_pos != -1\n+\n+        # Verify outputs once more; the wallet must have increased the existent change out value instead of removing it\n+        # in favor of a changeless solution\n+        dec_tx = wallet.decoderawtransaction(funded_tx['hex'])\n+        # assert inputs value\n+        assert_equal(len(dec_tx['vin']), 2)\n+        for input in dec_tx['vin']:\n+            assert_equal(wallet.gettransaction(input['txid'])['amount'], Decimal(50))\n+\n+        assert_equal(len(dec_tx['vout']), 2)\n+        for index in range(2):\n+            out = dec_tx['vout'][index]\n+            if index == change_pos:\n+                # Change must have increased its value, change = input - outputs - fee.\n+                assert_equal(out['value'], Decimal(100) - outputs[external_addr] - funded_tx['fee'])\n+                assert_equal(out['scriptPubKey']['address'], change_addr)\n+            else:\n+                # Non-change output must remain the same\n+                assert_equal(out['value'], outputs[external_addr])\n+                assert_equal(out['scriptPubKey']['address'], external_addr)\n+",
      "path": "test/functional/wallet_fundrawtransaction.py",
      "position": 87,
      "original_position": 72,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "7ec42848aa6033ae982dbf90ef33348c979c83e0",
      "in_reply_to_id": null,
      "user": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Perhaps you should add a test that checks how much fees you’ve paid for the change outputs. I suspect you might pay two change fees when increasing an existing change, unless that gets cleaned up in some fashion. A test that rules it out would be neat.",
      "created_at": "2023-06-14T19:57:07Z",
      "updated_at": "2023-06-14T19:57:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1230098983",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1230098983"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 393,
      "original_line": 393,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1247203254",
      "pull_request_review_id": 1506174314,
      "id": 1247203254,
      "node_id": "PRRC_kwDOABII585KVs-2",
      "diff_hunk": "@@ -987,14 +991,21 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n \n     const CAmount change_amount = result.GetChange(coin_selection_params.min_viable_change, coin_selection_params.m_change_fee);\n     if (change_amount > 0) {\n-        CTxOut newTxOut(change_amount, scriptChange);\n-        if (nChangePosInOut == -1) {\n-            // Insert change txn at random position:\n-            nChangePosInOut = rng_fast.randrange(txNew.vout.size() + 1);\n-        } else if ((unsigned int)nChangePosInOut > txNew.vout.size()) {\n-            return util::Error{_(\"Transaction change output index out of range\")};\n+        if (existent_change_out_index) {\n+            // If there is an output with the change address already, increase that one instead of creating a new output\n+            txNew.vout.at(*existent_change_out_index).nValue += change_amount;",
      "path": "src/wallet/spend.cpp",
      "position": 157,
      "original_position": 42,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "6499c4c007019945f1f42c40f70c19b781a7ae64",
      "in_reply_to_id": 1230096522,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It depends on how the output was crafted. If it was created manually, it will not account for the fee. And also, it will not account for it if it was created in a previous `createTransaction` call with SFFO enabled.\r\n\r\nI think that is fine to \"overpay\" the fee at this line because later in the process (50 lines below) we check if the final fee is above the needed one, automatically increasing the change by the surplus if needed.",
      "created_at": "2023-06-29T21:42:40Z",
      "updated_at": "2023-06-29T22:00:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1247203254",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1247203254"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1007,
      "original_line": 1007,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1247950494",
      "pull_request_review_id": 1507332746,
      "id": 1247950494,
      "node_id": "PRRC_kwDOABII585KYjae",
      "diff_hunk": "@@ -315,6 +316,67 @@ def test_change_type(self):\n         dec_tx = self.nodes[2].decoderawtransaction(rawtx['hex'])\n         assert_equal('witness_v0_keyhash', dec_tx['vout'][rawtx['changepos']]['scriptPubKey']['type'])\n \n+    def test_double_change(self):\n+        self.log.info(\"Test fundrawtxn funding a tx with an existent change output and the same custom change addr\")\n+        wallet = self.nodes[0]\n+\n+        # 1) fundrawtxn shouldn't create a second change output if there is one already going to that address\n+        change_addr = wallet.getrawchangeaddress()\n+        external_addr = wallet.getnewaddress()\n+        outputs = {external_addr: Decimal(40.0), change_addr: Decimal(3)}\n+        rawtx = wallet.createrawtransaction([], outputs)\n+        funded_tx = wallet.fundrawtransaction(hexstring=rawtx, options={'changeAddress': change_addr})\n+\n+        # Verify change output existence\n+        change_pos = funded_tx['changepos']\n+        assert change_pos != -1\n+\n+        # Verify outputs now; the wallet must have increased the existent change out value instead of creating a new one\n+        dec_tx = wallet.decoderawtransaction(funded_tx['hex'])\n+        assert_equal(wallet.gettransaction(dec_tx['vin'][0]['txid'])['amount'], Decimal(50))  # assert input value\n+        assert_equal(len(dec_tx['vout']), 2)\n+        for index in range(2):\n+            out = dec_tx['vout'][index]\n+            if index == change_pos:\n+                # Change must have increased its value, change = input - outputs - fee.\n+                assert_equal(out['value'], Decimal(50) - outputs[external_addr] - funded_tx['fee'])\n+                assert_equal(out['scriptPubKey']['address'], change_addr)\n+            else:\n+                # Non-change output must remain the same\n+                assert_equal(out['value'], outputs[external_addr])\n+                assert_equal(out['scriptPubKey']['address'], external_addr)\n+\n+        # 2) Fund tx and verify that the second output going to the change address is not discarded by the wallet\n+        #    changeless txs predilection. Even when the output is \"change\" under the wallet perspective, the user has\n+        #    set it manually, so it must not be discarded.\n+        outputs = {external_addr: Decimal(\"49.998\"), change_addr: Decimal(3)}\n+        rawtx = wallet.createrawtransaction([], outputs)\n+        funded_tx = wallet.fundrawtransaction(hexstring=rawtx, options={'changeAddress': change_addr})\n+\n+        # Verify change output existence\n+        change_pos = funded_tx['changepos']\n+        assert change_pos != -1\n+\n+        # Verify outputs once more; the wallet must have increased the existent change out value instead of removing it\n+        # in favor of a changeless solution\n+        dec_tx = wallet.decoderawtransaction(funded_tx['hex'])\n+        # assert inputs value\n+        assert_equal(len(dec_tx['vin']), 2)\n+        for input in dec_tx['vin']:\n+            assert_equal(wallet.gettransaction(input['txid'])['amount'], Decimal(50))\n+\n+        assert_equal(len(dec_tx['vout']), 2)\n+        for index in range(2):\n+            out = dec_tx['vout'][index]\n+            if index == change_pos:\n+                # Change must have increased its value, change = input - outputs - fee.\n+                assert_equal(out['value'], Decimal(100) - outputs[external_addr] - funded_tx['fee'])\n+                assert_equal(out['scriptPubKey']['address'], change_addr)\n+            else:\n+                # Non-change output must remain the same\n+                assert_equal(out['value'], outputs[external_addr])\n+                assert_equal(out['scriptPubKey']['address'], external_addr)\n+",
      "path": "test/functional/wallet_fundrawtransaction.py",
      "position": 87,
      "original_position": 72,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "7ec42848aa6033ae982dbf90ef33348c979c83e0",
      "in_reply_to_id": 1230098983,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yeah, it gets cleaned at the end of the tx creation process (check https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1247203254).\r\n\r\nBut new tests never hurt, so just added it inside 8f49902. Thanks for pushing me to do it.",
      "created_at": "2023-06-30T14:43:38Z",
      "updated_at": "2023-06-30T15:07:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1247950494",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1247950494"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 393,
      "original_line": 393,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1247950832",
      "pull_request_review_id": 1507332746,
      "id": 1247950832,
      "node_id": "PRRC_kwDOABII585KYjfw",
      "diff_hunk": "@@ -884,6 +874,19 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n         // change keypool ran out, but change is required.\n         CHECK_NONFATAL(IsValidDestination(dest) != scriptChange.empty());\n     }\n+\n+    // Gather total out and whether SFFO is enabled or not",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "cc82f6f65a43711a36ab6b4635fc8d34082c0d4b",
      "in_reply_to_id": 1230085873,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "done",
      "created_at": "2023-06-30T14:43:57Z",
      "updated_at": "2023-06-30T14:44:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1247950832",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1247950832"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 878,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1250387177",
      "pull_request_review_id": 1510542857,
      "id": 1250387177,
      "node_id": "PRRC_kwDOABII585Kh2Tp",
      "diff_hunk": "@@ -987,14 +991,21 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n \n     const CAmount change_amount = result.GetChange(coin_selection_params.min_viable_change, coin_selection_params.m_change_fee);\n     if (change_amount > 0) {\n-        CTxOut newTxOut(change_amount, scriptChange);\n-        if (nChangePosInOut == -1) {\n-            // Insert change txn at random position:\n-            nChangePosInOut = rng_fast.randrange(txNew.vout.size() + 1);\n-        } else if ((unsigned int)nChangePosInOut > txNew.vout.size()) {\n-            return util::Error{_(\"Transaction change output index out of range\")};\n+        if (existent_change_out_index) {\n+            // If there is an output with the change address already, increase that one instead of creating a new output\n+            txNew.vout.at(*existent_change_out_index).nValue += change_amount;",
      "path": "src/wallet/spend.cpp",
      "position": 157,
      "original_position": 42,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "6499c4c007019945f1f42c40f70c19b781a7ae64",
      "in_reply_to_id": 1230096522,
      "user": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Isn't the fee for all outputs accounted for in `not_input_fees`? It seems to me this will always overpay and then will be corrected when we detect surplus fee.\r\n\r\nMaybe a clearer way to handle this would be to pass `chnage_fee=0` to `GetChange` if `existent_change_out_index=true`. I'd prefer to minimise number of cases when we need to correct fees at the later stage of transaction building. ",
      "created_at": "2023-07-03T07:26:13Z",
      "updated_at": "2023-07-03T07:26:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1250387177",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1250387177"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1007,
      "original_line": 1007,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1250923477",
      "pull_request_review_id": 1511239594,
      "id": 1250923477,
      "node_id": "PRRC_kwDOABII585Kj5PV",
      "diff_hunk": "@@ -987,14 +991,21 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n \n     const CAmount change_amount = result.GetChange(coin_selection_params.min_viable_change, coin_selection_params.m_change_fee);\n     if (change_amount > 0) {\n-        CTxOut newTxOut(change_amount, scriptChange);\n-        if (nChangePosInOut == -1) {\n-            // Insert change txn at random position:\n-            nChangePosInOut = rng_fast.randrange(txNew.vout.size() + 1);\n-        } else if ((unsigned int)nChangePosInOut > txNew.vout.size()) {\n-            return util::Error{_(\"Transaction change output index out of range\")};\n+        if (existent_change_out_index) {\n+            // If there is an output with the change address already, increase that one instead of creating a new output\n+            txNew.vout.at(*existent_change_out_index).nValue += change_amount;",
      "path": "src/wallet/spend.cpp",
      "position": 157,
      "original_position": 42,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "6499c4c007019945f1f42c40f70c19b781a7ae64",
      "in_reply_to_id": 1230096522,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Isn't the fee for all outputs accounted for in not_input_fees? It seems to me this will always overpay and then will be corrected when we detect surplus fee.\r\n>\r\n> Maybe a clearer way to handle this would be to pass chnage_fee=0 to GetChange if existent_change_out_index=true. I'd prefer to minimise number of cases when we need to correct fees at the later stage of transaction building.\r\n\r\nGood point.\r\nCould go further and set the coin control `m_change_fee` and `min_viable_change` to 0 so coin selection produces results closer to the target (and don't drop any sats).\r\nAnd also, another improvement idea would be to set the `change_cost` to 0 as well. But.. that would need further modifications, so probably for a follow-up, because the waste calculation is not contemplating this scenario.",
      "created_at": "2023-07-03T13:49:35Z",
      "updated_at": "2023-07-03T14:09:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1250923477",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1250923477"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1007,
      "original_line": 1007,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1264962807",
      "pull_request_review_id": 1532133649,
      "id": 1264962807,
      "node_id": "PRRC_kwDOABII585LZcz3",
      "diff_hunk": "@@ -919,21 +916,24 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n         return util::Error{strprintf(_(\"Fee estimation failed. Fallbackfee is disabled. Wait a few blocks or enable %s.\"), \"-fallbackfee\")};\n     }\n \n+    // When the cost to spend a change output at the discard feerate exceeds its value, drop it to fees.\n+    CFeeRate discard_feerate = GetDiscardRate(wallet);\n+\n     // Calculate the cost of change\n     // Cost of change is the cost of creating the change output + cost of spending the change output in the future.\n     // For creating the change output now, we use the effective feerate.\n     // For spending the change output in the future, we use the discard feerate for now.\n     // So cost of change = (change output size * effective feerate) + (size of spending change output * discard feerate)\n     coin_selection_params.m_change_fee = coin_selection_params.m_effective_feerate.GetFee(coin_selection_params.change_output_size);\n-    coin_selection_params.m_cost_of_change = coin_selection_params.m_discard_feerate.GetFee(change_spend_size) + coin_selection_params.m_change_fee;\n+    coin_selection_params.m_cost_of_change = discard_feerate.GetFee(change_spend_size) + coin_selection_params.m_change_fee;",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "9dc5bbe042f4d1febde8753a8c56da35eedd9d3e",
      "in_reply_to_id": null,
      "user": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in 9dc5bbe042f4d1febde8753a8c56da35eedd9d3e\r\n\r\nI know this preserves current behaviour, but don't we want to use `long_term_fee_rate` to determine cost of change?\r\n\r\n@murchandamus ",
      "created_at": "2023-07-17T07:15:21Z",
      "updated_at": "2023-07-17T07:22:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1264962807",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1264962807"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 928,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1264968527",
      "pull_request_review_id": 1532142635,
      "id": 1264968527,
      "node_id": "PRRC_kwDOABII585LZeNP",
      "diff_hunk": "@@ -819,6 +819,41 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     }\n }\n \n+static void ComputeChangeParams(CoinSelectionParams& coin_selection_params, CWallet& wallet, const CScript& scriptChange, CAmount recipients_sum, size_t recipients_size)",
      "path": "src/wallet/spend.cpp",
      "position": 8,
      "original_position": 4,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "ea57562b4ab4071fd1a716f09e13d19ff68e99f1",
      "in_reply_to_id": null,
      "user": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "in ea57562b4ab4071fd1a716f09e13d19ff68e99f1\r\n\r\nI see how it's useful for the next commit, but the contract of the method is not really clear without reading the code.",
      "created_at": "2023-07-17T07:22:15Z",
      "updated_at": "2023-07-17T07:22:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1264968527",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1264968527"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 826,
      "original_line": 826,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265351007",
      "pull_request_review_id": 1532781263,
      "id": 1265351007,
      "node_id": "PRRC_kwDOABII585La7lf",
      "diff_hunk": "@@ -819,6 +819,41 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     }\n }\n \n+static void ComputeChangeParams(CoinSelectionParams& coin_selection_params, CWallet& wallet, const CScript& scriptChange, CAmount recipients_sum, size_t recipients_size)",
      "path": "src/wallet/spend.cpp",
      "position": 8,
      "original_position": 4,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "ea57562b4ab4071fd1a716f09e13d19ff68e99f1",
      "in_reply_to_id": 1264968527,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Guess that you are referring to the last two args?\r\n\r\nI think that it isn't much of a problem because it is an internal static helper function.\r\n\r\nThey are needed for Knapsack min change target calculation. What maybe could do is to pass them as one: `mean_amount = std::floor(recipients_sum / recipients_size)` and document the function properly.\r\n\r\nAnd also, in a follow-up, we could go further and move the else branch of the `scriptChange` block of code inside `ComputeChangeParams` too. That part is only needed when there isn't an existent change output.",
      "created_at": "2023-07-17T13:25:11Z",
      "updated_at": "2023-07-17T13:26:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1265351007",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1265351007"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 826,
      "original_line": 826,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266301780",
      "pull_request_review_id": 1534298080,
      "id": 1266301780,
      "node_id": "PRRC_kwDOABII585LejtU",
      "diff_hunk": "@@ -819,6 +819,41 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     }\n }\n \n+static void ComputeChangeParams(CoinSelectionParams& coin_selection_params, CWallet& wallet, const CScript& scriptChange, CAmount recipients_sum, size_t recipients_size)",
      "path": "src/wallet/spend.cpp",
      "position": 8,
      "original_position": 4,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "ea57562b4ab4071fd1a716f09e13d19ff68e99f1",
      "in_reply_to_id": 1264968527,
      "user": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Let's document which part of `CoinSelectionParams` is modified and which is not.",
      "created_at": "2023-07-18T06:39:26Z",
      "updated_at": "2023-07-18T06:39:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1266301780",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266301780"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 826,
      "original_line": 826,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266754466",
      "pull_request_review_id": 1535007122,
      "id": 1266754466,
      "node_id": "PRRC_kwDOABII585LgSOi",
      "diff_hunk": "@@ -819,6 +819,41 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     }\n }\n \n+static void ComputeChangeParams(CoinSelectionParams& coin_selection_params, CWallet& wallet, const CScript& scriptChange, CAmount recipients_sum, size_t recipients_size)",
      "path": "src/wallet/spend.cpp",
      "position": 8,
      "original_position": 4,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "ea57562b4ab4071fd1a716f09e13d19ff68e99f1",
      "in_reply_to_id": 1264968527,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Let's document which part of CoinSelectionParams is modified and which is not.\r\n\r\n@S3RK. `CoinSelectionParams` wasn't modified. Only change related code was moved from `CreateTransactionInternal` to `ComputeChangeParams`.",
      "created_at": "2023-07-18T13:11:46Z",
      "updated_at": "2023-07-18T13:11:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1266754466",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266754466"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 826,
      "original_line": 826,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267625784",
      "pull_request_review_id": 1536386673,
      "id": 1267625784,
      "node_id": "PRRC_kwDOABII585Ljm84",
      "diff_hunk": "@@ -819,6 +819,41 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     }\n }\n \n+static void ComputeChangeParams(CoinSelectionParams& coin_selection_params, CWallet& wallet, const CScript& scriptChange, CAmount recipients_sum, size_t recipients_size)",
      "path": "src/wallet/spend.cpp",
      "position": 8,
      "original_position": 4,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "ea57562b4ab4071fd1a716f09e13d19ff68e99f1",
      "in_reply_to_id": 1264968527,
      "user": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I mean `ComputeChangeParams` computes some of `CoinSelectionParams`, but it's not immediately obvious which ones without reading the code of the function ",
      "created_at": "2023-07-19T07:03:17Z",
      "updated_at": "2023-07-19T07:03:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1267625784",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267625784"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 826,
      "original_line": 826,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1268077213",
      "pull_request_review_id": 1537099800,
      "id": 1268077213,
      "node_id": "PRRC_kwDOABII585LlVKd",
      "diff_hunk": "@@ -819,6 +819,41 @@ static void DiscourageFeeSniping(CMutableTransaction& tx, FastRandomContext& rng\n     }\n }\n \n+static void ComputeChangeParams(CoinSelectionParams& coin_selection_params, CWallet& wallet, const CScript& scriptChange, CAmount recipients_sum, size_t recipients_size)",
      "path": "src/wallet/spend.cpp",
      "position": 8,
      "original_position": 4,
      "commit_id": "88916b1f6dd420d82f66c1e1fd6cd2a7d3728b15",
      "original_commit_id": "ea57562b4ab4071fd1a716f09e13d19ff68e99f1",
      "in_reply_to_id": 1264968527,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> I mean `ComputeChangeParams` computes some of `CoinSelectionParams`, but it's not immediately obvious which ones without reading the code of the function\r\n\r\nOk. Added docs.\r\nThe function calculates all the `CoinSelectionParams` fields related to 'change'. No exceptions.",
      "created_at": "2023-07-19T13:28:17Z",
      "updated_at": "2023-07-19T13:28:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27601#discussion_r1268077213",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1268077213"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27601"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 826,
      "original_line": 826,
      "side": "RIGHT"
    }
  ]
}