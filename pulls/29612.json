{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612",
    "id": 1764506330,
    "node_id": "PR_kwDOABII585pLDra",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/29612",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/29612.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/29612.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29612",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29612/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/71d41d536bc2f47a014c898891d77d58502c9554",
    "number": 29612,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "rpc: Optimize serialization disk space of dumptxoutset - Reloaded",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The second attempt at implementing the `dumptxoutset` space optimization as suggested in #25675. Closes #25675.\r\n\r\nThis builds on the work done in #26045, addresses open feedback, adds some further improvements (most importantly usage of compact size), documentation, and an additional test.\r\n\r\nThe [original snapshot at height 830,000](https://github.com/bitcoin/bitcoin/pull/29551) came in at 10.82 GB. With this change, the same snapshot is 8.94 GB, a reduction of 17.4%.",
    "labels": [
      {
        "id": 98279177,
        "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
        "name": "RPC/REST/ZMQ",
        "color": "0052cc",
        "default": false
      }
    ],
    "created_at": "2024-03-10T16:31:48Z",
    "updated_at": "2024-04-03T07:46:09Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "cec605e6cb914409bc6a5ac2252ac25ba11b9f4c",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "fjahr:2024-03-pr26045-reopen",
      "ref": "2024-03-pr26045-reopen",
      "sha": "71d41d536bc2f47a014c898891d77d58502c9554",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 196253948,
        "node_id": "MDEwOlJlcG9zaXRvcnkxOTYyNTM5NDg=",
        "name": "bitcoin",
        "full_name": "fjahr/bitcoin",
        "owner": {
          "login": "fjahr",
          "id": 1322187,
          "node_id": "MDQ6VXNlcjEzMjIxODc=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/fjahr",
          "html_url": "https://github.com/fjahr",
          "followers_url": "https://api.github.com/users/fjahr/followers",
          "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
          "organizations_url": "https://api.github.com/users/fjahr/orgs",
          "repos_url": "https://api.github.com/users/fjahr/repos",
          "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/fjahr/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/fjahr/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/fjahr/bitcoin",
        "archive_url": "https://api.github.com/repos/fjahr/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/fjahr/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/fjahr/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/fjahr/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/fjahr/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/fjahr/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/fjahr/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/fjahr/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/fjahr/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/fjahr/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/fjahr/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/fjahr/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/fjahr/bitcoin/events",
        "forks_url": "https://api.github.com/repos/fjahr/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/fjahr/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/fjahr/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/fjahr/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/fjahr/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/fjahr/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/fjahr/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/fjahr/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/fjahr/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/fjahr/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/fjahr/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/fjahr/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/fjahr/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/fjahr/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/fjahr/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/fjahr/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:fjahr/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/fjahr/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/fjahr/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/fjahr/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/fjahr/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/fjahr/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/fjahr/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/fjahr/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/fjahr/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/fjahr/bitcoin/hooks",
        "svn_url": "https://github.com/fjahr/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 4,
        "watchers_count": 4,
        "size": 242181,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-03-31T22:53:39Z",
        "created_at": "2019-07-10T18:11:06Z",
        "updated_at": "2022-02-24T18:41:19Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "e1ce5b8ae9124717c00dca71a5c5b43a7f5ad177",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34986,
        "stargazers_count": 75210,
        "watchers_count": 75210,
        "size": 254271,
        "default_branch": "master",
        "open_issues_count": 726,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-04-03T00:01:50Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-04-03T07:58:29Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 124,
    "deletions": 60,
    "changed_files": 6,
    "commits": 3,
    "review_comments": 20,
    "comments": 8
  },
  "events": [
    {
      "event": "commented",
      "id": 1987287180,
      "node_id": "IC_kwDOABII5852c5iM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1987287180",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-10T16:31:50Z",
      "updated_at": "2024-04-02T10:35:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29612).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/29612#pullrequestreview-1949165312), [mzumsande](https://github.com/bitcoin/bitcoin/pull/29612#pullrequestreview-1964816329), [theStack](https://github.com/bitcoin/bitcoin/pull/29612#pullrequestreview-1970409202), [Sjors](https://github.com/bitcoin/bitcoin/pull/29612#issuecomment-2031653725) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29641](https://github.com/bitcoin/bitcoin/pull/29641) (scripted-diff: Use LogInfo/LogDebug over LogPrintf/LogPrint by maflcko)\n* [#29307](https://github.com/bitcoin/bitcoin/pull/29307) (util: check for errors after close and read in AutoFile by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#issuecomment-1987287180",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29612"
    },
    {
      "event": "labeled",
      "id": 12065863171,
      "node_id": "LE_lADOABII586BzodWzwAAAALPLnYD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12065863171",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-10T16:31:52Z",
      "label": {
        "name": "RPC/REST/ZMQ",
        "color": "0052cc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-10T16:33:44Z",
      "updated_at": "2024-03-10T16:33:44Z",
      "source": {
        "issue": {
          "id": 1365358751,
          "node_id": "PR_kwDOABII584-jA0u",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26045",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26045/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26045/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26045/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26045",
          "number": 26045,
          "state": "closed",
          "state_reason": null,
          "title": "rpc: Optimize serialization disk space of dumptxoutset",
          "body": "This is an attempt to implement #25675.\r\n\r\nI was able to reduce the serialized utxo set from 5GB to 4.1GB on mainnet.\r\n\r\nCloses #25675.",
          "user": {
            "login": "aureleoules",
            "id": 22493292,
            "node_id": "MDQ6VXNlcjIyNDkzMjky",
            "avatar_url": "https://avatars.githubusercontent.com/u/22493292?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/aureleoules",
            "html_url": "https://github.com/aureleoules",
            "followers_url": "https://api.github.com/users/aureleoules/followers",
            "following_url": "https://api.github.com/users/aureleoules/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/aureleoules/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/aureleoules/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/aureleoules/subscriptions",
            "organizations_url": "https://api.github.com/users/aureleoules/orgs",
            "repos_url": "https://api.github.com/users/aureleoules/repos",
            "events_url": "https://api.github.com/users/aureleoules/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/aureleoules/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 23,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26045",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26045",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26045.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26045.patch"
          },
          "closed_at": "2024-03-07T17:52:55Z",
          "created_at": "2022-09-08T00:57:46Z",
          "updated_at": "2024-03-11T10:12:45Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 12065965098,
      "node_id": "LE_lADOABII586BzodWzwAAAALPMAQq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12065965098",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-10T17:25:56Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1987301899,
      "node_id": "IC_kwDOABII5852c9IL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1987301899",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-10T17:25:57Z",
      "updated_at": "2024-03-10T17:25:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\n🚧 At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/22485931752</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#issuecomment-1987301899",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29612"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12065986450,
      "node_id": "HRFPE_lADOABII586BzodWzwAAAALPMFeS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12065986450",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-10T17:37:58Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-10T19:57:47Z",
      "updated_at": "2024-03-10T19:57:47Z",
      "source": {
        "issue": {
          "id": 2177880415,
          "node_id": "I_kwDOABII586Bz9Ff",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29616",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29616/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29616/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29616/events",
          "html_url": "https://github.com/bitcoin/bitcoin/issues/29616",
          "number": 29616,
          "state": "open",
          "state_reason": null,
          "title": "AssumeUTXO Mainnet Readiness Tracking",
          "body": "## Goals of this issue\r\n\r\n- Track all ongoing work on assumeutxo until mainnet params are included in a release\r\n- Categorize the work into critical/optional for mainnet readiness\r\n- Conceptual discussion on assumeutxo topics that may or may not be critical for mainnet readiness\r\n\r\nThe initial categorizations here are suggestions and changes should be discussed here in the issue. Obviously let me know if I missed anything.\r\n\r\n## Critical Issues/PRs\r\n\r\n- [ ] #29612 (which fixes #25675) - Improves size of dump, critical because it is not backwards compatible\r\n- [ ] #29519 - Stop syncing non-snapshot chain from peers that are already connected\r\n- [ ] #29726 - Fix -reindex behavior\r\n- [x] #29370 - Get rid of faked nTx and nChainTx values (closing issues discussed in #29261)\r\n- [ ] #28553 - The mainnet params themselves\r\n\r\n## Optional Issues/PRs\r\n\r\n(Attempted a rough ordering by importance)\r\n\r\n- [ ] #28616 (which fixes #28598) - Show background chain funds as not fully confirmed in GUI\r\n- [ ] #29553 - `dumptxoutset` with height param\r\n- [ ] #28670 - Improved error handling for `loadtxoutset`\r\n- [x] #29478 - Additional test coverage for `loadtxoutset`\r\n- [ ] #29617 - Additional test coverage\r\n- [ ] #29428 (draft) - Additional test coverage\r\n- [ ] #28608 (draft) - State and locking cleanup\r\n\r\n## Critical conceptual discussion\r\n\r\n- [ ] Agreement on a rule of thumb which height we choose once there is consensus for mainnet readiness, i.e. how to choose the height for #28553 once we are close to an upcoming release. I think the earlier we discuss this the better, so that this doesn't get in the way later.\r\n\r\n## Optional conceptual discussion\r\n\r\nThese were taken from #28553 and [the original assumeutxo PR](https://github.com/bitcoin/bitcoin/pull/27596#issuecomment-1727936044).\r\n\r\n- [ ] Distribution of snapshots - This recently came up [here](https://github.com/bitcoin/bitcoin/pull/29551#pullrequestreview-1917416713) and [here](https://bitcoin-irc.chaincode.com/bitcoin-core-dev/2024-03-07#1012635;). There are multiple levels to this topic but I believe that this is not critical either way. If it were critical then, at the most basic level, we would probably provide an \"official\" torrent/download link for the dump with the release. It would be great if one or more contributors could do that (@Sjors did this in #28516 for example) and are willing to maintain this for a reasonable amount of time but it is not critical IMO because anyone can use `dumptxoutset` to recreate the dump and then share it any way they like. So there is no need to provide this service from within the project. I think anyone who plans to distribute the dump to other users (think of downstream projects like BTCPayServer, Raspiblitz, Umbrel, Greenlight etc.) should validate the dump like this at least once anyway. And there may even be options for distribution possible for downstream projects that we can not even think of right now but if we don't make the feature available they can also not be explored.\r\n- [ ] Usage of MuHash #27669 - While it would be nice to have this I don't think it is blocking because this can still be introduced later without invalidating existing dumps.\r\n- [ ] Make params configurable/not hardcoded params - I think it would be good to stay on the safe side for now and make the feature available to the public as originally planned. If the feature sees wide adoption and requests for more flexibility come in that would be the right point to explore this further.\r\n- [ ] Should old hashes be removed from source code at some point? - Obviously not relevant for the first mainnet params\r\n- [ ] How frequently should we update testnet/signet params and is there any way to deal with the possibility that these chains [may get nuked at some point](https://x.com/kallewoof/status/1763222648367308958)?",
          "user": {
            "login": "fjahr",
            "id": 1322187,
            "node_id": "MDQ6VXNlcjEzMjIxODc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fjahr",
            "html_url": "https://github.com/fjahr",
            "followers_url": "https://api.github.com/users/fjahr/followers",
            "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
            "organizations_url": "https://api.github.com/users/fjahr/orgs",
            "repos_url": "https://api.github.com/users/fjahr/repos",
            "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/fjahr/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 11,
          "created_at": "2024-03-10T19:57:46Z",
          "updated_at": "2024-03-25T19:57:37Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12066268909,
      "node_id": "HRFPE_lADOABII586BzodWzwAAAALPNKbt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12066268909",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-10T20:04:40Z"
    },
    {
      "event": "unlabeled",
      "id": 12066470500,
      "node_id": "UNLE_lADOABII586BzodWzwAAAALPN7pk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12066470500",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-10T21:59:19Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-10T23:32:12Z",
      "updated_at": "2024-03-10T23:32:12Z",
      "source": {
        "issue": {
          "id": 2152991981,
          "node_id": "PR_kwDOABII585n2i5-",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29478",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29478/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29478/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29478/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29478",
          "number": 29478,
          "state": "closed",
          "state_reason": null,
          "title": "test: Test new header sync behavior in loadtxoutset",
          "body": "It adds a test for the change to `loadtxoutset` made in #29345.  Before that change the test doesn't fail right away but times out after 10 minutes.\r\n\r\nAlso removes a `sync_blocks` call that didn't seem to do anything valuable.",
          "user": {
            "login": "fjahr",
            "id": 1322187,
            "node_id": "MDQ6VXNlcjEzMjIxODc=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/fjahr",
            "html_url": "https://github.com/fjahr",
            "followers_url": "https://api.github.com/users/fjahr/followers",
            "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
            "organizations_url": "https://api.github.com/users/fjahr/orgs",
            "repos_url": "https://api.github.com/users/fjahr/repos",
            "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/fjahr/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 5,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29478",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29478",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29478.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29478.patch"
          },
          "closed_at": "2024-03-13T16:04:05Z",
          "created_at": "2024-02-25T23:29:42Z",
          "updated_at": "2024-03-13T16:04:06Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-11T00:29:34Z",
      "updated_at": "2024-03-11T00:29:34Z",
      "source": {
        "issue": {
          "id": 2098407857,
          "node_id": "PR_kwDOABII585k9cr9",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29307/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29307",
          "number": 29307,
          "state": "open",
          "state_reason": null,
          "title": "util: check for errors after close and read in AutoFile",
          "body": "1. `fclose(3)` may fail to flush the previously written data to disk, thus a failing `fclose(3)` is as serious as a failing `fwrite(3)`. Previously the code ignored `fclose(3)` failures. This PR improves the explicit callers to check whether it failed. However there is a design issue that `fclose(3)` is also called from the `AutoFile` destructor. There is no good way to signal a failure to the caller from the destructor. Maybe one of:\r\n  1.1. `fflush(3)` after each write to the file (and throw if it fails from the `AutoFile::write()` method) and hope that `fclose(3)` will then always succeed. Assert that it succeeds from the destructor :roll_eyes:. Will hurt performance.\r\n  1.2. Throw nevertheless from the destructor. Exception within the exception in C++ I think results in terminating the program. Better to `assert()` explicitly because it will at least print a meaningful error message before crashing.\r\n  1.3. Only log an error and continue (with a possibly corrupt file :roller_skate:). We don't even know the file name in `AutoFile`.\r\n  1.4. Redesign `AutoFile` so that its destructor cannot fail. Adjust _all_ its users :sob:. For example, if the file has been written to, then require the callers to explicitly call the `AutoFile::fclose()` method before the object goes out of scope. In the destructor, as a sanity check, assume/assert that this is indeed the case. Defeats the purpose of a RAII wrapper for `FILE*` which automatically closes the file when it goes out of scope.\r\n\r\n3. Check for `ferror(3)` after calls to `fread(3)`.",
          "user": {
            "login": "vasild",
            "id": 266751,
            "node_id": "MDQ6VXNlcjI2Njc1MQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vasild",
            "html_url": "https://github.com/vasild",
            "followers_url": "https://api.github.com/users/vasild/followers",
            "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
            "organizations_url": "https://api.github.com/users/vasild/orgs",
            "repos_url": "https://api.github.com/users/vasild/repos",
            "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/vasild/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 241832923,
              "node_id": "MDU6TGFiZWwyNDE4MzI5MjM=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Utils/log/libs",
              "name": "Utils/log/libs",
              "description": "",
              "color": "5319e7",
              "default": false
            },
            {
              "id": 5334691551,
              "node_id": "LA_kwDOABII588AAAABPfju3w",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
              "name": "CI failed",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 11,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29307",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29307",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29307.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29307.patch"
          },
          "created_at": "2024-01-24T14:35:29Z",
          "updated_at": "2024-04-01T14:00:24Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-11T02:41:47Z",
      "updated_at": "2024-03-11T02:41:47Z",
      "source": {
        "issue": {
          "id": 1948758168,
          "node_id": "PR_kwDOABII585dFrMG",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28670",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28670/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28670/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28670/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28670",
          "number": 28670,
          "state": "open",
          "state_reason": null,
          "title": "assumeutxo, rpc: Improve EOF error when reading snapshot metadata in loadtxoutset",
          "body": "Improve error messaging in `loadtxoutset` to provide a more user-friendly error message when the utxo snapshot file size is insufficient to contain the necessary metadata structure (40 bytes).\r\n\r\n- Error message output before the change (current master):\r\n```\r\n./src/bitcoin-cli -datadir=${AU_DATADIR} loadtxoutset ${AU_DATADIR}/utxo-111.dat\r\nerror code: -1\r\nerror message:\r\nAutoFile::read: end of file: iostream error\r\n```\r\n\r\n- Error message output after the change:\r\n```\r\n./src/bitcoin-cli -datadir=${AU_DATADIR} loadtxoutset ${AU_DATADIR}/utxo-111.dat\r\nerror code: -32603\r\nerror message:\r\nUnable to load UTXO snapshot, couldn't read snapshot metadata from file /tmp/.test_utxo_3/utxo-111.dat.\r\nThe file may be corrupted or it was crafted in an incompatible format.\r\n```\r\n\r\n\r\nOriginal strategy was to check the size of the file before de-serialisation and the current strategy was presented at that time as an alternative which has been preferred by reviewers and it looks simpler since `streams` source code files are no longer touched.\r\n\r\nThis PR needs to be backported to 26.x",
          "user": {
            "login": "pablomartin4btc",
            "id": 110166421,
            "node_id": "U_kgDOBpEBlQ",
            "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/pablomartin4btc",
            "html_url": "https://github.com/pablomartin4btc",
            "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
            "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
            "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
            "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
            "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 148216,
              "node_id": "MDU6TGFiZWwxNDgyMTY=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Docs",
              "name": "Docs",
              "color": "02d7e1",
              "default": false
            },
            {
              "id": 98279177,
              "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
              "name": "RPC/REST/ZMQ",
              "color": "0052cc",
              "default": false
            },
            {
              "id": 5334691551,
              "node_id": "LA_kwDOABII588AAAABPfju3w",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
              "name": "CI failed",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 8,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28670",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28670",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28670.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28670.patch"
          },
          "created_at": "2023-10-18T03:59:10Z",
          "updated_at": "2024-03-13T22:19:46Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1988209242,
      "node_id": "IC_kwDOABII5852gapa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1988209242",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-11T11:21:53Z",
      "updated_at": "2024-03-11T11:21:53Z",
      "author_association": "MEMBER",
      "body": "> 我最近正在休假中\r\n\r\nWell, I'm not on holiday :-)\r\n\r\ntACK b0cfbce17a84158973ebba16f9801bd57cb70fe6\r\n\r\nI do suggest adding a comment to `PopulateAndValidateSnapshot` in `validation.h`:\r\n\r\n> To reduce space, this function takes advantage of the guarantee by leveldb that keys are lexicographically sorted.\r\n\r\nI generated a snapshot and loaded it using the patch in #29551 (only waited for it to reach the tip, not a full background sync).\r\n\r\nFor those testing who don't want to wait out the long flush, see #28358.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#issuecomment-1988209242",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29612"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12080057372,
      "node_id": "HRFPE_lADOABII586BzodWzwAAAALQBwwc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12080057372",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-11T20:58:25Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12080064309,
      "node_id": "HRFPE_lADOABII586BzodWzwAAAALQByc1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12080064309",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-11T20:59:13Z"
    },
    {
      "event": "commented",
      "id": 1989436033,
      "node_id": "IC_kwDOABII5852lGKB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1989436033",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-11T21:00:21Z",
      "updated_at": "2024-03-11T21:04:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the review and testing!\r\n\r\n> I do suggest adding a comment to `PopulateAndValidateSnapshot` in `validation.h`:\r\n> \r\n> > To reduce space, this function takes advantage of the guarantee by leveldb that keys are lexicographically sorted.\r\n\r\nAs it is worded, wouldn't this be more appropriate to add in `CreateUTXOSnapshot`? That's where we are iterating with the pcursor, leveraging the sorting, and writing the coins to file, so I would say that's also where the space savings are realized. \r\n\r\nI have now amended the comment a bit and added a version of it to both `CreateUTXOSnapshot` and `PopulateAndValidateSnapshot`. Please let me know if you think this is alright: https://github.com/bitcoin/bitcoin/commit/923ec9043af668f3a342422d32c1c28d29018ed0",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#issuecomment-1989436033",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29612"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12080098996,
      "node_id": "HRFPE_lADOABII586BzodWzwAAAALQB660",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12080098996",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-11T21:02:58Z"
    },
    {
      "event": "commented",
      "id": 1991022291,
      "node_id": "IC_kwDOABII5852rJbT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1991022291",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-12T08:24:59Z",
      "updated_at": "2024-03-12T08:24:59Z",
      "author_association": "MEMBER",
      "body": "re-ACK 923ec9043af668f3a342422d32c1c28d29018ed0\r\n\r\nThat looks good.\r\n\r\nThe reason I suggested (also) writing something in the header is because it's more likely to be noticed by some future dev looking through existing leveldb uses, seeing if they can replace it.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#issuecomment-1991022291",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29612"
    },
    {
      "event": "reviewed",
      "id": 1933303632,
      "node_id": "PRR_kwDOABII585zO99Q",
      "url": null,
      "actor": null,
      "commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Nice, ACK 923ec9043af668f3a342422d32c1c28d29018ed0\r\n\r\nJust some comment nits that could easily be done in a follow-up too.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#pullrequestreview-1933303632",
      "submitted_at": "2024-03-13T07:49:43Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-13T07:51:43Z",
      "updated_at": "2024-03-13T07:51:43Z",
      "source": {
        "issue": {
          "id": 2182604130,
          "node_id": "PR_kwDOABII585pbmSj",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29641",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29641/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29641/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29641/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29641",
          "number": 29641,
          "state": "open",
          "state_reason": null,
          "title": "scripted-diff: Use LogInfo/LogDebug over LogPrintf/LogPrint",
          "body": "`LogPrintf/LogPrint` are problematic, because:\r\n\r\n* Their name is non-descriptive of what the function does (info logging or debug logging).\r\n* They are deprecated aliases, where code is using either the deprecated or non-deprecated alias, which is inconsistent and confusing.\r\n\r\nFix all issues by replacing the usage.\r\n\r\nWhile the diff is large and may cause merge conflicts or backport conflicts, I don't see the deprecated aliases being kept forever, so this will have to be done at some point. All conflicts should be trivial to solve, in any case.",
          "user": {
            "login": "maflcko",
            "id": 6399679,
            "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/maflcko",
            "html_url": "https://github.com/maflcko",
            "followers_url": "https://api.github.com/users/maflcko/followers",
            "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
            "organizations_url": "https://api.github.com/users/maflcko/orgs",
            "repos_url": "https://api.github.com/users/maflcko/repos",
            "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/maflcko/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29641",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29641",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29641.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29641.patch"
          },
          "created_at": "2024-03-12T20:21:40Z",
          "updated_at": "2024-04-03T01:26:30Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-13T08:04:40Z",
      "updated_at": "2024-03-13T08:04:40Z",
      "source": {
        "issue": {
          "id": 2178121326,
          "node_id": "PR_kwDOABII585pMHJW",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29617",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29617/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29617/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29617/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29617",
          "number": 29617,
          "state": "open",
          "state_reason": null,
          "title": "test: Validate UTXO snapshot with coin height > base height & amount > MAX_MONEY supply",
          "body": "### Ensure snapshot loading fails for coins exceeding base height\r\n\r\n**Objective**: This test verifies that snapshot loading is correctly rejected for coins with a height greater than the base height.\r\n\r\n**Update**:\r\n- Added `test_invalid_snapshot_wrong_coin_code` to `feature_assumeutxo.py`.\r\n- The test artificially sets a coin's height above 299 in a snapshot and checks for load failure.\r\n- Edit: Added a test case for outputs whose amounts surpass the MAX_MONEY supply limit.\r\n\r\nThis implementation addresses the request for enhancing `assumeutxo` testing as outlined in issue #28648\r\n",
          "user": {
            "login": "jrakibi",
            "id": 19940301,
            "node_id": "MDQ6VXNlcjE5OTQwMzAx",
            "avatar_url": "https://avatars.githubusercontent.com/u/19940301?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/jrakibi",
            "html_url": "https://github.com/jrakibi",
            "followers_url": "https://api.github.com/users/jrakibi/followers",
            "following_url": "https://api.github.com/users/jrakibi/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/jrakibi/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/jrakibi/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/jrakibi/subscriptions",
            "organizations_url": "https://api.github.com/users/jrakibi/orgs",
            "repos_url": "https://api.github.com/users/jrakibi/repos",
            "events_url": "https://api.github.com/users/jrakibi/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/jrakibi/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29617",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29617",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29617.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29617.patch"
          },
          "created_at": "2024-03-11T03:00:51Z",
          "updated_at": "2024-03-20T17:08:35Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 12107188646,
      "node_id": "LE_lADOABII586BzodWzwAAAALRpQmm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12107188646",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-13T17:50:08Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU3ODg5ODA1OTk5ZWQzMTJhNWFmMTJhMmMwOGM1NDhjMTk0MDNiZDk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e7889805999ed312a5af12a2c08c548c19403bd9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e7889805999ed312a5af12a2c08c548c19403bd9",
      "tree": {
        "sha": "c32176a9084874b79dd67b0e7f17f21a82a796fb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c32176a9084874b79dd67b0e7f17f21a82a796fb"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree c32176a9084874b79dd67b0e7f17f21a82a796fb\nparent e1ce5b8ae9124717c00dca71a5c5b43a7f5ad177\nauthor Fabian Jahr <fjahr@protonmail.com> 1710029944 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1710412427 +0100\n\nrpc: Optimize serialization disk space of dumptxoutset\n\nCo-authored-by: Aurèle Oulès <aurele@oules.com>\nCo-authored-by: TheCharlatan <seb.kung@gmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmXy0osVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNbS0QAIr/b/4pkzzQ27bHCbHQXs/NX71n\nYMapXX9nnM9/USW8rQ6J0an3lpjEtigWx0wB6E+pxl/uiRrxzmUfUVzatEjRDewY\nK5jtNT8jWF2Ac6elb4BAq7nghDbdJ5wLwW5YMz5OMc++eGspm52sZ1CL91Pzt+Mv\nj7s2bDoBM77OFgrd5FT0o0audpZYoY2/uBKrfShkOeFfo90ImdAw2NA0upx8jngC\nfwPpbdpz7Zt4uuTkkFEQWR1c5It0S6sorh+R/ckdYHSGlGro6Bvl873aeCsA98Zx\nOrGpq1CIArb4mEDeXCNWDr87Wtk4qe+3qUlI4RUI6md8npgbRr+SVky0aCqpz8p3\nMCWpPmBRNBLcwQA6PEBqscIt/mCRcXFe62wjMWwupSqXst5NSNcW+KLTe+dJUXyj\numGg7qyJgvPj7UEgdJSFOxmyFrfDhD/Hb3U0kHv8LUYyqeH2IAozSdM+9I4Ub49j\n8E16nwft7ZKHTfI7VMZxxNVQcNMV/zcYsTjql/wH666Qc72b+o0cJMISGtifteIs\n0CKr8CqpLW20WoveyFvLECoL3JP6d+uCmFO+WFe0uAughTINg9WMJYuxzqHNH6PA\nvHHxUAyMpc9ii80IhNZVRcrpoyGfyDeMPzCs0+yyvbzHfsm888JBxBsQHxR/RATW\nZgVPx98EG8zbcQyn\n=AnLc\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e1ce5b8ae9124717c00dca71a5c5b43a7f5ad177",
          "sha": "e1ce5b8ae9124717c00dca71a5c5b43a7f5ad177",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e1ce5b8ae9124717c00dca71a5c5b43a7f5ad177"
        }
      ],
      "message": "rpc: Optimize serialization disk space of dumptxoutset\n\nCo-authored-by: Aurèle Oulès <aurele@oules.com>\nCo-authored-by: TheCharlatan <seb.kung@gmail.com>",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2024-03-14T10:33:47Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2024-03-10T00:19:04Z"
      },
      "sha": "e7889805999ed312a5af12a2c08c548c19403bd9"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12116139210,
      "node_id": "HRFPE_lADOABII586BzodWzwAAAALSLZzK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12116139210",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-14T10:39:05Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZhMmZiNzg5YjMyMjI5ODVhNmZkNjUxOWI3ZDgwZjY0NzRmYWQyMDk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa2fb789b3222985a6fd6519b7d80f6474fad209",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/fa2fb789b3222985a6fd6519b7d80f6474fad209",
      "tree": {
        "sha": "1adb1ef5be267a5019d0e50aed80912082d159cd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1adb1ef5be267a5019d0e50aed80912082d159cd"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 1adb1ef5be267a5019d0e50aed80912082d159cd\nparent e7889805999ed312a5af12a2c08c548c19403bd9\nauthor Fabian Jahr <fjahr@protonmail.com> 1710030018 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1710413140 +0100\n\nassumeutxo: Add test for changed coin size value\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmXy1VYVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNpL0QAJEPCfFfYYZBnKbSo9f3n/BhRvOH\n9Mj+nHjkIsmgQAExulcEsv8wsPBGZ1BIU+EHnXMz7oCA7qBlbERUt6D1ML1xXEcD\nU3xPgynTIP9crr+qCBi1wMlakq7jc0I2x8Sd5G7PQCA+5PCK4uCD0fS/VhcOuhe/\nkg6CV3ten+912tXmr0u7zG4hPHWmUFGK2whyfzjj5jyAfGK9AcSWqkxoEOBU1TqR\nU8IJJwc4YtNUg9JtAL46AgBZRi7Ha/ZDV3JjCILvI1F9xBuEWPcQOhaNYWSP1XEH\nKDIk0QYg3RDlvLelrbiweudVc/30Q+wyjJCP1PibFREkBKJmXBkv+24QHiDsVpkT\niKG+JXOMXobWYt/9BO4wDAH5Tg7x4Y2IT7D0nketKaODeRYWPZueTHKkim8j9JC0\nWMF2z+ehV9UNc7PLfmEp47V+SbowkWwMUuojQvarVPeUVjr/FdCc3VGnAJgBug5O\nxOcU2Cl3l48AmIE3mcscZn5ehgUTtAxKgaWj+ExVPAMvtnA/enyPzoGl73iOFCn1\nWYgs7P75ZadXQb/e8aOuuGT198z+Zqc88nLGYsAlaEwUZFGE19nEHXJjqZKYHTES\ndPJmDcBw4vSlznNdGQfafO5uMJoU48C+EX0x70+qaL3qweB8gqHoOTYYUo1jXn12\n3nPgX7Vgg3/nt+On\n=y+DK\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e7889805999ed312a5af12a2c08c548c19403bd9",
          "sha": "e7889805999ed312a5af12a2c08c548c19403bd9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e7889805999ed312a5af12a2c08c548c19403bd9"
        }
      ],
      "message": "assumeutxo: Add test for changed coin size value",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2024-03-14T10:45:40Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2024-03-10T00:20:18Z"
      },
      "sha": "fa2fb789b3222985a6fd6519b7d80f6474fad209"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12116219359,
      "node_id": "HRFPE_lADOABII586BzodWzwAAAALSLtXf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12116219359",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-14T10:45:48Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDcxZDQxZDUzNmJjMmY0N2EwMTRjODk4ODkxZDc3ZDU4NTAyYzk1NTQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/71d41d536bc2f47a014c898891d77d58502c9554",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/71d41d536bc2f47a014c898891d77d58502c9554",
      "tree": {
        "sha": "113eca4dd9c71cbcb9f2a49f04ba2bba7dc6fe86",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/113eca4dd9c71cbcb9f2a49f04ba2bba7dc6fe86"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 113eca4dd9c71cbcb9f2a49f04ba2bba7dc6fe86\nparent fa2fb789b3222985a6fd6519b7d80f6474fad209\nauthor Fabian Jahr <fjahr@protonmail.com> 1710083291 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1710413741 +0100\n\nassumeutxo: Add documentation on dumptxoutset serialization format\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmXy160VHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNBx4QAKD/ErVPpm2+F1avgFidjXonFpaU\njPU+skWSemDdR0GdS42eu7mWIGINvbwlDdH/JBRJO1eX85ImN78D2eBpjZ/wQrFX\nS/uS2uaL4IsQTC16QuJaLEMLQSVifyVkq/Mkf2f8rFaMW+3iXe2CKDRI6xpoCzEr\nsl93CyH3d0KKMudonT6ccNqTDv3l20K/yzPJkAAVPyAIG2TSqAuA53lXjpTg+88l\nGmx1hKnhZdhrKSk+e4KXVEgIXyvUzLkvdGugDd/zdZfJbsYUKl8lRJoSZbGbUY4k\nPx1RiEo2GkO5ynXCScgva4mxFBpgthWAoziQtcwES66pNKsBvxXHrPt+cC1uYIeb\n+1lIwazn+2n/Iajb6VZAw00pJ4xD+iNIvikMmyECNTzShpoC4H6wOKWya6dwXfy1\nOvj+C6ZR53sk98DpTtvw0hanKRDewEsFLr+WvDpYs6NGfAhtx2/l8XcwDI9DLm21\nHhU+i71QcqBZJ3k2qKxpUixtDzTPW4TihADE81q778zkUzh3NO7tuWF+HSGcXLFI\nhMsyMikcofYUAAnxgNWViCrcHQJMHb/03qm/VqoIaKTbN9Mz5V7dB8uqgYPDz7Mn\nE2adnoZlKqlNcDbnzHcS0Cl3lJi6v3G3B47L+cZlzNL/Pv0RwdWrRGND3A0Y3mV5\nxpBytxMKW12/atYb\n=SIkR\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa2fb789b3222985a6fd6519b7d80f6474fad209",
          "sha": "fa2fb789b3222985a6fd6519b7d80f6474fad209",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/fa2fb789b3222985a6fd6519b7d80f6474fad209"
        }
      ],
      "message": "assumeutxo: Add documentation on dumptxoutset serialization format",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2024-03-14T10:55:41Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2024-03-10T15:08:11Z"
      },
      "sha": "71d41d536bc2f47a014c898891d77d58502c9554"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12116343961,
      "node_id": "HRFPE_lADOABII586BzodWzwAAAALSMLyZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12116343961",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-14T10:55:47Z"
    },
    {
      "event": "unlabeled",
      "id": 12117622975,
      "node_id": "UNLE_lADOABII586BzodWzwAAAALSREC_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12117622975",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-14T12:39:22Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-14T13:08:25Z",
      "updated_at": "2024-03-14T13:08:25Z",
      "source": {
        "issue": {
          "id": 1657835564,
          "node_id": "PR_kwDOABII585NyjW8",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27432",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27432/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27432/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27432/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/27432",
          "number": 27432,
          "state": "open",
          "state_reason": null,
          "title": "contrib: add tool to convert compact-serialized UTXO set to SQLite database",
          "body": "(This PR is currently based on #29612, which should be reviewed first.)\r\n\r\n## Problem description\r\n\r\nThere is demand from users to get the UTXO set in form of a SQLite database (#24628). Bitcoin Core currently only supports dumping the UTXO set in a binary _compact-serialized_ format, which was crafted specifically for AssumeUTXO snapshots (see PR #16899), with the primary goal of being as compact as possible. Previous PRs tried to extend the `dumptxoutset` RPC with new formats, either in human-readable form (e.g. #18689, #24202), or most recently, directly as SQLite database (#24952). Both are not optimal: due to the huge size of the ever-growing UTXO set with already more than 80 million entries on mainnet, human-readable formats are practically useless, and very likely one of the first steps would be to put them in some form of database anyway. Directly adding SQLite3 dumping support on the other hand introduces an additional dependency to the non-wallet part of bitcoind and the risk of increased maintenance burden (see e.g. https://github.com/bitcoin/bitcoin/pull/24952#issuecomment-1163551060, https://github.com/bitcoin/bitcoin/issues/24628#issuecomment-1108469715).\r\n\r\n## Proposed solution\r\n\r\nThis PR follows the \"external tooling\" route by adding a simple Python script for achieving the same goal in a two-step process (first create compact-serialized UTXO set via `dumptxoutset`, then convert it to SQLite via the new script). Executive summary:\r\n- single file, no extra dependencies (sqlite3 is included in Python's standard library [1])\r\n- ~150 LOC, mostly deserialization/decompression routines ported from the Core codebase and (probably the most difficult part) a little elliptic curve / finite field math to decompress pubkeys (essentialy solving the secp256k1 curve equation y^2 = x^3 + 7 for y given x, respecting the proper polarity as indicated by the compression tag)\r\n- creates a database with only one table `utxos` with the following schema:\r\n  ```(txid TEXT, vout INT, value INT, coinbase INT, height INT, scriptpubkey TEXT)```\r\n- the resulting file has roughly 2x the size of the compact-serialized UTXO set (this is mostly due to encoding txids and scriptpubkeys as hex-strings rather than bytes)\r\n\r\n[1] note that there are some rare cases of operating systems like FreeBSD though, where the sqlite3 module has to installed explicitly (see #26819)\r\n\r\nA functional test is also added that creates UTXO set entries with various output script types (standard and also non-standard, for e.g. large scripts) and verifies that the UTXO sets of both formats match by comparing corresponding MuHashes. One MuHash is supplied by the bitcoind instance via `gettxoutsetinfo muhash`, the other is calculated in the test by reading back the created SQLite database entries and hashing them with the test framework's `MuHash3072` module.\r\n\r\n## Manual test instructions\r\nI'd suggest to do manual tests also by comparing MuHashes. For that, I've written a go tool some time ago which would calculate the MuHash of a sqlite database in the created format (I've tried to do a similar tool in Python, but it's painfully slow).\r\n```\r\n$ [run bitcoind instance with -coinstatsindex]\r\n$ ./src/bitcoin-cli dumptxoutset ~/utxos.dat\r\n$ ./src/bitcoin-cli gettxoutsetinfo muhash <block height returned in previous call>\r\n(outputs MuHash calculated from node)\r\n\r\n$ ./contrib/utxo-tools/utxo_to_sqlite.py ~/utxos.dat ~/utxos.sqlite\r\n$ git clone https://github.com/theStack/utxo_dump_tools\r\n$ cd utxo_dump_tools/calc_utxo_hash\r\n$ go run calc_utxo_hash.go ~/utxos.sqlite\r\n(outputs MuHash calculated from the SQLite UTXO set)\r\n\r\n=> verify that both MuHashes are equal\r\n```\r\nFor a demonstration what can be done with the resulting database, see https://github.com/bitcoin/bitcoin/pull/24952#pullrequestreview-956290477 for some example queries. Thanks go to LarryRuane who gave me to the idea of rewriting this script in Python and adding it to `contrib`.",
          "user": {
            "login": "theStack",
            "id": 91535,
            "node_id": "MDQ6VXNlcjkxNTM1",
            "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/theStack",
            "html_url": "https://github.com/theStack",
            "followers_url": "https://api.github.com/users/theStack/followers",
            "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
            "organizations_url": "https://api.github.com/users/theStack/orgs",
            "repos_url": "https://api.github.com/users/theStack/repos",
            "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/theStack/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 231994551,
              "node_id": "MDU6TGFiZWwyMzE5OTQ1NTE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Scripts%20and%20tools",
              "name": "Scripts and tools",
              "color": "ffffee",
              "default": false
            },
            {
              "id": 5334691551,
              "node_id": "LA_kwDOABII588AAAABPfju3w",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
              "name": "CI failed",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 12,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27432",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/27432",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/27432.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/27432.patch"
          },
          "created_at": "2023-04-06T17:59:23Z",
          "updated_at": "2024-04-01T18:06:44Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-19T10:42:06Z",
      "updated_at": "2024-03-19T10:42:06Z",
      "source": {
        "issue": {
          "id": 2115277897,
          "node_id": "PR_kwDOABII585l2bR0",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29370",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29370/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29370/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29370/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29370",
          "number": 29370,
          "state": "closed",
          "state_reason": null,
          "title": "assumeutxo: Get rid of faked nTx and nChainTx values",
          "body": "The `PopulateAndValidateSnapshot` function introduced in f6e2da5fb7c6406c37612c838c998078ea8d2252 from #19806 has been setting fake `nTx` and `nChainTx` values that can show up in RPC results (https://github.com/bitcoin/bitcoin/issues/29328) and make `CBlockIndex` state hard to reason about, because it is difficult to know whether the values are real or fake.\r\n\r\nRevert to previous behavior of setting `nTx` and `nChainTx` to 0 when the values are unknown, instead of faking them. Also drop no-longer needed `BLOCK_ASSUMED_VALID` flag.\r\n\r\nDropping the faked values also fixes assert failures in the `CheckBlockIndex` `(pindex->nChainTx == pindex->nTx + prev_chain_tx)` check that could happen previously if forked or out-of-order blocks before the snapshot got submitted while the snapshot was being validated. The PR includes two commits adding tests for these failures and describing them in detail.\r\n\r\nCompatibility note: This change could cause new `-checkblockindex` failures if a snapshot was loaded by a previous version of Bitcoin Core and not fully validated, because fake `nTx` values will have been saved to the block index. It would be pretty easy to avoid these failures by adding some compatibility code to `LoadBlockIndex` and changing `nTx` values from 1 to 0 when they are fake (when `(pindex->nStatus & BLOCK_VALID_MASK) < BLOCK_VALID_TRANSACTIONS`), but a little simpler not to worry about being compatible in this case.",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignee": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "assignees": [
            {
              "login": "achow101",
              "id": 3782274,
              "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
              "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/achow101",
              "html_url": "https://github.com/achow101",
              "followers_url": "https://api.github.com/users/achow101/followers",
              "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
              "organizations_url": "https://api.github.com/users/achow101/orgs",
              "repos_url": "https://api.github.com/users/achow101/repos",
              "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/achow101/received_events",
              "type": "User",
              "site_admin": false
            }
          ],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 27,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29370",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29370",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29370.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29370.patch"
          },
          "closed_at": "2024-03-20T16:56:58Z",
          "created_at": "2024-02-02T16:18:52Z",
          "updated_at": "2024-03-20T19:11:16Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 1949165312,
      "node_id": "PRR_kwDOABII5850LecA",
      "url": null,
      "actor": null,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Re-ACK 71d41d536bc2f47a014c898891d77d58502c9554",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#pullrequestreview-1949165312",
      "submitted_at": "2024-03-20T15:03:22Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
    },
    {
      "event": "review_requested",
      "id": 12186353384,
      "node_id": "RRE_lADOABII586BzodWzwAAAALWXP7o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12186353384",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-20T15:03:25Z",
      "requested_reviewer": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "comment_deleted",
      "id": 12201457844,
      "node_id": "CDE_lADOABII586BzodWzwAAAALXQ3i0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12201457844",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-21T14:09:45Z"
    },
    {
      "event": "reviewed",
      "id": 1958238106,
      "node_id": "PRR_kwDOABII5850uFea",
      "url": null,
      "actor": null,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#pullrequestreview-1958238106",
      "submitted_at": "2024-03-25T16:40:19Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
    },
    {
      "event": "reviewed",
      "id": 1964816329,
      "node_id": "PRR_kwDOABII5851HLfJ",
      "url": null,
      "actor": null,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Light ACK 71d41d536bc2f47a014c898891d77d58502c9554\r\n\r\nI tested this on signet and it worked well, but I'm not very familiar with our serialization code.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#pullrequestreview-1964816329",
      "submitted_at": "2024-03-27T21:43:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
    },
    {
      "event": "review_requested",
      "id": 12273565386,
      "node_id": "RRE_lADOABII586BzodWzwAAAALbj77K",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12273565386",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-27T21:43:11Z",
      "requested_reviewer": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "review_requested",
      "id": 12273569941,
      "node_id": "RRE_lADOABII586BzodWzwAAAALbj9CV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12273569941",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-27T21:43:44Z",
      "requested_reviewer": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      }
    },
    {
      "event": "reviewed",
      "id": 1970409202,
      "node_id": "PRR_kwDOABII5851cg7y",
      "url": null,
      "actor": null,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code-review ACK 71d41d536bc2f47a014c898891d77d58502c9554\r\n\r\n(Fwiw, I rebased #27432 on this PR and adapted the utxo-to-sqlite3 tool to the new serialization format.)",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#pullrequestreview-1970409202",
      "submitted_at": "2024-03-31T21:35:26Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
    },
    {
      "event": "commented",
      "id": 2031653725,
      "node_id": "IC_kwDOABII5855GJNd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2031653725",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-02T10:35:47Z",
      "updated_at": "2024-04-02T10:35:47Z",
      "author_association": "MEMBER",
      "body": "re-utACK 71d41d536bc2f47a014c898891d77d58502c9554\r\n\r\nOnly test (rebase) and documentation changes since my last review.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#issuecomment-2031653725",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29612"
    },
    {
      "event": "commented",
      "id": 2032041436,
      "node_id": "IC_kwDOABII5855Hn3c",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2032041436",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-02T13:26:54Z",
      "updated_at": "2024-04-02T13:28:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks all for the review, unless I have to retouch (I hope not since this has collected 4 ACKs) I will address the open comments in a follow-up.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#issuecomment-2032041436",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29612"
    },
    {
      "event": "reviewed",
      "id": 1974818797,
      "node_id": "PRR_kwDOABII5851tVft",
      "url": null,
      "actor": null,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "`dumptxoutset` is a RPC that has been available for several releases, including those prior to the completion of assumeutxo validation code. Changing the format now is a breaking change - utxo sets dumped prior to the PR are incompatible with any version with this PR merged, and utxo sets dumped after this PR are incompatible with all prior versions.\r\n\r\nConceivably, in the future, someone could run an older node and create a utxo set snapshot to setup a new node with more recent software. This would then fail as the formats are incompatible. Currently the failure does not provide much detail on what actually went wrong. The RPC error is just \"Unable to load UTXO snapshot\" while the log does say \"bad snapshot format or truncated snapshot after deserializing 0 coins\". However that is not an indication of a version incompatibility, and I think it would be better if the new format could include a version number so that this could be properly reported.\r\n\r\nHaving a version number would also make it easy to distinguish which snapshot format to deserialize as so we can avoid these kinds of errors. We could detect which format was used for serialization and proceed to deserialize as necessary.\r\n\r\nThe reverse is also a possibility - a new node creates a snapshot with the new format and tries to load it into older software, but this seems unlikely to actually happen. But, it would also be trivial to add an option that allows for serializing in the old format for those that need it.\r\n\r\nI think this also needs a release note about the format change as utxo set snapshots are useful for more than just snapshot loading.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#pullrequestreview-1974818797",
      "submitted_at": "2024-04-02T20:08:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
    },
    {
      "event": "commented",
      "id": 2033794015,
      "node_id": "IC_kwDOABII5855OTvf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2033794015",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-03T07:46:08Z",
      "updated_at": "2024-04-03T07:46:08Z",
      "author_association": "MEMBER",
      "body": "> I think it would be better if the new format could include a version number so that this could be properly reported.\r\n\r\nThis seems useful in general.\r\n\r\n> We could detect which format was used for serialization and proceed to deserialize as necessary.\r\n\r\nYes, but I don't think we need to support the format from before this PR - once we have the mainnet params, the instruction could simply be to use v28.0 or newer to generate the snapshot.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#issuecomment-2033794015",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29612"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1522639723",
      "pull_request_review_id": 1933303632,
      "id": 1522639723,
      "node_id": "PRRC_kwDOABII585awaNr",
      "diff_hunk": "@@ -2669,21 +2670,49 @@ UniValue CreateUTXOSnapshot(\n \n     afile << metadata;\n \n+    std::map<uint256, std::vector<std::pair<uint32_t, Coin>>> mapCoins;\n     COutPoint key;\n+    uint256 last_hash;\n     Coin coin;\n     unsigned int iter{0};\n+    std::vector<std::pair<uint32_t, Coin>> coins;\n+\n+    // To reduce space the serialization format of the snapshot avoids\n+    // dublication of tx hashes. The code takes advantage of the guarantee by",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: s/dublication/duplication/ (same in validation.h)",
      "created_at": "2024-03-13T07:08:06Z",
      "updated_at": "2024-03-13T07:49:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1522639723",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1522639723"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2705,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1522640424",
      "pull_request_review_id": 1933303632,
      "id": 1522640424,
      "node_id": "PRRC_kwDOABII585awaYo",
      "diff_hunk": "@@ -2669,21 +2670,49 @@ UniValue CreateUTXOSnapshot(\n \n     afile << metadata;\n \n+    std::map<uint256, std::vector<std::pair<uint32_t, Coin>>> mapCoins;\n     COutPoint key;\n+    uint256 last_hash;\n     Coin coin;\n     unsigned int iter{0};\n+    std::vector<std::pair<uint32_t, Coin>> coins;\n+\n+    // To reduce space the serialization format of the snapshot avoids\n+    // dublication of tx hashes. The code takes advantage of the guarantee by\n+    // leveldb that keys are lexicographically sorted.\n+    // In the coins vector we collect all coins that belong to a certain tx hash\n+    // (key.hash) and when we have them all (key.hash != last_hash) we write\n+    // them to file using the below lamda function.",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: s/lamda/lambda/",
      "created_at": "2024-03-13T07:08:42Z",
      "updated_at": "2024-03-13T07:49:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1522640424",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1522640424"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2709,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1522668381",
      "pull_request_review_id": 1933303632,
      "id": 1522668381,
      "node_id": "PRRC_kwDOABII585awhNd",
      "diff_hunk": "@@ -2669,21 +2670,49 @@ UniValue CreateUTXOSnapshot(\n \n     afile << metadata;\n \n+    std::map<uint256, std::vector<std::pair<uint32_t, Coin>>> mapCoins;\n     COutPoint key;\n+    uint256 last_hash;\n     Coin coin;\n     unsigned int iter{0};\n+    std::vector<std::pair<uint32_t, Coin>> coins;\n+\n+    // To reduce space the serialization format of the snapshot avoids",
      "path": "src/rpc/blockchain.cpp",
      "position": 19,
      "original_position": 19,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: Might it be useful to add a small diagram of the format to the `dumptxoutset` help output?",
      "created_at": "2024-03-13T07:31:54Z",
      "updated_at": "2024-03-13T07:49:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1522668381",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1522668381"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2704,
      "original_line": 2704,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1522686216",
      "pull_request_review_id": 1933303632,
      "id": 1522686216,
      "node_id": "PRRC_kwDOABII585awlkI",
      "diff_hunk": "@@ -98,12 +98,16 @@ def expected_error(log_msg=\"\", rpc_details=\"\"):\n                 f.write(valid_snapshot_contents[32 + 8:])\n             expected_error(log_msg=f\"bad snapshot - coins left over after deserializing 298 coins\" if off == -1 else f\"bad snapshot format or truncated snapshot after deserializing 299 coins\")\n \n-        self.log.info(\"  - snapshot file with alternated UTXO data\")\n+\n+        self.log.info(\"  - snapshot file with alternated but parsable UTXO data results in different hash\")\n         cases = [\n             [b\"\\xff\" * 32, 0, \"7d52155c9a9fdc4525b637ef6170568e5dad6fabd0b1fdbb9432010b8453095b\"],  # wrong outpoint hash\n-            [(1).to_bytes(4, \"little\"), 32, \"9f4d897031ab8547665b4153317ae2fdbf0130c7840b66427ebc48b881cb80ad\"],  # wrong outpoint index\n-            [b\"\\x81\", 36, \"3da966ba9826fb6d2604260e01607b55ba44e1a5de298606b08704bc62570ea8\"],  # wrong coin code VARINT((coinbase ? 1 : 0) | (height << 1))\n-            [b\"\\x80\", 36, \"091e893b3ccb4334378709578025356c8bcb0a623f37c7c4e493133c988648e5\"],  # another wrong coin code\n+            # The coin size byte is skipped here and its manipulation is tested\n+            # below because this will always cause parsing to fail, resulting in\n+            # and error that is not a mismatch of the expected hash.",
      "path": "test/functional/feature_assumeutxo.py",
      "position": null,
      "original_position": 14,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nit: I'm a bit confused about this sentence. Is this supposed to be `resulting in an error`?",
      "created_at": "2024-03-13T07:46:53Z",
      "updated_at": "2024-03-13T07:49:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1522686216",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1522686216"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 107,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523212386",
      "pull_request_review_id": 1934110716,
      "id": 1523212386,
      "node_id": "PRRC_kwDOABII585aymBi",
      "diff_hunk": "@@ -98,12 +98,16 @@ def expected_error(log_msg=\"\", rpc_details=\"\"):\n                 f.write(valid_snapshot_contents[32 + 8:])\n             expected_error(log_msg=f\"bad snapshot - coins left over after deserializing 298 coins\" if off == -1 else f\"bad snapshot format or truncated snapshot after deserializing 299 coins\")\n \n-        self.log.info(\"  - snapshot file with alternated UTXO data\")\n+\n+        self.log.info(\"  - snapshot file with alternated but parsable UTXO data results in different hash\")\n         cases = [\n             [b\"\\xff\" * 32, 0, \"7d52155c9a9fdc4525b637ef6170568e5dad6fabd0b1fdbb9432010b8453095b\"],  # wrong outpoint hash\n-            [(1).to_bytes(4, \"little\"), 32, \"9f4d897031ab8547665b4153317ae2fdbf0130c7840b66427ebc48b881cb80ad\"],  # wrong outpoint index\n-            [b\"\\x81\", 36, \"3da966ba9826fb6d2604260e01607b55ba44e1a5de298606b08704bc62570ea8\"],  # wrong coin code VARINT((coinbase ? 1 : 0) | (height << 1))\n-            [b\"\\x80\", 36, \"091e893b3ccb4334378709578025356c8bcb0a623f37c7c4e493133c988648e5\"],  # another wrong coin code\n+            # The coin size byte is skipped here and its manipulation is tested\n+            # below because this will always cause parsing to fail, resulting in\n+            # and error that is not a mismatch of the expected hash.",
      "path": "test/functional/feature_assumeutxo.py",
      "position": null,
      "original_position": 14,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": 1522686216,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "yepp, `in an error` would be right",
      "created_at": "2024-03-13T12:57:07Z",
      "updated_at": "2024-03-13T12:57:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1523212386",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523212386"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 107,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523213780",
      "pull_request_review_id": 1934112786,
      "id": 1523213780,
      "node_id": "PRRC_kwDOABII585aymXU",
      "diff_hunk": "@@ -98,12 +98,16 @@ def expected_error(log_msg=\"\", rpc_details=\"\"):\n                 f.write(valid_snapshot_contents[32 + 8:])\n             expected_error(log_msg=f\"bad snapshot - coins left over after deserializing 298 coins\" if off == -1 else f\"bad snapshot format or truncated snapshot after deserializing 299 coins\")\n \n-        self.log.info(\"  - snapshot file with alternated UTXO data\")\n+\n+        self.log.info(\"  - snapshot file with alternated but parsable UTXO data results in different hash\")\n         cases = [\n             [b\"\\xff\" * 32, 0, \"7d52155c9a9fdc4525b637ef6170568e5dad6fabd0b1fdbb9432010b8453095b\"],  # wrong outpoint hash\n-            [(1).to_bytes(4, \"little\"), 32, \"9f4d897031ab8547665b4153317ae2fdbf0130c7840b66427ebc48b881cb80ad\"],  # wrong outpoint index\n-            [b\"\\x81\", 36, \"3da966ba9826fb6d2604260e01607b55ba44e1a5de298606b08704bc62570ea8\"],  # wrong coin code VARINT((coinbase ? 1 : 0) | (height << 1))\n-            [b\"\\x80\", 36, \"091e893b3ccb4334378709578025356c8bcb0a623f37c7c4e493133c988648e5\"],  # another wrong coin code\n+            # The coin size byte is skipped here and its manipulation is tested\n+            # below because this will always cause parsing to fail, resulting in\n+            # and error that is not a mismatch of the expected hash.",
      "path": "test/functional/feature_assumeutxo.py",
      "position": null,
      "original_position": 14,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": 1522686216,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Do you think it is clear otherwise?",
      "created_at": "2024-03-13T12:58:06Z",
      "updated_at": "2024-03-13T12:58:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1523213780",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523213780"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 107,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523214777",
      "pull_request_review_id": 1934114212,
      "id": 1523214777,
      "node_id": "PRRC_kwDOABII585aymm5",
      "diff_hunk": "@@ -2669,21 +2670,49 @@ UniValue CreateUTXOSnapshot(\n \n     afile << metadata;\n \n+    std::map<uint256, std::vector<std::pair<uint32_t, Coin>>> mapCoins;\n     COutPoint key;\n+    uint256 last_hash;\n     Coin coin;\n     unsigned int iter{0};\n+    std::vector<std::pair<uint32_t, Coin>> coins;\n+\n+    // To reduce space the serialization format of the snapshot avoids\n+    // dublication of tx hashes. The code takes advantage of the guarantee by",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": 1522639723,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "That is my favorite typo, can't get enough of it ;D",
      "created_at": "2024-03-13T12:58:44Z",
      "updated_at": "2024-03-13T12:58:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1523214777",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523214777"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2705,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523218768",
      "pull_request_review_id": 1934120132,
      "id": 1523218768,
      "node_id": "PRRC_kwDOABII585aynlQ",
      "diff_hunk": "@@ -2669,21 +2670,49 @@ UniValue CreateUTXOSnapshot(\n \n     afile << metadata;\n \n+    std::map<uint256, std::vector<std::pair<uint32_t, Coin>>> mapCoins;\n     COutPoint key;\n+    uint256 last_hash;\n     Coin coin;\n     unsigned int iter{0};\n+    std::vector<std::pair<uint32_t, Coin>> coins;\n+\n+    // To reduce space the serialization format of the snapshot avoids",
      "path": "src/rpc/blockchain.cpp",
      "position": 19,
      "original_position": 19,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": 1522668381,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Sounds good, will think about what that could look like if I have to retouch or in the follow-up.",
      "created_at": "2024-03-13T13:01:14Z",
      "updated_at": "2024-03-13T13:01:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1523218768",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523218768"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2704,
      "original_line": 2704,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523235029",
      "pull_request_review_id": 1934144374,
      "id": 1523235029,
      "node_id": "PRRC_kwDOABII585ayrjV",
      "diff_hunk": "@@ -98,12 +98,16 @@ def expected_error(log_msg=\"\", rpc_details=\"\"):\n                 f.write(valid_snapshot_contents[32 + 8:])\n             expected_error(log_msg=f\"bad snapshot - coins left over after deserializing 298 coins\" if off == -1 else f\"bad snapshot format or truncated snapshot after deserializing 299 coins\")\n \n-        self.log.info(\"  - snapshot file with alternated UTXO data\")\n+\n+        self.log.info(\"  - snapshot file with alternated but parsable UTXO data results in different hash\")\n         cases = [\n             [b\"\\xff\" * 32, 0, \"7d52155c9a9fdc4525b637ef6170568e5dad6fabd0b1fdbb9432010b8453095b\"],  # wrong outpoint hash\n-            [(1).to_bytes(4, \"little\"), 32, \"9f4d897031ab8547665b4153317ae2fdbf0130c7840b66427ebc48b881cb80ad\"],  # wrong outpoint index\n-            [b\"\\x81\", 36, \"3da966ba9826fb6d2604260e01607b55ba44e1a5de298606b08704bc62570ea8\"],  # wrong coin code VARINT((coinbase ? 1 : 0) | (height << 1))\n-            [b\"\\x80\", 36, \"091e893b3ccb4334378709578025356c8bcb0a623f37c7c4e493133c988648e5\"],  # another wrong coin code\n+            # The coin size byte is skipped here and its manipulation is tested\n+            # below because this will always cause parsing to fail, resulting in\n+            # and error that is not a mismatch of the expected hash.",
      "path": "test/functional/feature_assumeutxo.py",
      "position": null,
      "original_position": 14,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": 1522686216,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Could be a bit clearer I guess, but I don't have a suggestion :P.",
      "created_at": "2024-03-13T13:11:39Z",
      "updated_at": "2024-03-13T13:11:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1523235029",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1523235029"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 107,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1524646529",
      "pull_request_review_id": 1936340686,
      "id": 1524646529,
      "node_id": "PRRC_kwDOABII585a4EKB",
      "diff_hunk": "@@ -2669,21 +2670,49 @@ UniValue CreateUTXOSnapshot(\n \n     afile << metadata;\n \n+    std::map<uint256, std::vector<std::pair<uint32_t, Coin>>> mapCoins;\n     COutPoint key;\n+    uint256 last_hash;\n     Coin coin;\n     unsigned int iter{0};\n+    std::vector<std::pair<uint32_t, Coin>> coins;\n+\n+    // To reduce space the serialization format of the snapshot avoids",
      "path": "src/rpc/blockchain.cpp",
      "position": 19,
      "original_position": 19,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": 1522668381,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I spent some time thinking about a diagram that would work but I wasn't very happy what I could come up with. I instead copied the expression used in the issue. It shows the format in a concise way that I find understandable: `list(Txid, list((vout,Coin))`. Let me know what you think.",
      "created_at": "2024-03-14T10:58:46Z",
      "updated_at": "2024-03-14T10:58:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1524646529",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1524646529"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2704,
      "original_line": 2704,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1524646629",
      "pull_request_review_id": 1936340970,
      "id": 1524646629,
      "node_id": "PRRC_kwDOABII585a4ELl",
      "diff_hunk": "@@ -2669,21 +2670,49 @@ UniValue CreateUTXOSnapshot(\n \n     afile << metadata;\n \n+    std::map<uint256, std::vector<std::pair<uint32_t, Coin>>> mapCoins;\n     COutPoint key;\n+    uint256 last_hash;\n     Coin coin;\n     unsigned int iter{0};\n+    std::vector<std::pair<uint32_t, Coin>> coins;\n+\n+    // To reduce space the serialization format of the snapshot avoids\n+    // dublication of tx hashes. The code takes advantage of the guarantee by\n+    // leveldb that keys are lexicographically sorted.\n+    // In the coins vector we collect all coins that belong to a certain tx hash\n+    // (key.hash) and when we have them all (key.hash != last_hash) we write\n+    // them to file using the below lamda function.",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": 1522640424,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "fixed",
      "created_at": "2024-03-14T10:58:51Z",
      "updated_at": "2024-03-14T10:58:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1524646629",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1524646629"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2709,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1524646720",
      "pull_request_review_id": 1936341199,
      "id": 1524646720,
      "node_id": "PRRC_kwDOABII585a4ENA",
      "diff_hunk": "@@ -2669,21 +2670,49 @@ UniValue CreateUTXOSnapshot(\n \n     afile << metadata;\n \n+    std::map<uint256, std::vector<std::pair<uint32_t, Coin>>> mapCoins;\n     COutPoint key;\n+    uint256 last_hash;\n     Coin coin;\n     unsigned int iter{0};\n+    std::vector<std::pair<uint32_t, Coin>> coins;\n+\n+    // To reduce space the serialization format of the snapshot avoids\n+    // dublication of tx hashes. The code takes advantage of the guarantee by",
      "path": "src/rpc/blockchain.cpp",
      "position": null,
      "original_position": 20,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": 1522639723,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "fixed",
      "created_at": "2024-03-14T10:58:55Z",
      "updated_at": "2024-03-14T10:58:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1524646720",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1524646720"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2705,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1524646866",
      "pull_request_review_id": 1936341500,
      "id": 1524646866,
      "node_id": "PRRC_kwDOABII585a4EPS",
      "diff_hunk": "@@ -98,12 +98,16 @@ def expected_error(log_msg=\"\", rpc_details=\"\"):\n                 f.write(valid_snapshot_contents[32 + 8:])\n             expected_error(log_msg=f\"bad snapshot - coins left over after deserializing 298 coins\" if off == -1 else f\"bad snapshot format or truncated snapshot after deserializing 299 coins\")\n \n-        self.log.info(\"  - snapshot file with alternated UTXO data\")\n+\n+        self.log.info(\"  - snapshot file with alternated but parsable UTXO data results in different hash\")\n         cases = [\n             [b\"\\xff\" * 32, 0, \"7d52155c9a9fdc4525b637ef6170568e5dad6fabd0b1fdbb9432010b8453095b\"],  # wrong outpoint hash\n-            [(1).to_bytes(4, \"little\"), 32, \"9f4d897031ab8547665b4153317ae2fdbf0130c7840b66427ebc48b881cb80ad\"],  # wrong outpoint index\n-            [b\"\\x81\", 36, \"3da966ba9826fb6d2604260e01607b55ba44e1a5de298606b08704bc62570ea8\"],  # wrong coin code VARINT((coinbase ? 1 : 0) | (height << 1))\n-            [b\"\\x80\", 36, \"091e893b3ccb4334378709578025356c8bcb0a623f37c7c4e493133c988648e5\"],  # another wrong coin code\n+            # The coin size byte is skipped here and its manipulation is tested\n+            # below because this will always cause parsing to fail, resulting in\n+            # and error that is not a mismatch of the expected hash.",
      "path": "test/functional/feature_assumeutxo.py",
      "position": null,
      "original_position": 14,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": 1522686216,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed and tried a different wording to make it more clear",
      "created_at": "2024-03-14T10:59:03Z",
      "updated_at": "2024-03-14T10:59:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1524646866",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1524646866"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 107,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1532248178",
      "pull_request_review_id": 1949164408,
      "id": 1532248178,
      "node_id": "PRRC_kwDOABII585bVEBy",
      "diff_hunk": "@@ -2669,21 +2670,49 @@ UniValue CreateUTXOSnapshot(\n \n     afile << metadata;\n \n+    std::map<uint256, std::vector<std::pair<uint32_t, Coin>>> mapCoins;\n     COutPoint key;\n+    uint256 last_hash;\n     Coin coin;\n     unsigned int iter{0};\n+    std::vector<std::pair<uint32_t, Coin>> coins;\n+\n+    // To reduce space the serialization format of the snapshot avoids",
      "path": "src/rpc/blockchain.cpp",
      "position": 19,
      "original_position": 19,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": 1522668381,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Maybe also add the size of the coins list `list(Txid, number_of_coins, list((vout,Coin)))`?",
      "created_at": "2024-03-20T15:03:03Z",
      "updated_at": "2024-03-20T15:03:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1532248178",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1532248178"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2704,
      "original_line": 2704,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1532311296",
      "pull_request_review_id": 1949270269,
      "id": 1532311296,
      "node_id": "PRRC_kwDOABII585bVTcA",
      "diff_hunk": "@@ -2669,21 +2670,49 @@ UniValue CreateUTXOSnapshot(\n \n     afile << metadata;\n \n+    std::map<uint256, std::vector<std::pair<uint32_t, Coin>>> mapCoins;\n     COutPoint key;\n+    uint256 last_hash;\n     Coin coin;\n     unsigned int iter{0};\n+    std::vector<std::pair<uint32_t, Coin>> coins;\n+\n+    // To reduce space the serialization format of the snapshot avoids",
      "path": "src/rpc/blockchain.cpp",
      "position": 19,
      "original_position": 19,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "923ec9043af668f3a342422d32c1c28d29018ed0",
      "in_reply_to_id": 1522668381,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I will add this if I have to retouch, but if not I can do this as a follow-up in one of my other assumeutxo PRs.",
      "created_at": "2024-03-20T15:33:15Z",
      "updated_at": "2024-03-20T15:33:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1532311296",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1532311296"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2704,
      "original_line": 2704,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1537892135",
      "pull_request_review_id": 1958238106,
      "id": 1537892135,
      "node_id": "PRRC_kwDOABII585bql8n",
      "diff_hunk": "@@ -2693,21 +2694,42 @@ UniValue CreateUTXOSnapshot(\n \n     afile << metadata;\n \n+    std::map<uint256, std::vector<std::pair<uint32_t, Coin>>> mapCoins;\n     COutPoint key;\n+    uint256 last_hash;",
      "path": "src/rpc/blockchain.cpp",
      "position": 14,
      "original_position": 14,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "e7889805999ed312a5af12a2c08c548c19403bd9",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit, if you retouch: slightly clearer imho, that's the type and naming also used in the snapshot loading routine (`ChainstateManager::PopulateAndValidateSnapshot`)\r\n```suggestion\r\n    Txid last_txid;\r\n```",
      "created_at": "2024-03-25T16:37:41Z",
      "updated_at": "2024-03-25T16:40:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1537892135",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1537892135"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2699,
      "original_line": 2699,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1542076565",
      "pull_request_review_id": 1964816329,
      "id": 1542076565,
      "node_id": "PRRC_kwDOABII585b6jiV",
      "diff_hunk": "@@ -2693,21 +2694,42 @@ UniValue CreateUTXOSnapshot(\n \n     afile << metadata;\n \n+    std::map<uint256, std::vector<std::pair<uint32_t, Coin>>> mapCoins;\n     COutPoint key;\n+    uint256 last_hash;\n     Coin coin;\n     unsigned int iter{0};\n+    std::vector<std::pair<uint32_t, Coin>> coins;\n \n+    auto write_coins_to_file = [&](AutoFile& afile, const uint256& last_hash, const std::vector<std::pair<uint32_t, Coin>>& coins) {\n+        afile << last_hash;\n+        WriteCompactSize(afile, coins.size());\n+        for (auto [n, coin] : coins) {\n+            WriteCompactSize(afile, n);\n+            afile << coin;\n+        }\n+    };\n+\n+    pcursor->GetKey(key);\n+    last_hash = key.hash;\n     while (pcursor->Valid()) {\n         if (iter % 5000 == 0) node.rpc_interruption_point();\n         ++iter;\n         if (pcursor->GetKey(key) && pcursor->GetValue(coin)) {\n-            afile << key;\n-            afile << coin;\n+            if (key.hash != last_hash) {\n+                write_coins_to_file(afile, last_hash, coins);\n+                last_hash = key.hash;\n+                coins.clear();\n+            }\n+            coins.emplace_back(key.n, coin);",
      "path": "src/rpc/blockchain.cpp",
      "position": 48,
      "original_position": 41,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "e7889805999ed312a5af12a2c08c548c19403bd9",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "slightly unrelated nit: might be useful to assert that we actually wrote the right number of coins (we just take `maybe_stats->coins_count` and wouldn't abort if the actual number of coins written was different becaus the db changed for some reason). I'm sure https://github.com/bitcoin/bitcoin/pull/15606#discussion_r274479369 is correct, but checking it explicitly seems better.",
      "created_at": "2024-03-27T21:35:26Z",
      "updated_at": "2024-03-27T21:43:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1542076565",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1542076565"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2731,
      "original_line": 2724,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545804370",
      "pull_request_review_id": 1970409202,
      "id": 1545804370,
      "node_id": "PRRC_kwDOABII585cIxpS",
      "diff_hunk": "@@ -5564,69 +5564,81 @@ bool ChainstateManager::PopulateAndValidateSnapshot(\n         return false;\n     }\n \n-    COutPoint outpoint;\n-    Coin coin;\n     const uint64_t coins_count = metadata.m_coins_count;\n     uint64_t coins_left = metadata.m_coins_count;\n \n-    LogPrintf(\"[snapshot] loading coins from snapshot %s\\n\", base_blockhash.ToString());\n+    LogPrintf(\"[snapshot] loading %d coins from snapshot %s\\n\", coins_left, base_blockhash.ToString());\n     int64_t coins_processed{0};\n \n     while (coins_left > 0) {\n         try {\n-            coins_file >> outpoint;\n-            coins_file >> coin;\n-        } catch (const std::ios_base::failure&) {\n-            LogPrintf(\"[snapshot] bad snapshot format or truncated snapshot after deserializing %d coins\\n\",\n-                      coins_count - coins_left);\n-            return false;\n-        }\n-        if (coin.nHeight > base_height ||\n-            outpoint.n >= std::numeric_limits<decltype(outpoint.n)>::max() // Avoid integer wrap-around in coinstats.cpp:ApplyHash\n-        ) {\n-            LogPrintf(\"[snapshot] bad snapshot data after deserializing %d coins\\n\",\n-                      coins_count - coins_left);\n-            return false;\n-        }\n-        if (!MoneyRange(coin.out.nValue)) {\n-            LogPrintf(\"[snapshot] bad snapshot data after deserializing %d coins - bad tx out value\\n\",\n-                      coins_count - coins_left);\n-            return false;\n-        }\n+            Txid txid;\n+            coins_file >> txid;\n+            size_t size{0};\n+            size = ReadCompactSize(coins_file);\n+\n+            if(size > coins_left) {",
      "path": "src/validation.cpp",
      "position": 39,
      "original_position": 39,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "e7889805999ed312a5af12a2c08c548c19403bd9",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "spacing nit:\r\n```suggestion\r\n            if (size > coins_left) {\r\n```",
      "created_at": "2024-03-31T21:24:11Z",
      "updated_at": "2024-03-31T21:35:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1545804370",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545804370"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 5580,
      "original_line": 5580,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545804948",
      "pull_request_review_id": 1970409202,
      "id": 1545804948,
      "node_id": "PRRC_kwDOABII585cIxyU",
      "diff_hunk": "@@ -5564,69 +5564,81 @@ bool ChainstateManager::PopulateAndValidateSnapshot(\n         return false;\n     }\n \n-    COutPoint outpoint;\n-    Coin coin;\n     const uint64_t coins_count = metadata.m_coins_count;\n     uint64_t coins_left = metadata.m_coins_count;\n \n-    LogPrintf(\"[snapshot] loading coins from snapshot %s\\n\", base_blockhash.ToString());\n+    LogPrintf(\"[snapshot] loading %d coins from snapshot %s\\n\", coins_left, base_blockhash.ToString());\n     int64_t coins_processed{0};\n \n     while (coins_left > 0) {\n         try {\n-            coins_file >> outpoint;\n-            coins_file >> coin;\n-        } catch (const std::ios_base::failure&) {\n-            LogPrintf(\"[snapshot] bad snapshot format or truncated snapshot after deserializing %d coins\\n\",\n-                      coins_count - coins_left);\n-            return false;\n-        }\n-        if (coin.nHeight > base_height ||\n-            outpoint.n >= std::numeric_limits<decltype(outpoint.n)>::max() // Avoid integer wrap-around in coinstats.cpp:ApplyHash\n-        ) {\n-            LogPrintf(\"[snapshot] bad snapshot data after deserializing %d coins\\n\",\n-                      coins_count - coins_left);\n-            return false;\n-        }\n-        if (!MoneyRange(coin.out.nValue)) {\n-            LogPrintf(\"[snapshot] bad snapshot data after deserializing %d coins - bad tx out value\\n\",\n-                      coins_count - coins_left);\n-            return false;\n-        }\n+            Txid txid;\n+            coins_file >> txid;\n+            size_t size{0};\n+            size = ReadCompactSize(coins_file);",
      "path": "src/validation.cpp",
      "position": 37,
      "original_position": 37,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "e7889805999ed312a5af12a2c08c548c19403bd9",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit:\r\n```suggestion\r\n            size_t size{ReadCompactSize(coins_file)};\r\n```\r\nalso, `size` is a quite generic name, would prefer something more explicit like `coins_per_txid`",
      "created_at": "2024-03-31T21:28:33Z",
      "updated_at": "2024-03-31T21:35:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1545804948",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1545804948"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": 5577,
      "original_start_line": 5577,
      "start_side": "RIGHT",
      "line": 5578,
      "original_line": 5578,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548483059",
      "pull_request_review_id": 1974818797,
      "id": 1548483059,
      "node_id": "PRRC_kwDOABII585cS_nz",
      "diff_hunk": "@@ -2693,21 +2694,42 @@ UniValue CreateUTXOSnapshot(\n \n     afile << metadata;\n \n+    std::map<uint256, std::vector<std::pair<uint32_t, Coin>>> mapCoins;",
      "path": "src/rpc/blockchain.cpp",
      "position": 12,
      "original_position": 12,
      "commit_id": "71d41d536bc2f47a014c898891d77d58502c9554",
      "original_commit_id": "e7889805999ed312a5af12a2c08c548c19403bd9",
      "in_reply_to_id": null,
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In e7889805999ed312a5af12a2c08c548c19403bd9 \"rpc: Optimize serialization disk space of dumptxoutset\"\r\n\r\n`mapCoins` is never used.",
      "created_at": "2024-04-02T19:24:16Z",
      "updated_at": "2024-04-02T20:08:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29612#discussion_r1548483059",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1548483059"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29612"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2697,
      "original_line": 2697,
      "side": "RIGHT"
    }
  ]
}