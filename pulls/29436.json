{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436",
    "id": 1726268388,
    "node_id": "PR_kwDOABII585m5MPk",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/29436",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/29436.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/29436.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29436",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29436/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/7b4b9535a7da91627eefc331b50d3b173af185fd",
    "number": 29436,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "net: call `Select` with reachable networks in `ThreadOpenConnections`",
    "user": {
      "login": "brunoerg",
      "id": 19480819,
      "node_id": "MDQ6VXNlcjE5NDgwODE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brunoerg",
      "html_url": "https://github.com/brunoerg",
      "followers_url": "https://api.github.com/users/brunoerg/followers",
      "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
      "organizations_url": "https://api.github.com/users/brunoerg/orgs",
      "repos_url": "https://api.github.com/users/brunoerg/repos",
      "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/brunoerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This PR changes addrman's `Select` to support multiple networks and change `ThreadOpenConnections` to call it with reachable networks. It can avoid unnecessary `Select` calls and avoid exceeding the max number of tries (100), especially when turning a clearnet + Tor/I2P/CJDNS node to Tor/I2P/CJDNS. Compared to #29330, this approach is \"less aggresive\". It does not add a new init flag and does not impact address relay.\r\n\r\nI did an experiment of calling `Select` without passing a network until it finds an address from a network that compose 20% ~ 25% of the addrman (limited to 100 tries).\r\n\r\n![Screenshot 2024-02-14 at 14 37 58](https://github.com/bitcoin/bitcoin/assets/19480819/7b6863a5-d7a6-40b6-87d5-01667c2de66a)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n ",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "created_at": "2024-02-14T18:49:23Z",
    "updated_at": "2024-02-27T10:15:50Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "6aae2b52a0354d40f87a24d12d7cab6c4b167ea5",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "brunoerg:2024-02-addrman-select-networks",
      "ref": "2024-02-addrman-select-networks",
      "sha": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 267841305,
        "node_id": "MDEwOlJlcG9zaXRvcnkyNjc4NDEzMDU=",
        "name": "bitcoin",
        "full_name": "brunoerg/bitcoin",
        "owner": {
          "login": "brunoerg",
          "id": 19480819,
          "node_id": "MDQ6VXNlcjE5NDgwODE5",
          "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/brunoerg",
          "html_url": "https://github.com/brunoerg",
          "followers_url": "https://api.github.com/users/brunoerg/followers",
          "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
          "organizations_url": "https://api.github.com/users/brunoerg/orgs",
          "repos_url": "https://api.github.com/users/brunoerg/repos",
          "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/brunoerg/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/brunoerg/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/brunoerg/bitcoin",
        "archive_url": "https://api.github.com/repos/brunoerg/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/brunoerg/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/brunoerg/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/brunoerg/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/brunoerg/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/brunoerg/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/brunoerg/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/brunoerg/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/brunoerg/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/brunoerg/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/brunoerg/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/brunoerg/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/brunoerg/bitcoin/events",
        "forks_url": "https://api.github.com/repos/brunoerg/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/brunoerg/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/brunoerg/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/brunoerg/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/brunoerg/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/brunoerg/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/brunoerg/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/brunoerg/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/brunoerg/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/brunoerg/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/brunoerg/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/brunoerg/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/brunoerg/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/brunoerg/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/brunoerg/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/brunoerg/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:brunoerg/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/brunoerg/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/brunoerg/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/brunoerg/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/brunoerg/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/brunoerg/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/brunoerg/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/brunoerg/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/brunoerg/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/brunoerg/bitcoin/hooks",
        "svn_url": "https://github.com/brunoerg/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 3,
        "watchers_count": 3,
        "size": 235261,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-02-26T12:00:08Z",
        "created_at": "2020-05-29T11:30:10Z",
        "updated_at": "2022-12-07T18:05:58Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "d0a9e339a9df4c6a7ab932e0409ce96263aeef95",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 34689,
        "stargazers_count": 74198,
        "watchers_count": 74198,
        "size": 250470,
        "default_branch": "master",
        "open_issues_count": 679,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-02-27T10:55:52Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-02-27T10:26:11Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 159,
    "deletions": 43,
    "changed_files": 9,
    "commits": 4,
    "review_comments": 30,
    "comments": 9
  },
  "events": [
    {
      "event": "commented",
      "id": 1944404918,
      "node_id": "IC_kwDOABII585z5UO2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1944404918",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-14T18:49:26Z",
      "updated_at": "2024-02-26T10:58:00Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29436).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Stale ACK | [vasild](https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1885261790), [naumenkogs](https://github.com/bitcoin/bitcoin/pull/29436#issuecomment-1953718864) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29043](https://github.com/bitcoin/bitcoin/pull/29043) (fuzz: make FuzzedDataProvider usage deterministic by martinus)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#issuecomment-1944404918",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29436"
    },
    {
      "event": "labeled",
      "id": 11805735998,
      "node_id": "LE_lADOABII585_QSIJzwAAAAK_rTw-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11805735998",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-14T18:49:28Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "commented",
      "id": 1944409727,
      "node_id": "IC_kwDOABII585z5VZ_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1944409727",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-14T18:52:39Z",
      "updated_at": "2024-02-14T18:52:39Z",
      "author_association": "CONTRIBUTOR",
      "body": "cc: @vasild @naumenkogs @amitiuttarwar @mzumsande ",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#issuecomment-1944409727",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29436"
    },
    {
      "event": "mentioned",
      "id": 11805769797,
      "node_id": "MEE_lADOABII585_QSIJzwAAAAK_rcBF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11805769797",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-14T18:52:41Z"
    },
    {
      "event": "subscribed",
      "id": 11805769810,
      "node_id": "SE_lADOABII585_QSIJzwAAAAK_rcBS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11805769810",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-14T18:52:41Z"
    },
    {
      "event": "mentioned",
      "id": 11805769829,
      "node_id": "MEE_lADOABII585_QSIJzwAAAAK_rcBl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11805769829",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-14T18:52:41Z"
    },
    {
      "event": "subscribed",
      "id": 11805769840,
      "node_id": "SE_lADOABII585_QSIJzwAAAAK_rcBw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11805769840",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-14T18:52:42Z"
    },
    {
      "event": "mentioned",
      "id": 11805769856,
      "node_id": "MEE_lADOABII585_QSIJzwAAAAK_rcCA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11805769856",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-14T18:52:42Z"
    },
    {
      "event": "subscribed",
      "id": 11805769869,
      "node_id": "SE_lADOABII585_QSIJzwAAAAK_rcCN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11805769869",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-14T18:52:42Z"
    },
    {
      "event": "mentioned",
      "id": 11805769886,
      "node_id": "MEE_lADOABII585_QSIJzwAAAAK_rcCe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11805769886",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-14T18:52:42Z"
    },
    {
      "event": "subscribed",
      "id": 11805769896,
      "node_id": "SE_lADOABII585_QSIJzwAAAAK_rcCo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11805769896",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-14T18:52:42Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-14T23:58:50Z",
      "updated_at": "2024-02-14T23:58:50Z",
      "source": {
        "issue": {
          "id": 2127176950,
          "node_id": "PR_kwDOABII585me8Nn",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29415/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29415",
          "number": 29415,
          "state": "open",
          "state_reason": null,
          "title": "Broadcast own transactions only via short-lived Tor or I2P connections",
          "body": "To improve privacy, broadcast locally submitted transactions (from the `sendrawtransaction` RPC) to the P2P network only via Tor or I2P short-lived connections.\r\n\r\n* Introduce a new connection type for private broadcast of transactions with the following properties:\r\n  * started whenever there are local transactions to be sent\r\n  * only opened to Tor or I2P peers\r\n  * opened regardless of max connections limits\r\n  * after handshake is completed one local transaction is pushed to the peer, `PING` is sent and after receiving `PONG` the connection is closed\r\n  * ignore all incoming messages after handshake is completed (except `PONG`)\r\n\r\n* Broadcast transactions submitted via `sendrawtransaction` using this new mechanism, to a few Tor or I2P peers. Keep doing this until we receive an `INV` about this transaction from one of our ordinary peers (this takes about 1 second on mainnet).\r\n\r\n* The transaction is stored in peerman and does not enter the mempool.\r\n\r\n* Once we get an `INV` from somebody, then the normal flow executes: we request the transaction with `GETDATA`, receive it with a `TX` message, put it in our mempool and broadcast it to all our existent connections (as if we see it for the first time).\r\n\r\n* After we receive the full transaction as a `TX` message, in reply to our `GETDATA` request, only then consider the transaction has propagated through the network and remove it from the storage in peerman, ending the private broadcast attempts.\r\n\r\nThe messages exchange should look like this:\r\n\r\n```\r\ntx-sender >--- connect -------> tx-recipient\r\ntx-sender >--- VERSION -------> tx-recipient (dummy VERSION with no revealing data)\r\ntx-sender <--- VERSION -------< tx-recipient\r\ntx-sender <--- WTXIDRELAY ----< tx-recipient (maybe)\r\ntx-sender <--- SENDADDRV2 ----< tx-recipient (maybe)\r\ntx-sender <--- SENDTXRCNCL ---< tx-recipient (maybe)\r\ntx-sender <--- VERACK --------< tx-recipient\r\ntx-sender >--- VERACK --------> tx-recipient\r\ntx-sender >--- TX ------------> tx-recipient\r\ntx-sender >--- PING ----------> tx-recipient\r\ntx-sender <--- PONG ----------< tx-recipient\r\ntx-sender disconnects\r\n```\r\n\r\nWhenever a new transaction is received from `sendrawtransaction` RPC, the node will send it to 5 (`NUM_PRIVATE_BROADCAST_PER_TX`) recipients right away. If after 10-15 mins we still have not heard anything about the transaction from the network, then it will be sent to 1 more peer (see `PeerManagerImpl::ReattemptPrivateBroadcast()`).\r\n\r\nA few considerations:\r\n* The short-lived private broadcast connections are very cheap and fast wrt network traffic. It is expected that some of those peers could blackhole the transaction. Just one honest/proper peer is enough for successful propagation.\r\n* The peers that receive the transaction could deduce that this is initial transaction broadcast from the transaction originator. This is ok, they can't identify the sender.\r\n\r\n---\r\n\r\nSome explanation of the commits:\r\n\r\n* Independent improvement (also opened as a standalone PR at https://github.com/bitcoin/bitcoin/pull/29419):\r\n  * `log: deduplicate category names and improve logging.cpp`\r\n\r\n* New logging category and config option to enable private broadcast\r\n  * `log: introduce a new category for private broadcast`\r\n  * `init: introduce a new option to enable/disable private broadcast`\r\n\r\n* Implement the private broadcast connection handling on the `CConnman` side:\r\n  * `net: introduce a new connection type for private broadcast`\r\n  * `net: move peers counting before grant acquisition in ThreadOpenConnections()`\r\n  * `net: implement opening PRIVATE_BROADCAST connections`\r\n\r\n* Prepare `BroadcastTransaction()` for private broadcast requests:\r\n  * `net_processing: rename RelayTransaction to better describe what it does`\r\n  * `node: change a tx-relay on/off flag to a tri-state`\r\n  * `net_processing: store transactions for private broadcast in PeerManager`\r\n\r\n* Implement the private broadcast connection handling on the `PeerManager` side:\r\n  * `net_processing: reorder the code that handles the VERSION message`\r\n  * `net_processing: handle ConnectionType::PRIVATE_BROADCAST connections`\r\n  * `net_processing: stop private broadcast of a transaction after round-trip`\r\n  * `net_processing: retry private broadcast`\r\n\r\n* Engage the new functionality from `sendrawtransaction`:\r\n  * `rpc: use private broadcast from sendrawtransaction RPC if -privatebroadcast is ON`\r\n\r\n* Independent test framework improvements (also opened as a standalone PR at https://github.com/bitcoin/bitcoin/pull/29420):\r\n  * `test: improve debug log message from P2PConnection::connection_made()`\r\n  * `test: extend the SOCKS5 Python proxy to actually connect to a destination`\r\n  * `test: support WTX INVs from P2PDataStore and fix a comment`\r\n  * `test: set P2PConnection::p2p_connected_to_node in peer_connect_helper()`\r\n\r\n* New functional test that exercies some of the new code:\r\n  * `test: add functional test for local tx relay`\r\n\r\n---\r\n\r\nThis addresses:\r\nhttps://github.com/bitcoin/bitcoin/issues/3828 Clients leak IPs if they are recipients of a transaction\r\nhttps://github.com/bitcoin/bitcoin/issues/14692 Can't configure bitocoind to only send tx via Tor but receive clearnet transactions\r\nhttps://github.com/bitcoin/bitcoin/issues/19042 Tor-only transaction broadcast onlynet=onion alternative\r\nhttps://github.com/bitcoin/bitcoin/issues/24557 Option for receive events with all networks, but send transactions and/or blocks only with anonymous network[s]?\r\nhttps://github.com/bitcoin/bitcoin/issues/25450 Ability to broadcast wallet transactions only via dedicated oneshot Tor connections\r\n\r\nRelated, but different:\r\nhttps://github.com/bitcoin/bitcoin/issues/21876 Broadcast a transaction to specific nodes\r\nhttps://github.com/bitcoin/bitcoin/issues/28636 new RPC: sendrawtransactiontopeer\r\n\r\n---\r\n\r\n_A previous incarnation of this can be found at https://github.com/bitcoin/bitcoin/pull/27509. It puts the transaction in the mempool and (tries to) hide it from the outside observers. This turned out to be too error prone or maybe even impossible._\r\n",
          "user": {
            "login": "vasild",
            "id": 266751,
            "node_id": "MDQ6VXNlcjI2Njc1MQ==",
            "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/vasild",
            "html_url": "https://github.com/vasild",
            "followers_url": "https://api.github.com/users/vasild/followers",
            "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
            "organizations_url": "https://api.github.com/users/vasild/orgs",
            "repos_url": "https://api.github.com/users/vasild/repos",
            "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/vasild/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 5,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29415",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29415",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29415.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29415.patch"
          },
          "created_at": "2024-02-09T13:39:10Z",
          "updated_at": "2024-02-26T21:25:26Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-15T02:07:56Z",
      "updated_at": "2024-02-15T02:07:56Z",
      "source": {
        "issue": {
          "id": 2033870672,
          "node_id": "PR_kwDOABII585hlozm",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29043",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29043/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29043/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29043/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29043",
          "number": 29043,
          "state": "open",
          "state_reason": null,
          "title": "fuzz: make FuzzedDataProvider usage deterministic",
          "body": "There exist many usages of `fuzzed_data_provider` where it is evaluated directly in the function call.\r\nUnfortunately, [the order of evaluation of function arguments is unspecified](https://en.cppreference.com/w/cpp/language/eval_order), and a simple example shows that it can differ e.g. between clang++ and g++: https://godbolt.org/z/jooMezWWY\r\n\r\nWhen the evaluation order is not consistent, the same fuzzing/random input will produce different output, which is bad for coverage/reproducibility. This PR fixes all these cases I have found where unspecified evaluation order could be a problem.\r\n\r\nFinding these has been manual work; I grepped the sourcecode for these patterns, and looked at each usage individually. So there is a chance I missed some.\r\n\r\n* `fuzzed_data_provider`\r\n* `.Consume`\r\n* `>Consume`\r\n* `.rand`\r\n\r\nI first discovered this in https://github.com/bitcoin/bitcoin/pull/29013#discussion_r1420236394. Note that there is a possibility that due to this fix the evaluation order is now different in many cases than when the fuzzing corpus has been created. If that is the case, the fuzzing corpus will have worse coverage than before.\r\n\r\nUpdate: In list-initialization the order of evaluation is well defined, so e.g. usages in `initializer_list` or constructors that use `{...}` is ok.",
          "user": {
            "login": "martinus",
            "id": 14386,
            "node_id": "MDQ6VXNlcjE0Mzg2",
            "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/martinus",
            "html_url": "https://github.com/martinus",
            "followers_url": "https://api.github.com/users/martinus/followers",
            "following_url": "https://api.github.com/users/martinus/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/martinus/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/martinus/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
            "organizations_url": "https://api.github.com/users/martinus/orgs",
            "repos_url": "https://api.github.com/users/martinus/repos",
            "events_url": "https://api.github.com/users/martinus/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/martinus/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            },
            {
              "id": 5334691551,
              "node_id": "LA_kwDOABII588AAAABPfju3w",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
              "name": "CI failed",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29043",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29043",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29043.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29043.patch"
          },
          "created_at": "2023-12-09T14:24:09Z",
          "updated_at": "2024-02-15T02:07:55Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 1881775768,
      "node_id": "PRR_kwDOABII585wKZ6Y",
      "url": null,
      "actor": null,
      "commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1881775768",
      "submitted_at": "2024-02-15T05:04:26Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
    },
    {
      "event": "reviewed",
      "id": 1882354205,
      "node_id": "PRR_kwDOABII585wMnId",
      "url": null,
      "actor": null,
      "commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK 2096aeabec288bd2852593f0c965a2a9d22ad0c8\r\n\r\nSome non-blockers below (feel free to ignore them) plus one `return` vs `continue` that probably needs to be addressed.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1882354205",
      "submitted_at": "2024-02-15T10:52:41Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11815651562,
      "node_id": "HRFPE_lADOABII585_QSIJzwAAAALARIjq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11815651562",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-15T13:41:31Z"
    },
    {
      "event": "commented",
      "id": 1946127103,
      "node_id": "IC_kwDOABII585z_4r_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1946127103",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-15T13:45:46Z",
      "updated_at": "2024-02-15T13:45:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "Force-pushed addressing:\r\nhttps://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490381331\r\nhttps://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490757436\r\nhttps://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490780583\r\nhttps://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490807334\r\nhttps://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490770478\r\n\r\nThanks @vasild and @amitiuttarwar for reviewing!\r\n",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#issuecomment-1946127103",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29436"
    },
    {
      "event": "mentioned",
      "id": 11815702969,
      "node_id": "MEE_lADOABII585_QSIJzwAAAALARVG5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11815702969",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-15T13:45:47Z"
    },
    {
      "event": "subscribed",
      "id": 11815702991,
      "node_id": "SE_lADOABII585_QSIJzwAAAALARVHP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11815702991",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-15T13:45:47Z"
    },
    {
      "event": "mentioned",
      "id": 11815703017,
      "node_id": "MEE_lADOABII585_QSIJzwAAAALARVHp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11815703017",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-15T13:45:47Z"
    },
    {
      "event": "subscribed",
      "id": 11815703032,
      "node_id": "SE_lADOABII585_QSIJzwAAAALARVH4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11815703032",
      "actor": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-15T13:45:47Z"
    },
    {
      "event": "reviewed",
      "id": 1885261790,
      "node_id": "PRR_kwDOABII585wXs_e",
      "url": null,
      "actor": null,
      "commit_id": "7edb07ca800991f7c88d582b880a392efe17f31d",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 7edb07ca800991f7c88d582b880a392efe17f31d\r\n\r\nAbout the graph in the OP: \"... until it finds an address from a network that compose 20% ...\". The chance of not getting the result after `N` tries is `(8/10)^N`. For example for `N=25` that is less than `0.004`. What is the explanation of having so many dots so high? Uneven distribution within addrman?\r\n",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1885261790",
      "submitted_at": "2024-02-16T14:17:16Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
    },
    {
      "event": "commented",
      "id": 1949222350,
      "node_id": "IC_kwDOABII5850LsXO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1949222350",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-16T19:45:53Z",
      "updated_at": "2024-02-16T19:45:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "> About the graph in the OP: \"... until it finds an address from a network that compose 20% ...\". The chance of not getting the result after N tries is (8/10)^N. For example for N=25 that is less than 0.004. What is the explanation of having so many dots so high? Uneven distribution within addrman?\r\n\r\nThat was what I was expecting too. I'll investigate but yes I think it might be an uneven distribution. Btw, this is not deterministic.",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#issuecomment-1949222350",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29436"
    },
    {
      "event": "reviewed",
      "id": 1887888527,
      "node_id": "PRR_kwDOABII585whuSP",
      "url": null,
      "actor": null,
      "commit_id": "7edb07ca800991f7c88d582b880a392efe17f31d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1887888527",
      "submitted_at": "2024-02-19T10:32:54Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
    },
    {
      "event": "commented",
      "id": 1953718864,
      "node_id": "IC_kwDOABII5850c2JQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1953718864",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-20T08:39:29Z",
      "updated_at": "2024-02-20T08:39:29Z",
      "author_association": "MEMBER",
      "body": "ACK 7edb07ca800991f7c88d582b880a392efe17f31d",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#issuecomment-1953718864",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29436"
    },
    {
      "event": "reviewed",
      "id": 1891096814,
      "node_id": "PRR_kwDOABII585wt9ju",
      "url": null,
      "actor": null,
      "commit_id": "7edb07ca800991f7c88d582b880a392efe17f31d",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "I tried to test the performance impact on the \"normal\" case of an addrman that only has addrs for reachable nets:\r\nIf I change the `AddrManSelect` benchmark to use `addrman.Select(false, g_reachable_nets.All()); ` the performance goes down by a factor of ~5 for me (from `~160ns/op` to `~770 ns/op`). Do you see a similar effect? ",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1891096814",
      "submitted_at": "2024-02-20T17:48:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
    },
    {
      "event": "reviewed",
      "id": 1891133220,
      "node_id": "PRR_kwDOABII585wuGck",
      "url": null,
      "actor": null,
      "commit_id": "3f99f5a6e58fae4981228929045ed7be32463381",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1891133220",
      "submitted_at": "2024-02-20T18:07:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
    },
    {
      "event": "reviewed",
      "id": 1893454940,
      "node_id": "PRR_kwDOABII585w29Rc",
      "url": null,
      "actor": null,
      "commit_id": "7edb07ca800991f7c88d582b880a392efe17f31d",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1893454940",
      "submitted_at": "2024-02-21T15:02:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNiM2JiM2I4MjEzMWUyNDM3NTEyMTg1MDNmYzZiZmM3OTlkNGM5NjM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cb3bb3b82131e243751218503fc6bfc799d4c963",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/cb3bb3b82131e243751218503fc6bfc799d4c963",
      "tree": {
        "sha": "2ecb423f100e984631329df71e3656e78604c836",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2ecb423f100e984631329df71e3656e78604c836"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/88b1229c134fa006d9a57e908ebebec944419347",
          "sha": "88b1229c134fa006d9a57e908ebebec944419347",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/88b1229c134fa006d9a57e908ebebec944419347"
        }
      ],
      "message": "net: add `All()` in `ReachableNets`\n\nCo-authored-by: Vasil Dimov <vd@FreeBSD.org>",
      "committer": {
        "name": "brunoerg",
        "email": "brunoely.gc@gmail.com",
        "date": "2024-02-22T13:48:10Z"
      },
      "author": {
        "name": "brunoerg",
        "email": "brunoely.gc@gmail.com",
        "date": "2024-02-15T12:33:24Z"
      },
      "sha": "cb3bb3b82131e243751218503fc6bfc799d4c963"
    },
    {
      "event": "commented",
      "id": 1959775549,
      "node_id": "IC_kwDOABII5850z809",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1959775549",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-22T16:09:08Z",
      "updated_at": "2024-02-22T16:09:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "> the performance goes down by a factor of ~5 for me\r\n\r\nIf this is correct and can be reproduced by others, I think that something should be done about it. If this PR would increase performance for a  rare and transient case (right after the users switched their onlynet parameters) but decrease performance for each `Select()` call in the typical scenario (addrman has mostly addrs from reachable networks), the overall impact on performance of this PR would be clearly negative.\r\nOne possibility might be to track the percentage of non-reachable addrs while loading AddrMan (we can't get more unreachable addrs afterwards) and only execute the slower logic if that is larger than some threshold (for example, 50%).",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#issuecomment-1959775549",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29436"
    },
    {
      "event": "commented",
      "id": 1959849246,
      "node_id": "IC_kwDOABII58500O0e",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1959849246",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-22T16:46:53Z",
      "updated_at": "2024-02-22T16:46:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "> If this is correct and can be reproduced by others, I think that something should be done about it. If this PR would increase performance for a rare and transient case (right after the users switched their onlynet parameters) but decrease performance for each Select() call in the typical scenario (addrman has mostly addrs from reachable networks), the overall impact on performance of this PR would be clearly negative.\r\nOne possibility might be to track the percentage of non-reachable addrs while loading AddrMan (we can't get more unreachable addrs afterwards) and only execute the slower logic if that is larger than some threshold (for example, 50%).\r\n\r\nI'm reproducing it to check it.",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#issuecomment-1959849246",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29436"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQ0YWJhNmNiZmY0OWMwMzQ3MDNkNzliODZkYzU5OTVkNmE3YjZjMWY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/44aba6cbff49c034703d79b86dc5995d6a7b6c1f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/44aba6cbff49c034703d79b86dc5995d6a7b6c1f",
      "tree": {
        "sha": "2d2b07540370c8313bde6726f000b41a141b0004",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2d2b07540370c8313bde6726f000b41a141b0004"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cb3bb3b82131e243751218503fc6bfc799d4c963",
          "sha": "cb3bb3b82131e243751218503fc6bfc799d4c963",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/cb3bb3b82131e243751218503fc6bfc799d4c963"
        }
      ],
      "message": "addrman: add `HasFewReachableAddresses`",
      "committer": {
        "name": "brunoerg",
        "email": "brunoely.gc@gmail.com",
        "date": "2024-02-26T10:52:41Z"
      },
      "author": {
        "name": "brunoerg",
        "email": "brunoely.gc@gmail.com",
        "date": "2024-02-23T17:36:00Z"
      },
      "sha": "44aba6cbff49c034703d79b86dc5995d6a7b6c1f"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11919504158,
      "node_id": "HRFPE_lADOABII585_QSIJzwAAAALGdTMe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11919504158",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T10:57:57Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNmNTc3NWYzYjZhMjQyNGE1ZjBlZDY4NGYyZGYyMDlkYjFjZDA1NzQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cf5775f3b6a2424a5f0ed684f2df209db1cd0574",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/cf5775f3b6a2424a5f0ed684f2df209db1cd0574",
      "tree": {
        "sha": "1385f49123ab6414b09030be9d72be87cb0e242a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1385f49123ab6414b09030be9d72be87cb0e242a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/44aba6cbff49c034703d79b86dc5995d6a7b6c1f",
          "sha": "44aba6cbff49c034703d79b86dc5995d6a7b6c1f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/44aba6cbff49c034703d79b86dc5995d6a7b6c1f"
        }
      ],
      "message": "addrman: change `Select` to support multiple networks",
      "committer": {
        "name": "brunoerg",
        "email": "brunoely.gc@gmail.com",
        "date": "2024-02-26T11:02:26Z"
      },
      "author": {
        "name": "brunoerg",
        "email": "brunoely.gc@gmail.com",
        "date": "2024-02-12T21:10:33Z"
      },
      "sha": "cf5775f3b6a2424a5f0ed684f2df209db1cd0574"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDdiNGI5NTM1YTdkYTkxNjI3ZWVmYzMzMWI1MGQzYjE3M2FmMTg1ZmQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7b4b9535a7da91627eefc331b50d3b173af185fd",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7b4b9535a7da91627eefc331b50d3b173af185fd",
      "tree": {
        "sha": "e69dde524659a460a3ffafbf36e7c04d50d07811",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e69dde524659a460a3ffafbf36e7c04d50d07811"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cf5775f3b6a2424a5f0ed684f2df209db1cd0574",
          "sha": "cf5775f3b6a2424a5f0ed684f2df209db1cd0574",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/cf5775f3b6a2424a5f0ed684f2df209db1cd0574"
        }
      ],
      "message": "net: call `Select` with reachable networks in `ThreadOpenConnections`\n\nCalling `Select` with reachable networks can avoid unecessary\ncalls and avoid exceed the max number of tries.",
      "committer": {
        "name": "brunoerg",
        "email": "brunoely.gc@gmail.com",
        "date": "2024-02-26T11:02:31Z"
      },
      "author": {
        "name": "brunoerg",
        "email": "brunoely.gc@gmail.com",
        "date": "2024-02-13T13:40:00Z"
      },
      "sha": "7b4b9535a7da91627eefc331b50d3b173af185fd"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11919568731,
      "node_id": "HRFPE_lADOABII585_QSIJzwAAAALGdi9b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11919568731",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T11:02:45Z"
    },
    {
      "event": "commented",
      "id": 1963866552,
      "node_id": "IC_kwDOABII5851Djm4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1963866552",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T11:02:51Z",
      "updated_at": "2024-02-26T11:02:51Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\n🚧 At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/21977629586</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#issuecomment-1963866552",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29436"
    },
    {
      "event": "labeled",
      "id": 11919569691,
      "node_id": "LE_lADOABII585_QSIJzwAAAALGdjMb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11919569691",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T11:02:51Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1963873765,
      "node_id": "IC_kwDOABII5851DlXl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1963873765",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T11:06:48Z",
      "updated_at": "2024-02-26T11:06:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "@mzumsande you're right! \r\n\r\nI checked the performance goes down when calling `Select` when addrman only has addrs for reachable nets. So, I changed the approach to call `Select` with networks only whether the number of addresses from reachable networks in the addrman is less than 50%. This should be enough to cover the cases where this is an issue.\r\n\r\nSo, when initializing `CConnman`, we check whether the number of addresses from reachable networks in the addrman is less than 50%, if so, we call `Select` passing the networks.\r\n\r\ncc: @vasild @naumenkogs (due previous ACK)",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#issuecomment-1963873765",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29436"
    },
    {
      "event": "mentioned",
      "id": 11919618156,
      "node_id": "MEE_lADOABII585_QSIJzwAAAALGdvBs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11919618156",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T11:06:49Z"
    },
    {
      "event": "subscribed",
      "id": 11919618187,
      "node_id": "SE_lADOABII585_QSIJzwAAAALGdvCL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11919618187",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T11:06:49Z"
    },
    {
      "event": "mentioned",
      "id": 11919618223,
      "node_id": "MEE_lADOABII585_QSIJzwAAAALGdvCv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11919618223",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T11:06:49Z"
    },
    {
      "event": "subscribed",
      "id": 11919618243,
      "node_id": "SE_lADOABII585_QSIJzwAAAALGdvDD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11919618243",
      "actor": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T11:06:49Z"
    },
    {
      "event": "mentioned",
      "id": 11919618266,
      "node_id": "MEE_lADOABII585_QSIJzwAAAALGdvDa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11919618266",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T11:06:49Z"
    },
    {
      "event": "subscribed",
      "id": 11919618288,
      "node_id": "SE_lADOABII585_QSIJzwAAAALGdvDw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11919618288",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T11:06:49Z"
    },
    {
      "event": "unlabeled",
      "id": 11921338926,
      "node_id": "UNLE_lADOABII585_QSIJzwAAAALGkTIu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11921338926",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T13:18:57Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1902554269,
      "node_id": "PRR_kwDOABII585xZqyd",
      "url": null,
      "actor": null,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1902554269",
      "submitted_at": "2024-02-27T05:31:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
    },
    {
      "event": "reviewed",
      "id": 1902566839,
      "node_id": "PRR_kwDOABII585xZt23",
      "url": null,
      "actor": null,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1902566839",
      "submitted_at": "2024-02-27T05:45:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
    },
    {
      "event": "reviewed",
      "id": 1902572174,
      "node_id": "PRR_kwDOABII585xZvKO",
      "url": null,
      "actor": null,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1902572174",
      "submitted_at": "2024-02-27T05:50:42Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
    },
    {
      "event": "reviewed",
      "id": 1902578690,
      "node_id": "PRR_kwDOABII585xZwwC",
      "url": null,
      "actor": null,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1902578690",
      "submitted_at": "2024-02-27T05:56:07Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
    },
    {
      "event": "reviewed",
      "id": 1902590359,
      "node_id": "PRR_kwDOABII585xZzmX",
      "url": null,
      "actor": null,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1902590359",
      "submitted_at": "2024-02-27T06:06:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
    },
    {
      "event": "reviewed",
      "id": 1902627837,
      "node_id": "PRR_kwDOABII585xZ8v9",
      "url": null,
      "actor": null,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1902627837",
      "submitted_at": "2024-02-27T06:32:15Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
    },
    {
      "event": "reviewed",
      "id": 1903087340,
      "node_id": "PRR_kwDOABII585xbs7s",
      "url": null,
      "actor": null,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#pullrequestreview-1903087340",
      "submitted_at": "2024-02-27T10:15:50Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490381331",
      "pull_request_review_id": 1881775768,
      "id": 1490381331,
      "node_id": "PRRC_kwDOABII585Y1WoT",
      "diff_hunk": "@@ -154,12 +154,12 @@ class AddrMan\n      *                     an address from the new table or an empty pair. Passing `false` will return an\n      *                     empty pair or an address from either the new or tried table (it does not\n      *                     guarantee a tried entry).\n-     * @param[in] network  Select only addresses of this network (nullopt = all). Passing a network may\n+     * @param[in] networks Select only addresses of these networks (nullopt = all). Passing networks may\n      *                     slow down the search.\n      * @return    CAddress The record for the selected peer.\n      *            seconds  The last time we attempted to connect to that peer.\n      */\n-    std::pair<CAddress, NodeSeconds> Select(bool new_only = false, std::optional<Network> network = std::nullopt) const;\n+    std::pair<CAddress, NodeSeconds> Select(bool new_only = false, std::optional<std::vector<Network>> networks = std::nullopt) const;",
      "path": "src/addrman.h",
      "position": null,
      "original_position": 11,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "in_reply_to_id": null,
      "user": {
        "login": "amitiuttarwar",
        "id": 1500952,
        "node_id": "MDQ6VXNlcjE1MDA5NTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/amitiuttarwar",
        "html_url": "https://github.com/amitiuttarwar",
        "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
        "following_url": "https://api.github.com/users/amitiuttarwar/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/amitiuttarwar/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/amitiuttarwar/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
        "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
        "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
        "events_url": "https://api.github.com/users/amitiuttarwar/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "instead of an optional of a vector, you could have the default value explicitly be all networks, or an empty vector be interpreted as all networks. probably the first one is clearer. ",
      "created_at": "2024-02-15T05:04:26Z",
      "updated_at": "2024-02-15T05:04:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490381331",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490381331"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 162,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490757436",
      "pull_request_review_id": 1882354205,
      "id": 1490757436,
      "node_id": "PRRC_kwDOABII585Y2yc8",
      "diff_hunk": "@@ -717,13 +717,17 @@ std::pair<CAddress, NodeSeconds> AddrManImpl::Select_(bool new_only, std::option\n     size_t new_count = nNew;\n     size_t tried_count = nTried;\n \n-    if (network.has_value()) {\n-        auto it = m_network_counts.find(*network);\n-        if (it == m_network_counts.end()) return {};\n+    if (networks.has_value()) {\n+        new_count = 0;\n+        tried_count = 0;\n+        for (auto& network : *networks) {\n+            auto it = m_network_counts.find(network);\n+            if (it == m_network_counts.end()) return {};",
      "path": "src/addrman.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This should be `continue;`? If addrman has 0 addresses from some of the requested networks, it can still return an address from another requested network.\r\n\r\n```suggestion\r\n            if (it == m_network_counts.end()) {\r\n                continue;\r\n            }\r\n```",
      "created_at": "2024-02-15T10:11:26Z",
      "updated_at": "2024-02-15T10:52:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490757436",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490757436"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 725,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490766626",
      "pull_request_review_id": 1882354205,
      "id": 1490766626,
      "node_id": "PRRC_kwDOABII585Y20si",
      "diff_hunk": "@@ -756,9 +760,10 @@ std::pair<CAddress, NodeSeconds> AddrManImpl::Select_(bool new_only, std::option\n             position = (initial_position + i) % ADDRMAN_BUCKET_SIZE;\n             node_id = GetEntry(search_tried, bucket, position);\n             if (node_id != -1) {\n-                if (network.has_value()) {\n+                if (networks.has_value()) {\n                     const auto it{mapInfo.find(node_id)};\n-                    if (Assume(it != mapInfo.end()) && it->second.GetNetwork() == *network) break;\n+                    auto& nets = *networks;\n+                    if (Assume(it != mapInfo.end()) && std::find(nets.begin(), nets.end(), it->second.GetNetwork()) != nets.end()) break;",
      "path": "src/addrman.cpp",
      "position": null,
      "original_position": 42,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This code is correct, but is doing linear search in the list of networks. For values of up to 6 that is irrelevant, but if it is changed from `vector` to `unordered_set` then lookup is also shorter to write, in addition to being `O(1)`:\r\n\r\n```suggestion\r\n                    if (Assume(it != mapInfo.end()) && networks->contains(it->second.GetNetwork())) break;\r\n```",
      "created_at": "2024-02-15T10:18:41Z",
      "updated_at": "2024-02-15T10:52:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490766626",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490766626"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": 765,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 766,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490770478",
      "pull_request_review_id": 1882354205,
      "id": 1490770478,
      "node_id": "PRRC_kwDOABII585Y21ou",
      "diff_hunk": "@@ -126,8 +126,10 @@ static void AddrManSelectByNetwork(benchmark::Bench& bench)\n \n     FillAddrMan(addrman);\n \n+    std::vector<Network> net_i2p = {NET_I2P};\n+\n     bench.run([&] {\n-        (void)addrman.Select(/*new_only=*/false, NET_I2P);\n+        (void)addrman.Select(/*new_only=*/false, net_i2p);",
      "path": "src/bench/addrman.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This should work as well (untested):\r\n\r\n```cpp\r\n(void)addrman.Select(/*new_only=*/false, {NET_I2P});\r\n```\r\n\r\nSame in `src/test/addrman_tests.cpp`.",
      "created_at": "2024-02-15T10:21:32Z",
      "updated_at": "2024-02-15T10:52:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490770478",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490770478"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": 129,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 132,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490780583",
      "pull_request_review_id": 1882354205,
      "id": 1490780583,
      "node_id": "PRRC_kwDOABII585Y24Gn",
      "diff_hunk": "@@ -2672,14 +2680,17 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n                     // a currently-connected peer.\n                     addrman.Good(addr);\n                     // Select a new table address for our feeler instead.\n-                    std::tie(addr, addr_last_try) = addrman.Select(true);\n+                    std::tie(addr, addr_last_try) = addrman.Select(true, networks);\n                 }\n             } else {\n                 // Not a feeler\n                 // If preferred_net has a value set, pick an extra outbound\n                 // peer from that network. The eviction logic in net_processing\n                 // ensures that a peer from another network will be evicted.\n-                std::tie(addr, addr_last_try) = addrman.Select(false, preferred_net);\n+                if (preferred_net.has_value()) {\n+                    networks = {*preferred_net};\n+                }\n+                std::tie(addr, addr_last_try) = addrman.Select(false, networks);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 40,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This could be shorter (untested):\r\n\r\n```cpp\r\nstd::tie(addr, addr_last_try) = preferred_net.has_value()\r\n    ? addrman.Select(false, {*preferred_net})\r\n    : addrman.Select(false, g_reachable_nets.All());\r\n```",
      "created_at": "2024-02-15T10:29:15Z",
      "updated_at": "2024-02-15T10:52:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490780583",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490780583"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": 2682,
      "start_side": "LEFT",
      "line": null,
      "original_line": 2693,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490794321",
      "pull_request_review_id": 1882354205,
      "id": 1490794321,
      "node_id": "PRRC_kwDOABII585Y27dR",
      "diff_hunk": "@@ -275,7 +275,16 @@ FUZZ_TARGET(addrman, .init = initialize_addrman)\n         /*max_pct=*/fuzzed_data_provider.ConsumeIntegralInRange<size_t>(0, 4096),\n         network,\n         /*filtered=*/fuzzed_data_provider.ConsumeBool());\n-    (void)const_addr_man.Select(fuzzed_data_provider.ConsumeBool(), network);\n+\n+    auto all_networks = ALL_NETWORKS;\n+    FastRandomContext fast_random_context{ConsumeUInt256(fuzzed_data_provider)};\n+    Shuffle(all_networks.begin(), all_networks.end(), fast_random_context);\n+    std::vector<Network> nets;\n+    for (size_t i = 0; i < all_networks.size() && fuzzed_data_provider.ConsumeBool(); i++) {\n+        nets.push_back(all_networks[i]);\n+    }\n+    (void)const_addr_man.Select(fuzzed_data_provider.ConsumeBool(), nets);",
      "path": "src/test/fuzz/addrman.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This could end up passing an empty container (`vector` or `unordered_set` if you decide to change it). Maybe this:\r\n\r\n```cpp\r\nif (nets.empty()) {\r\n    (void)const_addr_man.Select(fuzzed_data_provider.ConsumeBool());\r\n} else {\r\n    (void)const_addr_man.Select(fuzzed_data_provider.ConsumeBool(), nets);\r\n}",
      "created_at": "2024-02-15T10:39:13Z",
      "updated_at": "2024-02-15T10:52:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490794321",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490794321"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": 282,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 286,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490807334",
      "pull_request_review_id": 1882354205,
      "id": 1490807334,
      "node_id": "PRRC_kwDOABII585Y2-om",
      "diff_hunk": "@@ -2564,6 +2564,14 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         bool fFeeler = false;\n         std::optional<Network> preferred_net;\n \n+        std::vector<Network> networks;\n+        for (int i = 0; i != NET_MAX; i++) {\n+            Network net = static_cast<Network>(i);\n+            if (g_reachable_nets.Contains(net)) {\n+                networks.push_back(net);\n+            }\n+        }",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 10,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If you extend the `ReachableNets` class like this:\r\n\r\n```diff\r\n--- i/src/netbase.h\r\n+++ w/src/netbase.h\r\n@@ -102,12 +102,18 @@ public:\r\n     [[nodiscard]] bool Contains(const CNetAddr& addr) const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n     {   \r\n         AssertLockNotHeld(m_mutex);\r\n         return Contains(addr.GetNetwork());\r\n     }\r\n\r\n+    [[nodiscard]] std::unordered_set<Network> All() const EXCLUSIVE_LOCKS_REQUIRED(!m_mutex)\r\n+    {\r\n+        LOCK(m_mutex);\r\n+        return m_reachable;\r\n+    }\r\n+\r\n private:\r\n     mutable Mutex m_mutex;\r\n\r\n     std::unordered_set<Network> m_reachable GUARDED_BY(m_mutex){\r\n```\r\n\r\nThen you can pass directly `g_reachable_nets.All()` to `Select()` without an intermediate variable.",
      "created_at": "2024-02-15T10:46:54Z",
      "updated_at": "2024-02-15T10:52:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490807334",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490807334"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": 2567,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2573,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490857252",
      "pull_request_review_id": 1882520607,
      "id": 1490857252,
      "node_id": "PRRC_kwDOABII585Y3K0k",
      "diff_hunk": "@@ -154,12 +154,12 @@ class AddrMan\n      *                     an address from the new table or an empty pair. Passing `false` will return an\n      *                     empty pair or an address from either the new or tried table (it does not\n      *                     guarantee a tried entry).\n-     * @param[in] network  Select only addresses of this network (nullopt = all). Passing a network may\n+     * @param[in] networks Select only addresses of these networks (nullopt = all). Passing networks may\n      *                     slow down the search.\n      * @return    CAddress The record for the selected peer.\n      *            seconds  The last time we attempted to connect to that peer.\n      */\n-    std::pair<CAddress, NodeSeconds> Select(bool new_only = false, std::optional<Network> network = std::nullopt) const;\n+    std::pair<CAddress, NodeSeconds> Select(bool new_only = false, std::optional<std::vector<Network>> networks = std::nullopt) const;",
      "path": "src/addrman.h",
      "position": null,
      "original_position": 11,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "in_reply_to_id": 1490381331,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "With this PR all production code passes both arguments. No need anymore for defaults. This compiles:\r\n\r\n```diff\r\n-    std::pair<CAddress, NodeSeconds> Select(bool new_only = false, std::optional<std::vector<Network>> networks = std::nullopt) const;\r\n+    std::pair<CAddress, NodeSeconds> Select(bool new_only, std::vector<Network> networks) const;\r\n```\r\n\r\nSome tests use `Select()` and I adjusted them to do `Select(false, {})` just to check that the compilation will succeed. They can be adjusted to\r\n`Select(false, g_reachable_nets.All())`\r\nor\r\n`Select(false, {NET_IPV4, NET_IPV6, NET_ONION, NET_I2P, NET_CJDNS})`\r\nif you decide to drop the defaults.",
      "created_at": "2024-02-15T11:22:18Z",
      "updated_at": "2024-02-15T11:22:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490857252",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490857252"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 162,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490912711",
      "pull_request_review_id": 1882608433,
      "id": 1490912711,
      "node_id": "PRRC_kwDOABII585Y3YXH",
      "diff_hunk": "@@ -717,13 +717,17 @@ std::pair<CAddress, NodeSeconds> AddrManImpl::Select_(bool new_only, std::option\n     size_t new_count = nNew;\n     size_t tried_count = nTried;\n \n-    if (network.has_value()) {\n-        auto it = m_network_counts.find(*network);\n-        if (it == m_network_counts.end()) return {};\n+    if (networks.has_value()) {\n+        new_count = 0;\n+        tried_count = 0;\n+        for (auto& network : *networks) {\n+            auto it = m_network_counts.find(network);\n+            if (it == m_network_counts.end()) return {};",
      "path": "src/addrman.cpp",
      "position": null,
      "original_position": 21,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "in_reply_to_id": 1490757436,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, nice catch. I'll address it.",
      "created_at": "2024-02-15T12:06:54Z",
      "updated_at": "2024-02-15T12:06:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490912711",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490912711"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 725,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490938595",
      "pull_request_review_id": 1882650103,
      "id": 1490938595,
      "node_id": "PRRC_kwDOABII585Y3erj",
      "diff_hunk": "@@ -126,8 +126,10 @@ static void AddrManSelectByNetwork(benchmark::Bench& bench)\n \n     FillAddrMan(addrman);\n \n+    std::vector<Network> net_i2p = {NET_I2P};\n+\n     bench.run([&] {\n-        (void)addrman.Select(/*new_only=*/false, NET_I2P);\n+        (void)addrman.Select(/*new_only=*/false, net_i2p);",
      "path": "src/bench/addrman.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "in_reply_to_id": 1490770478,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "It doesn't work with vector I guess. But since I'll change it to `unordered_set`, it will work.",
      "created_at": "2024-02-15T12:30:17Z",
      "updated_at": "2024-02-15T12:30:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1490938595",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1490938595"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": 129,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 132,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1491007792",
      "pull_request_review_id": 1882761408,
      "id": 1491007792,
      "node_id": "PRRC_kwDOABII585Y3vkw",
      "diff_hunk": "@@ -275,7 +275,16 @@ FUZZ_TARGET(addrman, .init = initialize_addrman)\n         /*max_pct=*/fuzzed_data_provider.ConsumeIntegralInRange<size_t>(0, 4096),\n         network,\n         /*filtered=*/fuzzed_data_provider.ConsumeBool());\n-    (void)const_addr_man.Select(fuzzed_data_provider.ConsumeBool(), network);\n+\n+    auto all_networks = ALL_NETWORKS;\n+    FastRandomContext fast_random_context{ConsumeUInt256(fuzzed_data_provider)};\n+    Shuffle(all_networks.begin(), all_networks.end(), fast_random_context);\n+    std::vector<Network> nets;\n+    for (size_t i = 0; i < all_networks.size() && fuzzed_data_provider.ConsumeBool(); i++) {\n+        nets.push_back(all_networks[i]);\n+    }\n+    (void)const_addr_man.Select(fuzzed_data_provider.ConsumeBool(), nets);",
      "path": "src/test/fuzz/addrman.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "in_reply_to_id": 1490794321,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Empty container and nothing means the same, all networks.",
      "created_at": "2024-02-15T13:26:52Z",
      "updated_at": "2024-02-15T13:45:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1491007792",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1491007792"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": 282,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 286,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1491008021",
      "pull_request_review_id": 1882761728,
      "id": 1491008021,
      "node_id": "PRRC_kwDOABII585Y3voV",
      "diff_hunk": "@@ -2564,6 +2564,14 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         bool fFeeler = false;\n         std::optional<Network> preferred_net;\n \n+        std::vector<Network> networks;\n+        for (int i = 0; i != NET_MAX; i++) {\n+            Network net = static_cast<Network>(i);\n+            if (g_reachable_nets.Contains(net)) {\n+                networks.push_back(net);\n+            }\n+        }",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 10,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "in_reply_to_id": 1490807334,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nice idea! I'll address it.",
      "created_at": "2024-02-15T13:27:02Z",
      "updated_at": "2024-02-15T13:27:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1491008021",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1491008021"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": 2567,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2573,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1491008584",
      "pull_request_review_id": 1882762615,
      "id": 1491008584,
      "node_id": "PRRC_kwDOABII585Y3vxI",
      "diff_hunk": "@@ -756,9 +760,10 @@ std::pair<CAddress, NodeSeconds> AddrManImpl::Select_(bool new_only, std::option\n             position = (initial_position + i) % ADDRMAN_BUCKET_SIZE;\n             node_id = GetEntry(search_tried, bucket, position);\n             if (node_id != -1) {\n-                if (network.has_value()) {\n+                if (networks.has_value()) {\n                     const auto it{mapInfo.find(node_id)};\n-                    if (Assume(it != mapInfo.end()) && it->second.GetNetwork() == *network) break;\n+                    auto& nets = *networks;\n+                    if (Assume(it != mapInfo.end()) && std::find(nets.begin(), nets.end(), it->second.GetNetwork()) != nets.end()) break;",
      "path": "src/addrman.cpp",
      "position": null,
      "original_position": 42,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "in_reply_to_id": 1490766626,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Nice, I'll address it.",
      "created_at": "2024-02-15T13:27:28Z",
      "updated_at": "2024-02-15T13:27:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1491008584",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1491008584"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": 765,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 766,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1492529744",
      "pull_request_review_id": 1885264596,
      "id": 1492529744,
      "node_id": "PRRC_kwDOABII585Y9jJQ",
      "diff_hunk": "@@ -126,8 +126,10 @@ static void AddrManSelectByNetwork(benchmark::Bench& bench)\n \n     FillAddrMan(addrman);\n \n+    std::vector<Network> net_i2p = {NET_I2P};\n+\n     bench.run([&] {\n-        (void)addrman.Select(/*new_only=*/false, NET_I2P);\n+        (void)addrman.Select(/*new_only=*/false, net_i2p);",
      "path": "src/bench/addrman.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "2096aeabec288bd2852593f0c965a2a9d22ad0c8",
      "in_reply_to_id": 1490770478,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Does not matter now, but it should work with vector as well.",
      "created_at": "2024-02-16T14:18:45Z",
      "updated_at": "2024-02-16T14:18:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1492529744",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1492529744"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": 129,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 132,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1494214557",
      "pull_request_review_id": 1887888527,
      "id": 1494214557,
      "node_id": "PRRC_kwDOABII585ZD-ed",
      "diff_hunk": "@@ -717,13 +717,18 @@ std::pair<CAddress, NodeSeconds> AddrManImpl::Select_(bool new_only, std::option\n     size_t new_count = nNew;\n     size_t tried_count = nTried;\n \n-    if (network.has_value()) {\n-        auto it = m_network_counts.find(*network);\n-        if (it == m_network_counts.end()) return {};\n-\n-        auto counts = it->second;\n-        new_count = counts.n_new;\n-        tried_count = counts.n_tried;\n+    if (!networks.empty()) {\n+        new_count = 0;\n+        tried_count = 0;\n+        for (auto& network : networks) {\n+            auto it = m_network_counts.find(network);\n+            if (it == m_network_counts.end()) {\n+                continue;\n+            }\n+            auto counts = it->second;\n+            new_count += counts.n_new;",
      "path": "src/addrman.cpp",
      "position": 29,
      "original_position": 29,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "3f99f5a6e58fae4981228929045ed7be32463381",
      "in_reply_to_id": null,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "3f99f5a6e58fae4981228929045ed7be32463381\r\n\r\nMight be worth making this overflow-safe?",
      "created_at": "2024-02-19T09:02:54Z",
      "updated_at": "2024-02-19T10:32:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1494214557",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1494214557"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 733,
      "original_line": 733,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1494332423",
      "pull_request_review_id": 1887888527,
      "id": 1494332423,
      "node_id": "PRRC_kwDOABII585ZEbQH",
      "diff_hunk": "@@ -717,13 +717,18 @@ std::pair<CAddress, NodeSeconds> AddrManImpl::Select_(bool new_only, std::option\n     size_t new_count = nNew;\n     size_t tried_count = nTried;\n \n-    if (network.has_value()) {\n-        auto it = m_network_counts.find(*network);\n-        if (it == m_network_counts.end()) return {};\n-\n-        auto counts = it->second;\n-        new_count = counts.n_new;\n-        tried_count = counts.n_tried;\n+    if (!networks.empty()) {\n+        new_count = 0;\n+        tried_count = 0;\n+        for (auto& network : networks) {\n+            auto it = m_network_counts.find(network);\n+            if (it == m_network_counts.end()) {\n+                continue;\n+            }\n+            auto counts = it->second;\n+            new_count += counts.n_new;",
      "path": "src/addrman.cpp",
      "position": 29,
      "original_position": 29,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "3f99f5a6e58fae4981228929045ed7be32463381",
      "in_reply_to_id": 1494214557,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Might as well fix `    if (new_count + tried_count == 0) return {};` above. While it seems like a bug in the existing code, it's really hard to trigger.... feeding addrman with that much garbage would be a failure probably before the size_t limit is hit :)",
      "created_at": "2024-02-19T10:25:14Z",
      "updated_at": "2024-02-19T10:32:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1494332423",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1494332423"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 733,
      "original_line": 733,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1494903447",
      "pull_request_review_id": 1888979988,
      "id": 1494903447,
      "node_id": "PRRC_kwDOABII585ZGmqX",
      "diff_hunk": "@@ -717,13 +717,18 @@ std::pair<CAddress, NodeSeconds> AddrManImpl::Select_(bool new_only, std::option\n     size_t new_count = nNew;\n     size_t tried_count = nTried;\n \n-    if (network.has_value()) {\n-        auto it = m_network_counts.find(*network);\n-        if (it == m_network_counts.end()) return {};\n-\n-        auto counts = it->second;\n-        new_count = counts.n_new;\n-        tried_count = counts.n_tried;\n+    if (!networks.empty()) {\n+        new_count = 0;\n+        tried_count = 0;\n+        for (auto& network : networks) {\n+            auto it = m_network_counts.find(network);\n+            if (it == m_network_counts.end()) {\n+                continue;\n+            }\n+            auto counts = it->second;\n+            new_count += counts.n_new;",
      "path": "src/addrman.cpp",
      "position": 29,
      "original_position": 29,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "3f99f5a6e58fae4981228929045ed7be32463381",
      "in_reply_to_id": 1494214557,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Might be worth making this overflow-safe?\r\n\r\nI don't know, I don't see a viable way of reaching that.\r\n\r\n> it's really hard to trigger.... feeding addrman with that much garbage would be a failure probably before the size_t limit is hit :)\r\n\r\nI believe that's impractical due to the limited size of addrman.\r\n",
      "created_at": "2024-02-19T18:10:34Z",
      "updated_at": "2024-02-19T18:10:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1494903447",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1494903447"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 733,
      "original_line": 733,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1495427464",
      "pull_request_review_id": 1889779417,
      "id": 1495427464,
      "node_id": "PRRC_kwDOABII585ZImmI",
      "diff_hunk": "@@ -717,13 +717,18 @@ std::pair<CAddress, NodeSeconds> AddrManImpl::Select_(bool new_only, std::option\n     size_t new_count = nNew;\n     size_t tried_count = nTried;\n \n-    if (network.has_value()) {\n-        auto it = m_network_counts.find(*network);\n-        if (it == m_network_counts.end()) return {};\n-\n-        auto counts = it->second;\n-        new_count = counts.n_new;\n-        tried_count = counts.n_tried;\n+    if (!networks.empty()) {\n+        new_count = 0;\n+        tried_count = 0;\n+        for (auto& network : networks) {\n+            auto it = m_network_counts.find(network);\n+            if (it == m_network_counts.end()) {\n+                continue;\n+            }\n+            auto counts = it->second;\n+            new_count += counts.n_new;",
      "path": "src/addrman.cpp",
      "position": 29,
      "original_position": 29,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "3f99f5a6e58fae4981228929045ed7be32463381",
      "in_reply_to_id": 1494214557,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": ">I believe that's impractical due to the limited size of addrman.\r\n\r\nRight, probably fine to keep it this way for both cases.",
      "created_at": "2024-02-20T08:38:55Z",
      "updated_at": "2024-02-20T08:38:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1495427464",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1495427464"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 733,
      "original_line": 733,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1496276836",
      "pull_request_review_id": 1891133220,
      "id": 1496276836,
      "node_id": "PRRC_kwDOABII585ZL19k",
      "diff_hunk": "@@ -154,12 +155,12 @@ class AddrMan\n      *                     an address from the new table or an empty pair. Passing `false` will return an\n      *                     empty pair or an address from either the new or tried table (it does not\n      *                     guarantee a tried entry).\n-     * @param[in] network  Select only addresses of this network (nullopt = all). Passing a network may\n+     * @param[in] networks Select only addresses of these networks (empty = all). Passing networks may\n      *                     slow down the search.\n      * @return    CAddress The record for the selected peer.\n      *            seconds  The last time we attempted to connect to that peer.\n      */\n-    std::pair<CAddress, NodeSeconds> Select(bool new_only = false, std::optional<Network> network = std::nullopt) const;\n+    std::pair<CAddress, NodeSeconds> Select(bool new_only = false, std::unordered_set<Network> networks = {}) const;",
      "path": "src/addrman.h",
      "position": 19,
      "original_position": 19,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "3f99f5a6e58fae4981228929045ed7be32463381",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Looks like the case of empty networks is no longer used outside of tests after this PR. In that case, should we drop the default args and simplify the implementation?",
      "created_at": "2024-02-20T18:07:12Z",
      "updated_at": "2024-02-20T18:07:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1496276836",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1496276836"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 163,
      "original_line": 163,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1497744510",
      "pull_request_review_id": 1893454940,
      "id": 1497744510,
      "node_id": "PRRC_kwDOABII585ZRcR-",
      "diff_hunk": "@@ -275,7 +279,8 @@ BOOST_AUTO_TEST_CASE(addrman_select_special)\n     // since the only ipv4 address is on the new table, ensure that the new\n     // table gets selected even if new_only is false. if the table was being\n     // selected at random, this test will sporadically fail\n-    BOOST_CHECK(addrman->Select(/*new_only=*/false, NET_IPV4).first == addr1);\n+    std::unordered_set<Network> {NET_IPV4} = {NET_IPV4};",
      "path": "src/test/addrman_tests.cpp",
      "position": null,
      "original_position": 84,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "7edb07ca800991f7c88d582b880a392efe17f31d",
      "in_reply_to_id": null,
      "user": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "What is this supposed to do? :/",
      "created_at": "2024-02-21T15:02:52Z",
      "updated_at": "2024-02-21T15:02:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1497744510",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1497744510"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 282,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1499270150",
      "pull_request_review_id": 1895900755,
      "id": 1499270150,
      "node_id": "PRRC_kwDOABII585ZXQwG",
      "diff_hunk": "@@ -275,7 +279,8 @@ BOOST_AUTO_TEST_CASE(addrman_select_special)\n     // since the only ipv4 address is on the new table, ensure that the new\n     // table gets selected even if new_only is false. if the table was being\n     // selected at random, this test will sporadically fail\n-    BOOST_CHECK(addrman->Select(/*new_only=*/false, NET_IPV4).first == addr1);\n+    std::unordered_set<Network> {NET_IPV4} = {NET_IPV4};",
      "path": "src/test/addrman_tests.cpp",
      "position": null,
      "original_position": 84,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "7edb07ca800991f7c88d582b880a392efe17f31d",
      "in_reply_to_id": 1497744510,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Leftover from previous changes, thanks, I'll remove it.",
      "created_at": "2024-02-22T13:48:38Z",
      "updated_at": "2024-02-22T13:48:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1499270150",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1499270150"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 282,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1499286213",
      "pull_request_review_id": 1895926041,
      "id": 1499286213,
      "node_id": "PRRC_kwDOABII585ZXUrF",
      "diff_hunk": "@@ -154,12 +155,12 @@ class AddrMan\n      *                     an address from the new table or an empty pair. Passing `false` will return an\n      *                     empty pair or an address from either the new or tried table (it does not\n      *                     guarantee a tried entry).\n-     * @param[in] network  Select only addresses of this network (nullopt = all). Passing a network may\n+     * @param[in] networks Select only addresses of these networks (empty = all). Passing networks may\n      *                     slow down the search.\n      * @return    CAddress The record for the selected peer.\n      *            seconds  The last time we attempted to connect to that peer.\n      */\n-    std::pair<CAddress, NodeSeconds> Select(bool new_only = false, std::optional<Network> network = std::nullopt) const;\n+    std::pair<CAddress, NodeSeconds> Select(bool new_only = false, std::unordered_set<Network> networks = {}) const;",
      "path": "src/addrman.h",
      "position": 19,
      "original_position": 19,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "3f99f5a6e58fae4981228929045ed7be32463381",
      "in_reply_to_id": 1496276836,
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yes, sure! I'll address it.",
      "created_at": "2024-02-22T13:59:38Z",
      "updated_at": "2024-02-22T13:59:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1499286213",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1499286213"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 163,
      "original_line": 163,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503659916",
      "pull_request_review_id": 1902554269,
      "id": 1503659916,
      "node_id": "PRRC_kwDOABII585ZoAeM",
      "diff_hunk": "@@ -1016,6 +1021,35 @@ std::optional<AddressPosition> AddrManImpl::FindAddressEntry_(const CAddress& ad\n     }\n }\n \n+bool AddrManImpl::HasFewReachableAddresses_(const std::unordered_set<Network>& networks)\n+{\n+    AssertLockHeld(cs);\n+\n+    if (m_network_counts.empty()) {\n+        return false;\n+    }\n+\n+    int total_size{0};\n+    int reachable_size{0};\n+\n+    for (const auto& item : m_network_counts) {\n+        const auto& net{item.first};\n+        const auto& count{item.second};\n+\n+        total_size += (count.n_new + count.n_tried);\n+\n+        if (networks.count(net)) {",
      "path": "src/addrman.cpp",
      "position": 68,
      "original_position": 68,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "in_reply_to_id": null,
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: [`contains`](https://en.cppreference.com/w/cpp/container/unordered_set/contains) is equivalent but more semantically correct here",
      "created_at": "2024-02-27T05:31:47Z",
      "updated_at": "2024-02-27T05:31:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1503659916",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503659916"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1041,
      "original_line": 1041,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503668606",
      "pull_request_review_id": 1902566839,
      "id": 1503668606,
      "node_id": "PRRC_kwDOABII585ZoCl-",
      "diff_hunk": "@@ -3285,6 +3288,12 @@ bool CConnman::Start(CScheduler& scheduler, const Options& connOptions)\n         scheduler.scheduleEvery([this] { ASMapHealthCheck(); }, ASMAP_HEALTH_CHECK_INTERVAL);\n     }\n \n+    auto reachable_nets{g_reachable_nets.All()};\n+    const bool has_few_addresses{addrman.HasFewReachableAddresses(reachable_nets)};\n+    if (has_few_addresses) {",
      "path": "src/net.cpp",
      "position": 42,
      "original_position": 42,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "in_reply_to_id": null,
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: could inline these",
      "created_at": "2024-02-27T05:45:09Z",
      "updated_at": "2024-02-27T05:45:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1503668606",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503668606"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3293,
      "original_line": 3293,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503672316",
      "pull_request_review_id": 1902572174,
      "id": 1503672316,
      "node_id": "PRRC_kwDOABII585ZoDf8",
      "diff_hunk": "@@ -1016,6 +1021,35 @@ std::optional<AddressPosition> AddrManImpl::FindAddressEntry_(const CAddress& ad\n     }\n }\n \n+bool AddrManImpl::HasFewReachableAddresses_(const std::unordered_set<Network>& networks)\n+{\n+    AssertLockHeld(cs);\n+\n+    if (m_network_counts.empty()) {\n+        return false;\n+    }\n+\n+    int total_size{0};\n+    int reachable_size{0};\n+\n+    for (const auto& item : m_network_counts) {\n+        const auto& net{item.first};\n+        const auto& count{item.second};\n+\n+        total_size += (count.n_new + count.n_tried);\n+\n+        if (networks.count(net)) {\n+            reachable_size += (count.n_new + count.n_tried);\n+        }\n+    }\n+\n+    if (reachable_size < total_size / 2) {",
      "path": "src/addrman.cpp",
      "position": 73,
      "original_position": 73,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "in_reply_to_id": null,
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: could return this directly",
      "created_at": "2024-02-27T05:50:42Z",
      "updated_at": "2024-02-27T05:50:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1503672316",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503672316"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1046,
      "original_line": 1046,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503675942",
      "pull_request_review_id": 1902578690,
      "id": 1503675942,
      "node_id": "PRRC_kwDOABII585ZoEYm",
      "diff_hunk": "@@ -1396,6 +1396,9 @@ class CConnman\n     // P2P timeout in seconds\n     std::chrono::seconds m_peer_connect_timeout;\n \n+    // Reachable networks that have addresses in the addrman\n+    std::unordered_set<Network> networks_with_addrs;",
      "path": "src/net.h",
      "position": 5,
      "original_position": 5,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "in_reply_to_id": null,
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Should be [`m_networks_with_addrs`](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#coding-style-c)",
      "created_at": "2024-02-27T05:56:07Z",
      "updated_at": "2024-02-27T05:56:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1503675942",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503675942"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1400,
      "original_line": 1400,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503683117",
      "pull_request_review_id": 1902590359,
      "id": 1503683117,
      "node_id": "PRRC_kwDOABII585ZoGIt",
      "diff_hunk": "@@ -712,7 +712,7 @@ void AddrManImpl::Attempt_(const CService& addr, bool fCountFailure, NodeSeconds\n     }\n }\n \n-std::pair<CAddress, NodeSeconds> AddrManImpl::Select_(bool new_only, std::optional<Network> network) const\n+std::pair<CAddress, NodeSeconds> AddrManImpl::Select_(bool new_only, std::unordered_set<Network> networks) const",
      "path": "src/addrman.cpp",
      "position": 5,
      "original_position": 5,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "in_reply_to_id": null,
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`networks` could be a const reference throughout, no?",
      "created_at": "2024-02-27T06:06:02Z",
      "updated_at": "2024-02-27T06:06:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1503683117",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503683117"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 715,
      "original_line": 715,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503704858",
      "pull_request_review_id": 1902627837,
      "id": 1503704858,
      "node_id": "PRRC_kwDOABII585ZoLca",
      "diff_hunk": "@@ -3285,6 +3288,12 @@ bool CConnman::Start(CScheduler& scheduler, const Options& connOptions)\n         scheduler.scheduleEvery([this] { ASMapHealthCheck(); }, ASMAP_HEALTH_CHECK_INTERVAL);\n     }\n \n+    auto reachable_nets{g_reachable_nets.All()};\n+    const bool has_few_addresses{addrman.HasFewReachableAddresses(reachable_nets)};\n+    if (has_few_addresses) {\n+        networks_with_addrs = reachable_nets;",
      "path": "src/net.cpp",
      "position": 43,
      "original_position": 43,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "in_reply_to_id": null,
      "user": {
        "login": "Empact",
        "id": 5470,
        "node_id": "MDQ6VXNlcjU0NzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Empact",
        "html_url": "https://github.com/Empact",
        "followers_url": "https://api.github.com/users/Empact/followers",
        "following_url": "https://api.github.com/users/Empact/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Empact/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Empact/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
        "organizations_url": "https://api.github.com/users/Empact/orgs",
        "repos_url": "https://api.github.com/users/Empact/repos",
        "events_url": "https://api.github.com/users/Empact/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Empact/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "So, to be explicit, this uses `g_reachable_nets` if `reachable_size < total_size / 2` otherwise all nets. The switch is to avoid the cost of the filtering if the filtering doesn't much reduce the set size, yes?\r\n\r\nA comment to that effect might be helpful, as I had to puzzle out a bit why the value was set only in this case.",
      "created_at": "2024-02-27T06:32:14Z",
      "updated_at": "2024-02-27T06:33:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1503704858",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503704858"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3294,
      "original_line": 3294,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503979427",
      "pull_request_review_id": 1903087340,
      "id": 1503979427,
      "node_id": "PRRC_kwDOABII585ZpOej",
      "diff_hunk": "@@ -1016,6 +1016,35 @@ std::optional<AddressPosition> AddrManImpl::FindAddressEntry_(const CAddress& ad\n     }\n }\n \n+bool AddrManImpl::HasFewReachableAddresses_(const std::unordered_set<Network>& networks)",
      "path": "src/addrman.cpp",
      "position": 51,
      "original_position": 4,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "44aba6cbff49c034703d79b86dc5995d6a7b6c1f",
      "in_reply_to_id": null,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "An outside node easily influences the outcome by feeding garbage, right? Then I'd suggest commenting along the following lines: \"Should not be used for anything critical since it's easily [...]\"",
      "created_at": "2024-02-27T10:13:01Z",
      "updated_at": "2024-02-27T10:15:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1503979427",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503979427"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1024,
      "original_line": 1019,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503982139",
      "pull_request_review_id": 1903087340,
      "id": 1503982139,
      "node_id": "PRRC_kwDOABII585ZpPI7",
      "diff_hunk": "@@ -1016,6 +1016,35 @@ std::optional<AddressPosition> AddrManImpl::FindAddressEntry_(const CAddress& ad\n     }\n }\n \n+bool AddrManImpl::HasFewReachableAddresses_(const std::unordered_set<Network>& networks)",
      "path": "src/addrman.cpp",
      "position": 51,
      "original_position": 4,
      "commit_id": "7b4b9535a7da91627eefc331b50d3b173af185fd",
      "original_commit_id": "44aba6cbff49c034703d79b86dc5995d6a7b6c1f",
      "in_reply_to_id": 1503979427,
      "user": {
        "login": "naumenkogs",
        "id": 7975071,
        "node_id": "MDQ6VXNlcjc5NzUwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/naumenkogs",
        "html_url": "https://github.com/naumenkogs",
        "followers_url": "https://api.github.com/users/naumenkogs/followers",
        "following_url": "https://api.github.com/users/naumenkogs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/naumenkogs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/naumenkogs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
        "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
        "repos_url": "https://api.github.com/users/naumenkogs/repos",
        "events_url": "https://api.github.com/users/naumenkogs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Another improvement could be differentiating new/tried here, since tried is harder to influence.",
      "created_at": "2024-02-27T10:14:45Z",
      "updated_at": "2024-02-27T10:15:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29436#discussion_r1503982139",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1503982139"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29436"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1024,
      "original_line": 1019,
      "side": "RIGHT"
    }
  ]
}