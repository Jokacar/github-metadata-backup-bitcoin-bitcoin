{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442",
    "id": 1729853245,
    "node_id": "PR_kwDOABII585nG3c9",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/29442",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/29442.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/29442.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/0d752b592de19d271c0f14856f661fc5bba8bd60",
    "number": 29442,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "wallet: Target a pre-defined utxo set composition by adjusting change outputs",
    "user": {
      "login": "remyers",
      "id": 8568892,
      "node_id": "MDQ6VXNlcjg1Njg4OTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/remyers",
      "html_url": "https://github.com/remyers",
      "followers_url": "https://api.github.com/users/remyers/followers",
      "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
      "organizations_url": "https://api.github.com/users/remyers/orgs",
      "repos_url": "https://api.github.com/users/remyers/repos",
      "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/remyers/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This PR is designed for the use case of a Lightning node that provides liquidity of predefined amounts via [liquidity ads](https://github.com/lightning/bolts/pull/878).\r\n\r\nCoin selection is currently optimized to reduce the size of the utxo set and create change optimized for privacy. A liquidity provider instead needs to service multiple liquidity requests by spending confirmed utxos of known sizes.\r\n\r\nIdeally most liquidity transactions would be funded by a single input or a small set of inputs optimized to reduce fees. To minimize the number of unconfirmed transactions, inputs should also be sized in a range where most transactions do not produce change. When change is created, it should be divided into outputs of the sizes needed so that the wallet's utxo set converges towards an ideal utxo set specified by the user.\r\n\r\nI am opening this PR as a draft to get feedback and suggestions on the concept and my implementation to address this use case.\r\n\r\nThe algorithm described below can be implemented externally via RPC calls or directly in the wallet. \r\n\r\n1. Externally: use a new option to set the change target used for coin selection. \r\n2. Wallet (opportunistic): a new configuration file defines the desired utxo set which the wallet uses to compute the change target used for coin selection and to split change outputs (if any). \r\n4. Wallet (reactive/proactive):  pre-select a large input to force coin selection to produce change when fees are below some specified threshold or the desired set of utxos falls below some threshold. \r\n\r\n## utxo targets file example:\r\n\r\n```json\r\n{\r\n    \"buckets\": [\r\n        {\r\n            \"start_satoshis\": 10000,\r\n            \"end_satoshis\": 25000,\r\n            \"target_utxo_count\": 150\r\n        },\r\n        {\r\n            \"start_satoshis\": 50000,\r\n            \"end_satoshis\": 75000,\r\n            \"target_utxo_count\": 50\r\n        },\r\n        {\r\n            \"start_satoshis\": 200000,\r\n            \"end_satoshis\": 250000,\r\n            \"target_utxo_count\": 20\r\n        },\r\n        {\r\n            \"start_satoshis\": 1000000,\r\n            \"end_satoshis\": 1400000,\r\n            \"target_utxo_count\": 5\r\n        }\r\n    ],\r\n    \"bucket_refill_feerate\": 30000\r\n}\r\n```\r\n - The `target_utxo_count` for a bucket should be larger than the anticipated number of liquidity requests of `bucket_start_satoshis` within the expected confirmation time of a liquidity transaction.\r\n - The range from `bucket_start_satoshis` to `bucket_end_satoshis` should encompass expected fee variance.\r\n - The `bucket_refill_feerate` should be set to the expected median fee rate (?).\r\n - This file will be reloaded for every spend request to allow for on-the-fly updates\r\n\r\n## Algorithm steps\r\n\r\nFor each payment do the following:\r\n\r\n1) Calculate the current capacity of each target bucket from the wallet's utxo set.\r\n    - Include outputs from both confirmed and unconfirmed transactions in the wallet to calculate capacity.\r\n2) Add our largest confirmed utxo as an input IF the capacity of the least full target bucket is below some threshold (eg. < 30% full) or less than some higher threshold (eg. < 70%) and fee rates are below the `bucket_refill_feerate`.\r\n    - When the largest confirmed utxo is from one of our target buckets, then we should refill our wallet with a utxo from cold storage.\r\n3) Set the minimum change target [`m_min_change_target`](https://github.com/bitcoin/bitcoin/blob/3054416f62644120a4a6bc76e927054c7fbbd487/src/wallet/coinselection.h#L147) to a value from the target bucket with the lowest current capacity.\r\n    - Generate a random change target of the amount: current `change_fee` (the fee for creating an output) + a random value in the range: `bucket_start_satoshis` to `bucket_end_satoshi` - `change_fee`.\r\n    - Currently the change target is set by [`GenerateChangeTarget()`](https://github.com/bitcoin/bitcoin/blob/6ff0aa089c01ff3e610ecb47814ed739d685a14c/src/wallet/coinselection.cpp#L824) in a hard coded range.\r\n    - This parameter is only used by the 'knapsack' and 'coingrinder' algorithms.\r\n4) Call ['SelectCoins()'](https://github.com/bitcoin/bitcoin/blob/3054416f62644120a4a6bc76e927054c7fbbd487/src/wallet/spend.cpp#L1132) with the input from step 2 (if any) added to the `preset_inputs` parameter and with the minimum change target from step 3.\r\n    - The `consolidatefeerate=0` configuration option should always be set so that utxos are not preemptively cosolidated. Coin selection sets the parameter [`m_long_term_feerate`](https://github.com/bitcoin/bitcoin/blob/37fdf5a492786c1772b5b40773a1031237447070/src/wallet/coinselection.h#L160) to the wallets `consolidatefeerate`.\r\n    - Ideally, only the 'bnb' and 'cg' coin selection algorithms should be used and the others disabled to optimize for low fees.\r\n5) If the coin selection result includes a change output, then split the single change output amount into multiple outputs.\r\n    - Add the mimimum change target as an output first.\r\n    - If there is remaining value after paying the fee for a new output, then add a target from the next most empty target bucket.\r\n    - If there is not enough value to add a new output and fees, add remaining value to the last output added instead.\r\n\r\n",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      },
      {
        "id": 5334691551,
        "node_id": "LA_kwDOABII588AAAABPfju3w",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
        "name": "CI failed",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2024-02-16T16:45:09Z",
    "updated_at": "2024-04-26T02:36:50Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "2893610fe17c03007bea2e52d7ebc4fbd38feaa7",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "remyers:2024-02-change-target",
      "ref": "2024-02-change-target",
      "sha": "0d752b592de19d271c0f14856f661fc5bba8bd60",
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 221530299,
        "node_id": "MDEwOlJlcG9zaXRvcnkyMjE1MzAyOTk=",
        "name": "bitcoin",
        "full_name": "remyers/bitcoin",
        "owner": {
          "login": "remyers",
          "id": 8568892,
          "node_id": "MDQ6VXNlcjg1Njg4OTI=",
          "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/remyers",
          "html_url": "https://github.com/remyers",
          "followers_url": "https://api.github.com/users/remyers/followers",
          "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
          "organizations_url": "https://api.github.com/users/remyers/orgs",
          "repos_url": "https://api.github.com/users/remyers/repos",
          "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/remyers/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/remyers/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/remyers/bitcoin",
        "archive_url": "https://api.github.com/repos/remyers/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/remyers/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/remyers/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/remyers/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/remyers/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/remyers/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/remyers/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/remyers/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/remyers/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/remyers/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/remyers/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/remyers/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/remyers/bitcoin/events",
        "forks_url": "https://api.github.com/repos/remyers/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/remyers/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/remyers/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/remyers/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/remyers/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/remyers/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/remyers/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/remyers/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/remyers/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/remyers/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/remyers/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/remyers/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/remyers/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/remyers/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/remyers/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/remyers/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:remyers/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/remyers/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/remyers/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/remyers/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/remyers/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/remyers/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/remyers/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/remyers/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/remyers/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/remyers/bitcoin/hooks",
        "svn_url": "https://github.com/remyers/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 217444,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": true,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-04-15T08:59:41Z",
        "created_at": "2019-11-13T18:56:20Z",
        "updated_at": "2021-10-12T01:52:43Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "0de63b8b46eff5cda85b4950062703324ba65a80",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35298,
        "stargazers_count": 75998,
        "watchers_count": 75998,
        "size": 255111,
        "default_branch": "master",
        "open_issues_count": 686,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-04-26T02:03:20Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-04-26T02:58:31Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": true,
    "additions": 458,
    "deletions": 47,
    "changed_files": 11,
    "commits": 7,
    "review_comments": 7,
    "comments": 9
  },
  "events": [
    {
      "event": "commented",
      "id": 1948862298,
      "node_id": "IC_kwDOABII5850KUda",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1948862298",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-16T16:45:12Z",
      "updated_at": "2024-04-26T02:36:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29442).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29906](https://github.com/bitcoin/bitcoin/pull/29906) (Disable util::Result copying and assignment by ryanofsky)\n* [#29700](https://github.com/bitcoin/bitcoin/pull/29700) (kernel, refactor: return error status on all fatal errors by ryanofsky)\n* [#29523](https://github.com/bitcoin/bitcoin/pull/29523) (Wallet:  Add `max_tx_weight` to transaction funding options (take 2) by ismaelsadeeq)\n* [#29015](https://github.com/bitcoin/bitcoin/pull/29015) (kernel: Streamline util library by ryanofsky)\n* [#28366](https://github.com/bitcoin/bitcoin/pull/28366) (Fix waste calculation in SelectionResult by murchandamus)\n* [#28201](https://github.com/bitcoin/bitcoin/pull/28201) (Silent Payments: sending by josibake)\n* [#26606](https://github.com/bitcoin/bitcoin/pull/26606) (wallet: Implement independent BDB parser by achow101)\n* [#26596](https://github.com/bitcoin/bitcoin/pull/26596) (wallet: Migrate legacy wallets to descriptor wallets without requiring BDB by achow101)\n* [#26022](https://github.com/bitcoin/bitcoin/pull/26022) (Add util::ResultPtr class by ryanofsky)\n* [#25722](https://github.com/bitcoin/bitcoin/pull/25722) (refactor: Use util::Result class for wallet loading by ryanofsky)\n* [#25665](https://github.com/bitcoin/bitcoin/pull/25665) (refactor: Add util::Result failure values, multiple error and warning messages by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1948862298",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "labeled",
      "id": 11831179519,
      "node_id": "LE_lADOABII585_fkYfzwAAAALBMXj_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11831179519",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-16T16:45:14Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11831263913,
      "node_id": "HRFPE_lADOABII585_fkYfzwAAAALBMsKp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11831263913",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-16T16:53:06Z"
    },
    {
      "event": "labeled",
      "id": 11831265260,
      "node_id": "LE_lADOABII585_fkYfzwAAAALBMsfs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11831265260",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-16T16:53:12Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1948874005,
      "node_id": "IC_kwDOABII5850KXUV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1948874005",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-16T16:53:13Z",
      "updated_at": "2024-02-16T16:53:13Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\n🚧 At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/21662752091</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1948874005",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11832889282,
      "node_id": "HRFPE_lADOABII585_fkYfzwAAAALBS4_C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11832889282",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-16T19:29:54Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11834253537,
      "node_id": "HRFPE_lADOABII585_fkYfzwAAAALBYGDh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11834253537",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-16T22:20:27Z"
    },
    {
      "event": "unlabeled",
      "id": 11834570500,
      "node_id": "UNLE_lADOABII585_fkYfzwAAAALBZTcE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11834570500",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-16T23:19:45Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-17T00:02:54Z",
      "updated_at": "2024-02-17T00:02:54Z",
      "source": {
        "issue": {
          "id": 2029493410,
          "node_id": "PR_kwDOABII585hWvMx",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29015",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29015/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29015/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29015/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29015",
          "number": 29015,
          "state": "open",
          "state_reason": null,
          "title": "kernel: Streamline util library",
          "body": "Remove `fees.h`, `errors.h`, and `spanparsing.h` from the util library. Specifically:\r\n\r\n- Move `Split` functions from `util/spanparsing.h` to `util/string.h`, using `util` namespace for clarity.\r\n- Move remaining spanparsing functions to `script/parsing.h` since they are used for descriptor and miniscript parsing.\r\n- Combine `util/fees.h` and `util/errors.h` into `common/messages.h` so there is a place for simple functions that generate user messages to live, and these functions are not part of the util library.\r\n\r\nMotivation for this change is that the util library is a dependency of the kernel, and we should remove functionality from util that shouldn't be called by kernel code or kernel applications. These changes should also improve code organization and make functions easier to discover. Some of these same moves are (or were) part of #28690, but did not help with code organization, or made it worse, so it is better to move them and clean them up in the same PR so code only has to change one time.\r\n",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 118379652,
              "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
              "name": "Validation",
              "color": "6060aa",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 19,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29015",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29015",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29015.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29015.patch"
          },
          "created_at": "2023-12-06T22:26:39Z",
          "updated_at": "2024-04-23T22:03:16Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-17T01:58:11Z",
      "updated_at": "2024-02-17T01:58:11Z",
      "source": {
        "issue": {
          "id": 1833542215,
          "node_id": "PR_kwDOABII585XB4Gh",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28201",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28201/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28201/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28201/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28201",
          "number": 28201,
          "state": "open",
          "state_reason": null,
          "title": "Silent Payments: sending",
          "body": "This PR is part of integrating silent payments into Bitcoin Core. Status and tracking for the project is managed in https://github.com/bitcoin/bitcoin/issues/28536\r\n\r\nThis PR depends on #28122 and is marked as a draft until it is merged. If interested in those commits, please review on #28122\r\n\r\n## Sending \r\n### Silent Payments logic\r\n\r\nThe main focus of this PR is:\r\n\r\n* Applying the Taptweak to a taproot internal private key (this is a copy-paste of the code for applying the taptweak in the signing process)\r\n* Getting a private key from a given `scriptPubKey`\r\n* Creating silent payment outputs\r\n* Applying the created scriptPubKeys back to the vector of `CRecipients`\r\n\r\nThe functions are then used together to create silent payment outputs during `CreateTransactionInternal`.\r\n\r\n### Final steps\r\n\r\nThe last commits ensure that:\r\n\r\n* Coin selection is silent payments aware and knows to exclude taproot script path spends and inputs with unknown witness when funding a transaction which pays to a silent payment address\r\n* The change output type is correctly chosen when paying to a silent payment address\r\n* Functional tests\r\n",
          "user": {
            "login": "josibake",
            "id": 7444140,
            "node_id": "MDQ6VXNlcjc0NDQxNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/josibake",
            "html_url": "https://github.com/josibake",
            "followers_url": "https://api.github.com/users/josibake/followers",
            "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
            "organizations_url": "https://api.github.com/users/josibake/orgs",
            "repos_url": "https://api.github.com/users/josibake/repos",
            "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/josibake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 249581124,
              "node_id": "MDU6TGFiZWwyNDk1ODExMjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Privacy",
              "name": "Privacy",
              "color": "5319e7",
              "default": false
            },
            {
              "id": 5334691551,
              "node_id": "LA_kwDOABII588AAAABPfju3w",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
              "name": "CI failed",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28201",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28201",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28201.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28201.patch"
          },
          "created_at": "2023-08-02T16:37:04Z",
          "updated_at": "2024-04-25T04:29:06Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 1952151548,
      "node_id": "IC_kwDOABII5850W3f8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1952151548",
      "actor": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-19T10:30:39Z",
      "updated_at": "2024-02-19T10:30:39Z",
      "author_association": "CONTRIBUTOR",
      "body": "@murchandamus we'd love to get your feedback on this! I'll try to summarize at a higher level what we'd like to achieve.\r\n\r\nThe `bitcoind` wallet currently tries to keep a somewhat \"minimal\" utxo set and actively consolidates user utxos, because it assumes that we receive transactions as much (or more) than we send transactions and wants outgoing transactions to be as cheap as possible. But that's not true of liquidity service providers, who usually only receive funds when refilling the wallet from cold storage, and want to make sure they always have enough confirmed utxos to satisfy user demand efficiently. In such cases, the wallet operator has a good idea of what they'd like their utxo pool to look like (because they're selling a limited sets of specific amounts), and would like `bitcoind` to try to maintain that utxo pool as much as possible, while optimizing mostly for transaction weight, especially when feerate is high (above a user-defined threshold, similar to `consolidatefeerate` but with the exact opposite semantics - when below that threshold, we want to actively _create_ more utxos, not _consolidate_ them).\r\n\r\nWe can think of this type of wallet as a slowly draining wallet: its total amount is linearly decreasing over time, and is occasionally topped-up from cold storage.\r\n\r\nWe're not sure how to best achieve that. Our goal is to do it inside `bitcoind` (which is the source of truth for the wallet state), but with minimal changes to the coin selection code itself. We'd like this to be as much as possible done by simply pre-processing inputs to the coin selection algorithms and post-processing their outputs, which would make this:\r\n\r\n- easy to rebase on top of bitcoind releases if this work doesn't make sense to be accepted into `bitcoind`\r\n- or as a user-configurable option if that PR can be merged to `bitcoind`",
      "user": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1952151548",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "mentioned",
      "id": 11847586352,
      "node_id": "MEE_lADOABII585_fkYfzwAAAALCK9Iw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11847586352",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-19T10:30:41Z"
    },
    {
      "event": "subscribed",
      "id": 11847586371,
      "node_id": "SE_lADOABII585_fkYfzwAAAALCK9JD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11847586371",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-19T10:30:41Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "notmandatory",
        "id": 4724730,
        "node_id": "MDQ6VXNlcjQ3MjQ3MzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4724730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/notmandatory",
        "html_url": "https://github.com/notmandatory",
        "followers_url": "https://api.github.com/users/notmandatory/followers",
        "following_url": "https://api.github.com/users/notmandatory/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/notmandatory/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/notmandatory/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/notmandatory/subscriptions",
        "organizations_url": "https://api.github.com/users/notmandatory/orgs",
        "repos_url": "https://api.github.com/users/notmandatory/repos",
        "events_url": "https://api.github.com/users/notmandatory/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/notmandatory/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-20T18:07:56Z",
      "updated_at": "2024-02-20T18:07:56Z",
      "source": {
        "issue": {
          "id": 2144978504,
          "node_id": "I_kwDODgwEWM5_2cZI",
          "url": "https://api.github.com/repos/bitcoindevkit/bdk/issues/1356",
          "repository_url": "https://api.github.com/repos/bitcoindevkit/bdk",
          "labels_url": "https://api.github.com/repos/bitcoindevkit/bdk/issues/1356/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoindevkit/bdk/issues/1356/comments",
          "events_url": "https://api.github.com/repos/bitcoindevkit/bdk/issues/1356/events",
          "html_url": "https://github.com/bitcoindevkit/bdk/issues/1356",
          "number": 1356,
          "state": "open",
          "state_reason": null,
          "title": "wallet: target a pre-defined utxo set composition by adjusting change outputs",
          "body": "**Describe the enhancement**  \r\n\r\nThis is an interesting feature that was suggested for the bitcoin core wallet that I think could be useful for bdk wallet users also. See description here: https://github.com/bitcoin/bitcoin/pull/29442\r\n\r\n**Use case**  \r\n\r\nThis would be useful for LN liquidity providers who are using BDK instead of the core wallet, or any other users who might want to maintain a utxo set composition of pre-defined sizes. Could this be useful for payjoin or coinjoin?\r\n\r\n**Additional context**\r\n\r\nThis is very low priority right now, but putting it out there as a reminder for future discussion.",
          "user": {
            "login": "notmandatory",
            "id": 4724730,
            "node_id": "MDQ6VXNlcjQ3MjQ3MzA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4724730?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/notmandatory",
            "html_url": "https://github.com/notmandatory",
            "followers_url": "https://api.github.com/users/notmandatory/followers",
            "following_url": "https://api.github.com/users/notmandatory/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/notmandatory/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/notmandatory/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/notmandatory/subscriptions",
            "organizations_url": "https://api.github.com/users/notmandatory/orgs",
            "repos_url": "https://api.github.com/users/notmandatory/repos",
            "events_url": "https://api.github.com/users/notmandatory/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/notmandatory/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 1803493658,
              "node_id": "MDU6TGFiZWwxODAzNDkzNjU4",
              "url": "https://api.github.com/repos/bitcoindevkit/bdk/labels/enhancement",
              "name": "enhancement",
              "description": "New feature or request",
              "color": "a2eeef",
              "default": true
            },
            {
              "id": 1803493671,
              "node_id": "MDU6TGFiZWwxODAzNDkzNjcx",
              "url": "https://api.github.com/repos/bitcoindevkit/bdk/labels/discussion",
              "name": "discussion",
              "description": "There's still a discussion ongoing",
              "color": "d876e3",
              "default": false
            },
            {
              "id": 2372774528,
              "node_id": "MDU6TGFiZWwyMzcyNzc0NTI4",
              "url": "https://api.github.com/repos/bitcoindevkit/bdk/labels/module-wallet",
              "name": "module-wallet",
              "description": "",
              "color": "efb14c",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 1,
          "created_at": "2024-02-20T18:07:56Z",
          "updated_at": "2024-03-18T02:51:55Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 1893495240,
      "node_id": "PRR_kwDOABII585w3HHI",
      "url": null,
      "actor": null,
      "commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "I really like the fact that it consists mostly of a pre-processing step before coin selection runs, followed by a post-processing step on the output of coin selection.\r\n\r\nShould we also tweak which coin selection algorithms are run depending on whether we're trying to refill buckets (and how aggressive we'd like to be) or not? Some of them may not be well suited for that?",
      "user": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#pullrequestreview-1893495240",
      "submitted_at": "2024-02-21T15:55:17Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
    },
    {
      "event": "commented",
      "id": 1961125346,
      "node_id": "IC_kwDOABII58505GXi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1961125346",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-23T11:01:44Z",
      "updated_at": "2024-02-23T11:01:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Should we also tweak which coin selection algorithms are run depending on whether we're trying to refill buckets (and how aggressive we'd like to be) or not? Some of them may not be well suited for that?\r\n\r\nYes, I think we should only run BnB and Coingrinder. Currently SRD and Knapsack are fallbacks that could win when BnB and CoinGrinder have higher waste metrics. When `consolidatefeerate=0` then `longTermFeeRate=0` and the waste metric used to compare the results of the different algorithms should be based on how much we overshoot the target value + how much it costs to add more inputs.\r\n```c\r\nwaste = selectionTotal - target + inputs × (currentFeeRate - longTermFeeRate)\r\n```\r\nIf one of the algorithms can find a solution with less overshoot than the cost of adding more (small value) inputs, then it seems like they would win. Coingrinder should always find a solution with the least input weight. \r\n\r\nWhen fees are high, I think we should not care if we overshoot our target. We should always prefer a changeless BnB solution over one with change. When we have to produce change, we would prefer the Coingrinder solution with minimal input weight. We will allocate change to outputs sized to favor BnB in the future.\r\n\r\nWhen fees are low, I think we will want to create more change to refill our target buckets, but still not favor more exact matches that use more inputs.",
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1961125346",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "commented",
      "id": 1963579537,
      "node_id": "IC_kwDOABII5851CdiR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1963579537",
      "actor": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T08:37:58Z",
      "updated_at": "2024-02-26T08:37:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "I think we should consider a pluggable architecture for coin selection algorithms.\r\n\r\nIt's clear that there are multiple personas using the bitcoin core wallet, e.g. merchant, customer, lightning wallets. They have different and conflicting needs. So we either will have to have a complicated code and configuration surface to reconcile them or make our code extendable. \r\n\r\nThe interface of coin selection is pretty well defined, so it seems like it is a good fit for extensibility. The coin selection plug-in could receive utxo_pool and target amount as inputs (plus maybe some additional info), and return selected utxo's as result. @remyers @t-bast would something like this work in your case?",
      "user": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1963579537",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "mentioned",
      "id": 11917527211,
      "node_id": "MEE_lADOABII585_fkYfzwAAAALGVwir",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11917527211",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T08:37:59Z"
    },
    {
      "event": "subscribed",
      "id": 11917527229,
      "node_id": "SE_lADOABII585_fkYfzwAAAALGVwi9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11917527229",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T08:37:59Z"
    },
    {
      "event": "mentioned",
      "id": 11917527248,
      "node_id": "MEE_lADOABII585_fkYfzwAAAALGVwjQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11917527248",
      "actor": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T08:38:00Z"
    },
    {
      "event": "subscribed",
      "id": 11917527263,
      "node_id": "SE_lADOABII585_fkYfzwAAAALGVwjf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11917527263",
      "actor": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T08:38:00Z"
    },
    {
      "event": "commented",
      "id": 1963645226,
      "node_id": "IC_kwDOABII5851Ctkq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1963645226",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T09:16:02Z",
      "updated_at": "2024-02-26T09:16:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I think we should consider a pluggable architecture for coin selection algorithms.\r\n\r\nThat's an interesting suggestion. So far in our case I don't see a need to use a different coin selection algorithm, though I do think there might be value in having the ability to selectively disable SRD and knapsack. The current scheme proposed in this PR is more of a wrapper around the existing coin selection system.\r\n\r\nI can not rule out the possibility that there might exist a superior custom coin selection algorithm for this use case. If someone were to propose a different algorithm then that would certainly help motivate a pluggable coin selection architecture.",
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1963645226",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "commented",
      "id": 1969608193,
      "node_id": "IC_kwDOABII5851ZdYB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1969608193",
      "actor": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-28T18:40:35Z",
      "updated_at": "2024-02-28T18:40:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "Is the bitcoin core reference implementation the right place to try these customization/personas?",
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1969608193",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "commented",
      "id": 1973296966,
      "node_id": "IC_kwDOABII5851nh9G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1973296966",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-01T14:25:07Z",
      "updated_at": "2024-03-01T14:25:07Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Is the bitcoin core reference implementation the right place to try these customization/personas?\r\n\r\nThat's a fair question - I think it depends on how widely useful this kind of customization/persona is for different wallet users. \r\n\r\nEven if it's not deemed general enough for more than a draft PR, comments will help improve the implementation in a fork and could feed back less invasive ideas to core.  For example, just having a way to specify the `minimum_change` used by cs could be useful.",
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1973296966",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-01T17:20:07Z",
      "updated_at": "2024-03-01T17:20:07Z",
      "source": {
        "issue": {
          "id": 2162996458,
          "node_id": "PR_kwDOABII585oYykW",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29523",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29523/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29523/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29523/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29523",
          "number": 29523,
          "state": "open",
          "state_reason": null,
          "title": "Wallet:  Add `max_tx_weight` to transaction funding options (take 2)",
          "body": "This PR taken over from #29264\r\n\r\nThe PR added an option `max_tx_weight` to transaction funding RPC's that ensures the resulting transaction weight does not exceed the specified `max_tx_weight` limit.\r\n\r\nIf `max_tx_weight` is not given `MAX_STANDARD_TX_WEIGHT` is used as the max threshold.\r\n\r\nThis PR addressed outstanding review comments in #29264\r\n\r\nFor more context and rationale behind this PR see https://delvingbitcoin.org/t/lightning-transactions-with-v3-and-ephemeral-anchors/418/11?u=instagibbs",
          "user": {
            "login": "ismaelsadeeq",
            "id": 48946461,
            "node_id": "MDQ6VXNlcjQ4OTQ2NDYx",
            "avatar_url": "https://avatars.githubusercontent.com/u/48946461?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ismaelsadeeq",
            "html_url": "https://github.com/ismaelsadeeq",
            "followers_url": "https://api.github.com/users/ismaelsadeeq/followers",
            "following_url": "https://api.github.com/users/ismaelsadeeq/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ismaelsadeeq/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ismaelsadeeq/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ismaelsadeeq/subscriptions",
            "organizations_url": "https://api.github.com/users/ismaelsadeeq/orgs",
            "repos_url": "https://api.github.com/users/ismaelsadeeq/repos",
            "events_url": "https://api.github.com/users/ismaelsadeeq/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ismaelsadeeq/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 5334691551,
              "node_id": "LA_kwDOABII588AAAABPfju3w",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
              "name": "CI failed",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 7,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29523",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29523",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29523.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29523.patch"
          },
          "created_at": "2024-03-01T09:38:37Z",
          "updated_at": "2024-04-24T23:55:59Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-15T09:44:39Z",
      "updated_at": "2024-03-15T09:44:39Z",
      "source": {
        "issue": {
          "id": 2169720264,
          "node_id": "PR_kwDOBGUq285ovn60",
          "url": "https://api.github.com/repos/lightning/bolts/issues/1145",
          "repository_url": "https://api.github.com/repos/lightning/bolts",
          "labels_url": "https://api.github.com/repos/lightning/bolts/issues/1145/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/lightning/bolts/issues/1145/comments",
          "events_url": "https://api.github.com/repos/lightning/bolts/issues/1145/events",
          "html_url": "https://github.com/lightning/bolts/pull/1145",
          "number": 1145,
          "state": "open",
          "state_reason": null,
          "title": "Advertise liquidity ads rates",
          "body": "Add the ability to advertise rates at which nodes wish to sell their liquidity. Buyers can then connect to sellers and request liquidity, at one of the advertised rates.\r\n\r\nThis can be used when creating a dual-funded channel, where both participants contribute to the funding transaction, and one of them is paid for (some of) their contribution. This can also be used to splice additional liquidity into existing channels, when splicing is supported.\r\n\r\nWe don't add any constraints to the commitment transaction. The lease duration isn't protected by script opcodes, which means that the seller could immediately close the channel, or splice funds out. It is up to the buyer to then blacklist that seller.\r\n\r\nThis is a subset of #878 and mostly matches what @niftynei proposed there, with some changes that were discussed during the review process and over threads on the mailing list (such as https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-December/004227.html). The goal of this PR is to be a first step that can be integrated before #878 and allows nodes to buy/sell liquidity without restrictions on the seller side, relying on incentives rather than scripts inside the commitment transactions. This will let us observe what behaviors emerge and the market dynamics. If we feel that adding restrictions on the seller side by modifying the commitment transactions can be useful (as proposed in #878), we can easily add it on top of this change using a dedicated feature bit. It would still allow unrestricted liquidity leases, by simply using a `lease_duration` of `0`. This provides an easy path for a more complex change, without sacrificing simplicity in the short term.",
          "user": {
            "login": "t-bast",
            "id": 31281497,
            "node_id": "MDQ6VXNlcjMxMjgxNDk3",
            "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/t-bast",
            "html_url": "https://github.com/t-bast",
            "followers_url": "https://api.github.com/users/t-bast/followers",
            "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
            "organizations_url": "https://api.github.com/users/t-bast/orgs",
            "repos_url": "https://api.github.com/users/t-bast/repos",
            "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/t-bast/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "COLLABORATOR",
          "locked": false,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/lightning/bolts/pulls/1145",
            "html_url": "https://github.com/lightning/bolts/pull/1145",
            "diff_url": "https://github.com/lightning/bolts/pull/1145.diff",
            "patch_url": "https://github.com/lightning/bolts/pull/1145.patch"
          },
          "created_at": "2024-03-05T16:57:49Z",
          "updated_at": "2024-04-15T14:02:40Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 2015224563,
      "node_id": "IC_kwDOABII5854HeLz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2015224563",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-22T14:27:33Z",
      "updated_at": "2024-03-22T14:27:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\n🚧 At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/22979879322</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-2015224563",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "labeled",
      "id": 12216560411,
      "node_id": "LE_lADOABII585_fkYfzwAAAALYKesb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12216560411",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-22T14:27:33Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-22T20:48:03Z",
      "updated_at": "2024-03-22T20:48:03Z",
      "source": {
        "issue": {
          "id": 1872576431,
          "node_id": "PR_kwDOABII585ZFQ32",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28366",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28366/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28366/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28366/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/28366",
          "number": 28366,
          "state": "open",
          "state_reason": null,
          "title": "Fix waste calculation in SelectionResult",
          "body": "PR #26152 moved waste calculation into SelectionResult to be able to correct the waste score on basis of the bump_fee_group_discount for overlapping ancestries. This left two functions with largely overlapping purpose, where one was simply a wrapper of the other. This PR cleans up the overlap, and fixes the double-meaning of `change_cost` where the `GetChange()` function assumed that no change was created when `change_cost` was set to 0. This behavior was exploited in a bunch of tests, but is problematic, because a `change_cost` of 0 is permitted with custom settings for feerate and discard_feerate (i.e. when they’re both 0).",
          "user": {
            "login": "murchandamus",
            "id": 4060799,
            "node_id": "MDQ6VXNlcjQwNjA3OTk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/murchandamus",
            "html_url": "https://github.com/murchandamus",
            "followers_url": "https://api.github.com/users/murchandamus/followers",
            "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
            "organizations_url": "https://api.github.com/users/murchandamus/orgs",
            "repos_url": "https://api.github.com/users/murchandamus/repos",
            "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/murchandamus/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 10,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28366",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/28366",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/28366.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/28366.patch"
          },
          "created_at": "2023-08-29T22:17:50Z",
          "updated_at": "2024-04-24T18:00:58Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGVhMmZiODNjY2MxN2E4NjdiNDdmOTRhMTZiZDFmMjUxMGY5NzZjYjg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ea2fb83ccc17a867b47f94a16bd1f2510f976cb8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ea2fb83ccc17a867b47f94a16bd1f2510f976cb8",
      "tree": {
        "sha": "d46c809a4d308c4c8fdc67f9ac6e83c40c24035c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d46c809a4d308c4c8fdc67f9ac6e83c40c24035c"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree d46c809a4d308c4c8fdc67f9ac6e83c40c24035c\nparent 2e1c84b333dc744dec04b783dc77b24a55e528d8\nauthor Richard Myers <remyers@yakshaver.org> 1707840382 +0100\ncommitter Richard Myers <remyers@yakshaver.org> 1711384616 +0100\n\nwallet: Add change_target parameter to coin control\n\nAdd a coin control parameter to optionally force a particular change target for coin selection algorithms that result in a change output.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYBqCgWHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7YoY+EACfCS26DBRrITMaRIOXgfW/Wq0I\nAK3r054atnFnO6DB6oSZd0WQA5DZpPVn/230WRluj4nIAFSOqvdhTv6/iAHbE911\nFrcR4/qCAtIghzRHoes4rjLgRrco5BIYf0/AgUuJ+ZdCUt5R0a73qIZYZf/1DUKv\n6ud3HHN5ho2ImU/gq+eDs++XEjQu7O5sMqaRYnvTF1KBpqYNIkacw5QisWPFjoOS\nfNShCRsiKHfKWGkIekI5neIrBpHUb6uYdYRaQbnsAO26q8avTC/H8iuZV3q9wDD8\nS1FQ0H6ljpYQEOOO4+yQG4ArRCBvp327aFHO0fautH7StZIX4pNa++1Ng9Z4mVa1\nWhHB9ArBcXzI9KcVhFUSg+LYxKUeJDEDimXrPICvYHyhRSOKeYIKIMcS0J2x9prY\nTALC3812cyEsGK346wmqX9n5IRqdYrx6qqRcXT2BOmXAO11ByTXblpBZD79LxT+I\nBGF5Rw1GK2uhqftACocW7UvhZKL/6AuH4QSsl9Mt7uncQUQDKcl0//7Hs6O9HqKw\nmRw4HIx6hwMES/x8KQgl9fBSzutXOhddwkUhofzD/6zGw4dDUuJqLJyXyPUwW50A\nd949KgZqdzZ8AEMRbaC6MAVTlVpLK+ykYIdYCc4Yt0XRmoGUWIv/4rPOtQdutr3l\nZgDtO/rdcNoPQBn7Pg==\n=24ws\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2e1c84b333dc744dec04b783dc77b24a55e528d8",
          "sha": "2e1c84b333dc744dec04b783dc77b24a55e528d8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2e1c84b333dc744dec04b783dc77b24a55e528d8"
        }
      ],
      "message": "wallet: Add change_target parameter to coin control\n\nAdd a coin control parameter to optionally force a particular change target for coin selection algorithms that result in a change output.",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-25T16:36:56Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-02-13T16:06:22Z"
      },
      "sha": "ea2fb83ccc17a867b47f94a16bd1f2510f976cb8"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDgzYjFmNWQyNWU3NzI3ZmZmOTQ3NGM0NmNhYjYyNGFjMjljYmU2YTY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/83b1f5d25e7727fff9474c46cab624ac29cbe6a6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/83b1f5d25e7727fff9474c46cab624ac29cbe6a6",
      "tree": {
        "sha": "1411a936c5c90b27ec4d7a42326e2e653705a6cb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1411a936c5c90b27ec4d7a42326e2e653705a6cb"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 1411a936c5c90b27ec4d7a42326e2e653705a6cb\nparent ea2fb83ccc17a867b47f94a16bd1f2510f976cb8\nauthor Richard Myers <remyers@yakshaver.org> 1706102379 +0100\ncommitter Richard Myers <remyers@yakshaver.org> 1711384616 +0100\n\nwallet: Define utxo set targets to replenish when spends have change\n\nAdd a config option to load a json file that defines a set of utxo target buckets with a value range and count. When the current utxo set for the wallet does not match or exceed the counts for the value ranges of the buckets, opportunistically split the change output produced by coin selection (if any) into additional outputs.\n\nTarget buckets will be refilled from most to least depleted. The value of a new output to refill a target bucket will be randomly selected from its value range.\n\nOnce all buckets are full the change output will not be further split.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYBqCgWHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7YvseD/9wqbiKVnbelMSbpP6kLY2aQy8s\nBynSh8zJJiG/J0/mPGikQEjqw+xOkN2pE61wPoItNwMaWuAh9ImjVn0T94RX3BDV\nc/8Cy/qWBcayNYP1dWnESsgRG7qRTFSRBShywhflhCY27H/p7URYybe/Rv8yoF6a\nvJwUsRW2V6qD/80jH6YJ2CDA62e3BQfiZO9kS0TbxEyN8tknzytphKBJkBBrI0CD\n1+QMoceIBm66tBziM2Qjn2SwT2cJceEqTHdpiA5o5UnmcSWXSLv2CIZCQnjcRJmI\n5hGeZoZx5a2KlBlL1tVKePCHejW7jaXmN0ZloJQYZEq4KxsmwSQA4S0tQWwe0ASg\nnJOr2Z+KBEXwyRSIs3YrNtO+mH9zB7MTn4kAVXaOC7tpuf0gZrc3GXuKr67A0Dtc\nj3htr8tXM01y3ZnLPzpYND55fnprruY+tr6dlSu3aYsCNwcgZTJnDdCE/Q75iE4b\nrTPXueOlTwfrJSBvfjuqXHnAvvRVJRJCSQooc4LivV3q4CTQV7aKiP+A/Og+zh2q\nHfP0UnZLM3I4Uh4cJEvuYeHBlN7VaooLJ/lIZ1Itvl40CmUc9BQqBNDglUQdO5ko\nfiYXZuS5UPOVc7c9qmXfKbcSxSSLyl13VVtmgLfURqk17k7F/y5jpqbRng8ijRE6\n9GJXZXt3SdcsaRpEOA==\n=nVXp\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ea2fb83ccc17a867b47f94a16bd1f2510f976cb8",
          "sha": "ea2fb83ccc17a867b47f94a16bd1f2510f976cb8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ea2fb83ccc17a867b47f94a16bd1f2510f976cb8"
        }
      ],
      "message": "wallet: Define utxo set targets to replenish when spends have change\n\nAdd a config option to load a json file that defines a set of utxo target buckets with a value range and count. When the current utxo set for the wallet does not match or exceed the counts for the value ranges of the buckets, opportunistically split the change output produced by coin selection (if any) into additional outputs.\n\nTarget buckets will be refilled from most to least depleted. The value of a new output to refill a target bucket will be randomly selected from its value range.\n\nOnce all buckets are full the change output will not be further split.",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-25T16:36:56Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-01-24T13:19:39Z"
      },
      "sha": "83b1f5d25e7727fff9474c46cab624ac29cbe6a6"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE2NDE3MzYxNTY2ZWJhMWNkOWJiMmI5MjIyZTAwNDYxYmI1MzgzMTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/16417361566eba1cd9bb2b9222e00461bb538310",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/16417361566eba1cd9bb2b9222e00461bb538310",
      "tree": {
        "sha": "14f9654cd60e503a3ed4ead7d7637d1336889d30",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/14f9654cd60e503a3ed4ead7d7637d1336889d30"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 14f9654cd60e503a3ed4ead7d7637d1336889d30\nparent 83b1f5d25e7727fff9474c46cab624ac29cbe6a6\nauthor Richard Myers <remyers@yakshaver.org> 1707838360 +0100\ncommitter Richard Myers <remyers@yakshaver.org> 1711384617 +0100\n\nwallet: Refill utxo target buckets proactively\n\nWhen utxo targets are specified and a utxo target bucket is depleted, or fees are low, produce excess change that can be split to replenish the utxo target set. This is accomplished by including a large valued utxo as an input to coin selection.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYBqCkWHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7YtaSEACU8JJ6gkQrDycWZGF7WuXoPo0I\n5X6hlsfhHoE9QIiUKcUZlsEtQJZOzImwdHzjc4GtzCdgfMoQRnFHyswDb0/pNPvg\nQhFfn7G5hW/AAr6gi2AJJTvupntn4p09vfVdsNKwyzjX+tBiDP5eFdP4chaXdv3o\nQ7rWhGJ7ykuQw+fEkkC8ISoMRCTRFEwmxRzB0xC5/83RoBDYsasj6V/5sXX3aWVi\nrldgn5kGI1ZdfY2xzOX+SoZSkDrpdbsw3s/xdz1KtxcsZ7u/QQWX6ief2DUft1Yb\nJes+k4mc0Cavuy2j+60IOm3f0Y43ASiRzUBk/viPkdC1Q5nCjoLOq+eb/Fd5qwcx\nKjU6/wkkWtv89LEgaw3cSxMnQ/wHw18R3k8YbYWau/ONUeAbic26lZXRYNhGjBq2\nEjDZqB2boHnXQjfrMbG9v61z1bWSamScCcCOnGaAxXAzl796fdOuGMZ2LSecWe+Z\nhOAi29dJzSfy6Ck2FEpSMK6sVpnUTOOXzlYi7e0jFVFOR+aaH/mhgOl1CJmP1Szh\noNngcUWXPKSl0EEZqyplSDpqDi/uWuu7H2YumuZdq05MTqfn+carSJAQLwJohFf6\nx6L+4hcw9N3+WiS8ZwrATVfHV+2Z1kxZWMh50+s8qOITurq+hPar0WvXdPOvKgNl\ngrHg6gyUfSpbVAmHVQ==\n=E0SW\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/83b1f5d25e7727fff9474c46cab624ac29cbe6a6",
          "sha": "83b1f5d25e7727fff9474c46cab624ac29cbe6a6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/83b1f5d25e7727fff9474c46cab624ac29cbe6a6"
        }
      ],
      "message": "wallet: Refill utxo target buckets proactively\n\nWhen utxo targets are specified and a utxo target bucket is depleted, or fees are low, produce excess change that can be split to replenish the utxo target set. This is accomplished by including a large valued utxo as an input to coin selection.",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-25T16:36:57Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-02-13T15:32:40Z"
      },
      "sha": "16417361566eba1cd9bb2b9222e00461bb538310"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGUzMTcwNmE5NTdkODM0Yjc5MmYyMDZjZmI3NDQ2MWIzNzJmYWY3YmI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e31706a957d834b792f206cfb74461b372faf7bb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e31706a957d834b792f206cfb74461b372faf7bb",
      "tree": {
        "sha": "5049ae109952b8a580c76db8f8fd11be969fee1a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5049ae109952b8a580c76db8f8fd11be969fee1a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 5049ae109952b8a580c76db8f8fd11be969fee1a\nparent 16417361566eba1cd9bb2b9222e00461bb538310\nauthor Richard Myers <remyers@yakshaver.org> 1709544761 +0100\ncommitter Richard Myers <remyers@yakshaver.org> 1711384617 +0100\n\nCompute utxo targets using unconfirmed outputs\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYBqCkWHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7YiXnD/sFZ6lBs0selhsiBSVoG3HhyBUs\nGEoLqFVZGBZ8sGSkmLi6tz54nMCXMEOk7I8fn49wh3JgLRJkXGL9+P9wF6EAF0xi\nv7xEeKIIXzBcRDz5URYB+JRbZui+dK9CpYMOFTxKBH2y/0EjpVoPcLQNX4g9MXnZ\n+tmT3yfTBnAM7ctxlmx6JvgxU/SEVPilfkga7hh4BcEXw7YzL2OtnzH/3LvbZGL3\n6yxLDUn81SL5Ms2E8r6mOPJn+q/3qpl2H3f2IpmLAg+D+C/awjxaauKWd9O8mtFb\narBUxZWIHCQ/OdDbz7QpYvLHOK9WaKY/WSwdlcMkeyyfy/h5a0qkt9/Rtbfqemxi\nfOoiASvo3lLOYaK4F9D/88c51CZ7ZwNvrPLrkXpaxto2/R2PADjXv0i44ACcLO0Z\nX/XPJQCqu1V6fU0Iep6RZRQXiFBRpnOibslufJFlMHffuKfSNHCZV7NgBjaqvqAh\ncH3IrlD+NxhUzqiyX0/u7JBYc/SN5sU9K0MFbjYQ2YXYeEhnXYXgP3KNZbI3ViyJ\nNAtaeCUruqHgula8Wk0S/1CLKY1goYrT6tBmE3Bs/dNk1ryAd82MWj8v6woiucqT\nvjva9xgAKWkdK43nNM768BVJF1foZjw0Ryjun0QM2eiG2Wk1EaIgctg6AtyQm9+a\n4xwk3lzuCE14TSNdEg==\n=w9nI\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/16417361566eba1cd9bb2b9222e00461bb538310",
          "sha": "16417361566eba1cd9bb2b9222e00461bb538310",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/16417361566eba1cd9bb2b9222e00461bb538310"
        }
      ],
      "message": "Compute utxo targets using unconfirmed outputs",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-25T16:36:57Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-04T09:32:41Z"
      },
      "sha": "e31706a957d834b792f206cfb74461b372faf7bb"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU0MWQ4NTNiZGEzNzg3ZmY0MGVlZDM2NjFhYmRhNjVjYjVkNzQzN2I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e41d853bda3787ff40eed3661abda65cb5d7437b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e41d853bda3787ff40eed3661abda65cb5d7437b",
      "tree": {
        "sha": "966ae5cae0c67cbb6053a2c66649a6995b4f0a92",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/966ae5cae0c67cbb6053a2c66649a6995b4f0a92"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 966ae5cae0c67cbb6053a2c66649a6995b4f0a92\nparent e31706a957d834b792f206cfb74461b372faf7bb\nauthor Richard Myers <remyers@yakshaver.org> 1710860130 +0100\ncommitter Richard Myers <remyers@yakshaver.org> 1711384618 +0100\n\nAdd max_excess coin selection parameter\n\nWhen considering a transaction without change, the max_excess amount is how much extra value can be added to the target value and not be counted as waste.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYBqCoWHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7Yg3oD/9e4KND33hko3V5iupmVrU7S15Z\nJO8oqneL9qm5i4cdeK0wn7sij8l71G3BIzmQNLcoBs0wuqR6CtfKbsfVkUfxp8+Y\nql6I/BvpWsMN2bUV1uU7lhJgNqlTc1LtzvkxWOflfEEVf/MhkYb1Px9WV7luEwzT\nTSuUoyppJRcLqVEbPJi3DdeTqhEDhlGUk+8iNuG7ARxAfxyKWTmznbrIWFmBu9DI\nCBYj++l1Yrj3AimrRGGkrUXdsbqMeS7tEjs4R32AlY1WxOHfa9LOh2HeO9AZpjWZ\nPS47yRI8/8gMW4YWoXlNJF7Ue1aFXLjeurPMhKzLzimKVBOuiGmK53crAcHUVJgG\nz5xLdGvbLvm/t8HrbySoCt5Ec+U1DS1qbo4KKhZGiAIyPO4A3KTwVZBG0GKDV8xs\n1VJ6xCG/8MD0e3qZHmh+tIjo28TeW0z4ZM+PqlRsWh6D6HDaRdun5ya9Y43JMn+i\nhVhyLJ7EBAp00UcMStxI9svUTpGss8Pt0Fa7eXEB8hwFvwsXm8eNs2wGaU7ONGmw\nyuAK47jAR6+RG/O1WITeUD2pmYUW2ihO3r69AOwKgl+CHAf2IHtXMaRW26VQjHkC\nm3+3HxsOstIF/hORH6O2DPVgstbnJxVwANtCi9EmrfdxPH1UrkgR37Pj08bRYntY\n0/OO4ciFLAQKpzTHKg==\n=kzHF\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e31706a957d834b792f206cfb74461b372faf7bb",
          "sha": "e31706a957d834b792f206cfb74461b372faf7bb",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e31706a957d834b792f206cfb74461b372faf7bb"
        }
      ],
      "message": "Add max_excess coin selection parameter\n\nWhen considering a transaction without change, the max_excess amount is how much extra value can be added to the target value and not be counted as waste.",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-25T16:36:58Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-19T14:55:30Z"
      },
      "sha": "e41d853bda3787ff40eed3661abda65cb5d7437b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDY3NjRhZmI5NWVhNTU2Mzg5MzMxN2UzMzJlYjAwYmMyOTVmNjA4ZTk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6764afb95ea5563893317e332eb00bc295f608e9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6764afb95ea5563893317e332eb00bc295f608e9",
      "tree": {
        "sha": "9eb2f51b484ac2f201384bb678e9637b41f53b3e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9eb2f51b484ac2f201384bb678e9637b41f53b3e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 9eb2f51b484ac2f201384bb678e9637b41f53b3e\nparent e41d853bda3787ff40eed3661abda65cb5d7437b\nauthor Richard Myers <remyers@yakshaver.org> 1711399326 +0100\ncommitter Richard Myers <remyers@yakshaver.org> 1711399326 +0100\n\nAdd coin control rpc option \"disable_algos\"\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYB4Z4WHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7YpwED/4mVxmyxiOHNB5P8zxV44TwdfrK\nDD38Ry//ceBbHdNUlgwW5ojLzUvU8M0wQgOE8XGvz/PI57UATn7r8r+8N276+CR8\neq9OVqKNNCtrsWaQo47uT61a4+3cjULGARjoXhRQSPnVUlHEIeuf+LCgXUQWixSd\nbp8vuCtZY02j34ummJLo5hCL2gCzQ+aoH+ObeF6qPL4bUbvj3/ITB489uKDKkhFw\n5vkR6gwJEY2/ubRxMf3i4u27BAvS7lApy3Q/l1W+CvEKZ3BalMRWeGMkO7z/TsBH\n64/hzzxkbajkDRO4HFKyipQfRfBJ//Jn5nOcaMXCQSAF1blOWtAhYshJk28OkiDX\nxzY1f2qtb6roGORVU9Ry2wwto1M4DZDJ5JB3TjUn6UdaLPFSVW/xsZqJvtLBS+8g\nVnRQXcZ7/kODrzicgPbkkvkamz0a8gdSP8c33f+10/Tjxcfj5LbCaPqB3WGYMx3d\ns7/+lKIzHU5RW2muN9emfk7z7kyha2WOlew9LaRuZVtSHk7MYJ3sJ2R69Fe7AbE3\nZ/In7LeXeUIW0PisiIYCgauDhfXg6caScZJ/ENyYRFcSMeSG89/vjpsS3fh1C8pt\nHnFTvifKF4jMEMvfv0WsJCNBJf27dnzXrXLK5QlBpFJWjnx0PqGUX5peupboYjQ+\nTSeeUUK7K9Nf8TH2ig==\n=TFH2\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e41d853bda3787ff40eed3661abda65cb5d7437b",
          "sha": "e41d853bda3787ff40eed3661abda65cb5d7437b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e41d853bda3787ff40eed3661abda65cb5d7437b"
        }
      ],
      "message": "Add coin control rpc option \"disable_algos\"",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-25T20:42:06Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-25T20:42:06Z"
      },
      "sha": "6764afb95ea5563893317e332eb00bc295f608e9"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBkNzUyYjU5MmRlMTlkMjcxYzBmMTQ4NTZmNjYxZmM1YmJhOGJkNjA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0d752b592de19d271c0f14856f661fc5bba8bd60",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0d752b592de19d271c0f14856f661fc5bba8bd60",
      "tree": {
        "sha": "f18ee5ee403ba61f327f6131c06dda52c76a6dcf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f18ee5ee403ba61f327f6131c06dda52c76a6dcf"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree f18ee5ee403ba61f327f6131c06dda52c76a6dcf\nparent 6764afb95ea5563893317e332eb00bc295f608e9\nauthor Richard Myers <remyers@yakshaver.org> 1712603118 +0200\ncommitter Richard Myers <remyers@yakshaver.org> 1713171460 +0200\n\nAdd new pre-coinselection using utxotargets and feerate estimates\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYc7AcWHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7YtHeD/9BZ1TmhTbGOj6twsI2iTDEUi5t\ng1eITtSm0LRGOuRbMc0TRULbHHKFTGjFOg47k2iuYsn1HpOhjmqhnGHydXF3YKw6\nEcXekOtv1/rQmO22VdS+gZLbHB4l6fHYSb7gGyOmP/xDYk4R8/EFt84XqEA1ueMN\nSY6cl9TqN6bvzNWiHp+Kfz/ngIuzVLOilZf+Ojn5Sky8Xmx9DoKZkTv4iIAJdsky\n2b8ZnWHqmxMlU3QthEn5/a9ejSAve9iUfxelBF/nsCGildOmNzXKueS0uLVZ6knj\noRuFb1B4euyPRbNJLGk7EMcwTFU+bO/HzR9x1TnTZDMTncs+38VL6mlRkBG1TiVM\n5uBxWziwcD/nboaPJBRVa17O1q8lzg5uFMjXA2GpLpKLrlrqZiO84iVFjZR2sK96\nzEPM+wO62erlF15vjg3gISTyePh4Oc8PvQUsbgXIBJgZbmgQAkpKZAgNLP4YlNqp\n9qjZRlo0DVr9ffoBG3/4mHhc9I+E+BvVSUhrhsmKmJiEjnprtn8/WHvFidHDidnD\nKBTidfNK0g0B3RCCRr/C0XcrCh2kCSmUBKTpbs0sZhW5qHct5HhrFFjBHnB/ecwK\nEH/VSibZHW9LaUL7lMVKSZyR1a4jMKmi0KLewNrXqxH9KLUoxO0TmC9RS3kKN3I8\nmYTmBo4Ih8L7c4FBzg==\n=JkHs\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6764afb95ea5563893317e332eb00bc295f608e9",
          "sha": "6764afb95ea5563893317e332eb00bc295f608e9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6764afb95ea5563893317e332eb00bc295f608e9"
        }
      ],
      "message": "Add new pre-coinselection using utxotargets and feerate estimates",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-04-15T08:57:40Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-04-08T19:05:18Z"
      },
      "sha": "0d752b592de19d271c0f14856f661fc5bba8bd60"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12465566393,
      "node_id": "HRFPE_lADOABII585_fkYfzwAAAALnAXK5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12465566393",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-15T08:59:43Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-16T02:12:50Z",
      "updated_at": "2024-04-16T02:12:50Z",
      "source": {
        "issue": {
          "id": 1363503515,
          "node_id": "PR_kwDOABII584-c4WZ",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26022",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26022/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26022/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26022/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26022",
          "number": 26022,
          "state": "open",
          "state_reason": null,
          "title": "Add util::ResultPtr class",
          "body": "**This is based on #25665.** The non-base commits are:\r\n\r\n- [`96809f65d1dd` Add util::ResultPtr class](https://github.com/bitcoin/bitcoin/pull/26022/commits/96809f65d1ddcf0bde953fd69922908ad64f2539)\r\n- [`8ecac0885ef5` Use ResultPtr<unique_ptr> instead of Result<unique_ptr>](https://github.com/bitcoin/bitcoin/pull/26022/commits/8ecac0885ef5b6fc2313cd2f8dfb48c10a05db27)\r\n\r\n---\r\n\r\nThe `util::ResultPtr` class is a wrapper for `util::Result` providing syntax sugar to make it less awkward to use with returned pointers. Instead of needing to be deferenced twice with `**result` or `(*result)->member`, it only needs to be dereferenced once with `*result` or `result->member`. Also when it is used in a boolean context, instead of evaluating to true when there is no error and the pointer is null, it evaluates to false so it is straightforward to determine whether the result points to something.\r\n\r\nThis PR is only partial a solution to #26004 because while it makes it easier to check for null pointer values, it does not make it impossible to return a null pointer value inside a successful result. It would be possible to enforce that successful results always contain non-null pointers by using a `not_null` type (https://github.com/bitcoin/bitcoin/issues/24423) in combination with `ResultPtr`, though.\r\n",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 4,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26022",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26022",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26022.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26022.patch"
          },
          "created_at": "2022-09-06T15:57:14Z",
          "updated_at": "2024-04-25T06:04:32Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-16T02:24:44Z",
      "updated_at": "2024-04-16T02:24:44Z",
      "source": {
        "issue": {
          "id": 1320033494,
          "node_id": "PR_kwDOABII5848NBt5",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25722",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25722/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25722/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25722/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25722",
          "number": 25722,
          "state": "open",
          "state_reason": null,
          "title": "refactor: Use util::Result class for wallet loading",
          "body": "**This is based on #25665 + #26022.** The non-base commits are:\r\n\r\n- [`b027d1df5981` refactor: Use util::Result class in wallet/spend](https://github.com/bitcoin/bitcoin/pull/25722/commits/b027d1df598177dec3236f8689b3218f53de3fa9)\r\n- [`5972a3abf26c` Add temporary ResultExtract helper for porting to util::Result](https://github.com/bitcoin/bitcoin/pull/25722/commits/5972a3abf26c25e47db298461c08a4553e4010bb)\r\n- [`1a92d9497bd1` refactor: Use util::Result class in wallet/sqlite](https://github.com/bitcoin/bitcoin/pull/25722/commits/1a92d9497bd158a1d16efd281c68e41fa11e5b0d)\r\n- [`b4fbcf5f2a8f` refactor: Use util::Result class in wallet/bdb](https://github.com/bitcoin/bitcoin/pull/25722/commits/b4fbcf5f2a8f3b390b4041ac98f16161c5181a76)\r\n- [`f56538aa2b92` refactor: Use util::Result class in wallet::MakeDatabase](https://github.com/bitcoin/bitcoin/pull/25722/commits/f56538aa2b924aaeae28f55b41c03eb0145c981d)\r\n- [`e880f6d5e89b` refactor: Use util::Result class in wallet/dump](https://github.com/bitcoin/bitcoin/pull/25722/commits/e880f6d5e89bbdceed2e4d769882f37b3a3c81b2)\r\n- [`4128ab5cdcc6` refactor: Use util::Result class in wallet/salvage](https://github.com/bitcoin/bitcoin/pull/25722/commits/4128ab5cdcc6e2a540e994b615618586e902ccda)\r\n- [`1138e12cfd98` refactor: Use util::Result class in wallet/wallettool](https://github.com/bitcoin/bitcoin/pull/25722/commits/1138e12cfd984fbceaa045348d993b70047d3ab3)\r\n- [`aed183ad112f` refactor: Use util::Result class in wallet/wallet](https://github.com/bitcoin/bitcoin/pull/25722/commits/aed183ad112f00d7ac11435244149e8e936494f9)\r\n- [`032e3e1ebf9b` refactor: Use util::Result class in wallet/load](https://github.com/bitcoin/bitcoin/pull/25722/commits/032e3e1ebf9b1d86596e8393f85461d60074e821)\r\n- [`46ed2908e6f8` refactor: Use util::Result class in wallet/rpc](https://github.com/bitcoin/bitcoin/pull/25722/commits/46ed2908e6f8b6d0f2ebcfc5600a52c61f26109e)\r\n- [`799467626de3` refactor: Use util::Result class in wallet/interfaces](https://github.com/bitcoin/bitcoin/pull/25722/commits/799467626de3c40249be6f0be4ecef5aa5757ed9)\r\n- [`5c7e1caff7db` refactor: Use util::Result class in wallet/test](https://github.com/bitcoin/bitcoin/pull/25722/commits/5c7e1caff7db1f9a61e94e40c22f056f9bef9715)\r\n- [`965c31baa9a3` Drop temporary ResultExtract helper for porting to util::Result](https://github.com/bitcoin/bitcoin/pull/25722/commits/965c31baa9a357e5a92bf4da94e84c37df7e0a9f)\r\n- [`2385cb37dbbe` scripted-diff: replace wallet DatabaseStatus with DatabaseError](https://github.com/bitcoin/bitcoin/pull/25722/commits/2385cb37dbbe00004f8bffe1d1d784778d89a21e)\r\n\r\n---\r\n\r\nWallet loading functions up and down the stack have lots of error and warning parameters, and return error information in different ways. This PR makes them uniformly return `util::Result`, without changing behavior.",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 6,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25722",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25722",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25722.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25722.patch"
          },
          "created_at": "2022-07-27T19:26:58Z",
          "updated_at": "2024-04-25T06:13:16Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-16T02:27:24Z",
      "updated_at": "2024-04-16T02:27:24Z",
      "source": {
        "issue": {
          "id": 1313204802,
          "node_id": "PR_kwDOABII58472hm-",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25665",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25665/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25665/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/25665/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/25665",
          "number": 25665,
          "state": "open",
          "state_reason": null,
          "title": "refactor: Add util::Result failure values, multiple error and warning messages",
          "body": "**This is based on #29906.** The non-base commits are:\r\n\r\n- [`f5c4d18bd010` refactor: Add util::Result failure values](https://github.com/bitcoin/bitcoin/pull/25665/commits/f5c4d18bd010c9af9ae84b9a507c79c3d9225f1a)\r\n- [`1376583dca0a` refactor: Use util::Result class in LoadChainstate and VerifyLoadedChainstate](https://github.com/bitcoin/bitcoin/pull/25665/commits/1376583dca0a8c34be0be53fd4d7f21b156d2133)\r\n- [`e9a5ad3f4b8c` refactor: Add util::Result multiple error and warning messages](https://github.com/bitcoin/bitcoin/pull/25665/commits/e9a5ad3f4b8ce9c21b144de35fd761333bff7a70)\r\n- [`55d7de92bbbe` test: add static test for util::Result memory usage](https://github.com/bitcoin/bitcoin/pull/25665/commits/55d7de92bbbe035c1833c89f885af14e5b243932)\r\n\r\n---\r\n\r\nAdd `util::Result` support for returning more error information and make use of it in [LoadChainstate method](https://github.com/bitcoin/bitcoin/pull/25665/commits/1376583dca0a8c34be0be53fd4d7f21b156d2133) as an initial application. Followup PR [#25722](https://github.com/bitcoin/bitcoin/pull/25722) uses it more broadly to return errors and warnings from wallet loading functions as well.\r\n\r\nThis change adds two major features to the result class:\r\n\r\n- For better error handling, adds the ability to return a value on failure, not just a value on success. This is a key missing feature that makes the result class not useful for functions like `LoadChainstate()` which produce different errors that need to be handled differently [^1].\r\n\r\n[^1]: Ability to return error values was actually present in the original implementation of [#25218](https://github.com/bitcoin/bitcoin/pull/25218), but unfortunately removed in later iterations.\r\n\r\n- For better error reporting, adds the ability to return warning messages and multiple errors, not just a single error string. This provides a way for functions to report errors and warnings in a standard way, and simplifies interfaces:\r\n\r\n    ```diff\r\n    -virtual std::unique_ptr<Wallet> loadWallet(const std::string& name, bilingual_str& error, std::vector<bilingual_str>& warnings) = 0;\r\n    +virtual util::Result<std::unique_ptr<Wallet>> loadWallet(const std::string& name) = 0;\r\n    ```\r\n\r\n    ```diff\r\n    -std::unique_ptr<WalletDatabase> MakeDatabase(const fs::path& path, const DatabaseOptions& options, DatabaseStatus& status, bilingual_str& error);\r\n    +util::Result<std::unique_ptr<WalletDatabase>, DatabaseError> MakeDatabase(const fs::path& path, const DatabaseOptions& options);\r\n   ```\r\n\r\nThis change also makes some more minor improvements:\r\n\r\n- Smaller type size. `util::Result<int>` is 16 bytes, and `util::Result<void>` is 8 bytes. Previously both were 72 bytes.\r\n\r\n- Broader type compatibility. Supports noncopyable and nonmovable success and error types.\r\n\r\n### Alternatives & design notes\r\n\r\nThe main goal for the `util::Result` class is to provide a standard way for functions to report error and warnings strings. The interface tries to make it easy to provide detailed error feedback to end users, without cluttering code or making it harder to return other result information. There have been multiple iterations of the design using different internal representations and providing different capabilities:\r\n\r\n|   | Representation (approximate)                   | Notes |\r\n|---|------------------------------------------------|-------|\r\n| _1_ | `tuple<T,optional<bilingual_str>>`        | Original #25218 implementation in da98fd2efc1a6b9c6e876cf3e227a8c2e9a10827. Good capabilities, but larger type size. Supports error standardized error reporting and customized error handling with failure values. |\r\n| _2_ | `variant<T,bilingual_str>`                | Final #25218 implementation in 7a45c33d1f8a758850cf8e7bd6ad508939ba5c0d. No support for returning failure values so not useful in many cases.\r\n| _3_ | `variant<monostate,T,F>`                 | Pending #25601 implementation that allows choosing whether to use standardized error reporting or return custom failure values, but doesn't support having both at the same time, like approaches _(1)_, _(4)_, _(5)_, _(6)_ do. |\r\n | _4_ | `tuple<variant<T,F>,bilingual_str>`      | Original #25608 implementation in c29d3008de9314dd463ed08e8bff39fe55324498. Basically the same as _(1)_ except it uses separate success and failure types instead of the same type. Using separate success and failure types makes the result class a little less flexible but can help avoid some ambiguity and inconsistent result states. |\r\n| _5_ | `tuple<T,optional<bilingual_str>>`        | Final #25608 implementation in dd91f294206ac87b213d23bb76656a0a5f0f4781. Essentially the same as original implementation _(1)_ except has some usability improvements. |\r\n| _6_ | `tuple<T,unique_ptr<tuple<F,bilingual_str>>` | Pending #25665 implementation (this PR). Supports returning failure values, uses separate success and failure types to avoid ambiguity, uses `unique_ptr` to reduce result type size, and avoids heap allocation in the happy path. |\r\n\r\n### Prior discussions & history\r\n\r\n- _furszy_ introduced a `BResult` class providing a standard error reporting mechanism in [#25218](https://github.com/bitcoin/bitcoin/pull/25218). It was renamed to `util::Result` in [#25721](https://github.com/bitcoin/bitcoin/pull/25721) but kept the same representation and capabilities.\r\n\r\n- _MarcoFalke_ suggested using `BResult` for the `LoadChainstate` function in [#25308 (comment)](https://github.com/bitcoin/bitcoin/pull/25308#issuecomment-1181674645). Inability to use `BResult` there due to lack of support for failure values led to initial work on [#25608](https://github.com/bitcoin/bitcoin/pull/25608).\r\n\r\n- _w0xlt_ wrote a `StructuredResult` class in [#25308](https://github.com/bitcoin/bitcoin/pull/25601) adding the ability to return failure values but sacrificing standard error reporting, which led to more work on [#25608](https://github.com/bitcoin/bitcoin/pull/25608).\r\n\r\n- _martinus_ suggested a space optimization in [#25608 (comment)](https://github.com/bitcoin/bitcoin/pull/25608#discussion_r921049409) that also made it easier to support distinct failure & success types, leading to [#25665](https://github.com/bitcoin/bitcoin/pull/25665) as a replacement for [#25608](https://github.com/bitcoin/bitcoin/pull/25608).",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            },
            {
              "id": 5334691551,
              "node_id": "LA_kwDOABII588AAAABPfju3w",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
              "name": "CI failed",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 38,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/25665",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/25665",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/25665.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/25665.patch"
          },
          "created_at": "2022-07-21T12:46:09Z",
          "updated_at": "2024-04-26T00:55:23Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-19T06:42:02Z",
      "updated_at": "2024-04-19T06:42:02Z",
      "source": {
        "issue": {
          "id": 2251373533,
          "node_id": "PR_kwDOABII585tFkFs",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29906",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29906/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29906/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29906/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29906",
          "number": 29906,
          "state": "open",
          "state_reason": null,
          "title": "Disable util::Result copying and assignment",
          "body": "This PR just contains the first two commits of #25665.\r\n\r\nIt disables copying of `util::Result` objects because unnecessary copies are inefficient and not possible after #25665, which makes `util::Result` object move-only.\r\n\r\nIt disables the assignment operator and replaces it with an `Update()` method, because #25665 adds more information to `util::Result` objects (warning and error messages and failure values) and having an assignment operator that overwrites data instead of merging it would make it easy to accidentally erase existing information while trying to assign new information.",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 135961,
              "node_id": "MDU6TGFiZWwxMzU5NjE=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring",
              "name": "Refactoring",
              "color": "E6F6D6",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 4,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29906",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29906",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29906.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29906.patch"
          },
          "created_at": "2024-04-18T19:09:54Z",
          "updated_at": "2024-04-26T01:22:27Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-19T09:04:06Z",
      "updated_at": "2024-04-19T09:04:06Z",
      "source": {
        "issue": {
          "id": 2201362078,
          "node_id": "PR_kwDOABII585qbY-z",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29700",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29700/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29700/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29700/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/29700",
          "number": 29700,
          "state": "open",
          "state_reason": null,
          "title": "kernel, refactor: return error status on all fatal errors",
          "body": "Return util::Result objects from all functions that can trigger fatal errors.\r\n\r\nThere are many validation functions that handle failures by calling `AbortNode` and triggering shutdowns, without returning error information to their callers. This makes error handling in libbitcoinkernel application code difficult, because the only way to handle these errors is to register for [notification callbacks](https://github.com/bitcoin/bitcoin/blob/master/src/kernel/notifications_interface.h). Improve this by making all functions that trigger fatal errors return util::Result objects with the error information.\r\n\r\nThis PR is a pure refactoring that returns extra result information from functions without changing their behavior. It's a possible alternative to and subset of #29642, which adds similar return information but also makes behavior changes and exposes a FatalError type.\r\n\r\n---\r\n\r\n**This is based on #29906 + #25665.** The non-base commits are:\r\n\r\n- [`4cda7caf043b` refactor, kernel: Add FlushStatus / FlushResult types](https://github.com/bitcoin/bitcoin/pull/29700/commits/4cda7caf043bbcaceb6b92524041f397e8027544)\r\n- [`1e3519b8411c` refactor: Add InfoType field to util::Result](https://github.com/bitcoin/bitcoin/pull/29700/commits/1e3519b8411c9b188bdff6a5693b5fe258fd028b)\r\n- [`e7605d3a26f6` refactor, blockstorage: Return FlushResult from flush methods](https://github.com/bitcoin/bitcoin/pull/29700/commits/e7605d3a26f6d782ac67ddf1c0363acc28f10175)\r\n- [`85392fe736ab` refactor, blockstorage: Return fatal errors from block writes](https://github.com/bitcoin/bitcoin/pull/29700/commits/85392fe736ab7b69c8f3a6f23c280dd3b7a28fe8)\r\n- [`748ae7038124` refactor, blockstorage: Return fatal error from LoadBlockIndex](https://github.com/bitcoin/bitcoin/pull/29700/commits/748ae7038124bd005f4018abf100e77bb5f483da)\r\n- [`e0f637e02d86` refactor, validation: Return fatal errors from FlushStateToDisk](https://github.com/bitcoin/bitcoin/pull/29700/commits/e0f637e02d8636b7910d12403f8a2b3bf419bc96)\r\n- [`8ffc919783ea` refactor, validation: Return fatal errors from mempool accept functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/8ffc919783eaf5959877998e39cbe111b51fda0e)\r\n- [`4d0aa437f89b` refactor, validation: Return fatal errors from assumeutxo snapshot functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/4d0aa437f89b2c2cfbe7b97a4d142e5702fa5251)\r\n- [`33d3dbeb8b1f` refactor, validation: Return fatal errors from block connect functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/33d3dbeb8b1fc755d9ea07be3aeb55676c2bc6eb)\r\n- [`b0d98b4789a4` refactor, validation: Return fatal errors from activate best chain functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/b0d98b4789a459b4a89a1431c95787fd96935af8)\r\n- [`5d891ed72246` refactor, validation: Return fatal errors from new block functions](https://github.com/bitcoin/bitcoin/pull/29700/commits/5d891ed72246305d3f1a3f1c81f99e45c53f7815)\r\n- [`fd257d944c59` refactor, blockstorage: Return fatal error from ImportBlocks](https://github.com/bitcoin/bitcoin/pull/29700/commits/fd257d944c59abfed05bc81664033d39ab4ff258)\r\n- [`4d2c9de24916` refactor, validation: Return more errors from VerifyDB](https://github.com/bitcoin/bitcoin/pull/29700/commits/4d2c9de24916f8d69514ea7c7251136e2762fa5c)",
          "user": {
            "login": "ryanofsky",
            "id": 7133040,
            "node_id": "MDQ6VXNlcjcxMzMwNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ryanofsky",
            "html_url": "https://github.com/ryanofsky",
            "followers_url": "https://api.github.com/users/ryanofsky/followers",
            "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
            "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
            "repos_url": "https://api.github.com/users/ryanofsky/repos",
            "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 5334691551,
              "node_id": "LA_kwDOABII588AAAABPfju3w",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
              "name": "CI failed",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 2,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29700",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/29700",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/29700.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/29700.patch"
          },
          "created_at": "2024-03-21T23:11:56Z",
          "updated_at": "2024-04-26T00:56:58Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-24T16:48:42Z",
      "updated_at": "2024-04-24T16:48:42Z",
      "source": {
        "issue": {
          "id": 1468749742,
          "node_id": "PR_kwDOABII585D7KFN",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26606",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26606/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26606/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26606/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26606",
          "number": 26606,
          "state": "open",
          "state_reason": null,
          "title": "wallet: Implement independent BDB parser",
          "body": "Split from #26596 \r\n\r\nThis PR adds `BerkeleyRODatabase` which is an independent implementation of a BDB file parser. It provides read only access to a BDB file, and can therefore be used as a read only database backend for wallets. This will be used for dumping legacy wallet records and migrating legacy wallets without the need for BDB itself.\r\n\r\nWallettool's `dump` command is changed to use `BerkeleyRODatabase` instead of `BerkeleyDatabase` (and `CWallet` itself) to demonstrate that this parser works and to test it against the existing wallettool functional tests.",
          "user": {
            "login": "achow101",
            "id": 3782274,
            "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/achow101",
            "html_url": "https://github.com/achow101",
            "followers_url": "https://api.github.com/users/achow101/followers",
            "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
            "organizations_url": "https://api.github.com/users/achow101/orgs",
            "repos_url": "https://api.github.com/users/achow101/repos",
            "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/achow101/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            },
            {
              "id": 5334691551,
              "node_id": "LA_kwDOABII588AAAABPfju3w",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
              "name": "CI failed",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 34,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26606",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26606",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26606.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26606.patch"
          },
          "created_at": "2022-11-29T21:50:53Z",
          "updated_at": "2024-04-25T23:16:16Z"
        },
        "type": "issue"
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1497769911",
      "pull_request_review_id": 1893495240,
      "id": 1497769911,
      "node_id": "PRRC_kwDOABII585ZRie3",
      "diff_hunk": "@@ -1128,6 +1225,36 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n         available_coins = AvailableCoins(wallet, &coin_control, coin_selection_params.m_effective_feerate);\n     }\n \n+    // Load a json file that describes a target utxo set",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 138,
      "commit_id": "0d752b592de19d271c0f14856f661fc5bba8bd60",
      "original_commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "in_reply_to_id": null,
      "user": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Loading this file every time we fund a transaction doesn't seem reasonable. I think we should start with a static file that needs a restart whenever the node operator wants to change values, and we can later decide how to make this more dynamic (if it's even necessary).",
      "created_at": "2024-02-21T15:17:52Z",
      "updated_at": "2024-02-21T15:55:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#discussion_r1497769911",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1497769911"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1228,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1497820248",
      "pull_request_review_id": 1893495240,
      "id": 1497820248,
      "node_id": "PRRC_kwDOABII585ZRuxY",
      "diff_hunk": "@@ -799,6 +815,83 @@ util::Result<SelectionResult> SelectCoins(const CWallet& wallet, CoinsResult& av\n     return op_selection_result;\n }\n \n+/** Returns UTXO targets and compute their current count from available coins */\n+std::vector<UtxoTarget> UtxoTargetsFromJson(const UniValue& utxo_targets_json, const CoinsResult& available_coins)\n+{\n+    std::vector<UtxoTarget> utxo_targets;\n+    for (const auto& bucket : utxo_targets_json.getValues()) {\n+        UtxoTarget target = {\n+            bucket[\"start_satoshis\"].getInt<CAmount>(),\n+            bucket[\"end_satoshis\"].getInt<CAmount>(),\n+            bucket[\"target_utxo_count\"].getInt<uint32_t>()};\n+        utxo_targets.push_back(target);\n+    }\n+    for (const auto& [type, outputs] : available_coins.coins) {\n+        for (const wallet::COutput& output : outputs) {\n+            for (UtxoTarget& target : utxo_targets) {\n+                if (output.txout.nValue >= target.start_satoshis && output.txout.nValue <= target.end_satoshis) {\n+                    target.current_utxo_count++;\n+                    break;\n+                }\n+            }\n+        }\n+    }\n+\n+    return utxo_targets;\n+}\n+\n+/** Returns a random change amount in the range of the most depleted Utxo bucket and sets `capacity`\n+ * to the capacity of that change target, if any.\n+ */\n+std::optional<CAmount> GenerateChangeTargetFromUtxoTargets(const std::vector<UtxoTarget>& utxo_targets, const CAmount change_fee, double& capacity, FastRandomContext& rng)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 69,
      "commit_id": "0d752b592de19d271c0f14856f661fc5bba8bd60",
      "original_commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "in_reply_to_id": null,
      "user": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm not sure this is really what we want. I think this function should try to refill multiple buckets at once (when amounts allow it), not just the most depleted one:\r\n\r\n- Check which utxo buckets should be refilled:\r\n  - Initialize a `to_refill` list of `(bucket, target_quantity)`\r\n  - For each utxo bucket:\r\n    - If the feerate is low (below a to-be-defined threshold) and the bucket is less than 70% full (or a to-be-defined threshold that could be configurable):\r\n      - Add this bucket to `to_refill` with a `target_quantity` of `target_utxo_count - current_utxo_count` (when feerate is low, we'd like to refill as much as possible)\r\n    - If the feerate is higher than our threshold and the bucket is less than 30% full (or a to-be-defined threshold that could be configurable), we refill less aggressively:\r\n      - Add this bucket to `to_refill` with a `target_quantity` that we scale (somehow) based on feerate and how many utxos we're missing\r\n  - Order `to_refill` by `target_quantity`, descending (we'll want to refill the buckets that are missing the most utxos first)\r\n- Check the utxos that we have outside of our buckets: we ideally want to spend those utxos to refill our buckets. We have no guarantee that those are the ones that will be used by the coin selection, but we can use their total amount as the maximum amount of funds we allocate to refill our buckets. This part is a bit fuzzy for me right now, I'm not sure this is the best approach, it definitely deserves more thoughts.\r\n  - Iterate over those utxos and add their amount to obtain `utxos_outside_buckets_total_amount`\r\n- Compute the change target based on `to_refill` and `utxos_outside_buckets_total_amount`:\r\n  - Initialize `change_target` to `0`\r\n  - Iterate over `to_refill`, and for each bucket that needs to be refilled:\r\n    - Decide how much of the `target_quantity` we want to refill based on `utxos_outside_buckets_total_amount` and the current `change_target`\r\n    - Add the corresponding amount to `change_target`\r\n    - That step probably has a lot of issues as well and deserves more thought. If we have a lot of utxos outside of our buckets, we may end up targeting a very large change amount and thus create a huge transaction, which is generally undesirable, but maybe desirable when our buckets are close to being empty. Maybe it makes sense to bound the `change_target` to a (small) multiplier of the funding amount? Or have a very different behavior when the feerate is very low, because when that happens we may want to fully refill our buckets?\r\n\r\nAs you can see, this is still very early discussion on what the algorithm should look like. It feels like we're still trying to understand the pitfalls we want to avoid we should try to write the algorithm in pseudo-code first in order to converge on an initial version (maybe to be detailed and discussed in a delving bitcoin post).\r\n\r\nAlso, when we don't want to actively refill buckets, we should target a changeless transaction, I'm not sure that is done right now?",
      "created_at": "2024-02-21T15:47:29Z",
      "updated_at": "2024-02-21T15:55:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#discussion_r1497820248",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1497820248"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 846,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1497828903",
      "pull_request_review_id": 1893495240,
      "id": 1497828903,
      "node_id": "PRRC_kwDOABII585ZRw4n",
      "diff_hunk": "@@ -799,6 +815,83 @@ util::Result<SelectionResult> SelectCoins(const CWallet& wallet, CoinsResult& av\n     return op_selection_result;\n }\n \n+/** Returns UTXO targets and compute their current count from available coins */\n+std::vector<UtxoTarget> UtxoTargetsFromJson(const UniValue& utxo_targets_json, const CoinsResult& available_coins)\n+{\n+    std::vector<UtxoTarget> utxo_targets;\n+    for (const auto& bucket : utxo_targets_json.getValues()) {\n+        UtxoTarget target = {\n+            bucket[\"start_satoshis\"].getInt<CAmount>(),\n+            bucket[\"end_satoshis\"].getInt<CAmount>(),\n+            bucket[\"target_utxo_count\"].getInt<uint32_t>()};\n+        utxo_targets.push_back(target);\n+    }\n+    for (const auto& [type, outputs] : available_coins.coins) {\n+        for (const wallet::COutput& output : outputs) {\n+            for (UtxoTarget& target : utxo_targets) {\n+                if (output.txout.nValue >= target.start_satoshis && output.txout.nValue <= target.end_satoshis) {\n+                    target.current_utxo_count++;\n+                    break;\n+                }\n+            }\n+        }\n+    }\n+\n+    return utxo_targets;\n+}\n+\n+/** Returns a random change amount in the range of the most depleted Utxo bucket and sets `capacity`\n+ * to the capacity of that change target, if any.\n+ */\n+std::optional<CAmount> GenerateChangeTargetFromUtxoTargets(const std::vector<UtxoTarget>& utxo_targets, const CAmount change_fee, double& capacity, FastRandomContext& rng)\n+{\n+    // Refill the most depleted utxo targets first.\n+    auto target_iter = std::min_element(utxo_targets.begin(), utxo_targets.end(), [](const UtxoTarget& a, const UtxoTarget& b) {\n+        return (double(a.current_utxo_count) / a.target_utxo_count) < (double(b.current_utxo_count) / b.target_utxo_count);\n+    });\n+    std::optional<CAmount> change_target;\n+    if (target_iter != utxo_targets.end()) {\n+        // Adjust the range of the target bucket based on the current fee rate.\n+        change_target = rng.randrange(target_iter->end_satoshis - target_iter->start_satoshis - change_fee) + target_iter->start_satoshis + change_fee;\n+        capacity = double(target_iter->current_utxo_count) / target_iter->target_utxo_count;\n+    }\n+    return change_target;\n+}\n+\n+std::list<CTxOut> SplitChangeFromUtxoTargets(CAmount change_amount, std::vector<UtxoTarget> utxo_targets, CAmount change_target, const CAmount change_fee, FastRandomContext& rng, CScript script_change)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 84,
      "commit_id": "0d752b592de19d271c0f14856f661fc5bba8bd60",
      "original_commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "in_reply_to_id": null,
      "user": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'm wondering whether we should use a fully deterministic algorithm to split the change into buckets, I'm afraid this is exactly the kind of algorithm that may end up in a loop where one funding attempt does something, and the next one undoes it. It feels like adding randomization may be the simple way to avoid this? But maybe it's too early in the algorithm design phase to decide.",
      "created_at": "2024-02-21T15:52:42Z",
      "updated_at": "2024-02-21T15:55:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#discussion_r1497828903",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1497828903"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 861,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1500540279",
      "pull_request_review_id": 1897914077,
      "id": 1500540279,
      "node_id": "PRRC_kwDOABII585ZcG13",
      "diff_hunk": "@@ -1128,6 +1225,36 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n         available_coins = AvailableCoins(wallet, &coin_control, coin_selection_params.m_effective_feerate);\n     }\n \n+    // Load a json file that describes a target utxo set",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 138,
      "commit_id": "0d752b592de19d271c0f14856f661fc5bba8bd60",
      "original_commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "in_reply_to_id": 1497769911,
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "That makes sense. I also think a static file could describe the buckets in a way that better adapts to a changing fee environment.\r\n\r\nFor example, rather than `start_satoshis` and `end_satoshi` we could define a bucket as:\r\n\r\n```json\r\n        \"confirmation_target\": 6,\r\n        \"fee_rate_std\": 10000, \r\n        \"buckets\": [\r\n        {\r\n            \"target_satoshis\": 10000,\r\n            \"target_utxo_count\": 150\r\n        },\r\n```\r\n\r\nThe range of values you want to spend should be \"target_satoshis\" + the fee to spend that input at a fee rate that will confirm in \"confirmation_target\" blocks. Because free rates vary, we randomize the current fee rate within a range +/- \"fee_rate_std\".\r\n\r\nTo refill a bucket, compute the `target_output` as:\r\n```\r\ntarget_feerate = current_feerate(\"confirmation_target\") + random(-1 * \"fee_rate_std\", \"fee_rate_std\")\r\ntarget_output = \"target_satoshis\" + size_of_input * target_feerate \r\n``` \r\nIdeally we would only need to restart when we add/remove buckets, change their counts or when fee variance changes dramatically.\r\n",
      "created_at": "2024-02-23T11:33:13Z",
      "updated_at": "2024-02-23T11:33:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#discussion_r1500540279",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1500540279"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1228,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1500904878",
      "pull_request_review_id": 1898503321,
      "id": 1500904878,
      "node_id": "PRRC_kwDOABII585Zdf2u",
      "diff_hunk": "@@ -799,6 +815,83 @@ util::Result<SelectionResult> SelectCoins(const CWallet& wallet, CoinsResult& av\n     return op_selection_result;\n }\n \n+/** Returns UTXO targets and compute their current count from available coins */\n+std::vector<UtxoTarget> UtxoTargetsFromJson(const UniValue& utxo_targets_json, const CoinsResult& available_coins)\n+{\n+    std::vector<UtxoTarget> utxo_targets;\n+    for (const auto& bucket : utxo_targets_json.getValues()) {\n+        UtxoTarget target = {\n+            bucket[\"start_satoshis\"].getInt<CAmount>(),\n+            bucket[\"end_satoshis\"].getInt<CAmount>(),\n+            bucket[\"target_utxo_count\"].getInt<uint32_t>()};\n+        utxo_targets.push_back(target);\n+    }\n+    for (const auto& [type, outputs] : available_coins.coins) {\n+        for (const wallet::COutput& output : outputs) {\n+            for (UtxoTarget& target : utxo_targets) {\n+                if (output.txout.nValue >= target.start_satoshis && output.txout.nValue <= target.end_satoshis) {\n+                    target.current_utxo_count++;\n+                    break;\n+                }\n+            }\n+        }\n+    }\n+\n+    return utxo_targets;\n+}\n+\n+/** Returns a random change amount in the range of the most depleted Utxo bucket and sets `capacity`\n+ * to the capacity of that change target, if any.\n+ */\n+std::optional<CAmount> GenerateChangeTargetFromUtxoTargets(const std::vector<UtxoTarget>& utxo_targets, const CAmount change_fee, double& capacity, FastRandomContext& rng)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 69,
      "commit_id": "0d752b592de19d271c0f14856f661fc5bba8bd60",
      "original_commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "in_reply_to_id": 1497820248,
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think it is unavoidable that refilling buckets cannibalizes utxos from other buckets unless there is a pool of utxos larger than the largest target bucket to pick from. The goal though is that in the long run the system wastes as little value from fees and over payment as possible in aggregate.\r\n\r\nThis is how I think the process as implemented currently ([85a049d](https://github.com/bitcoin/bitcoin/pull/29442/commits/85a049ddceb854106efea8316462e356d9b88b21)) should work: \r\n\r\nBecause we always set our minimum change value to be *at least* as large as one of our target buckets that is depleted,  all of the wallet utxos are either in the range of one of our target buckets or larger than one of our target buckets.\r\n\r\nA changeless BnB solution is found when:\r\n1) there is a single utxo in the corresponding target bucket that does not overpay by too much in fees\r\n2) a combination of multiple utxos smaller than the target bucket exist that do not overpay by too much in fees\r\n\r\nA CoinGrinder solution is preferred when the cost of fees and over payment of the best BnB solution is more than the fees from using:\r\n1) a single larger utxo with change outputs \r\n2) a combination of multiple smaller utxos and change outputs\r\n\r\nThe largest wallet utxo will hold the residual value after initially refilling the buckets from cold storage. This residual funding utxo will be used as a single input when:\r\n1) this utxo is available and CoinGrinder selects it to refill buckets opportunistically \r\n2) fees are low, or buckets are severely depleted, we force this input to be selected to refill buckets. \r\n\r\nWhen a large residual value utxo is used to refill all buckets via change outputs, another large residual utxo may also be created. That residual value utxo can not be used again until the tx that uses it confirms. This seems like an area that can be optimized. Perhaps a separate automatic refill transaction that confirms quickly makes more sense than using it for opportunistic bucket refills.\r\n\r\nEventually the largest utxo in the wallet will be in the range of the target buckets. The utxo set will then no longer be able to refill buckets without also depleting other buckets. This should be a signal to refill the wallet from cold storage.",
      "created_at": "2024-02-23T16:30:06Z",
      "updated_at": "2024-02-23T16:30:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#discussion_r1500904878",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1500904878"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 846,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1502339382",
      "pull_request_review_id": 1900440292,
      "id": 1502339382,
      "node_id": "PRRC_kwDOABII585Zi-E2",
      "diff_hunk": "@@ -799,6 +815,83 @@ util::Result<SelectionResult> SelectCoins(const CWallet& wallet, CoinsResult& av\n     return op_selection_result;\n }\n \n+/** Returns UTXO targets and compute their current count from available coins */\n+std::vector<UtxoTarget> UtxoTargetsFromJson(const UniValue& utxo_targets_json, const CoinsResult& available_coins)\n+{\n+    std::vector<UtxoTarget> utxo_targets;\n+    for (const auto& bucket : utxo_targets_json.getValues()) {\n+        UtxoTarget target = {\n+            bucket[\"start_satoshis\"].getInt<CAmount>(),\n+            bucket[\"end_satoshis\"].getInt<CAmount>(),\n+            bucket[\"target_utxo_count\"].getInt<uint32_t>()};\n+        utxo_targets.push_back(target);\n+    }\n+    for (const auto& [type, outputs] : available_coins.coins) {\n+        for (const wallet::COutput& output : outputs) {\n+            for (UtxoTarget& target : utxo_targets) {\n+                if (output.txout.nValue >= target.start_satoshis && output.txout.nValue <= target.end_satoshis) {\n+                    target.current_utxo_count++;\n+                    break;\n+                }\n+            }\n+        }\n+    }\n+\n+    return utxo_targets;\n+}\n+\n+/** Returns a random change amount in the range of the most depleted Utxo bucket and sets `capacity`\n+ * to the capacity of that change target, if any.\n+ */\n+std::optional<CAmount> GenerateChangeTargetFromUtxoTargets(const std::vector<UtxoTarget>& utxo_targets, const CAmount change_fee, double& capacity, FastRandomContext& rng)\n+{\n+    // Refill the most depleted utxo targets first.\n+    auto target_iter = std::min_element(utxo_targets.begin(), utxo_targets.end(), [](const UtxoTarget& a, const UtxoTarget& b) {\n+        return (double(a.current_utxo_count) / a.target_utxo_count) < (double(b.current_utxo_count) / b.target_utxo_count);\n+    });\n+    std::optional<CAmount> change_target;\n+    if (target_iter != utxo_targets.end()) {\n+        // Adjust the range of the target bucket based on the current fee rate.\n+        change_target = rng.randrange(target_iter->end_satoshis - target_iter->start_satoshis - change_fee) + target_iter->start_satoshis + change_fee;\n+        capacity = double(target_iter->current_utxo_count) / target_iter->target_utxo_count;\n+    }\n+    return change_target;\n+}\n+\n+std::list<CTxOut> SplitChangeFromUtxoTargets(CAmount change_amount, std::vector<UtxoTarget> utxo_targets, CAmount change_target, const CAmount change_fee, FastRandomContext& rng, CScript script_change)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 84,
      "commit_id": "0d752b592de19d271c0f14856f661fc5bba8bd60",
      "original_commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "in_reply_to_id": 1497828903,
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I agree that there's a risk that one funding operation adds an extra input from an existing bucket and then creates a change output to refill that same bucket, for example. My intuition though is that we can't optimize too far into the future.\r\n\r\nEven if an input is cannibalized from a bucket, it will be \"reforged\" into a new utxo that hopefully has a value that is more likely to be selected by BnB as a single input to a future changeless funding transaction.  The current scheme randomizes new change outputs and skews them based on the current fee rate to try to optimize for future changeless single input transactions.\r\n\r\nCan we do better with some ideas from memory caching? Maybe use the frequency that a particular amount is requested for funding to influence whether it is used as an extra input or as the size of a new change output?",
      "created_at": "2024-02-26T10:04:46Z",
      "updated_at": "2024-02-26T10:04:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#discussion_r1502339382",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1502339382"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 861,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1505941145",
      "pull_request_review_id": 1906233583,
      "id": 1505941145,
      "node_id": "PRRC_kwDOABII585ZwtaZ",
      "diff_hunk": "@@ -799,6 +815,83 @@ util::Result<SelectionResult> SelectCoins(const CWallet& wallet, CoinsResult& av\n     return op_selection_result;\n }\n \n+/** Returns UTXO targets and compute their current count from available coins */\n+std::vector<UtxoTarget> UtxoTargetsFromJson(const UniValue& utxo_targets_json, const CoinsResult& available_coins)\n+{\n+    std::vector<UtxoTarget> utxo_targets;\n+    for (const auto& bucket : utxo_targets_json.getValues()) {\n+        UtxoTarget target = {\n+            bucket[\"start_satoshis\"].getInt<CAmount>(),\n+            bucket[\"end_satoshis\"].getInt<CAmount>(),\n+            bucket[\"target_utxo_count\"].getInt<uint32_t>()};\n+        utxo_targets.push_back(target);\n+    }\n+    for (const auto& [type, outputs] : available_coins.coins) {\n+        for (const wallet::COutput& output : outputs) {\n+            for (UtxoTarget& target : utxo_targets) {\n+                if (output.txout.nValue >= target.start_satoshis && output.txout.nValue <= target.end_satoshis) {\n+                    target.current_utxo_count++;\n+                    break;\n+                }\n+            }\n+        }\n+    }\n+\n+    return utxo_targets;\n+}\n+\n+/** Returns a random change amount in the range of the most depleted Utxo bucket and sets `capacity`\n+ * to the capacity of that change target, if any.\n+ */\n+std::optional<CAmount> GenerateChangeTargetFromUtxoTargets(const std::vector<UtxoTarget>& utxo_targets, const CAmount change_fee, double& capacity, FastRandomContext& rng)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 69,
      "commit_id": "0d752b592de19d271c0f14856f661fc5bba8bd60",
      "original_commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "in_reply_to_id": 1497820248,
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Also, when we don't want to actively refill buckets, we should target a changeless transaction, I'm not sure that is done right now?\r\n\r\nThe current system should always prefer changeless transactions unless, for example, an exact match with more inputs and no change is more wasteful than selecting fewer inputs that generate a change output.",
      "created_at": "2024-02-28T13:10:18Z",
      "updated_at": "2024-02-28T13:10:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#discussion_r1505941145",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1505941145"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 846,
      "side": "RIGHT"
    }
  ]
}