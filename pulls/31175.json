{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175",
    "id": 2151266647,
    "node_id": "PR_kwDOABII586AOblX",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/31175",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/31175.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/31175.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31175",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31175/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/73db95c65c1d372822166045ca8b9f173d5fd883",
    "number": 31175,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "rpc: Remove submitblock pre-checks",
    "user": {
      "login": "TheCharlatan",
      "id": 8421793,
      "node_id": "MDQ6VXNlcjg0MjE3OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheCharlatan",
      "html_url": "https://github.com/TheCharlatan",
      "followers_url": "https://api.github.com/users/TheCharlatan/followers",
      "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
      "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
      "repos_url": "https://api.github.com/users/TheCharlatan/repos",
      "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "With the introduction of a mining ipc interface and the potential future introduction of a kernel library API it becomes increasingly important to offer common behaviour between them. An example of this is ProcessNewBlock, which is used by ipc, rpc, net_processing and (potentially) the kernel library. Having divergent behaviour on suggested pre-checks and checks for these functions is confusing to both developers and users and is a maintenance burden.\r\n\r\nThe rpc interface for ProcessNewBlock (submitblock) currently pre-checks if the block has a coinbase transaction and whether it has been processed before. While the current example binary for how to use the kernel library, bitcoin-chainstate, imitates these checks, the other interfaces do not.\r\n\r\nThe coinbase check is repeated again early during ProcessNewBlock. Pre-checking it may also shadow more fundamental problems with a block. In most cases the block header is checked first, before validating the transactions. Checking the coinbase first therefore masks potential issues with the header. Fix this by removing the pre-check.\r\n\r\nSimilary the duplicate checks are repeated early in the contextual checks of ProcessNewBlock. If duplicate blocks are detected much of their validation is skipped. Depending on the constitution of the block, validating the merkle root of the block is part of the more intensive workload when validating a block. This could be an argument for moving the pre-checks into block processing. In net_processing this would have a smaller effect however, since the block mutation check, which also validates the merkle root, is done before.\r\n\r\nTesting spamming a node with valid, but duplicate unrequested blocks seems to exhaust a CPU thread, but does not seem to significantly impact keeping up with the tip. The benefits of adding these checks to net_processing are questionable, especially since there are other ways to trigger the more CPU-intensive checks without submitting a duplicate block. Since these DOS concerns apply even less to the RPC interface, which does not have banning mechanics built in, remove them too.\r\n\r\nFinally, also remove the pre-checks from `bitcoin-chainstate.cpp`.\r\n\r\n---\r\n\r\nThis PR is part of the [libbitcoinkernel project](https://github.com/bitcoin/bitcoin/issues/27587).",
    "labels": [
      {
        "id": 98279177,
        "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
        "name": "RPC/REST/ZMQ",
        "color": "0052cc",
        "default": false
      }
    ],
    "created_at": "2024-10-29T11:05:05Z",
    "updated_at": "2024-11-29T14:06:03Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "afdb67d9ab58fdcc5461c5a50ba2d57a3361c7b8",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "TheCharlatan:submitblock_prechecks",
      "ref": "submitblock_prechecks",
      "sha": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 94456368,
        "node_id": "MDEwOlJlcG9zaXRvcnk5NDQ1NjM2OA==",
        "name": "bitcoin",
        "full_name": "TheCharlatan/bitcoin",
        "owner": {
          "login": "TheCharlatan",
          "id": 8421793,
          "node_id": "MDQ6VXNlcjg0MjE3OTM=",
          "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/TheCharlatan",
          "html_url": "https://github.com/TheCharlatan",
          "followers_url": "https://api.github.com/users/TheCharlatan/followers",
          "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
          "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
          "repos_url": "https://api.github.com/users/TheCharlatan/repos",
          "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/TheCharlatan/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/TheCharlatan/bitcoin",
        "archive_url": "https://api.github.com/repos/TheCharlatan/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/TheCharlatan/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/TheCharlatan/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/TheCharlatan/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/TheCharlatan/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/TheCharlatan/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/TheCharlatan/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/TheCharlatan/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/TheCharlatan/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/TheCharlatan/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/TheCharlatan/bitcoin/events",
        "forks_url": "https://api.github.com/repos/TheCharlatan/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/TheCharlatan/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/TheCharlatan/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/TheCharlatan/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/TheCharlatan/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/TheCharlatan/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/TheCharlatan/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/TheCharlatan/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/TheCharlatan/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/TheCharlatan/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/TheCharlatan/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/TheCharlatan/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/TheCharlatan/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:TheCharlatan/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/TheCharlatan/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/TheCharlatan/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/TheCharlatan/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/TheCharlatan/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/TheCharlatan/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/TheCharlatan/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/TheCharlatan/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/TheCharlatan/bitcoin/hooks",
        "svn_url": "https://github.com/TheCharlatan/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 2,
        "watchers_count": 2,
        "size": 252034,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-11-28T14:19:52Z",
        "created_at": "2017-06-15T16:03:35Z",
        "updated_at": "2024-11-20T22:10:56Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "17834bd1976df7a2ff6c2f5f05a59ae3fd3f6875",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 36485,
        "stargazers_count": 79914,
        "watchers_count": 79914,
        "size": 272953,
        "default_branch": "master",
        "open_issues_count": 667,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-11-29T13:35:01Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2024-11-29T13:45:55Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 44,
    "deletions": 44,
    "changed_files": 5,
    "commits": 5,
    "review_comments": 15,
    "comments": 11
  },
  "events": [
    {
      "event": "commented",
      "id": 2443908337,
      "node_id": "IC_kwDOABII586RqxTx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2443908337",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-29T11:05:08Z",
      "updated_at": "2024-11-29T14:06:03Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31175.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [Sjors](https://github.com/bitcoin/bitcoin/pull/31175#issuecomment-2493170407), [instagibbs](https://github.com/bitcoin/bitcoin/pull/31175#pullrequestreview-2455019300), [mzumsande](https://github.com/bitcoin/bitcoin/pull/31175#pullrequestreview-2465507312) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#issuecomment-2443908337",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31175"
    },
    {
      "event": "labeled",
      "id": 14982190543,
      "node_id": "LE_lADOABII586cN9yczwAAAAN9AhXP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14982190543",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-29T11:05:11Z",
      "label": {
        "name": "RPC/REST/ZMQ",
        "color": "0052cc"
      }
    },
    {
      "event": "reviewed",
      "id": 2402259498,
      "node_id": "PRR_kwDOABII586PL5Iq",
      "url": null,
      "actor": null,
      "commit_id": "e742d66b1c77a90de502c45b452184b183b3778c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Haven't looked deeply yet, just wanted to mention #10146, which introduced the coinbase check and was even backported (see also #10190 for a regression test). Makes me wonder if there is more historical context to this.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#pullrequestreview-2402259498",
      "submitted_at": "2024-10-29T15:22:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
    },
    {
      "event": "commented",
      "id": 2449494945,
      "node_id": "IC_kwDOABII586SAFOh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2449494945",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-31T10:11:09Z",
      "updated_at": "2024-10-31T10:11:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Makes me wonder if there is more historical context to this.\r\n\r\nYes, me too. If there are good reasons to keep these checks, then we should document why (and why they are not needed for the other interfaces). I could not come up with one, so I opened this PR, but I may well be missing something.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#issuecomment-2449494945",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31175"
    },
    {
      "event": "commented",
      "id": 2452572531,
      "node_id": "IC_kwDOABII586SL0lz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2452572531",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-01T20:50:47Z",
      "updated_at": "2024-11-01T20:50:47Z",
      "author_association": "MEMBER",
      "body": "my guess is from #10146 this commit ada0caa165905b50db351a56ec124518c922085a looks like a covert fix for `submitblock` with a completely empty block. https://github.com/bitcoin/bitcoin/blob/master/src/rpc/mining.cpp#L1041 shows that it will call:\r\n\r\n`UpdateUncommittedBlockStructures -> GetWitnessCommitmentIndex` which would result in UB, before any PoW checks are made.",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#issuecomment-2452572531",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31175"
    },
    {
      "event": "reviewed",
      "id": 2419408412,
      "node_id": "PRR_kwDOABII586QNT4c",
      "url": null,
      "actor": null,
      "commit_id": "e742d66b1c77a90de502c45b452184b183b3778c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nI agree with the general motivation. While this PR can change the error message of `submitblock` in case more than one thing is wrong with the block, I don't really see why one is more important than the other.\r\n\r\n> UpdateUncommittedBlockStructures -> GetWitnessCommitmentIndex which would result in UB, before any PoW checks are made.\r\n\r\nNice find!\r\nI think that it would be good to have a test that would trigger the UB if https://github.com/bitcoin/bitcoin/commit/ada0caa165905b50db351a56ec124518c922085a was reverted (it requires us to know the header so that `UpdateUncommittedBlockStructures()` gets called, so the added test for an empty block doesn't trigger it - could make another `deepcopy` of `block` instead and then delete the txns):\r\n\r\n> Fix this by removing the pre-check, but still throwing the same more expressive exception in case a coinbase validation error occurs.\r\n\r\nI realize that you want to keep the existing behavior in this PR, but I do wonder if it really makes sense to have other consensus errors return \"rejected\", and this particular one to throw an exception.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#pullrequestreview-2419408412",
      "submitted_at": "2024-11-06T21:00:22Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15193586464,
      "node_id": "HRFPE_lADOABII586cN9yczwAAAAOJm7sg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15193586464",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-07T21:12:20Z"
    },
    {
      "event": "commented",
      "id": 2463233587,
      "node_id": "IC_kwDOABII586S0fYz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2463233587",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-07T21:18:33Z",
      "updated_at": "2024-11-07T21:18:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated e742d66b1c77a90de502c45b452184b183b3778c -> b83d509d59dde352054cccf792d28bb87835e64f ([submitblock_prechecks_0](https://github.com/TheCharlatan/bitcoin/tree/submitblock_prechecks_0) -> [submitblock_prechecks_1](https://github.com/TheCharlatan/bitcoin/tree/submitblock_prechecks_1), [compare](https://github.com/TheCharlatan/bitcoin/compare/submitblock_prechecks_0..submitblock_prechecks_1))\r\n\r\n\r\n* Addressed @mzumsande's [comment](https://github.com/bitcoin/bitcoin/pull/31175#pullrequestreview-2419408412), added a small addition to the functional test for checking blocks with no transactions.\r\n* Mentioned the commit introducing the patch to `GetWitnessCommitmentIndex` in the commit message.\r\n\r\n> I realize that you want to keep the existing behavior in this PR, but I do wonder if it really makes sense to have other consensus errors return \"rejected\", and this particular one to throw an exception.\r\n\r\nYeah, I also don't think it makes a lot of sense, and even though it looks like the original description in #10146 was used to mask an actual problem, it does still mention the distinct error message as an improvement, so not sure if removing it could be annoying for users.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#issuecomment-2463233587",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31175"
    },
    {
      "event": "mentioned",
      "id": 15193729017,
      "node_id": "MEE_lADOABII586cN9yczwAAAAOJnef5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15193729017",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-07T21:18:35Z"
    },
    {
      "event": "subscribed",
      "id": 15193729038,
      "node_id": "SE_lADOABII586cN9yczwAAAAOJnegO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15193729038",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-07T21:18:35Z"
    },
    {
      "event": "reviewed",
      "id": 2422203882,
      "node_id": "PRR_kwDOABII586QX-Xq",
      "url": null,
      "actor": null,
      "commit_id": "eedbce9dea2b18600a1e02aa54ade3dcf50b5d06",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#pullrequestreview-2422203882",
      "submitted_at": "2024-11-07T21:35:43Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15195623841,
      "node_id": "HRFPE_lADOABII586cN9yczwAAAAOJutGh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15195623841",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-07T22:33:29Z"
    },
    {
      "event": "labeled",
      "id": 15196651237,
      "node_id": "LE_lADOABII586cN9yczwAAAAOJyn7l",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15196651237",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-07T23:19:44Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15208196096,
      "node_id": "HRFPE_lADOABII586cN9yczwAAAAOKeqgA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15208196096",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-08T09:28:59Z"
    },
    {
      "event": "commented",
      "id": 2464228255,
      "node_id": "IC_kwDOABII586S4SOf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2464228255",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-08T09:30:08Z",
      "updated_at": "2024-11-08T09:30:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated b83d509d59dde352054cccf792d28bb87835e64f -> 309bd56d97f87f973f45897fc00b1bd2fc5cff1a ([submitblock_prechecks_1](https://github.com/TheCharlatan/bitcoin/tree/submitblock_prechecks_1) -> [submitblock_prechecks_2](https://github.com/TheCharlatan/bitcoin/tree/submitblock_prechecks_2), [compare](https://github.com/TheCharlatan/bitcoin/compare/submitblock_prechecks_1..submitblock_prechecks_2))\r\n\r\n\r\n* Removed throw on missing coinbase in `submitblock`. ",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#issuecomment-2464228255",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31175"
    },
    {
      "event": "unlabeled",
      "id": 15212405051,
      "node_id": "UNLE_lADOABII586cN9yczwAAAAOKuuE7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15212405051",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-08T11:38:55Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2443525257,
      "node_id": "PRR_kwDOABII586RpTyJ",
      "url": null,
      "actor": null,
      "commit_id": "309bd56d97f87f973f45897fc00b1bd2fc5cff1a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#pullrequestreview-2443525257",
      "submitted_at": "2024-11-18T19:36:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15381130939,
      "node_id": "HRFPE_lADOABII586cN9yczwAAAAOUyW67",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15381130939",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "563278b6a125f1a3d2111d4ebd74b9cc16d83ec5",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/563278b6a125f1a3d2111d4ebd74b9cc16d83ec5",
      "created_at": "2024-11-21T12:27:24Z"
    },
    {
      "event": "commented",
      "id": 2491006682,
      "node_id": "IC_kwDOABII586Ueb7a",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2491006682",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-21T12:27:27Z",
      "updated_at": "2024-11-21T12:27:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "309bd56d97f87f973f45897fc00b1bd2fc5cff1a -> 563278b6a125f1a3d2111d4ebd74b9cc16d83ec5 ([submitblock_prechecks_2](https://github.com/TheCharlatan/bitcoin/tree/submitblock_prechecks_2) -> [submitblock_prechecks_3](https://github.com/TheCharlatan/bitcoin/tree/submitblock_prechecks_3), [compare](https://github.com/TheCharlatan/bitcoin/compare/submitblock_prechecks_2..submitblock_prechecks_3))\r\n\r\n\r\n* Added release notes documenting the submitblock change w.rt. duplicate block handling and pruning.\r\n* Split the changes into more incremental commits.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#issuecomment-2491006682",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31175"
    },
    {
      "event": "commented",
      "id": 2491534171,
      "node_id": "IC_kwDOABII586Ugctb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2491534171",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-21T15:26:00Z",
      "updated_at": "2024-11-21T15:26:24Z",
      "author_association": "MEMBER",
      "body": "Note that #31196 proposes to drop `processNewBlock()` from the Mining IPC interface, which straight-forwardly uses `ProcessNewBlock`. The interface does still use it via `submitSolution()`.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#issuecomment-2491534171",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31175"
    },
    {
      "event": "commented",
      "id": 2491616239,
      "node_id": "IC_kwDOABII586Ugwvv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2491616239",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-21T15:55:46Z",
      "updated_at": "2024-11-21T16:25:06Z",
      "author_association": "MEMBER",
      "body": "Something I noticed while looking at df7ad9223025b5d75e27813ce3b89ef6fc431805\r\n\r\nThe release notes of 0.18 \"promise\" that the RPC never returns `duplicate-invalid`:\r\n\r\n```md\r\n- The `submitblock` RPC previously returned the reason a rejected block\r\n  was invalid the first time it processed that block, but returned a\r\n  generic \"duplicate\" rejection message on subsequent occasions it\r\n  processed the same block.  It now always returns the fundamental\r\n  reason for rejecting an invalid block and only returns \"duplicate\" for\r\n  valid blocks it has already accepted.\r\n```\r\n\r\nStrangely however `mining_basic.py` has two checks for `duplicate-invalid`. Those were introduced were introduced in the same v0.18 release: commit fa6ab8ada14dd265e224496440ab0b5d99dfd0ef of #13983.\r\n\r\n_Update_: the real behaviour seems to be that we give the real reason for early checks, but return `duplicate-invalid` if later checks failed previously. The change in df7ad9223025b5d75e27813ce3b89ef6fc431805 seems compatible with that.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#issuecomment-2491616239",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31175"
    },
    {
      "event": "reviewed",
      "id": 2451842933,
      "node_id": "PRR_kwDOABII586SJCd1",
      "url": null,
      "actor": null,
      "commit_id": "563278b6a125f1a3d2111d4ebd74b9cc16d83ec5",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#pullrequestreview-2451842933",
      "submitted_at": "2024-11-21T15:56:00Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
    },
    {
      "event": "reviewed",
      "id": 2452017538,
      "node_id": "PRR_kwDOABII586SJtGC",
      "url": null,
      "actor": null,
      "commit_id": "563278b6a125f1a3d2111d4ebd74b9cc16d83ec5",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "utACK 563278b6a125f1a3d2111d4ebd74b9cc16d83ec5\r\n\r\nIt would be good to test the new pruned node behavior, in a way similar to `rpc_getblockfrompeer.py`.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#pullrequestreview-2452017538",
      "submitted_at": "2024-11-21T16:32:34Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
    },
    {
      "event": "review_requested",
      "id": 15385029196,
      "node_id": "RRE_lADOABII586cN9yczwAAAAOVBOpM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15385029196",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-21T16:32:37Z",
      "requested_reviewer": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "commented",
      "id": 2491873388,
      "node_id": "IC_kwDOABII586Uhvhs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2491873388",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-21T17:39:25Z",
      "updated_at": "2024-11-21T17:39:25Z",
      "author_association": "MEMBER",
      "body": "minimal test case for pruning, feel free to take: https://gist.github.com/instagibbs/cb1f7cfbd0a70e8b5393e457c7a959e6",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#issuecomment-2491873388",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31175"
    },
    {
      "event": "unsubscribed",
      "id": 15386017875,
      "node_id": "UE_lADOABII586cN9yczwAAAAOVFABT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15386017875",
      "actor": {
        "login": "jixi1991",
        "id": 5715530,
        "node_id": "MDQ6VXNlcjU3MTU1MzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5715530?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jixi1991",
        "html_url": "https://github.com/jixi1991",
        "followers_url": "https://api.github.com/users/jixi1991/followers",
        "following_url": "https://api.github.com/users/jixi1991/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jixi1991/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jixi1991/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jixi1991/subscriptions",
        "organizations_url": "https://api.github.com/users/jixi1991/orgs",
        "repos_url": "https://api.github.com/users/jixi1991/repos",
        "events_url": "https://api.github.com/users/jixi1991/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jixi1991/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-21T17:48:38Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDM2ZGJlYmFmYjliNTQ3NjQwMDVlNmZmZmE3YWQyOGQ0Y2FkZmU1ZTQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/36dbebafb9b54764005e6fffa7ad28d4cadfe5e4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/36dbebafb9b54764005e6fffa7ad28d4cadfe5e4",
      "tree": {
        "sha": "1e05a8054b7b9ad2466f5a638eb8323a7d4013bc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1e05a8054b7b9ad2466f5a638eb8323a7d4013bc"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 1e05a8054b7b9ad2466f5a638eb8323a7d4013bc\nparent da10e0bab4a3e98868dd663af02c43b1dc8b7f4a\nauthor TheCharlatan <seb.kung@gmail.com> 1732187665 +0100\ncommitter TheCharlatan <seb.kung@gmail.com> 1732223803 +0100\n\nrpc: Remove submitblock coinbase pre-check\n\nThe coinbase check is repeated again early during ProcessNewBlock.\nPre-checking it may also shadow more fundamental problems with a block.\nIn most cases the block header is checked first, before validating the\ntransactions. Checking the coinbase first therefore masks potential\nissues with the header. Fix this by removing the pre-check.\n\nThe pre-check was likely introduced on top of\nada0caa165905b50db351a56ec124518c922085a to fix UB in\nGetWitnessCommitmentIndex in case a block's transactions are empty. This\ncode path could only be reached because of the call to\nUpdateUncommittedBlockStructures in submitblock, but cannot be reached\nthrough net_processing.\n\nAdd some functional test cases to cover the previous conditions that\nlead to a \"Block does not start with a coinbase\" json rpc error being\nreturned.\n\n---\n\nWith the introduction of a mining ipc interface and the potential future\nintroduction of a kernel library API it becomes increasingly important\nto offer common behaviour between them. An example of this is\nProcessNewBlock, which is used by ipc, rpc, net_processing and\n(potentially) the kernel library. Having divergent behaviour on\nsuggested pre-checks and checks for these functions is confusing to both\ndevelopers and users and is a maintenance burden.\n\nThe rpc interface for ProcessNewBlock (submitblock) currently pre-checks\nif the block has a coinbase transaction and whether it has been\nprocessed before. While the current example binary for how to use the\nkernel library, bitcoin-chainstate, imitates these checks, the other\ninterfaces do not.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmc/o6EACgkQm3m0VpHb\nQXNpQhAAnIEWCtglSRZ/gkvZbVsAbbTA6AkLhxACbBZq+M128/5EQgcfEr2Pxrjf\nDu65LtHZkRXYnYR5A4nhFc6X6I9NLCjMCJzuKv4pxjYdHh9JnjNzUdkAfjzMQ/A8\nhaQn9dbpejLgOr7iLRomb+9MYGQKWGwlMhvBOXfJF+RhuHQO5RvutdoOeQHkmeN8\ngk/uDjuEagIcLnjZtXUPe7A5se68S723dUcc06h/XttXXQ7BX71301l9c79wGwl6\nOoJIPaxdFeh1RxWnzChVU0qY/9H6+eOm0eUWwA4FZAAUaeTvGbpwysRveve3zFJP\nd2xiKxbNAxMdytQE1yX4S73rjPvWn7vThLfSURvekQE8AwFcoWQDcHcjC8Yk3tp9\nyc40iviLgAfjWqytZCYCDROZs2e4N7OnJy6gQPIKR3CzJsMUU1RClzVUllJPXmjQ\n/3vB/24ZQKrRcIJ7knH++mY7c1ULquVMjolSWF588NoSr7lru3Zb0WiGRmZtvJ8v\nXGH3S9k4zEq/c8V89GgQTWBpsaPkKmpFhm1ADL6qrycr/hhJBEidLMa5T0zfe4tk\nLYl1xNdRCCUEIrpw5dm9GsoKYtg9qEC0i5zyOBCY2csvnQRTnl2BrZvVvuuH6R21\nC5GviJQ5eUmFQHUA6OfvpUh/hMyQqkgy14bk5i4X9qBo5xu5YXA=\n=ZrMy\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/da10e0bab4a3e98868dd663af02c43b1dc8b7f4a",
          "sha": "da10e0bab4a3e98868dd663af02c43b1dc8b7f4a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/da10e0bab4a3e98868dd663af02c43b1dc8b7f4a"
        }
      ],
      "message": "rpc: Remove submitblock coinbase pre-check\n\nThe coinbase check is repeated again early during ProcessNewBlock.\nPre-checking it may also shadow more fundamental problems with a block.\nIn most cases the block header is checked first, before validating the\ntransactions. Checking the coinbase first therefore masks potential\nissues with the header. Fix this by removing the pre-check.\n\nThe pre-check was likely introduced on top of\nada0caa165905b50db351a56ec124518c922085a to fix UB in\nGetWitnessCommitmentIndex in case a block's transactions are empty. This\ncode path could only be reached because of the call to\nUpdateUncommittedBlockStructures in submitblock, but cannot be reached\nthrough net_processing.\n\nAdd some functional test cases to cover the previous conditions that\nlead to a \"Block does not start with a coinbase\" json rpc error being\nreturned.\n\n---\n\nWith the introduction of a mining ipc interface and the potential future\nintroduction of a kernel library API it becomes increasingly important\nto offer common behaviour between them. An example of this is\nProcessNewBlock, which is used by ipc, rpc, net_processing and\n(potentially) the kernel library. Having divergent behaviour on\nsuggested pre-checks and checks for these functions is confusing to both\ndevelopers and users and is a maintenance burden.\n\nThe rpc interface for ProcessNewBlock (submitblock) currently pre-checks\nif the block has a coinbase transaction and whether it has been\nprocessed before. While the current example binary for how to use the\nkernel library, bitcoin-chainstate, imitates these checks, the other\ninterfaces do not.",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-11-21T21:16:43Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-11-21T11:14:25Z"
      },
      "sha": "36dbebafb9b54764005e6fffa7ad28d4cadfe5e4"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU2MmE4YWJkN2RmMjE3OTVkY2QxNzM3NzNmNjg5YjZkNGM4ZmVhYjY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e62a8abd7df21795dcd173773f689b6d4c8feab6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e62a8abd7df21795dcd173773f689b6d4c8feab6",
      "tree": {
        "sha": "da0a71bddb466602743c2221552ed26490344b60",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/da0a71bddb466602743c2221552ed26490344b60"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree da0a71bddb466602743c2221552ed26490344b60\nparent 36dbebafb9b54764005e6fffa7ad28d4cadfe5e4\nauthor TheCharlatan <seb.kung@gmail.com> 1732189015 +0100\ncommitter TheCharlatan <seb.kung@gmail.com> 1732223911 +0100\n\nrpc: Remove submitblock invalid-duplicate precheck\n\nProcessNewBlock fails if an invalid duplicate block is passed in through\nits call to AcceptBlock and AcceptBlockHeader. The failure in\nAcceptBlockHeader makes AcceptBlock return early. This makes the\npre-check in submitblock redundant.\n\n---\n\nWith the introduction of a mining ipc interface and the potential future\nintroduction of a kernel library API it becomes increasingly important\nto offer common behaviour between them. An example of this is\nProcessNewBlock, which is used by ipc, rpc, net_processing and\n(potentially) the kernel library. Having divergent behaviour on\nsuggested pre-checks and checks for these functions is confusing to both\ndevelopers and users and is a maintenance burden.\n\nThe rpc interface for ProcessNewBlock (submitblock) currently pre-checks\nif the block has a coinbase transaction and whether it has been\nprocessed before. While the current example binary for how to use the\nkernel library, bitcoin-chainstate, imitates these checks, the other\ninterfaces do not.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmc/o6cACgkQm3m0VpHb\nQXMIZBAAtGuVtaC9kjHSC87FLJHPVc3ieHpklpd7YRpKIwXcVdwmbv6eSD4exkst\nZhhhIzdTKMuDgZRfoQJk3uS25PSBLCykTPqehZxrbiqSvF0iXMJBWkkfImLQKoOs\nVHXXPv34sNyVKIY0mZcvUuCpTpTsWoejysRCUmAcNDAGALgc4DYan0vQd5LCfFQL\nBQJEhq02aw/Y+5277zvSVVU2/aMyr5zbI3n2PwG4VRE42VubY4toElb+Rj89r+h+\nZuA6WOmPP2wdL0JpnoYHblFQFzhTz9fhM7q35XmTIoxr1rdRsqqz7e+nXTMwXq57\nK5bpRcdQwAyZYSxATd4dyl/pWOvXcmGpLGLviBSzTcCMxvS7Xiy+raJk12MuWon4\ndgdFtaCNJH2ILvrcCuoTMDamEKWPfbthi6pP7TFC9KCxFkRZo4l0FrdLo+KRFi90\ngTqxt3p4fe3tmNZoFBCwdk4JwLg56aJ/5i4Td1LX9vZ2gKJEPEXg2XpGwEV1wKWf\nA+Cu9fqsa9mX8ZBQpWo5uCZ1QhTgKBBBgBO2D++bx1jx+e176Wg9jV4GDEGcrk3d\nD2l1m1CbhPk/OysTLV6AWty8ZZ2BrOp4bCaF7IERpFK26/yEQ1tbmkxWn4H7+V6K\nVvupmvgs/s4w6AwHni2avUuhjn1XdbnbOIydpkWWwHGJCwkQJe4=\n=sC+5\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/36dbebafb9b54764005e6fffa7ad28d4cadfe5e4",
          "sha": "36dbebafb9b54764005e6fffa7ad28d4cadfe5e4",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/36dbebafb9b54764005e6fffa7ad28d4cadfe5e4"
        }
      ],
      "message": "rpc: Remove submitblock invalid-duplicate precheck\n\nProcessNewBlock fails if an invalid duplicate block is passed in through\nits call to AcceptBlock and AcceptBlockHeader. The failure in\nAcceptBlockHeader makes AcceptBlock return early. This makes the\npre-check in submitblock redundant.\n\n---\n\nWith the introduction of a mining ipc interface and the potential future\nintroduction of a kernel library API it becomes increasingly important\nto offer common behaviour between them. An example of this is\nProcessNewBlock, which is used by ipc, rpc, net_processing and\n(potentially) the kernel library. Having divergent behaviour on\nsuggested pre-checks and checks for these functions is confusing to both\ndevelopers and users and is a maintenance burden.\n\nThe rpc interface for ProcessNewBlock (submitblock) currently pre-checks\nif the block has a coinbase transaction and whether it has been\nprocessed before. While the current example binary for how to use the\nkernel library, bitcoin-chainstate, imitates these checks, the other\ninterfaces do not.",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-11-21T21:18:31Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-11-21T11:36:55Z"
      },
      "sha": "e62a8abd7df21795dcd173773f689b6d4c8feab6"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDFmN2ZjNzM4MjU1MjA1YTY0Mzc0Njg2YWNhOWE0YzUzMDg5MzYwZjE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1f7fc738255205a64374686aca9a4c53089360f1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1f7fc738255205a64374686aca9a4c53089360f1",
      "tree": {
        "sha": "6ed12bb68ada895025d8a97f7abe420ead4551a1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6ed12bb68ada895025d8a97f7abe420ead4551a1"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 6ed12bb68ada895025d8a97f7abe420ead4551a1\nparent e62a8abd7df21795dcd173773f689b6d4c8feab6\nauthor TheCharlatan <seb.kung@gmail.com> 1732189639 +0100\ncommitter TheCharlatan <seb.kung@gmail.com> 1732223913 +0100\n\nrpc: Remove submitblock duplicate pre-check\n\nThe duplicate checks are repeated early in the contextual checks of\nProcessNewBlock. If duplicate blocks are detected much of their\nvalidation is skipped. Depending on the constitution of the block,\nvalidating the merkle root of the block is part of the more intensive\nworkload when validating a block. This could be an argument for moving\nthe pre-checks into block processing. In net_processing this would have\na smaller effect however, since the block mutation check, which also\nvalidates the merkle root, is done before.\n\nA side effect of this change is that a duplicate block is persisted\nagain on disk even when pruning is activated. This is similar to the\nbehaviour with getblockfrompeer. Add a release note for this change in\nbehaviour.\n\nTesting spamming a node with valid, but duplicate unrequested blocks\nseems to exhaust a CPU thread, but does not seem to significantly impact\nkeeping up with the tip. The benefits of adding these checks to\nnet_processing are questionable, especially since there are other ways\nto trigger the more CPU-intensive checks without submitting a duplicate\nblock. Since these DOS concerns apply even less to the RPC interface,\nwhich does not have banning mechanics built in, remove them too.\n\n---\n\nWith the introduction of a mining ipc interface and the potential future\nintroduction of a kernel library API it becomes increasingly important\nto offer common behaviour between them. An example of this is\nProcessNewBlock, which is used by ipc, rpc, net_processing and\n(potentially) the kernel library. Having divergent behaviour on\nsuggested pre-checks and checks for these functions is confusing to both\ndevelopers and users and is a maintenance burden.\n\nThe rpc interface for ProcessNewBlock (submitblock) currently pre-checks\nif the block has a coinbase transaction and whether it has been\nprocessed before. While the current example binary for how to use the\nkernel library, bitcoin-chainstate, imitates these checks, the other\ninterfaces do not.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmc/o6kACgkQm3m0VpHb\nQXMU7Q/8Dl78YOfcCX1ViEzbzZS/Bd9cVFES649RilBu5x28QwW/y9Z9TH9HsUR9\nwx6y1YcoclSMZL+KDRo6OQc0s8f5w+LDJ/owS0OyU98gCygDtGF393x9cTC50lpJ\n3bvarhJd6KWl6ADepDwScCjGgOPsT+pnO+N9wkcYP2o1NVRjpd9GBauUFIrlrxPo\nxnXuxIfmWCX1JhLqFIAXDcdKXzGaf6KzTEMuaR+XPaEOduAipiKr8/tkoiIyxSdw\nt9XnC5bdAZTdGDSmbua9MJfLyG97bkOVx26kOGM387cxB8MQJTRGbhHfv5LrzASq\nQtVv/73WncCy3w8BVhxBARRovZKWqpY/LAPAbTf730DIoRKUSLt3md7WZxMi97xj\nD6inrGuQl+DM8L9v+daq2xOaZd1+aM7cHhQCeKqyUOVZM9cOjeWKQ+hb/SX5EvaE\njEub3HMJtMJpMrvbfSy0YaNZFOYaNno66NCHUC6jIHAJZKqr8/PvFp9QhAcjSpwd\n0szKRcLPawp1MFS74FFjPJ/07R7UFIR51tKHgSHsF16PfxIzKOWBbvjhhs+S3s/2\n4fhv4Vza6M2yLl0vCta1WfDRWQUpraSDH91x0sp22JkDbBvhsL+mVxC4cOpbeSdd\nFb2AEwGMHaYc3uXMojO3yol1v9thsKF3vzT6dZASL7TxohVHTg0=\n=x9M8\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e62a8abd7df21795dcd173773f689b6d4c8feab6",
          "sha": "e62a8abd7df21795dcd173773f689b6d4c8feab6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e62a8abd7df21795dcd173773f689b6d4c8feab6"
        }
      ],
      "message": "rpc: Remove submitblock duplicate pre-check\n\nThe duplicate checks are repeated early in the contextual checks of\nProcessNewBlock. If duplicate blocks are detected much of their\nvalidation is skipped. Depending on the constitution of the block,\nvalidating the merkle root of the block is part of the more intensive\nworkload when validating a block. This could be an argument for moving\nthe pre-checks into block processing. In net_processing this would have\na smaller effect however, since the block mutation check, which also\nvalidates the merkle root, is done before.\n\nA side effect of this change is that a duplicate block is persisted\nagain on disk even when pruning is activated. This is similar to the\nbehaviour with getblockfrompeer. Add a release note for this change in\nbehaviour.\n\nTesting spamming a node with valid, but duplicate unrequested blocks\nseems to exhaust a CPU thread, but does not seem to significantly impact\nkeeping up with the tip. The benefits of adding these checks to\nnet_processing are questionable, especially since there are other ways\nto trigger the more CPU-intensive checks without submitting a duplicate\nblock. Since these DOS concerns apply even less to the RPC interface,\nwhich does not have banning mechanics built in, remove them too.\n\n---\n\nWith the introduction of a mining ipc interface and the potential future\nintroduction of a kernel library API it becomes increasingly important\nto offer common behaviour between them. An example of this is\nProcessNewBlock, which is used by ipc, rpc, net_processing and\n(potentially) the kernel library. Having divergent behaviour on\nsuggested pre-checks and checks for these functions is confusing to both\ndevelopers and users and is a maintenance burden.\n\nThe rpc interface for ProcessNewBlock (submitblock) currently pre-checks\nif the block has a coinbase transaction and whether it has been\nprocessed before. While the current example binary for how to use the\nkernel library, bitcoin-chainstate, imitates these checks, the other\ninterfaces do not.",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-11-21T21:18:33Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-11-21T11:47:19Z"
      },
      "sha": "1f7fc738255205a64374686aca9a4c53089360f1"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGJiNTNjZTliZGFlMmYwMmQ3YmQ5NWNmNWQ4Y2E0Y2NmNTEzNjQ2NmE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bb53ce9bdae2f02d7bd95cf5d8ca4ccf5136466a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/bb53ce9bdae2f02d7bd95cf5d8ca4ccf5136466a",
      "tree": {
        "sha": "09abdf2ba06ba57a08fb8a54b5670efa09148692",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/09abdf2ba06ba57a08fb8a54b5670efa09148692"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 09abdf2ba06ba57a08fb8a54b5670efa09148692\nparent 1f7fc738255205a64374686aca9a4c53089360f1\nauthor Greg Sanders <gsanders87@gmail.com> 1732222818 +0100\ncommitter TheCharlatan <seb.kung@gmail.com> 1732223915 +0100\n\ntests: Add functional test for submitting a previously pruned block\n\nThis tests the new submitblock behaviour that is introduced in the\nprevious commit: Submitting a previously pruned block should persist the\nblock's data again.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmc/o6sACgkQm3m0VpHb\nQXM8Zg//TXqeco+5hmldFsZPN+VE1jBkYx9U/OEDMd4/2nZBLeqeogx+85ZGKZ/Q\nJ+P/uytNsMpfyc8/+qredjynNj04tKmHzD8052dW5yvxz46VZ/2HNkzWogvX6NnS\n434KVNs7Bu/kV4xnxQBj70sEEQlSSAwPyn9GB+Asv3TehZA37PuTbMr0ixWgVdei\nXKY8FmdZvgjKxr+DFnKgMR7zkmTIDKXICTbpBAy7nkYHZkVjcs0tRg0pYjYxcPNB\nCbvbUY5SD5HxbYQuGg5RY2WN6I5zSX7xk4FVV4jEU5u7lNk5gyyK5W23Deb1REd1\nj5E/eTr8t834s+fUnN7oRbrMN+rskbyiptqYhEEhp6YiEVH8tSHFBZNKE3epKTYE\nFJusiZSC5kwhGf5v4ecqsXcl7kNGDraUtYFyI1xN4ivyYNWrrjbwcpYMfYKSgDg0\nXgvpeydksNmwavXbNo7Ak5wep3CQs8ybwuGn1pB6Bdx6mefEMWclQTDuvD9CFZOV\n3Z30pjn+fczLBosvsqVmKClfVkquRlL/32mZh/Ggk2ylg8O5cKcDywvu2F/OUD3d\nvOiXDLiGBGAxyYOLRYqwCUqifdQTw4i6hWuI9F1Exx03ZtTkQyaUD9c4Op247BkS\nK4H1Fl3166E9BO8EwEGsNmhue0xUkmp8GbSkoEQlsxLp2hvzM0Q=\n=Z2kP\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1f7fc738255205a64374686aca9a4c53089360f1",
          "sha": "1f7fc738255205a64374686aca9a4c53089360f1",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/1f7fc738255205a64374686aca9a4c53089360f1"
        }
      ],
      "message": "tests: Add functional test for submitting a previously pruned block\n\nThis tests the new submitblock behaviour that is introduced in the\nprevious commit: Submitting a previously pruned block should persist the\nblock's data again.",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-11-21T21:18:35Z"
      },
      "author": {
        "name": "Greg Sanders",
        "email": "gsanders87@gmail.com",
        "date": "2024-11-21T21:00:18Z"
      },
      "sha": "bb53ce9bdae2f02d7bd95cf5d8ca4ccf5136466a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDczZGI5NWM2NWMxZDM3MjgyMjE2NjA0NWNhOGI5ZjE3M2Q1ZmQ4ODM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/73db95c65c1d372822166045ca8b9f173d5fd883",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/73db95c65c1d372822166045ca8b9f173d5fd883",
      "tree": {
        "sha": "896fc80625a350e43b15f5678011d6421202b9a7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/896fc80625a350e43b15f5678011d6421202b9a7"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 896fc80625a350e43b15f5678011d6421202b9a7\nparent bb53ce9bdae2f02d7bd95cf5d8ca4ccf5136466a\nauthor TheCharlatan <seb.kung@gmail.com> 1730130418 +0100\ncommitter TheCharlatan <seb.kung@gmail.com> 1732223916 +0100\n\nkernel: Make bitcoin-chainstate's block validation mirror submitblock's\n\nThe behaviour of submitblock was changed in the previous commit, so\nchange it here too.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmc/o6wACgkQm3m0VpHb\nQXPwSg/8Dw9YCMN1C+vPJPvq2FMMLCCPwjQiLdQFPmZfC91cMdH4vxut5FS453mp\nR7XPlewZoNw8yANchEHxFEM8W3W9//sW9c5v6VsgKAw/jS1aSr2NXH2mvI2j4z9h\nuD778KBGoyX62Wg3JPgmRrAVDcR9Cae6gciiDarNggrtJuL2qiPXj3vo07qONYjY\ns3g+ImCt5vdLrQ7zJFtIazs15PFwCkCMkOS1QJV3NgCQD5Y5s4Cun3UgnYbsabv3\n0XhtnewKAfBTVRTl5J2tCKM3GC09Fx1YiERNsqdgS6GX6aJ1tsySwHN5Og0Ui0ae\n707qOFw77ua8lS/gwWYp0xtpXrAFdR+ZLRtskCudfq87vDuMDqo+PPu6YJA21Is3\npTEC4NXW7AKZOSpLmJDXbt398AuTI7gg4Uwz3ZYECAelTrLLWl30kQmtoD8B19tU\nhC0MDl0Tfolm64mIGb45c9KCw1vr9sxIENKczvA6MT4ASaAm8CPO+Z9GlOq40GvI\nfv59OLT3Cg3CGP/5MmNyp1CIRIalwsicRf89c/pOSDbhlJlXD8zqI7D5Pm9ZO1KG\nkJi7U5/krNBYNNqIAKlW9ttIN0WLZDR6u8y3BBYLZ2rAAcb1H2TylY3x6+CbHVCf\ngtYm9OSw4S3S3gqNtpUkh2c5JgfWki1rvrzEpEgyNLwnbLL0gRE=\n=n1BA\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bb53ce9bdae2f02d7bd95cf5d8ca4ccf5136466a",
          "sha": "bb53ce9bdae2f02d7bd95cf5d8ca4ccf5136466a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/bb53ce9bdae2f02d7bd95cf5d8ca4ccf5136466a"
        }
      ],
      "message": "kernel: Make bitcoin-chainstate's block validation mirror submitblock's\n\nThe behaviour of submitblock was changed in the previous commit, so\nchange it here too.",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-11-21T21:18:36Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-10-28T15:46:58Z"
      },
      "sha": "73db95c65c1d372822166045ca8b9f173d5fd883"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15389036771,
      "node_id": "HRFPE_lADOABII586cN9yczwAAAAOVQhDj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15389036771",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/73db95c65c1d372822166045ca8b9f173d5fd883",
      "created_at": "2024-11-21T21:23:46Z"
    },
    {
      "event": "commented",
      "id": 2492366799,
      "node_id": "IC_kwDOABII586Ujn_P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2492366799",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-21T21:23:51Z",
      "updated_at": "2024-11-22T08:41:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thank you for the reviews and the test case @instagibbs,\r\n\r\nUpdated 563278b6a125f1a3d2111d4ebd74b9cc16d83ec5 -> 73db95c65c1d372822166045ca8b9f173d5fd883 ([submitblock_prechecks_3](https://github.com/TheCharlatan/bitcoin/tree/submitblock_prechecks_3) -> [submitblock_prechecks_4](https://github.com/TheCharlatan/bitcoin/tree/submitblock_prechecks_4), [compare](https://github.com/TheCharlatan/bitcoin/compare/submitblock_prechecks_3..submitblock_prechecks_4))\r\n\r\n* Addressed @Sjors' [comment](https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1852357156), improved the logging, but did not split it into its own commit. Should be clear enough with the other changes now.\r\n* Addressed @Sjors' [comment](https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1852467087), fixed typo.\r\n* Added suggested [patch](https://github.com/bitcoin/bitcoin/pull/31175#issuecomment-2491873388) from @instagibbs in its own commit.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#issuecomment-2492366799",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31175"
    },
    {
      "event": "mentioned",
      "id": 15389037771,
      "node_id": "MEE_lADOABII586cN9yczwAAAAOVQhTL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15389037771",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-21T21:23:53Z"
    },
    {
      "event": "subscribed",
      "id": 15389037785,
      "node_id": "SE_lADOABII586cN9yczwAAAAOVQhTZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15389037785",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-21T21:23:53Z"
    },
    {
      "event": "mentioned",
      "id": 15389037801,
      "node_id": "MEE_lADOABII586cN9yczwAAAAOVQhTp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15389037801",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-21T21:23:53Z"
    },
    {
      "event": "subscribed",
      "id": 15389037815,
      "node_id": "SE_lADOABII586cN9yczwAAAAOVQhT3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15389037815",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-21T21:23:53Z"
    },
    {
      "event": "commented",
      "id": 2493170407,
      "node_id": "IC_kwDOABII586UmsLn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2493170407",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-22T08:31:26Z",
      "updated_at": "2024-11-22T08:31:26Z",
      "author_association": "MEMBER",
      "body": "re-utACK 73db95c65c1d372822166045ca8b9f173d5fd883\r\n\r\nI also checked that `submitblock` in the new test fails with `duplicate` if you revert 1f7fc738255205a64374686aca9a4c53089360f1.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#issuecomment-2493170407",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31175"
    },
    {
      "event": "reviewed",
      "id": 2455019300,
      "node_id": "PRR_kwDOABII586SVJ8k",
      "url": null,
      "actor": null,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK 73db95c65c1d372822166045ca8b9f173d5fd883\r\n\r\nNot an expert here but motivation makes a lot of sense, and good to remove such indirect code from past covert fixes",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#pullrequestreview-2455019300",
      "submitted_at": "2024-11-22T16:41:02Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
    },
    {
      "event": "reviewed",
      "id": 2465507312,
      "node_id": "PRR_kwDOABII586S9Kfw",
      "url": null,
      "actor": null,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 73db95c65c1d372822166045ca8b9f173d5fd883\r\nReviewed the code (didn't look closely at `bitcoin-chainstate.cpp`) and tested it a little bit.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#pullrequestreview-2465507312",
      "submitted_at": "2024-11-27T16:36:15Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1833399181",
      "pull_request_review_id": 2422203882,
      "id": 1833399181,
      "node_id": "PRRC_kwDOABII585tR3ON",
      "diff_hunk": "@@ -237,10 +237,17 @@ def assert_submitblock(block, result_str_1, result_str_2=None):\n         bad_block = copy.deepcopy(block)\n         bad_block.vtx[0].vin[0].prevout.hash += 1\n         bad_block.vtx[0].rehash()\n+        self.log.info(\"getblocktemplate: Test block with missing coinbase\")\n         assert_template(node, bad_block, 'bad-cb-missing')\n \n+        self.log.info(\"submitblock: Test empty block\")\n+        assert_equal('high-hash', node.submitblock(hexdata=CBlock().serialize().hex()))\n         self.log.info(\"submitblock: Test invalid coinbase transaction\")\n-        assert_raises_rpc_error(-22, \"Block does not start with a coinbase\", node.submitblock, CBlock().serialize().hex())\n+        bad_block.solve()\n+        assert_raises_rpc_error(-22, \"Block does not start with a coinbase\", node.submitblock, bad_block.serialize().hex())\n+        no_tx_block = copy.deepcopy(block)\n+        no_tx_block.vtx.clear()\n+        no_tx_block.solve()\n         assert_raises_rpc_error(-22, \"Block does not start with a coinbase\", node.submitblock, bad_block.serialize().hex())",
      "path": "test/functional/mining_basic.py",
      "position": null,
      "original_position": 16,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "eedbce9dea2b18600a1e02aa54ade3dcf50b5d06",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "submit `no_tx_block` instead of `bad_block` here, and if I remember correctly from yesterday, that will lead to a different error.",
      "created_at": "2024-11-07T21:35:42Z",
      "updated_at": "2024-11-07T21:35:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1833399181",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1833399181"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 251,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1833458457",
      "pull_request_review_id": 2422298352,
      "id": 1833458457,
      "node_id": "PRRC_kwDOABII585tSFsZ",
      "diff_hunk": "@@ -237,10 +237,17 @@ def assert_submitblock(block, result_str_1, result_str_2=None):\n         bad_block = copy.deepcopy(block)\n         bad_block.vtx[0].vin[0].prevout.hash += 1\n         bad_block.vtx[0].rehash()\n+        self.log.info(\"getblocktemplate: Test block with missing coinbase\")\n         assert_template(node, bad_block, 'bad-cb-missing')\n \n+        self.log.info(\"submitblock: Test empty block\")\n+        assert_equal('high-hash', node.submitblock(hexdata=CBlock().serialize().hex()))\n         self.log.info(\"submitblock: Test invalid coinbase transaction\")\n-        assert_raises_rpc_error(-22, \"Block does not start with a coinbase\", node.submitblock, CBlock().serialize().hex())\n+        bad_block.solve()\n+        assert_raises_rpc_error(-22, \"Block does not start with a coinbase\", node.submitblock, bad_block.serialize().hex())\n+        no_tx_block = copy.deepcopy(block)\n+        no_tx_block.vtx.clear()\n+        no_tx_block.solve()\n         assert_raises_rpc_error(-22, \"Block does not start with a coinbase\", node.submitblock, bad_block.serialize().hex())",
      "path": "test/functional/mining_basic.py",
      "position": null,
      "original_position": 16,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "eedbce9dea2b18600a1e02aa54ade3dcf50b5d06",
      "in_reply_to_id": 1833399181,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Sorry, fixed. Makes me even less certain on keeping the coinbase error around. I'll sleep on it.",
      "created_at": "2024-11-07T22:35:34Z",
      "updated_at": "2024-11-07T22:35:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1833458457",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1833458457"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 251,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1847140617",
      "pull_request_review_id": 2443525257,
      "id": 1847140617,
      "node_id": "PRRC_kwDOABII585uGSEJ",
      "diff_hunk": "@@ -1015,25 +1015,7 @@ static RPCHelpMan submitblock()\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block decode failed\");\n     }\n \n-    if (block.vtx.empty() || !block.vtx[0]->IsCoinBase()) {\n-        throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block does not start with a coinbase\");\n-    }\n-\n     ChainstateManager& chainman = EnsureAnyChainman(request.context);\n-    uint256 hash = block.GetHash();\n-    {\n-        LOCK(cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(hash);\n-        if (pindex) {\n-            if (pindex->IsValid(BLOCK_VALID_SCRIPTS)) {\n-                return \"duplicate\";",
      "path": "src/rpc/mining.cpp",
      "position": 15,
      "original_position": 15,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "ab3a67b60069b2f0371740ccd84fb13c6a0e064b",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think that this will change behavior in the case where we re-submit a previously pruned block with `submitblock`:\r\n\r\nOn master, we'd skip early here and return \"duplicate\" because the index is still `BLOCK_VALID_SCRIPTS`-valid.\r\nBut with his branch, we'd accept the block and save it to disk once more.\r\n\r\nI'm really unsure if that is an undesired change in behavior or not - I guess it could also be viewed as a feature.\r\nIn any case, it's a behavior change that should be documented if we do go through with it.",
      "created_at": "2024-11-18T19:31:49Z",
      "updated_at": "2024-11-18T19:36:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1847140617",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1847140617"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1029,
      "original_line": 1029,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1847279135",
      "pull_request_review_id": 2443737880,
      "id": 1847279135,
      "node_id": "PRRC_kwDOABII585uGz4f",
      "diff_hunk": "@@ -1015,25 +1015,7 @@ static RPCHelpMan submitblock()\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block decode failed\");\n     }\n \n-    if (block.vtx.empty() || !block.vtx[0]->IsCoinBase()) {\n-        throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block does not start with a coinbase\");\n-    }\n-\n     ChainstateManager& chainman = EnsureAnyChainman(request.context);\n-    uint256 hash = block.GetHash();\n-    {\n-        LOCK(cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(hash);\n-        if (pindex) {\n-            if (pindex->IsValid(BLOCK_VALID_SCRIPTS)) {\n-                return \"duplicate\";",
      "path": "src/rpc/mining.cpp",
      "position": 15,
      "original_position": 15,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "ab3a67b60069b2f0371740ccd84fb13c6a0e064b",
      "in_reply_to_id": 1847140617,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good catch, thank you for taking another look! I'm also not sure what to do in light of this. At the minimum this reason for the duplicate check should be documented. I feel like with this kind of change I would err on the conservative side and not introduce potentially breaking behaviour. Even if this might be a nice way to inject block data into the node, I don't know if this is something anybody needs, even if it now more closely mimics `getblockfrompeer`. \r\n\r\nWe could keep the duplicate check and remove the invalid duplicate check, but I feel like requiring a pre-check to handle the pruning and force processing case is not very elegant. At the same time we can't move the check into `ProcessNewBlock`, since it would break `getblockfrompeer` as far as I can tell. What do you think?\r\n\r\n`bitcoin-chainstate` currently does not support pruning (though it also sets force processing), so removing it there should not have the same effect.",
      "created_at": "2024-11-18T21:08:58Z",
      "updated_at": "2024-11-18T21:08:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1847279135",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1847279135"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1029,
      "original_line": 1029,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1850831460",
      "pull_request_review_id": 2449457866,
      "id": 1850831460,
      "node_id": "PRRC_kwDOABII585uUXJk",
      "diff_hunk": "@@ -1015,25 +1015,7 @@ static RPCHelpMan submitblock()\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block decode failed\");\n     }\n \n-    if (block.vtx.empty() || !block.vtx[0]->IsCoinBase()) {\n-        throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block does not start with a coinbase\");\n-    }\n-\n     ChainstateManager& chainman = EnsureAnyChainman(request.context);\n-    uint256 hash = block.GetHash();\n-    {\n-        LOCK(cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(hash);\n-        if (pindex) {\n-            if (pindex->IsValid(BLOCK_VALID_SCRIPTS)) {\n-                return \"duplicate\";",
      "path": "src/rpc/mining.cpp",
      "position": 15,
      "original_position": 15,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "ab3a67b60069b2f0371740ccd84fb13c6a0e064b",
      "in_reply_to_id": 1847140617,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> err on the conservative side and not introduce potentially breaking behaviour\r\n\r\nGenerally speaking, I don't see reason why we should artificially restrict a user from submitting a previously pruned block via RPC, when they could request  that block via `getblockfrompeer`, and I can't of use cases it would break.\r\n\r\nMaybe one way to move forward would be to not remove the duplicate check in this PR (but document why it exists) - and instead remove it in a follow-up PR, together with a release note about the changed behavior.\r\n\r\n@Sjors: FYI, since you introduced `getblockfrompeer`, do you remember any discussions about also allowing to re-submit previously pruned blocks via RPC / do you see a problem with that?",
      "created_at": "2024-11-20T18:56:20Z",
      "updated_at": "2024-11-20T19:05:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1850831460",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1850831460"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1029,
      "original_line": 1029,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1850834724",
      "pull_request_review_id": 2449463007,
      "id": 1850834724,
      "node_id": "PRRC_kwDOABII585uUX8k",
      "diff_hunk": "@@ -1015,25 +1015,7 @@ static RPCHelpMan submitblock()\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block decode failed\");\n     }\n \n-    if (block.vtx.empty() || !block.vtx[0]->IsCoinBase()) {\n-        throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block does not start with a coinbase\");\n-    }\n-\n     ChainstateManager& chainman = EnsureAnyChainman(request.context);\n-    uint256 hash = block.GetHash();\n-    {\n-        LOCK(cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(hash);\n-        if (pindex) {\n-            if (pindex->IsValid(BLOCK_VALID_SCRIPTS)) {\n-                return \"duplicate\";",
      "path": "src/rpc/mining.cpp",
      "position": 15,
      "original_position": 15,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "ab3a67b60069b2f0371740ccd84fb13c6a0e064b",
      "in_reply_to_id": 1847140617,
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "The only danger I can foresee is if someone was somehow relying on them not being able to be committed to disk again. Would there be any performance concerns with commiting+re-pruning or similar?",
      "created_at": "2024-11-20T18:59:07Z",
      "updated_at": "2024-11-20T18:59:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1850834724",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1850834724"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1029,
      "original_line": 1029,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1851973626",
      "pull_request_review_id": 2451238795,
      "id": 1851973626,
      "node_id": "PRRC_kwDOABII585uYt_6",
      "diff_hunk": "@@ -1015,25 +1015,7 @@ static RPCHelpMan submitblock()\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block decode failed\");\n     }\n \n-    if (block.vtx.empty() || !block.vtx[0]->IsCoinBase()) {\n-        throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block does not start with a coinbase\");\n-    }\n-\n     ChainstateManager& chainman = EnsureAnyChainman(request.context);\n-    uint256 hash = block.GetHash();\n-    {\n-        LOCK(cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(hash);\n-        if (pindex) {\n-            if (pindex->IsValid(BLOCK_VALID_SCRIPTS)) {\n-                return \"duplicate\";",
      "path": "src/rpc/mining.cpp",
      "position": 15,
      "original_position": 15,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "ab3a67b60069b2f0371740ccd84fb13c6a0e064b",
      "in_reply_to_id": 1847140617,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I decided to add a release note for now. I think the changes in this PR are small enough that we can hash the changes out wholesale and it is also not a particularly pressing change. Still not wholly convinced, but thinking about it some more I don't think somebody was relying on this behaviour beforehand either.",
      "created_at": "2024-11-21T12:32:42Z",
      "updated_at": "2024-11-21T12:32:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1851973626",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1851973626"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1029,
      "original_line": 1029,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1852276089",
      "pull_request_review_id": 2451703799,
      "id": 1852276089,
      "node_id": "PRRC_kwDOABII585uZ315",
      "diff_hunk": "@@ -1015,25 +1015,7 @@ static RPCHelpMan submitblock()\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block decode failed\");\n     }\n \n-    if (block.vtx.empty() || !block.vtx[0]->IsCoinBase()) {\n-        throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block does not start with a coinbase\");\n-    }\n-\n     ChainstateManager& chainman = EnsureAnyChainman(request.context);\n-    uint256 hash = block.GetHash();\n-    {\n-        LOCK(cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(hash);\n-        if (pindex) {\n-            if (pindex->IsValid(BLOCK_VALID_SCRIPTS)) {\n-                return \"duplicate\";",
      "path": "src/rpc/mining.cpp",
      "position": 15,
      "original_position": 15,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "ab3a67b60069b2f0371740ccd84fb13c6a0e064b",
      "in_reply_to_id": 1847140617,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "@mzumsande I don't recall such discussions. The only thing that matters for `getblockfrompeer` is that it _can_ store previously pruned blocks.\r\n\r\nThat said, I do think it's useful to allow `submitblock` to store a previously pruned block. It lets a user dump the block on one node and submit it on this node, without having go through the effort of establishing a p2p connection, figuring out the peer id and then calling `getblockfrompeer`. ",
      "created_at": "2024-11-21T14:45:24Z",
      "updated_at": "2024-11-21T14:45:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1852276089",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1852276089"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1029,
      "original_line": 1029,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1852312507",
      "pull_request_review_id": 2451772690,
      "id": 1852312507,
      "node_id": "PRRC_kwDOABII585uaAu7",
      "diff_hunk": "@@ -1015,25 +1015,7 @@ static RPCHelpMan submitblock()\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block decode failed\");\n     }\n \n-    if (block.vtx.empty() || !block.vtx[0]->IsCoinBase()) {\n-        throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block does not start with a coinbase\");\n-    }\n-\n     ChainstateManager& chainman = EnsureAnyChainman(request.context);\n-    uint256 hash = block.GetHash();\n-    {\n-        LOCK(cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(hash);\n-        if (pindex) {\n-            if (pindex->IsValid(BLOCK_VALID_SCRIPTS)) {\n-                return \"duplicate\";",
      "path": "src/rpc/mining.cpp",
      "position": 15,
      "original_position": 15,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "ab3a67b60069b2f0371740ccd84fb13c6a0e064b",
      "in_reply_to_id": 1847140617,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "@maflcko it's probably useful to briefly reopen #10146 and link to this thread for the likely real reason for that PR.\r\n\r\nI'm speculating it was done in a stealthy way because there might be someone running a public service to submit blocks, and it would use that RPC under the hood. Or they were worried that since mining pools use this RPC internally (see e.g. #3658, https://github.com/bitcoin/bitcoin/issues/5538#issuecomment-68075858) they might have it exposed to the internet - or at least blindly forward \"blocks\" to it. And therefore could be attacked.\r\n\r\ncc @dergoegge @darosior in case you want to add it to the disclosure overview.",
      "created_at": "2024-11-21T15:04:31Z",
      "updated_at": "2024-11-21T15:06:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1852312507",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1852312507"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1029,
      "original_line": 1029,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1852357156",
      "pull_request_review_id": 2451842933,
      "id": 1852357156,
      "node_id": "PRRC_kwDOABII585uaLok",
      "diff_hunk": "@@ -237,11 +237,19 @@ def assert_submitblock(block, result_str_1, result_str_2=None):\n         bad_block = copy.deepcopy(block)\n         bad_block.vtx[0].vin[0].prevout.hash += 1\n         bad_block.vtx[0].rehash()\n+        self.log.info(\"getblocktemplate: Test block with missing coinbase\")\n         assert_template(node, bad_block, 'bad-cb-missing')\n \n+        self.log.info(\"submitblock: Test empty block\")",
      "path": "test/functional/mining_basic.py",
      "position": null,
      "original_position": 7,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "6993836cb6488afa48922f19778ecef6d122bb69",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "6993836cb6488afa48922f19778ecef6d122bb69 nit: adding these log messages could be its own commit to de-obfuscate what it's actually testing.",
      "created_at": "2024-11-21T15:28:43Z",
      "updated_at": "2024-11-21T15:56:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1852357156",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1852357156"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 243,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1852467087",
      "pull_request_review_id": 2452017538,
      "id": 1852467087,
      "node_id": "PRRC_kwDOABII585uameP",
      "diff_hunk": "@@ -0,0 +1,8 @@\n+RPC\n+---\n+\n+Duplicate blocks submitted with `submitblock` will now persist their block data\n+even pruning. If pruning is activated, the data will be pruned again eventually",
      "path": "doc/release-notes-31175.md",
      "position": null,
      "original_position": 5,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "3c6eeaf39e01a599829648ecd34990540835962f",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "3c6eeaf39e01a599829648ecd34990540835962f: even if it was previously pruned.",
      "created_at": "2024-11-21T16:26:37Z",
      "updated_at": "2024-11-21T16:32:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1852467087",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1852467087"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 5,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1859092261",
      "pull_request_review_id": 2462460172,
      "id": 1859092261,
      "node_id": "PRRC_kwDOABII585uz38l",
      "diff_hunk": "@@ -1015,25 +1015,7 @@ static RPCHelpMan submitblock()\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block decode failed\");\n     }\n \n-    if (block.vtx.empty() || !block.vtx[0]->IsCoinBase()) {\n-        throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block does not start with a coinbase\");\n-    }\n-\n     ChainstateManager& chainman = EnsureAnyChainman(request.context);\n-    uint256 hash = block.GetHash();\n-    {\n-        LOCK(cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(hash);\n-        if (pindex) {\n-            if (pindex->IsValid(BLOCK_VALID_SCRIPTS)) {\n-                return \"duplicate\";",
      "path": "src/rpc/mining.cpp",
      "position": 15,
      "original_position": 15,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "ab3a67b60069b2f0371740ccd84fb13c6a0e064b",
      "in_reply_to_id": 1847140617,
      "user": {
        "login": "darosior",
        "id": 22457751,
        "node_id": "MDQ6VXNlcjIyNDU3NzUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darosior",
        "html_url": "https://github.com/darosior",
        "followers_url": "https://api.github.com/users/darosior/followers",
        "following_url": "https://api.github.com/users/darosior/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/darosior/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/darosior/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
        "organizations_url": "https://api.github.com/users/darosior/orgs",
        "repos_url": "https://api.github.com/users/darosior/repos",
        "events_url": "https://api.github.com/users/darosior/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/darosior/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I do not have the context nor the bug report behind this fix, but #10146 is clearly preventing a crash on accessing `block->vtx[0]` when an empty block is submitted through `submitblock`. In addition the introduction of the check for a valid coinbase transaction smells like preventing https://gnusha.org/url/?https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2019-February/016697.html but i can't think of how it could be exploited.\r\n\r\nTypically you would think of an attack along these lines:\r\n1. Miner A is exposing `submitblock`.\r\n2. Miner B mines a valid block and a malleated, invalid, block with the same hash.\r\n3. Miner B sends the malleated block to Miner A's `submitblock` API, which stores it as invalid.\r\n4. Miner A broadcasts his valid block.\r\n5. Miner B rejects it. REKT.\r\n\r\nBut `submitblock` uses `ProcessNewBlock` to store the block. And #10146 is after https://github.com/bitcoin/bitcoin/pull/9765, which makes sure `CheckBlock` is called (and therefore the coinbase check performed) before persisting the header.\r\n\r\n@gmaxwell was there more to #10146 than the crash fix?",
      "created_at": "2024-11-26T19:02:31Z",
      "updated_at": "2024-11-26T19:02:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1859092261",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1859092261"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1029,
      "original_line": 1029,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1860960957",
      "pull_request_review_id": 2465507312,
      "id": 1860960957,
      "node_id": "PRRC_kwDOABII585u7AK9",
      "diff_hunk": "@@ -1016,17 +1016,6 @@ static RPCHelpMan submitblock()\n     }\n \n     ChainstateManager& chainman = EnsureAnyChainman(request.context);\n-    uint256 hash = block.GetHash();\n-    {\n-        LOCK(cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(hash);",
      "path": "src/rpc/mining.cpp",
      "position": 12,
      "original_position": 7,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "1f7fc738255205a64374686aca9a4c53089360f1",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: If, after this PR, we re-submit genesis via `submitblock`, a different code path will be taken than for non-genesis duplicate blocks:\r\nWe won't return early in `AcceptBlockHeader`, will actually call `AddToBlockIndex()`, and write an incorrect log message\r\n`Saw new header hash=0f9188f13cb7b2c71f2a335e3a4fc328bf5beb436012afca590b1a11466e2206 height=0` for each `submitblock` call.\r\nNot a real problem though because nothing fails and why would you do that in the first place.",
      "created_at": "2024-11-27T16:29:56Z",
      "updated_at": "2024-11-27T16:36:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1860960957",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1860960957"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1026,
      "original_line": 1022,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1862626447",
      "pull_request_review_id": 2468750259,
      "id": 1862626447,
      "node_id": "PRRC_kwDOABII585vBWyP",
      "diff_hunk": "@@ -1016,17 +1016,6 @@ static RPCHelpMan submitblock()\n     }\n \n     ChainstateManager& chainman = EnsureAnyChainman(request.context);\n-    uint256 hash = block.GetHash();\n-    {\n-        LOCK(cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(hash);",
      "path": "src/rpc/mining.cpp",
      "position": 12,
      "original_position": 7,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "1f7fc738255205a64374686aca9a4c53089360f1",
      "in_reply_to_id": 1860960957,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This is also a debug only log, and it otherwise does not seem to be hitting any hot code paths, so I am not too concerned either.",
      "created_at": "2024-11-28T19:31:13Z",
      "updated_at": "2024-11-28T19:31:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1862626447",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1862626447"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1026,
      "original_line": 1022,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1862673015",
      "pull_request_review_id": 2468799917,
      "id": 1862673015,
      "node_id": "PRRC_kwDOABII585vBiJ3",
      "diff_hunk": "@@ -1016,17 +1016,6 @@ static RPCHelpMan submitblock()\n     }\n \n     ChainstateManager& chainman = EnsureAnyChainman(request.context);\n-    uint256 hash = block.GetHash();\n-    {\n-        LOCK(cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(hash);",
      "path": "src/rpc/mining.cpp",
      "position": 12,
      "original_position": 7,
      "commit_id": "73db95c65c1d372822166045ca8b9f173d5fd883",
      "original_commit_id": "1f7fc738255205a64374686aca9a4c53089360f1",
      "in_reply_to_id": 1860960957,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "it's unconditional once out of IBD. But allowing untrusted parties access to this rpc is unsafe anyway (can spam the node with low-work blocks since `force_processing` and `min_pow_checked` are true for the `ProcessNewBlock` call).",
      "created_at": "2024-11-28T20:44:00Z",
      "updated_at": "2024-11-28T20:44:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31175#discussion_r1862673015",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1862673015"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31175"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1026,
      "original_line": 1022,
      "side": "LEFT"
    }
  ]
}