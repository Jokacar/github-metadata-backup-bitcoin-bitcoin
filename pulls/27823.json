{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823",
    "id": 1377887024,
    "node_id": "PR_kwDOABII585SIOMw",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/27823",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/27823.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/27823.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27823",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27823/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/d27b9a2248476439ddab7700327f074005a810d5",
    "number": 27823,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "init: return error when block index is non-contiguous, fix feature_init.py file perturbation",
    "user": {
      "login": "mzumsande",
      "id": 48763452,
      "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mzumsande",
      "html_url": "https://github.com/mzumsande",
      "followers_url": "https://api.github.com/users/mzumsande/followers",
      "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
      "organizations_url": "https://api.github.com/users/mzumsande/orgs",
      "repos_url": "https://api.github.com/users/mzumsande/repos",
      "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/mzumsande/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "When the block index database is non-contiguous due to file corruption (i.e. it contains indexes of height `x-1` and `x+1`, but not `x`), bitcoind can currently crash with an assert in `BuildSkip()` / `GetAncestor()` during `BlockManager::LoadBlockIndex()`:\r\n```\r\nbitcoind: chain.cpp:112: const CBlockIndex* CBlockIndex::GetAncestor(int) const: Assertion `pindexWalk->pprev' failed.\r\n```\r\nThis PR changes it such that we instead return an `InitError` to the user.\r\n\r\nI stumbled upon this because I noticed that the file perturbation in `feature_init.py`  wasn't working as intended, which is fixed in the second commit:\r\n* Opening the file twice in one `with` statement would lead to `tf_read` being empty, so the test wouldn't perturb anything but replace the file with a new one. Fixed by first opening for read, then for write.\r\n* We need to restore the previous state after perturbations, so that only the current perturbation is active and not a mix of the current and previous ones.\r\n* I also added `checkblocks=200` to the startup parameters so that corruption in earlier blocks of `blk00000.dat` is detected during init verification and not ignored.\r\n\r\nAfter fixing `feature_init.py` like that I'd run into the `assert` mentioned above (so running the testfix from the second commit without the first one is a way to reproduce it).",
    "labels": [],
    "created_at": "2023-06-04T18:55:13Z",
    "updated_at": "2023-07-19T13:55:15Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "0da90373ed4a04a82f90a9f99bdc64ce77d44b67",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "mzumsande:202306_feature_init_fix",
      "ref": "202306_feature_init_fix",
      "sha": "d27b9a2248476439ddab7700327f074005a810d5",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 187673073,
        "node_id": "MDEwOlJlcG9zaXRvcnkxODc2NzMwNzM=",
        "name": "bitcoin",
        "full_name": "mzumsande/bitcoin",
        "owner": {
          "login": "mzumsande",
          "id": 48763452,
          "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
          "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/mzumsande",
          "html_url": "https://github.com/mzumsande",
          "followers_url": "https://api.github.com/users/mzumsande/followers",
          "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
          "organizations_url": "https://api.github.com/users/mzumsande/orgs",
          "repos_url": "https://api.github.com/users/mzumsande/repos",
          "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/mzumsande/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/mzumsande/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/mzumsande/bitcoin",
        "archive_url": "https://api.github.com/repos/mzumsande/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/mzumsande/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/mzumsande/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/mzumsande/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/mzumsande/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/mzumsande/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/mzumsande/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/mzumsande/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/mzumsande/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/mzumsande/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/mzumsande/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/mzumsande/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/mzumsande/bitcoin/events",
        "forks_url": "https://api.github.com/repos/mzumsande/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/mzumsande/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/mzumsande/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/mzumsande/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/mzumsande/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/mzumsande/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/mzumsande/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/mzumsande/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/mzumsande/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/mzumsande/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/mzumsande/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/mzumsande/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/mzumsande/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/mzumsande/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/mzumsande/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/mzumsande/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:mzumsande/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/mzumsande/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/mzumsande/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/mzumsande/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/mzumsande/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/mzumsande/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/mzumsande/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/mzumsande/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/mzumsande/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/mzumsande/bitcoin/hooks",
        "svn_url": "https://github.com/mzumsande/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 2,
        "watchers_count": 2,
        "size": 218813,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-07-28T17:06:51Z",
        "created_at": "2019-05-20T16:03:10Z",
        "updated_at": "2023-07-28T06:57:51Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "c6a338b67e8e7848e6f42329a8b0bf3add16ad51",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 35476,
        "stargazers_count": 70608,
        "watchers_count": 70608,
        "size": 236222,
        "default_branch": "master",
        "open_issues_count": 673,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-08-03T00:03:27Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2023-08-02T18:21:18Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 24,
    "deletions": 5,
    "changed_files": 2,
    "commits": 2,
    "review_comments": 13,
    "comments": 7
  },
  "events": [
    {
      "event": "commented",
      "id": 1575673596,
      "node_id": "IC_kwDOABII585d6t78",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1575673596",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-04T18:55:16Z",
      "updated_at": "2023-07-19T13:55:12Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [furszy](https://github.com/bitcoin/bitcoin/pull/27823#pullrequestreview-1535880019) |\n| Concept ACK | [jonatack](https://github.com/bitcoin/bitcoin/pull/27823#pullrequestreview-1482357475), [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/27823#issuecomment-1598781025) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#issuecomment-1575673596",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27823"
    },
    {
      "event": "reviewed",
      "id": 1461336335,
      "node_id": "PRR_kwDOABII585XGjkP",
      "url": null,
      "actor": null,
      "commit_id": "fe0006221737023fd66f6fbf37f605670920fe77",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "Brotcrunsher",
        "id": 19430475,
        "node_id": "MDQ6VXNlcjE5NDMwNDc1",
        "avatar_url": "https://avatars.githubusercontent.com/u/19430475?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Brotcrunsher",
        "html_url": "https://github.com/Brotcrunsher",
        "followers_url": "https://api.github.com/users/Brotcrunsher/followers",
        "following_url": "https://api.github.com/users/Brotcrunsher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Brotcrunsher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Brotcrunsher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Brotcrunsher/subscriptions",
        "organizations_url": "https://api.github.com/users/Brotcrunsher/orgs",
        "repos_url": "https://api.github.com/users/Brotcrunsher/repos",
        "events_url": "https://api.github.com/users/Brotcrunsher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Brotcrunsher/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#pullrequestreview-1461336335",
      "submitted_at": "2023-06-04T19:27:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
    },
    {
      "event": "commented",
      "id": 1575685598,
      "node_id": "IC_kwDOABII585d6w3e",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1575685598",
      "actor": {
        "login": "Brotcrunsher",
        "id": 19430475,
        "node_id": "MDQ6VXNlcjE5NDMwNDc1",
        "avatar_url": "https://avatars.githubusercontent.com/u/19430475?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Brotcrunsher",
        "html_url": "https://github.com/Brotcrunsher",
        "followers_url": "https://api.github.com/users/Brotcrunsher/followers",
        "following_url": "https://api.github.com/users/Brotcrunsher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Brotcrunsher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Brotcrunsher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Brotcrunsher/subscriptions",
        "organizations_url": "https://api.github.com/users/Brotcrunsher/orgs",
        "repos_url": "https://api.github.com/users/Brotcrunsher/repos",
        "events_url": "https://api.github.com/users/Brotcrunsher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Brotcrunsher/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-04T19:34:01Z",
      "updated_at": "2023-06-04T19:34:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "Little disclaimer: It's my first Review for Bitcoin Core. So treat my input with care, I might have no clue what I am talking about.\r\n\r\nWhat I don't like about this change is that previously the user at least had a chance of finding out what's wrong, without debugging the code. Now he won't have any info of what went wrong other than \"Error loading block database\", which can have multiple other reasons. Is there a way for us to communicate this better? Maybe a log? Or can we throw here? The sad thing is that the return seems to be intermangled with none error cases like `ShutdownRequested`.",
      "user": {
        "login": "Brotcrunsher",
        "id": 19430475,
        "node_id": "MDQ6VXNlcjE5NDMwNDc1",
        "avatar_url": "https://avatars.githubusercontent.com/u/19430475?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Brotcrunsher",
        "html_url": "https://github.com/Brotcrunsher",
        "followers_url": "https://api.github.com/users/Brotcrunsher/followers",
        "following_url": "https://api.github.com/users/Brotcrunsher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Brotcrunsher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Brotcrunsher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Brotcrunsher/subscriptions",
        "organizations_url": "https://api.github.com/users/Brotcrunsher/orgs",
        "repos_url": "https://api.github.com/users/Brotcrunsher/repos",
        "events_url": "https://api.github.com/users/Brotcrunsher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Brotcrunsher/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#issuecomment-1575685598",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27823"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9425678157,
      "node_id": "HRFPE_lADOABII585nvmawzwAAAAIx0G9N",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9425678157",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-04T19:43:59Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-05T01:07:17Z",
      "updated_at": "2023-06-05T01:07:17Z",
      "source": {
        "issue": {
          "id": 1718465932,
          "node_id": "PR_kwDOABII585Q9EjQ",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27711/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/27711",
          "number": 27711,
          "state": "closed",
          "state_reason": null,
          "title": "kernel:  Remove shutdown globals from kernel library",
          "body": "This pull request is part of the `libbitcoinkernel` project https://github.com/bitcoin/bitcoin/issues/27587 https://github.com/orgs/bitcoin/projects/3 and more specifically its \"Step 2: Decouple most non-consensus code from libbitcoinkernel\".\r\n\r\n---\r\n\r\nThis removes the shutdown files from the kernel library. As a standalone library the libbitcoinkernel should not have to rely on code that accesses shutdown state through a global. Instead, replace it with an interrupt class that is owned by the kernel context. Additionally this moves the remaining usages of the `uiInterface` out of the kernel code. The process of moving the `uiInterface` out of the kernel was started in https://github.com/bitcoin/bitcoin/pull/27636.\r\n\r\nThe approach taken here uses the notification interface to externalize the existing shutdown code from the kernel library. The `SignalInterrupt` kernel context member is passed by reference to the `ChainstateManager` to allow for the termination of long-running kernel functions and sending interrupt signals.\r\n",
          "user": {
            "login": "TheCharlatan",
            "id": 8421793,
            "node_id": "MDQ6VXNlcjg0MjE3OTM=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TheCharlatan",
            "html_url": "https://github.com/TheCharlatan",
            "followers_url": "https://api.github.com/users/TheCharlatan/followers",
            "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
            "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
            "repos_url": "https://api.github.com/users/TheCharlatan/repos",
            "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 118379652,
              "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
              "name": "Validation",
              "color": "6060aa",
              "default": false
            },
            {
              "id": 955867938,
              "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
              "name": "Needs rebase",
              "description": "",
              "color": "cccccc",
              "default": false
            },
            {
              "id": 5334691551,
              "node_id": "LA_kwDOABII588AAAABPfju3w",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
              "name": "CI failed",
              "description": "",
              "color": "cccccc",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 20,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27711",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/27711",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/27711.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/27711.patch"
          },
          "closed_at": "2023-07-08T10:45:07Z",
          "created_at": "2023-05-21T11:20:12Z",
          "updated_at": "2023-07-08T10:45:07Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-05T09:45:23Z",
      "updated_at": "2023-06-05T09:45:23Z",
      "source": {
        "issue": {
          "id": 1482410987,
          "node_id": "PR_kwDOABII585Eqmsf",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26653",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26653/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26653/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/26653/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/26653",
          "number": 26653,
          "state": "closed",
          "state_reason": null,
          "title": "test, init: perturb file to ensure failure instead of only deleting them",
          "body": "In `feature_init.py` there is a TODO about perturbing the files instead of only testing by deleting them.\r\n```py\r\n            # TODO: at some point, we should test perturbing the files instead of removing\r\n            # them, e.g.\r\n            #\r\n            # contents = target_file.read_bytes()\r\n            # tweaked_contents = bytearray(contents)\r\n            # tweaked_contents[50:250] = b'1' * 200\r\n            # target_file.write_bytes(bytes(tweaked_contents))\r\n            #\r\n            # At the moment I can't get this to work (bitcoind loads successfully?) so\r\n            # investigate doing this later.\r\n```\r\n\r\nThis PR adds it by writing into the file random bytes and checking whether it throws an error when starting.",
          "user": {
            "login": "brunoerg",
            "id": 19480819,
            "node_id": "MDQ6VXNlcjE5NDgwODE5",
            "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/brunoerg",
            "html_url": "https://github.com/brunoerg",
            "followers_url": "https://api.github.com/users/brunoerg/followers",
            "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
            "organizations_url": "https://api.github.com/users/brunoerg/orgs",
            "repos_url": "https://api.github.com/users/brunoerg/repos",
            "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/brunoerg/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 62963516,
              "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
              "name": "Tests",
              "color": "d4c5f9",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 2,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/26653",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/26653",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/26653.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/26653.patch"
          },
          "closed_at": "2023-05-05T13:13:53Z",
          "created_at": "2022-12-07T17:12:21Z",
          "updated_at": "2023-06-05T09:45:23Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 1462508209,
      "node_id": "PRR_kwDOABII585XLBqx",
      "url": null,
      "actor": null,
      "commit_id": "6d853ab639a7ddecf7d934c4d1fb48d29eccc27b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#pullrequestreview-1462508209",
      "submitted_at": "2023-06-05T13:11:45Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
    },
    {
      "event": "commented",
      "id": 1576922867,
      "node_id": "IC_kwDOABII585d_e7z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1576922867",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-05T14:34:08Z",
      "updated_at": "2023-06-05T14:34:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Now he won't have any info of what went wrong other than \"Error loading block database\", which can have multiple other reasons. Is there a way for us to communicate this better? Maybe a log? Or can we throw here?\r\n\r\nThanks! Yes, adding a log seems like a good idea, I'll do that with the next push!",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#issuecomment-1576922867",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27823"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-13T17:44:08Z",
      "updated_at": "2023-06-13T17:44:08Z",
      "source": {
        "issue": {
          "id": 1752750822,
          "node_id": "PR_kwDOABII585SxeMV",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27861",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27861/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27861/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27861/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/27861",
          "number": 27861,
          "state": "closed",
          "state_reason": null,
          "title": "kernel: Rm ShutdownRequested and AbortNode from validation code.",
          "body": "Get rid of all `ShutdownRequested` calls in validation code by introducing an interrupt object that applications can use to cancel long-running kernel operations.\r\n\r\nReplace all `AbortNode` calls in validation code with new fatal error and flush error notifications so kernel applications can be notified about failures and choose how to handle them. \r\n\r\n---\r\n\r\nThis pull request is part of the `libbitcoinkernel` project https://github.com/bitcoin/bitcoin/issues/27587 https://github.com/orgs/bitcoin/projects/3 and more specifically its \"Step 2: Decouple most non-consensus code from libbitcoinkernel\".\r\n\r\nThe pull request mostly allows dropping the kernel dependency on shutdown.cpp. The only dependency left after this is a `StartShutdown` call which will be removed in followup PR https://github.com/bitcoin/bitcoin/pull/27711. This PR also drops the last reference to the `uiInterface` global in kernel code. The process of moving the `uiInterface` out of the kernel was started in https://github.com/bitcoin/bitcoin/pull/27636.\r\n\r\nThis pull request contains a subset of patches originally proposed in #27711. It will be part of a series of changes required to make handling of interrupts (or in other words the current shutdown procedure) in the kernel library more transparent and less reliable on global mutable state. The set of patches contained here was originally proposed by @ryanofsky [here](https://github.com/bitcoin/bitcoin/pull/27711#issuecomment-1580779869). ",
          "user": {
            "login": "TheCharlatan",
            "id": 8421793,
            "node_id": "MDQ6VXNlcjg0MjE3OTM=",
            "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/TheCharlatan",
            "html_url": "https://github.com/TheCharlatan",
            "followers_url": "https://api.github.com/users/TheCharlatan/followers",
            "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
            "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
            "repos_url": "https://api.github.com/users/TheCharlatan/repos",
            "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 118379652,
              "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
              "name": "Validation",
              "color": "6060aa",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 17,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27861",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/27861",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/27861.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/27861.patch"
          },
          "closed_at": "2023-07-06T21:07:43Z",
          "created_at": "2023-06-12T13:16:33Z",
          "updated_at": "2023-07-10T23:43:05Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9543838118,
      "node_id": "HRFPE_lADOABII585nvmawzwAAAAI422mm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9543838118",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-15T18:48:01Z"
    },
    {
      "event": "commented",
      "id": 1593569559,
      "node_id": "IC_kwDOABII585e-_EX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1593569559",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-15T18:53:25Z",
      "updated_at": "2023-06-15T18:53:25Z",
      "author_association": "CONTRIBUTOR",
      "body": "Added a Log error, and made the commit message more precise.\r\n\r\n\r\n> I do wonder though if it would be possible / more general to directly check that each block of height > 0 has a predecessor in the chain, instead of doing what the PR currently suggests.\r\n\r\nSince the current approach wouldn't catch all possible cases of a non-contiguous block index (but the one encountered in feature_init.py !), still looking to into having a stricter check - opinions welcome!\r\n",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#issuecomment-1593569559",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27823"
    },
    {
      "event": "labeled",
      "id": 9544375237,
      "node_id": "LE_lADOABII585nvmawzwAAAAI445vF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9544375237",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-15T19:53:23Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1482357475,
      "node_id": "PRR_kwDOABII585YWvrj",
      "url": null,
      "actor": null,
      "commit_id": "5352a981de1cc17e231e7336098bf03d600002ff",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#pullrequestreview-1482357475",
      "submitted_at": "2023-06-15T20:43:40Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
    },
    {
      "event": "unsubscribed",
      "id": 9547896371,
      "node_id": "UE_lADOABII585nvmawzwAAAAI5GVYz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9547896371",
      "actor": {
        "login": "joostjager",
        "id": 4638168,
        "node_id": "MDQ6VXNlcjQ2MzgxNjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4638168?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/joostjager",
        "html_url": "https://github.com/joostjager",
        "followers_url": "https://api.github.com/users/joostjager/followers",
        "following_url": "https://api.github.com/users/joostjager/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/joostjager/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/joostjager/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/joostjager/subscriptions",
        "organizations_url": "https://api.github.com/users/joostjager/orgs",
        "repos_url": "https://api.github.com/users/joostjager/repos",
        "events_url": "https://api.github.com/users/joostjager/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/joostjager/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-16T06:54:50Z"
    },
    {
      "event": "commented",
      "id": 1598781025,
      "node_id": "IC_kwDOABII585fS3Zh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1598781025",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-20T13:23:05Z",
      "updated_at": "2023-06-20T13:23:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#issuecomment-1598781025",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27823"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9665753309,
      "node_id": "HRFPE_lADOABII585nvmawzwAAAAJAH7Dd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9665753309",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-28T14:43:51Z"
    },
    {
      "event": "commented",
      "id": 1611579553,
      "node_id": "IC_kwDOABII585gDsCh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1611579553",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-28T14:44:02Z",
      "updated_at": "2023-06-28T14:44:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Could rebase for CI?\r\n\r\ndone",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#issuecomment-1611579553",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27823"
    },
    {
      "event": "unlabeled",
      "id": 9673403646,
      "node_id": "UNLE_lADOABII585nvmawzwAAAAJAlGz-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9673403646",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-29T07:02:59Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 9748531447,
      "node_id": "LE_lADOABII585nvmawzwAAAAJFDsj3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9748531447",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-06T22:05:18Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGFkNjZjYTFlNDc1ZDI1NDZkYmJkYTIwNjQ2NTMwNzYxMzEwOGExNWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ad66ca1e475d2546dbbda206465307613108a15d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ad66ca1e475d2546dbbda206465307613108a15d",
      "tree": {
        "sha": "14a50278e78e8c68cfe96e94a870ce9cb6cee9d9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/14a50278e78e8c68cfe96e94a870ce9cb6cee9d9"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/57b8336dfed6312003cf34cd5ae7099f77115e73",
          "sha": "57b8336dfed6312003cf34cd5ae7099f77115e73",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/57b8336dfed6312003cf34cd5ae7099f77115e73"
        }
      ],
      "message": "init: abort loading of blockindex in case of missing height.\n\nIf a height is missing we are facing a non-contiguous block index db, and could previously\nhit an assert in GetAncestor() called from BuildSkip() instead of returning an error.",
      "committer": {
        "name": "Martin Zumsande",
        "email": "mzumsande@gmail.com",
        "date": "2023-07-18T15:29:40Z"
      },
      "author": {
        "name": "Martin Zumsande",
        "email": "mzumsande@gmail.com",
        "date": "2023-06-02T20:36:01Z"
      },
      "sha": "ad66ca1e475d2546dbbda206465307613108a15d"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9852108798,
      "node_id": "HRFPE_lADOABII585nvmawzwAAAAJLOz_-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9852108798",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-18T15:37:09Z"
    },
    {
      "event": "reviewed",
      "id": 1535361885,
      "node_id": "PRR_kwDOABII585bg8Nd",
      "url": null,
      "actor": null,
      "commit_id": "9d3368141b7e782a578efa765899103b29c814f3",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#pullrequestreview-1535361885",
      "submitted_at": "2023-07-18T15:46:22Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
    },
    {
      "event": "unlabeled",
      "id": 9852896615,
      "node_id": "UNLE_lADOABII585nvmawzwAAAAJLR0Vn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9852896615",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-18T16:46:26Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQyN2I5YTIyNDg0NzY0MzlkZGFiNzcwMDMyN2YwNzQwMDVhODEwZDU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d27b9a2248476439ddab7700327f074005a810d5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d27b9a2248476439ddab7700327f074005a810d5",
      "tree": {
        "sha": "cf647082c3750728f0e7842ebc6054264df02e83",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cf647082c3750728f0e7842ebc6054264df02e83"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ad66ca1e475d2546dbbda206465307613108a15d",
          "sha": "ad66ca1e475d2546dbbda206465307613108a15d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ad66ca1e475d2546dbbda206465307613108a15d"
        }
      ],
      "message": "test: fix feature_init.py file perturbation\n\nSimultaneously opening the file in read and write mode would\nlead to opening of an empty file instead of perturbing the existing\nfile.\nAlso, revert to the previous state after each perturbation so that\neach perturbation is applied in isolation.",
      "committer": {
        "name": "Martin Zumsande",
        "email": "mzumsande@gmail.com",
        "date": "2023-07-18T19:54:23Z"
      },
      "author": {
        "name": "Martin Zumsande",
        "email": "mzumsande@gmail.com",
        "date": "2023-06-02T17:45:02Z"
      },
      "sha": "d27b9a2248476439ddab7700327f074005a810d5"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9855097565,
      "node_id": "HRFPE_lADOABII585nvmawzwAAAAJLaNrd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/9855097565",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-18T20:17:14Z"
    },
    {
      "event": "commented",
      "id": 1640940299,
      "node_id": "IC_kwDOABII585hzsML",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1640940299",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-18T20:20:11Z",
      "updated_at": "2023-07-18T20:20:11Z",
      "author_association": "CONTRIBUTOR",
      "body": "[9d33681 ](https://github.com/bitcoin/bitcoin/commit/9d3368141b7e782a578efa765899103b29c814f3)to [d27b9a2](https://github.com/bitcoin/bitcoin/commit/d27b9a2248476439ddab7700327f074005a810d5):\r\nAdded an explanation why the `tweaked_contents` window of `feature_init.py` was changed: Since the genesis block is not checked by the `-checkblocks` verification, the perturbation window must be chosen such that a higher block in blk*.dat is affected.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#issuecomment-1640940299",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/27823"
    },
    {
      "event": "reviewed",
      "id": 1535880019,
      "node_id": "PRR_kwDOABII585bi6tT",
      "url": null,
      "actor": null,
      "commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code ACK d27b9a224",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#pullrequestreview-1535880019",
      "submitted_at": "2023-07-19T13:55:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1217034392",
      "pull_request_review_id": 1461336335,
      "id": 1217034392,
      "node_id": "PRRC_kwDOABII585IiniY",
      "diff_hunk": "@@ -260,8 +260,11 @@ bool BlockManager::LoadBlockIndex()\n     std::sort(vSortedByHeight.begin(), vSortedByHeight.end(),\n               CBlockIndexHeightOnlyComparator());\n \n+    CBlockIndex* previous_index{nullptr};\n     for (CBlockIndex* pindex : vSortedByHeight) {\n         if (ShutdownRequested()) return false;\n+        if (previous_index && pindex->nHeight > previous_index->nHeight + 1) return false; // corruption, non-contiguous block indexes",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 7,
      "commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "original_commit_id": "fe0006221737023fd66f6fbf37f605670920fe77",
      "in_reply_to_id": null,
      "user": {
        "login": "Brotcrunsher",
        "id": 19430475,
        "node_id": "MDQ6VXNlcjE5NDMwNDc1",
        "avatar_url": "https://avatars.githubusercontent.com/u/19430475?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Brotcrunsher",
        "html_url": "https://github.com/Brotcrunsher",
        "followers_url": "https://api.github.com/users/Brotcrunsher/followers",
        "following_url": "https://api.github.com/users/Brotcrunsher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Brotcrunsher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Brotcrunsher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Brotcrunsher/subscriptions",
        "organizations_url": "https://api.github.com/users/Brotcrunsher/orgs",
        "repos_url": "https://api.github.com/users/Brotcrunsher/repos",
        "events_url": "https://api.github.com/users/Brotcrunsher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Brotcrunsher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Wouldn't it be better to check for `!=` instead for `>`? If the file is corrupt, then the indices might as well suddenly go down.",
      "created_at": "2023-06-04T19:27:22Z",
      "updated_at": "2023-06-04T19:28:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#discussion_r1217034392",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1217034392"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 266,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1217039090",
      "pull_request_review_id": 1461337650,
      "id": 1217039090,
      "node_id": "PRRC_kwDOABII585Iiory",
      "diff_hunk": "@@ -260,8 +260,11 @@ bool BlockManager::LoadBlockIndex()\n     std::sort(vSortedByHeight.begin(), vSortedByHeight.end(),\n               CBlockIndexHeightOnlyComparator());\n \n+    CBlockIndex* previous_index{nullptr};\n     for (CBlockIndex* pindex : vSortedByHeight) {\n         if (ShutdownRequested()) return false;\n+        if (previous_index && pindex->nHeight > previous_index->nHeight + 1) return false; // corruption, non-contiguous block indexes",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 7,
      "commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "original_commit_id": "fe0006221737023fd66f6fbf37f605670920fe77",
      "in_reply_to_id": 1217034392,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think that would be incorrect, because there will be multiple indexes for a given height in case of stale blocks / forks.",
      "created_at": "2023-06-04T19:32:01Z",
      "updated_at": "2023-06-04T19:32:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#discussion_r1217039090",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1217039090"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 266,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1217039358",
      "pull_request_review_id": 1461337678,
      "id": 1217039358,
      "node_id": "PRRC_kwDOABII585Iiov-",
      "diff_hunk": "@@ -260,8 +260,11 @@ bool BlockManager::LoadBlockIndex()\n     std::sort(vSortedByHeight.begin(), vSortedByHeight.end(),\n               CBlockIndexHeightOnlyComparator());\n \n+    CBlockIndex* previous_index{nullptr};\n     for (CBlockIndex* pindex : vSortedByHeight) {\n         if (ShutdownRequested()) return false;\n+        if (previous_index && pindex->nHeight > previous_index->nHeight + 1) return false; // corruption, non-contiguous block indexes",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 7,
      "commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "original_commit_id": "fe0006221737023fd66f6fbf37f605670920fe77",
      "in_reply_to_id": 1217034392,
      "user": {
        "login": "Brotcrunsher",
        "id": 19430475,
        "node_id": "MDQ6VXNlcjE5NDMwNDc1",
        "avatar_url": "https://avatars.githubusercontent.com/u/19430475?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Brotcrunsher",
        "html_url": "https://github.com/Brotcrunsher",
        "followers_url": "https://api.github.com/users/Brotcrunsher/followers",
        "following_url": "https://api.github.com/users/Brotcrunsher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Brotcrunsher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Brotcrunsher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Brotcrunsher/subscriptions",
        "organizations_url": "https://api.github.com/users/Brotcrunsher/orgs",
        "repos_url": "https://api.github.com/users/Brotcrunsher/repos",
        "events_url": "https://api.github.com/users/Brotcrunsher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Brotcrunsher/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "True!",
      "created_at": "2023-06-04T19:32:23Z",
      "updated_at": "2023-06-04T19:44:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#discussion_r1217039358",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1217039358"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 266,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1218054540",
      "pull_request_review_id": 1462508209,
      "id": 1218054540,
      "node_id": "PRRC_kwDOABII585ImgmM",
      "diff_hunk": "@@ -260,8 +260,11 @@ bool BlockManager::LoadBlockIndex()\n     std::sort(vSortedByHeight.begin(), vSortedByHeight.end(),\n               CBlockIndexHeightOnlyComparator());\n \n+    CBlockIndex* previous_index{nullptr};\n     for (CBlockIndex* pindex : vSortedByHeight) {\n         if (ShutdownRequested()) return false;\n+        if (previous_index && pindex->nHeight > previous_index->nHeight + 1) return false; // corruption, non-contiguous block indexes\n+        previous_index = pindex;",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "original_commit_id": "0b8b0e3051bb972a878f1855e7d32822b799e1e1",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Couldn't `vSortedByHeight` contain blocks from different chains at the same height?",
      "created_at": "2023-06-05T13:11:23Z",
      "updated_at": "2023-06-05T13:11:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#discussion_r1218054540",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1218054540"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
        }
      },
      "start_line": null,
      "original_start_line": 263,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 268,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1218160139",
      "pull_request_review_id": 1462689403,
      "id": 1218160139,
      "node_id": "PRRC_kwDOABII585Im6YL",
      "diff_hunk": "@@ -260,8 +260,11 @@ bool BlockManager::LoadBlockIndex()\n     std::sort(vSortedByHeight.begin(), vSortedByHeight.end(),\n               CBlockIndexHeightOnlyComparator());\n \n+    CBlockIndex* previous_index{nullptr};\n     for (CBlockIndex* pindex : vSortedByHeight) {\n         if (ShutdownRequested()) return false;\n+        if (previous_index && pindex->nHeight > previous_index->nHeight + 1) return false; // corruption, non-contiguous block indexes\n+        previous_index = pindex;",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "original_commit_id": "0b8b0e3051bb972a878f1855e7d32822b799e1e1",
      "in_reply_to_id": 1218054540,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "What do you mean with \"different chains\"? `vSortedHeight` could contain blocks with the same height x (forks), but I can't see how these could have made it into the block index without having a predecessor of height x - 1 at the time they were added. Also, these shouldn't make the added check fail.\r\n\r\nI do wonder though if it would be possible / more general to directly check that each block of height > 0 has a predecessor in the chain, instead of doing what the PR currently suggests. I'll look into that.",
      "created_at": "2023-06-05T14:30:58Z",
      "updated_at": "2023-06-05T14:40:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#discussion_r1218160139",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1218160139"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
        }
      },
      "start_line": null,
      "original_start_line": 263,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 268,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1218214833",
      "pull_request_review_id": 1462776690,
      "id": 1218214833,
      "node_id": "PRRC_kwDOABII585InHux",
      "diff_hunk": "@@ -260,8 +260,11 @@ bool BlockManager::LoadBlockIndex()\n     std::sort(vSortedByHeight.begin(), vSortedByHeight.end(),\n               CBlockIndexHeightOnlyComparator());\n \n+    CBlockIndex* previous_index{nullptr};\n     for (CBlockIndex* pindex : vSortedByHeight) {\n         if (ShutdownRequested()) return false;\n+        if (previous_index && pindex->nHeight > previous_index->nHeight + 1) return false; // corruption, non-contiguous block indexes\n+        previous_index = pindex;",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "original_commit_id": "0b8b0e3051bb972a878f1855e7d32822b799e1e1",
      "in_reply_to_id": 1218054540,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> What do you mean with \"different chains\"? `vSortedHeight` could contain blocks with the same height x (forks), but I can't see how these could have made it into the block index without having a predecessor of height x - 1 at the time they were added. Also, these shouldn't make the added check fail.\r\n\r\nyeah ok. nvm. Got confused by the early return (I thought it in the other way around).\r\nThe check will have the previous block at the same height, so `pindex->nHeight > previous_index->nHeight + 1` will be false.\r\n\r\n> I do wonder though if it would be possible / more general to directly check that each block of height > 0 has a predecessor in the chain, instead of doing what the PR currently suggests. I'll look into that.\r\n\r\nWouldn't that be broken if we ever add a parallel headers download process?\r\nWhich IIRC we don't have because they are downloaded from a single peer at time. But if we implement it, we could get orphan block indexes pretty easily.",
      "created_at": "2023-06-05T15:09:22Z",
      "updated_at": "2023-06-05T15:09:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#discussion_r1218214833",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1218214833"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
        }
      },
      "start_line": null,
      "original_start_line": 263,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 268,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1218371741",
      "pull_request_review_id": 1463032349,
      "id": 1218371741,
      "node_id": "PRRC_kwDOABII585InuCd",
      "diff_hunk": "@@ -260,8 +260,11 @@ bool BlockManager::LoadBlockIndex()\n     std::sort(vSortedByHeight.begin(), vSortedByHeight.end(),\n               CBlockIndexHeightOnlyComparator());\n \n+    CBlockIndex* previous_index{nullptr};\n     for (CBlockIndex* pindex : vSortedByHeight) {\n         if (ShutdownRequested()) return false;\n+        if (previous_index && pindex->nHeight > previous_index->nHeight + 1) return false; // corruption, non-contiguous block indexes\n+        previous_index = pindex;",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "original_commit_id": "0b8b0e3051bb972a878f1855e7d32822b799e1e1",
      "in_reply_to_id": 1218054540,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Wouldn't that be broken if we ever add a parallel headers download process?\r\n> Which IIRC we don't have because they are downloaded from a single peer at time. But if we implement it, we could get orphan block indexes pretty easily.\r\n\r\nYes, but only we had a very naive parallel headers download process. I would imagine that if we ever parallelized headers download, we'd take care not to accept orphaned block indexes into our main block index (for DoS reasons) but would keep those headers in some kind of intermediate buffer until we can connect them.\r\n\r\n`net_processing` makes sure that we only save headers that we connect ([code](https://github.com/bitcoin/bitcoin/blob/f4a8269dfc144cc918570bdb870aa5143a11c1fe/src/net_processing.cpp#L2871-L2881)).",
      "created_at": "2023-06-05T17:22:11Z",
      "updated_at": "2023-06-05T17:22:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#discussion_r1218371741",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1218371741"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
        }
      },
      "start_line": null,
      "original_start_line": 263,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 268,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1231516688",
      "pull_request_review_id": 1482357475,
      "id": 1231516688,
      "node_id": "PRRC_kwDOABII585JZ3QQ",
      "diff_hunk": "@@ -260,8 +260,13 @@ bool BlockManager::LoadBlockIndex()\n     std::sort(vSortedByHeight.begin(), vSortedByHeight.end(),\n               CBlockIndexHeightOnlyComparator());\n \n+    CBlockIndex* previous_index{nullptr};\n     for (CBlockIndex* pindex : vSortedByHeight) {\n         if (ShutdownRequested()) return false;\n+        if (previous_index && pindex->nHeight > previous_index->nHeight + 1) {\n+            return error(\"%s: block index is non-contiguous, index of height %d missing\", __func__, previous_index->nHeight + 1);",
      "path": "src/node/blockstorage.cpp",
      "position": 8,
      "original_position": 8,
      "commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "original_commit_id": "5352a981de1cc17e231e7336098bf03d600002ff",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I've probably confused myself by how I'm checking this, but this doesn't seem to be the error site that is being hit?  The diff below passes.  (Your updated test does indeed fail on master and pass after building this pull, as described in the OP.)\r\n\r\n<details><summary>test diff</summary><p>\r\n\r\n```diff\r\ndiff --git a/test/functional/feature_init.py b/test/functional/feature_init.py\r\nindex 194ba9ed265..38bd3d5db0f 100755\r\n--- a/test/functional/feature_init.py\r\n+++ b/test/functional/feature_init.py\r\n@@ -107,6 +107,12 @@ class InitStressTest(BitcoinTestFramework):\r\n             'blocks/blk*.dat': 'Corrupted block database detected.',\r\n         }\r\n \r\n+        errors_logged = [\r\n+            \"ERROR: LoadBlockIndex: block index is non-contiguous\",\r\n+            \"LevelDB read failure: Corruption: not an sstable (bad magic number)\",\r\n+            \"ReadBlockFromDisk(CBlock&, CBlockIndex*): GetHash() doesn't match index for CBlockIndex\",\r\n+        ]\r\n+\r\n         for file_patt, err_fragment in files_to_delete.items():\r\n             target_files = list(node.chain_path.glob(file_patt))\r\n \r\n@@ -126,6 +132,7 @@ class InitStressTest(BitcoinTestFramework):\r\n             self.stop_node(0)\r\n \r\n         self.log.info(\"Test startup errors after perturbing certain essential files\")\r\n+        i = 0\r\n         for file_patt, err_fragment in files_to_perturb.items():\r\n             shutil.copytree(node.chain_path / \"blocks\", node.chain_path / \"blocks_bak\")\r\n             shutil.copytree(node.chain_path / \"chainstate\", node.chain_path / \"chainstate_bak\")\r\n@@ -139,8 +146,10 @@ class InitStressTest(BitcoinTestFramework):\r\n                     tweaked_contents[50:350] = b'1' * 300\r\n                 with open(target_file, \"wb\") as tf_write:\r\n                     tf_write.write(bytes(tweaked_contents))\r\n\r\n-            start_expecting_error(err_fragment)\r\n+            self.log.info(f\"{i} - {err_fragment} - {errors_logged[i]}\")\r\n+            with node.assert_debug_log([errors_logged[i]]):\r\n+                start_expecting_error(err_fragment)\r\n+            i += 1\r\n \r\n             shutil.rmtree(node.chain_path / \"blocks\")\r\n             shutil.rmtree(node.chain_path / \"chainstate\")\r\n```\r\n</p></details>\r\n",
      "created_at": "2023-06-15T20:42:47Z",
      "updated_at": "2023-06-16T01:12:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#discussion_r1231516688",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1231516688"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 266,
      "original_line": 266,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1232345298",
      "pull_request_review_id": 1483668947,
      "id": 1232345298,
      "node_id": "PRRC_kwDOABII585JdBjS",
      "diff_hunk": "@@ -260,8 +260,13 @@ bool BlockManager::LoadBlockIndex()\n     std::sort(vSortedByHeight.begin(), vSortedByHeight.end(),\n               CBlockIndexHeightOnlyComparator());\n \n+    CBlockIndex* previous_index{nullptr};\n     for (CBlockIndex* pindex : vSortedByHeight) {\n         if (ShutdownRequested()) return false;\n+        if (previous_index && pindex->nHeight > previous_index->nHeight + 1) {\n+            return error(\"%s: block index is non-contiguous, index of height %d missing\", __func__, previous_index->nHeight + 1);",
      "path": "src/node/blockstorage.cpp",
      "position": 8,
      "original_position": 8,
      "commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "original_commit_id": "5352a981de1cc17e231e7336098bf03d600002ff",
      "in_reply_to_id": 1231516688,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> The diff below passes.\r\n\r\nWhere does it pass for you?\r\nI tried to apply the diff too, and for me it passes on this branch and fails after removing 04d533781002be054e6f2493f3ab2389135ceec5 (not because the log message isn't found, but because the bitcoin core crashes with the assert before that).\r\nThat is what I would have expected, since the diff adds an additional check for the added log \"ERROR: LoadBlockIndex: block index is non-contiguous\", which is supposed to be hit as a result of the perturbation of the block files.",
      "created_at": "2023-06-16T14:41:16Z",
      "updated_at": "2023-06-16T14:42:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#discussion_r1232345298",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1232345298"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 266,
      "original_line": 266,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266974334",
      "pull_request_review_id": 1535361885,
      "id": 1266974334,
      "node_id": "PRRC_kwDOABII585LhH5-",
      "diff_hunk": "@@ -259,8 +259,13 @@ bool BlockManager::LoadBlockIndex()\n     std::sort(vSortedByHeight.begin(), vSortedByHeight.end(),\n               CBlockIndexHeightOnlyComparator());\n \n+    CBlockIndex* previous_index{nullptr};\n     for (CBlockIndex* pindex : vSortedByHeight) {\n         if (m_interrupt) return false;\n+        if (previous_index && pindex->nHeight > previous_index->nHeight + 1) {\n+            return error(\"%s: block index is non-contiguous, index of height %d missing\", __func__, previous_index->nHeight + 1);\n+        }\n+        previous_index = pindex;",
      "path": "src/node/blockstorage.cpp",
      "position": 10,
      "original_position": 10,
      "commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "original_commit_id": "ad66ca1e475d2546dbbda206465307613108a15d",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "In ad66ca1e:\r\n\r\nWhat if the genesis block index is missing?\r\nThe first round of the loop would set `previous_index` to block_index_1. Second one to block_index_2, etc. Making `LoadBlockIndex()` pass?.",
      "created_at": "2023-07-18T15:46:03Z",
      "updated_at": "2023-07-18T15:46:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#discussion_r1266974334",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1266974334"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
        }
      },
      "start_line": 265,
      "original_start_line": 265,
      "start_side": "RIGHT",
      "line": 268,
      "original_line": 268,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267265463",
      "pull_request_review_id": 1535841203,
      "id": 1267265463,
      "node_id": "PRRC_kwDOABII585LiO-3",
      "diff_hunk": "@@ -259,8 +259,13 @@ bool BlockManager::LoadBlockIndex()\n     std::sort(vSortedByHeight.begin(), vSortedByHeight.end(),\n               CBlockIndexHeightOnlyComparator());\n \n+    CBlockIndex* previous_index{nullptr};\n     for (CBlockIndex* pindex : vSortedByHeight) {\n         if (m_interrupt) return false;\n+        if (previous_index && pindex->nHeight > previous_index->nHeight + 1) {\n+            return error(\"%s: block index is non-contiguous, index of height %d missing\", __func__, previous_index->nHeight + 1);\n+        }\n+        previous_index = pindex;",
      "path": "src/node/blockstorage.cpp",
      "position": 10,
      "original_position": 10,
      "commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "original_commit_id": "ad66ca1e475d2546dbbda206465307613108a15d",
      "in_reply_to_id": 1266974334,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "That is true, but the specific case of a missing (or incorrect) genesis block index should get caught in an extra check right after, [see here](https://github.com/bitcoin/bitcoin/blob/c6a338b67e8e7848e6f42329a8b0bf3add16ad51/src/node/chainstate.cpp#L69C1-L74).\r\n\r\nThere are other cases that wouldn't be caught with the proposed solution: We could have the valid chain and also some extra block indices that don't connect. \r\nA stricter check would therefore be to require each block index of height `x` (except genesis) to have a predecessor of height `x - 1`. I didn't add it because these kind of extra blocks wouldn't actually hurt anything, plus maybe there are some of these block indices out there because of some bug in some ancient version of core.",
      "created_at": "2023-07-18T20:16:38Z",
      "updated_at": "2023-07-18T20:16:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#discussion_r1267265463",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267265463"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
        }
      },
      "start_line": 265,
      "original_start_line": 265,
      "start_side": "RIGHT",
      "line": 268,
      "original_line": 268,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267289758",
      "pull_request_review_id": 1535880019,
      "id": 1267289758,
      "node_id": "PRRC_kwDOABII585LiU6e",
      "diff_hunk": "@@ -124,18 +125,31 @@ def check_clean_start():\n             check_clean_start()\n             self.stop_node(0)\n \n+        self.log.info(\"Test startup errors after perturbing certain essential files\")\n         for file_patt, err_fragment in files_to_perturb.items():\n+            shutil.copytree(node.chain_path / \"blocks\", node.chain_path / \"blocks_bak\")\n+            shutil.copytree(node.chain_path / \"chainstate\", node.chain_path / \"chainstate_bak\")\n             target_files = list(node.chain_path.glob(file_patt))\n \n             for target_file in target_files:\n                 self.log.info(f\"Perturbing file to ensure failure {target_file}\")\n-                with open(target_file, \"rb\") as tf_read, open(target_file, \"wb\") as tf_write:\n+                with open(target_file, \"rb\") as tf_read:\n                     contents = tf_read.read()\n                     tweaked_contents = bytearray(contents)\n-                    tweaked_contents[50:250] = b'1' * 200\n+                    # Since the genesis block is not checked by -checkblocks, the\n+                    # perturbation window must be chosen such that a higher block\n+                    # in blk*.dat is affected.\n+                    tweaked_contents[150:350] = b'1' * 200",
      "path": "test/functional/feature_init.py",
      "position": 49,
      "original_position": 49,
      "commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "original_commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Maybe could randomize (or restructure) this a bit in a follow-up. Perturbing different parts of the block content might let us detect and add coverage for different errors.",
      "created_at": "2023-07-18T20:45:39Z",
      "updated_at": "2023-07-19T13:55:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#discussion_r1267289758",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1267289758"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
        }
      },
      "start_line": 139,
      "original_start_line": 139,
      "start_side": "RIGHT",
      "line": 142,
      "original_line": 142,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1268112906",
      "pull_request_review_id": 1535880019,
      "id": 1268112906,
      "node_id": "PRRC_kwDOABII585Lld4K",
      "diff_hunk": "@@ -124,18 +125,31 @@ def check_clean_start():\n             check_clean_start()\n             self.stop_node(0)\n \n+        self.log.info(\"Test startup errors after perturbing certain essential files\")\n         for file_patt, err_fragment in files_to_perturb.items():\n+            shutil.copytree(node.chain_path / \"blocks\", node.chain_path / \"blocks_bak\")\n+            shutil.copytree(node.chain_path / \"chainstate\", node.chain_path / \"chainstate_bak\")",
      "path": "test/functional/feature_init.py",
      "position": 36,
      "original_position": 36,
      "commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "original_commit_id": "d27b9a2248476439ddab7700327f074005a810d5",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: couldn't this be copied outside of the for-loop only once?",
      "created_at": "2023-07-19T13:54:01Z",
      "updated_at": "2023-07-19T13:55:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/27823#discussion_r1268112906",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1268112906"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/27823"
        }
      },
      "start_line": 130,
      "original_start_line": 130,
      "start_side": "RIGHT",
      "line": 131,
      "original_line": 131,
      "side": "RIGHT"
    }
  ]
}