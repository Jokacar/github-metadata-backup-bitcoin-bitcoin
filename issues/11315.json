{
  "type": "issue",
  "issue": {
    "id": 257221993,
    "node_id": "MDU6SXNzdWUyNTcyMjE5OTM=",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11315",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11315/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11315/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11315/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/11315",
    "number": 11315,
    "state": "open",
    "state_reason": null,
    "title": "Prune undermines the dbcache.",
    "body": "\r\n17:13:01 < esotericnonsense> Aaaaand: in particular what was happening for me was that the utxo cache seemingly was being dropped on every   prune event\r\n17:13:18 < esotericnonsense> so with prune off, it'd build up to 2-3GB or more, with it on, it'd never go above 300mb or so\r\n\r\nWe should probably add the dbcache size to the amount of extra blockdata that prune lets the blocks and disk take up over the pruning size... so that pruning doesn't undermine the user's dbcache settings.",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 326918230,
        "node_id": "MDU6TGFiZWwzMjY5MTgyMzA=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Resource%20usage",
        "name": "Resource usage",
        "color": "981023",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 3,
    "created_at": "2017-09-13T00:20:51Z",
    "updated_at": "2019-11-19T16:32:51Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 1246333886,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDEyNDYzMzM4ODY=",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/1246333886",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2017-09-13T00:21:36Z",
      "label": {
        "name": "Resource usage",
        "color": "981023"
      }
    },
    {
      "event": "commented",
      "id": 329021915,
      "node_id": "MDEyOklzc3VlQ29tbWVudDMyOTAyMTkxNQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/329021915",
      "actor": {
        "login": "esotericnonsense",
        "id": 7999704,
        "node_id": "MDQ6VXNlcjc5OTk3MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7999704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/esotericnonsense",
        "html_url": "https://github.com/esotericnonsense",
        "followers_url": "https://api.github.com/users/esotericnonsense/followers",
        "following_url": "https://api.github.com/users/esotericnonsense/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/esotericnonsense/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/esotericnonsense/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/esotericnonsense/subscriptions",
        "organizations_url": "https://api.github.com/users/esotericnonsense/orgs",
        "repos_url": "https://api.github.com/users/esotericnonsense/repos",
        "events_url": "https://api.github.com/users/esotericnonsense/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/esotericnonsense/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2017-09-13T00:25:04Z",
      "updated_at": "2017-09-13T00:25:04Z",
      "author_association": "CONTRIBUTOR",
      "body": "Additional information on how this happened:\r\n\r\n0.15.0rc3 running on a Linode VPS with prune=6480 dbcache=8000.\r\n\r\ndebug.log would indicate cache dropping on every prune event as stated.\r\n\r\nWhen raising prune to 64800, the behaviour stopped happening until hitting the new prune target.\r\n\r\nSounds like gmaxwell's identified the issue already though.",
      "user": {
        "login": "esotericnonsense",
        "id": 7999704,
        "node_id": "MDQ6VXNlcjc5OTk3MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7999704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/esotericnonsense",
        "html_url": "https://github.com/esotericnonsense",
        "followers_url": "https://api.github.com/users/esotericnonsense/followers",
        "following_url": "https://api.github.com/users/esotericnonsense/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/esotericnonsense/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/esotericnonsense/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/esotericnonsense/subscriptions",
        "organizations_url": "https://api.github.com/users/esotericnonsense/orgs",
        "repos_url": "https://api.github.com/users/esotericnonsense/repos",
        "events_url": "https://api.github.com/users/esotericnonsense/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/esotericnonsense/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/11315#issuecomment-329021915",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11315"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "esotericnonsense",
        "id": 7999704,
        "node_id": "MDQ6VXNlcjc5OTk3MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7999704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/esotericnonsense",
        "html_url": "https://github.com/esotericnonsense",
        "followers_url": "https://api.github.com/users/esotericnonsense/followers",
        "following_url": "https://api.github.com/users/esotericnonsense/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/esotericnonsense/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/esotericnonsense/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/esotericnonsense/subscriptions",
        "organizations_url": "https://api.github.com/users/esotericnonsense/orgs",
        "repos_url": "https://api.github.com/users/esotericnonsense/repos",
        "events_url": "https://api.github.com/users/esotericnonsense/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/esotericnonsense/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2017-09-17T22:23:55Z",
      "updated_at": "2017-09-17T22:23:55Z",
      "source": {
        "issue": {
          "id": 258340267,
          "node_id": "MDExOlB1bGxSZXF1ZXN0MTQxNTA1MjM4",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11359",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11359/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11359/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11359/events",
          "html_url": "https://github.com/bitcoin/bitcoin/pull/11359",
          "number": 11359,
          "state": "closed",
          "state_reason": null,
          "title": "Add a pruning 'high water mark' to reduce the frequency of pruning events",
          "body": "Partial fix for issue #11315.\r\n\r\nEvery prune event flushes the dbcache to disk.\r\nBy default this happens approximately every ~160MiB so high dbcache values are negated and IBD takes far longer than without pruning enabled.\r\n\r\nThis change allows a 'high water mark' for pruning such that the actual size of blk/rev on disk can increase a reasonable amount before flushing.\r\n\r\nOn a machine with prune=550 and dbcache=3000:\r\n```\r\n2017-09-17 22:04:56 Prune: target=550MiB hwm=3540MiB actual=3510MiB diff=-2960MiB max_prune_height=292477 removed 0 blk/rev pairs\r\n2017-09-17 22:04:56 Prune: target=550MiB hwm=3540MiB actual=3516MiB diff=-2966MiB max_prune_height=292499 removed 0 blk/rev pairs\r\n2017-09-17 22:04:57 Prune: target=550MiB hwm=3540MiB actual=468MiB diff=81MiB max_prune_height=292537 removed 21 blk/rev pairs\r\n2017-09-17 22:04:57 Prune: UnlinkPrunedFiles deleted blk/rev (00103)\r\n...\r\n```\r\n\r\nI haven't changed the 'diff' column in debug log (it could perhaps be hwm - actual rather than target - actual).\r\n\r\nNot sure if this could potentially increase disk space requirements in some cases - may need documentation. With a very high dbcache value, if say 10GiB of blocks come in that only produce 2GiB of chainstate then you'd overshoot quite a bit, I think. It's a tradeoff - more frequent flushing = slower IBD.\r\n\r\nThanks to sipa and gmaxwell for helping out on IRC.",
          "user": {
            "login": "esotericnonsense",
            "id": 7999704,
            "node_id": "MDQ6VXNlcjc5OTk3MDQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7999704?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/esotericnonsense",
            "html_url": "https://github.com/esotericnonsense",
            "followers_url": "https://api.github.com/users/esotericnonsense/followers",
            "following_url": "https://api.github.com/users/esotericnonsense/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/esotericnonsense/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/esotericnonsense/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/esotericnonsense/subscriptions",
            "organizations_url": "https://api.github.com/users/esotericnonsense/orgs",
            "repos_url": "https://api.github.com/users/esotericnonsense/repos",
            "events_url": "https://api.github.com/users/esotericnonsense/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/esotericnonsense/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 118379652,
              "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
              "name": "Validation",
              "color": "6060aa",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 8,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11359",
            "html_url": "https://github.com/bitcoin/bitcoin/pull/11359",
            "diff_url": "https://github.com/bitcoin/bitcoin/pull/11359.diff",
            "patch_url": "https://github.com/bitcoin/bitcoin/pull/11359.patch"
          },
          "closed_at": "2018-07-14T15:07:13Z",
          "created_at": "2017-09-17T22:23:55Z",
          "updated_at": "2021-12-16T14:11:43Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 391290010,
      "node_id": "MDEyOklzc3VlQ29tbWVudDM5MTI5MDAxMA==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/391290010",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2018-05-23T09:52:52Z",
      "updated_at": "2018-05-23T09:53:06Z",
      "author_association": "MEMBER",
      "body": "I did some benchmarking in https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-390595338. So far it appears that reducing the number of flush events if helpful, but reducing them too much appears counter productive, for reasons I don't understand yet.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/11315#issuecomment-391290010",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11315"
    },
    {
      "event": "commented",
      "id": 555592009,
      "node_id": "MDEyOklzc3VlQ29tbWVudDU1NTU5MjAwOQ==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/555592009",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-11-19T16:32:51Z",
      "updated_at": "2019-11-19T16:32:51Z",
      "author_association": "MEMBER",
      "body": "Continued discussion in #15265",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/11315#issuecomment-555592009",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11315"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2020-08-17T05:53:40Z",
      "updated_at": "2020-08-17T05:53:40Z",
      "source": {
        "issue": {
          "id": 679945708,
          "node_id": "MDU6SXNzdWU2Nzk5NDU3MDg=",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19742",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19742/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19742/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19742/events",
          "html_url": "https://github.com/bitcoin/bitcoin/issues/19742",
          "number": 19742,
          "state": "closed",
          "state_reason": "completed",
          "title": "In-memory UTXO cache is flushed too frequently when pruning",
          "body": "**Is your feature request related to a problem? Please describe.**\r\nI'm experimenting `assumevalid=0` (full validation) by running two bitcoin-qt on my laptop, one of which is `-connect`ing to `127.0.0.1`.\r\nIn hope that my hard drive would wear as little as possible (also to accelerate the syncing process as much as possible), I set `dbcache` to 10240 MiB, then pointed `blocksdir` to a ramdisk.\r\nThen I found Bitcoin Core didn't work as my expectation. The files under `chainstate` directory were still read/written frequently.\r\nI think these lines from debug.log should explain what was going on:\r\n```\r\n2020-08-16T17:29:01Z UpdateTip: new best=000000000000066cccef1be790592e559ec4f1cd18f8683554a6bcecb87f8f97 height=154467 version=0x00000001 log2_work=67.223948 tx=1904617 date='2011-11-23T09:49:28Z' progress=0.003424 cache=40.7MiB(276733txo)\r\n2020-08-16T17:29:01Z UpdateTip: new best=00000000000009879303cae0f79181c45eecf749eecd56976c369a546ba7d78e height=154468 version=0x00000001 log2_work=67.223991 tx=1904624 date='2011-11-23T09:49:41Z' progress=0.003424 cache=40.7MiB(276741txo)\r\n2020-08-16T17:29:01Z UpdateTip: new best=0000000000000aa936ad49eb0f7f3342fd8f193960c7fac1571b0625d5aed9de height=154469 version=0x00000001 log2_work=67.224033 tx=1904633 date='2011-11-23T09:55:22Z' progress=0.003424 cache=40.7MiB(276730txo)\r\n2020-08-16T17:29:01Z Pre-allocating up to position 0xd00000 in rev00005.dat\r\n2020-08-16T17:29:01Z Prune: UnlinkPrunedFiles deleted blk/rev (00002)\r\n2020-08-16T17:29:01Z FlushStateToDisk: write coins cache to disk (276837 coins, 42709kB) started\r\n2020-08-16T17:29:02Z FlushStateToDisk: write coins cache to disk (276837 coins, 42709kB) completed (0.59s)\r\n2020-08-16T17:29:02Z UpdateTip: new best=0000000000000bf0a84c8f47fa804644fab66081f4d1207009e09ffe8b1dd272 height=154470 version=0x00000001 log2_work=67.224076 tx=1904752 date='2011-11-23T10:08:52Z' progress=0.003424 cache=6.9MiB(0txo)\r\n2020-08-16T17:29:02Z UpdateTip: new best=0000000000000823d28d3053a071d12e57072b93733a2e57047dff4aac495a6e height=154471 version=0x00000001 log2_work=67.224119 tx=1904756 date='2011-11-23T10:10:42Z' progress=0.003424 cache=6.9MiB(15txo)\r\n2020-08-16T17:29:02Z UpdateTip: new best=0000000000000b8732b07e326bde0a79f91e4808a5683a77c0fc85728a4ca06b height=154472 version=0x00000001 log2_work=67.224162 tx=1904777 date='2011-11-23T10:16:37Z' progress=0.003424 cache=6.9MiB(154txo)\r\n```\r\n\r\n**The log shows that in-memory UTXO cache is flushed too frequently.**\r\n\r\nI then found nothing to control the cache flushing behavoir.\r\n\r\nPreviously I had once done a full sync with similar settings (except that pruning was not enabled, and the blockchain was downloaded from the P2P network, rather than localhost), if I recalled correctly, the cache didn't flush until I finally shut down the full node.\r\n\r\n**Describe the solution you'd like**\r\nProvide an option to control how often the UTXO cache should be flushed, so that the user can take his/her own responsibility for consequences (loss of syncing progress) of system crash/power loss etc.\r\n\r\nIt's also well known that consumer HDDs are flooded with sh*tty DM-SMR models. I think it's really worthwhile to trade such \"crash tolerance\" for performance improvement if there's plenty of RAM. \r\n\r\nThere's also a relatively high chance for a user to take out his/her old spare laptop to run the full node, so that even if more and more PCs come with SSD only in the future, it's still meaningful to take care of this issue.\r\n\r\n**Describe alternatives you've considered**\r\n\r\n**Additional context**",
          "user": {
            "login": "andronoob",
            "id": 4075106,
            "node_id": "MDQ6VXNlcjQwNzUxMDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4075106?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/andronoob",
            "html_url": "https://github.com/andronoob",
            "followers_url": "https://api.github.com/users/andronoob/followers",
            "following_url": "https://api.github.com/users/andronoob/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/andronoob/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/andronoob/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/andronoob/subscriptions",
            "organizations_url": "https://api.github.com/users/andronoob/orgs",
            "repos_url": "https://api.github.com/users/andronoob/repos",
            "events_url": "https://api.github.com/users/andronoob/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/andronoob/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 64585,
              "node_id": "MDU6TGFiZWw2NDU4NQ==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug",
              "name": "Bug",
              "color": "FBBAAB",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "NONE",
          "locked": true,
          "active_lock_reason": "resolved",
          "comments": 2,
          "closed_at": "2020-08-17T07:16:30Z",
          "created_at": "2020-08-17T05:31:27Z",
          "updated_at": "2022-02-15T10:48:37Z"
        },
        "type": "issue"
      }
    }
  ]
}